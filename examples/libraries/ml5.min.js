(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory();else if(typeof define==="function"&&define.amd)define([],factory);else if(typeof exports==="object")exports["ml5"]=factory();else root["ml5"]=factory()})(typeof self!=="undefined"?self:this,function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{configurable:false,enumerable:true,get:getter})}};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="/dist/";return __webpack_require__(__webpack_require__.s=162)}([function(module,exports,__webpack_require__){var global=__webpack_require__(2);var core=__webpack_require__(28);var hide=__webpack_require__(16);var redefine=__webpack_require__(17);var ctx=__webpack_require__(24);var PROTOTYPE="prototype";var $export=function(type,name,source){var IS_FORCED=type&$export.F;var IS_GLOBAL=type&$export.G;var IS_STATIC=type&$export.S;var IS_PROTO=type&$export.P;var IS_BIND=type&$export.B;var target=IS_GLOBAL?global:IS_STATIC?global[name]||(global[name]={}):(global[name]||{})[PROTOTYPE];var exports=IS_GLOBAL?core:core[name]||(core[name]={});var expProto=exports[PROTOTYPE]||(exports[PROTOTYPE]={});var key,own,out,exp;if(IS_GLOBAL)source=name;for(key in source){own=!IS_FORCED&&target&&target[key]!==undefined;out=(own?target:source)[key];exp=IS_BIND&&own?ctx(out,global):IS_PROTO&&typeof out=="function"?ctx(Function.call,out):out;if(target)redefine(target,key,out,type&$export.U);if(exports[key]!=out)hide(exports,key,exp);if(IS_PROTO&&expProto[key]!=out)expProto[key]=out}};global.core=core;$export.F=1;$export.G=2;$export.S=4;$export.P=8;$export.B=16;$export.W=32;$export.U=64;$export.R=128;module.exports=$export},function(module,exports,__webpack_require__){var isObject=__webpack_require__(6);module.exports=function(it){if(!isObject(it))throw TypeError(it+" is not an object!");return it}},function(module,exports){var global=module.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();if(typeof __g=="number")__g=global},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=y[op[0]&2?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[0,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var environment_1=__webpack_require__(11);var util=__webpack_require__(4);var rand_1=__webpack_require__(371);var DType;(function(DType){DType["float32"]="float32";DType["int32"]="int32";DType["bool"]="bool"})(DType=exports.DType||(exports.DType={}));var NDArray=function(){function NDArray(shape,dtype,values,dataId,math){this.isDisposed=false;this.math=math||environment_1.ENV.math;this.size=util.sizeFromShape(shape);if(values!=null){util.assert(this.size===values.length,"Constructing ndarray of shape ("+this.size+") should match the "+("length of values ("+values.length+")"))}this.shape=shape;this.dtype=dtype||"float32";var dim=this.shape.length;if(dim<2){this.strides=[]}else{this.strides=new Array(dim-1);this.strides[dim-2]=this.shape[dim-1];for(var i=dim-3;i>=0;--i){this.strides[i]=this.strides[i+1]*this.shape[i+1]}}this.dataId=dataId!=null?dataId:NDArray.nextDataId++;this.id=NDArray.nextId++;this.rankType=this.rank<5?this.rank.toString():"higher";this.math.register(this);if(values!=null){this.math.write(this.dataId,values)}}NDArray.ones=function(shape,dtype){var values=makeOnesTypedArray(util.sizeFromShape(shape),dtype);return NDArray.make(shape,{values:values},dtype)};NDArray.zeros=function(shape,dtype){var values=makeZerosTypedArray(util.sizeFromShape(shape),dtype);return NDArray.make(shape,{values:values},dtype)};NDArray.onesLike=function(another){return NDArray.ones(another.shape,another.dtype)};NDArray.zerosLike=function(another){return NDArray.zeros(another.shape,another.dtype)};NDArray.like=function(another){var newValues=copyTypedArray(another.dataSync(),another.dtype);return NDArray.make(another.shape,{values:newValues},another.dtype,another.math)};NDArray.make=function(shape,data,dtype,math){switch(shape.length){case 0:return new Scalar(shape,dtype,data.values,data.dataId,math);case 1:return new Array1D(shape,dtype,data.values,data.dataId,math);case 2:return new Array2D(shape,dtype,data.values,data.dataId,math);case 3:return new Array3D(shape,dtype,data.values,data.dataId,math);case 4:return new Array4D(shape,dtype,data.values,data.dataId,math);default:return new NDArray(shape,dtype,data.values,data.dataId,math)}};NDArray.fromPixels=function(pixels,numChannels,math){if(numChannels===void 0){numChannels=3}if(numChannels>4){throw new Error("Cannot construct NDArray with more than 4 channels from pixels.")}var ndarrayData={};var shape=[pixels.height,pixels.width,numChannels];math=math||environment_1.ENV.math;var res=NDArray.make(shape,ndarrayData,"int32",math);math.writePixels(res.dataId,pixels,numChannels);return res};NDArray.prototype.reshape=function(newShape){this.throwIfDisposed();return this.math.reshape(this,newShape)};NDArray.prototype.flatten=function(){this.throwIfDisposed();if(this instanceof Array1D){return this}return this.as1D()};NDArray.prototype.asScalar=function(){this.throwIfDisposed();util.assert(this.size===1,"The array must have only 1 element.");return this.reshape([])};NDArray.prototype.as1D=function(){this.throwIfDisposed();return this.reshape([this.size])};NDArray.prototype.as2D=function(rows,columns){this.throwIfDisposed();return this.reshape([rows,columns])};NDArray.prototype.as3D=function(rows,columns,depth){this.throwIfDisposed();return this.reshape([rows,columns,depth])};NDArray.prototype.as4D=function(rows,columns,depth,depth2){this.throwIfDisposed();return this.reshape([rows,columns,depth,depth2])};NDArray.prototype.asType=function(dtype){this.throwIfDisposed();return this.math.cast(this,dtype)};Object.defineProperty(NDArray.prototype,"rank",{get:function(){return this.shape.length},enumerable:true,configurable:true});NDArray.prototype.get=function(){var locs=[];for(var _i=0;_i<arguments.length;_i++){locs[_i]=arguments[_i]}var index=locs[locs.length-1];for(var i=0;i<locs.length-1;++i){index+=this.strides[i]*locs[i]}return this.dataSync()[index]};NDArray.prototype.add=function(value){var locs=[];for(var _i=1;_i<arguments.length;_i++){locs[_i-1]=arguments[_i]}this.set.apply(this,[this.get.apply(this,locs)+value].concat(locs))};NDArray.prototype.set=function(value){var locs=[];for(var _i=1;_i<arguments.length;_i++){locs[_i-1]=arguments[_i]}this.throwIfDisposed();util.assert(locs.length===this.rank,"The number of provided coordinates ("+locs.length+") must "+("match the rank ("+this.rank+")"));var index=locs.length>0?locs[locs.length-1]:0;for(var i=0;i<locs.length-1;++i){index+=this.strides[i]*locs[i]}var vals=this.dataSync();vals[index]=value;this.math.write(this.dataId,vals)};NDArray.prototype.val=function(){var locs=[];for(var _i=0;_i<arguments.length;_i++){locs[_i]=arguments[_i]}return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:this.throwIfDisposed();return[4,this.data()];case 1:_a.sent();return[2,this.get.apply(this,locs)]}})})};NDArray.prototype.locToIndex=function(locs){this.throwIfDisposed();if(locs.length===0){return 0}var index=locs[locs.length-1];for(var i=0;i<locs.length-1;++i){index+=this.strides[i]*locs[i]}return index};NDArray.prototype.indexToLoc=function(index){this.throwIfDisposed();var locs=new Array(this.shape.length);for(var i=0;i<locs.length-1;++i){locs[i]=Math.floor(index/this.strides[i]);index-=locs[i]*this.strides[i]}locs[locs.length-1]=index;return locs};NDArray.prototype.fill=function(value){this.throwIfDisposed();var vals=this.dataSync();vals.fill(value);this.math.write(this.dataId,vals)};NDArray.prototype.getValues=function(){return this.dataSync()};NDArray.prototype.getValuesAsync=function(){return this.data()};NDArray.prototype.data=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){this.throwIfDisposed();return[2,this.math.read(this.dataId)]})})};NDArray.prototype.dataSync=function(){this.throwIfDisposed();return this.math.readSync(this.dataId)};NDArray.prototype.dispose=function(){if(this.isDisposed){return}this.isDisposed=true;this.math.disposeData(this.dataId)};NDArray.prototype.equals=function(t){this.throwIfDisposed();return this.dtype===t.dtype&&util.arraysEqual(this.shape,t.shape)&&util.arraysEqual(this.dataSync(),t.dataSync())};NDArray.rand=function(shape,randFunction,dtype){var size=util.sizeFromShape(shape);var values=null;if(dtype==null||dtype==="float32"){values=new Float32Array(size)}else if(dtype==="int32"){values=new Int32Array(size)}else if(dtype==="bool"){values=new Uint8Array(size)}else{throw new Error("Unknown data type "+dtype)}for(var i=0;i<size;i++){values[i]=randFunction()}return NDArray.make(shape,{values:values},dtype)};NDArray.randNormal=function(shape,mean,stdDev,dtype,seed){if(mean===void 0){mean=0}if(stdDev===void 0){stdDev=1}if(dtype!=null&&dtype==="bool"){throw new Error("Unsupported data type "+dtype)}var randGauss=new rand_1.MPRandGauss(mean,stdDev,dtype,false,seed);return NDArray.rand(shape,function(){return randGauss.nextValue()},dtype)};NDArray.randTruncatedNormal=function(shape,mean,stdDev,dtype,seed){if(mean===void 0){mean=0}if(stdDev===void 0){stdDev=1}if(dtype!=null&&dtype==="bool"){throw new Error("Unsupported data type "+dtype)}var randGauss=new rand_1.MPRandGauss(mean,stdDev,dtype,true,seed);return NDArray.rand(shape,function(){return randGauss.nextValue()},dtype)};NDArray.randUniform=function(shape,a,b,dtype){return NDArray.rand(shape,function(){return util.randUniform(a,b)},dtype)};NDArray.prototype.throwIfDisposed=function(){if(this.isDisposed){throw new Error("NDArray is disposed.")}};NDArray.nextId=0;NDArray.nextDataId=0;return NDArray}();exports.NDArray=NDArray;var Scalar=function(_super){__extends(Scalar,_super);function Scalar(){return _super!==null&&_super.apply(this,arguments)||this}Scalar.new=function(value,dtype){var values=[value];return new Scalar([],dtype,toTypedArray(values,dtype))};Scalar.prototype.get=function(){return this.dataSync()[0]};Scalar.prototype.val=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.data()];case 1:_a.sent();return[2,this.get()]}})})};Scalar.prototype.add=function(value){this.dataSync()[0]+=value};Scalar.prototype.asType=function(dtype){return _super.prototype.asType.call(this,dtype)};Scalar.prototype.locToIndex=function(loc){return 0};Scalar.prototype.indexToLoc=function(index){return[]};return Scalar}(NDArray);exports.Scalar=Scalar;var Array1D=function(_super){__extends(Array1D,_super);function Array1D(){return _super!==null&&_super.apply(this,arguments)||this}Array1D.new=function(values,dtype){if(!instanceofTypedArray(values)){var inferredShape=util.inferShape(values);util.assert(inferredShape.length===1,"Error constructing Array1D. Shape of values "+inferredShape+" is "+"not 1 dimensional.")}return new Array1D([values.length],dtype,toTypedArray(values,dtype))};Array1D.prototype.get=function(i){return this.dataSync()[i]};Array1D.prototype.val=function(i){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.data()];case 1:_a.sent();return[2,this.get(i)]}})})};Array1D.prototype.add=function(value,i){this.dataSync()[i]+=value};Array1D.prototype.locToIndex=function(loc){return loc[0]};Array1D.prototype.indexToLoc=function(index){return[index]};Array1D.prototype.asType=function(dtype){return _super.prototype.asType.call(this,dtype)};Array1D.ones=function(shape,dtype){return NDArray.ones(shape,dtype)};Array1D.zeros=function(shape,dtype){return NDArray.zeros(shape,dtype)};Array1D.randNormal=function(shape,mean,stdDev,dtype,seed){if(mean===void 0){mean=0}if(stdDev===void 0){stdDev=1}if(dtype!=null&&dtype==="bool"){throw new Error("Unsupported data type "+dtype)}var randGauss=new rand_1.MPRandGauss(mean,stdDev,dtype,false,seed);return NDArray.rand(shape,function(){return randGauss.nextValue()},dtype)};Array1D.randTruncatedNormal=function(shape,mean,stdDev,dtype,seed){if(mean===void 0){mean=0}if(stdDev===void 0){stdDev=1}if(dtype!=null&&dtype==="bool"){throw new Error("Unsupported data type "+dtype)}var randGauss=new rand_1.MPRandGauss(mean,stdDev,dtype,true,seed);return NDArray.rand(shape,function(){return randGauss.nextValue()},dtype)};Array1D.randUniform=function(shape,a,b,dtype){return NDArray.rand(shape,function(){return util.randUniform(a,b)},dtype)};return Array1D}(NDArray);exports.Array1D=Array1D;var Array2D=function(_super){__extends(Array2D,_super);function Array2D(shape,dtype,values,dataId,math){var _this=this;util.assert(shape.length===2,"Shape should be of length 2");_this=_super.call(this,shape,dtype,values,dataId,math)||this;return _this}Array2D.new=function(shape,values,dtype){if(!instanceofTypedArray(values)){var inferredShape=util.inferShape(values);if(inferredShape.length>1){util.assertShapesMatch(shape,inferredShape,"Error when constructing Array2D. Shape of values "+(inferredShape+" does not match the provided shape ")+(shape+". "))}}return new Array2D(shape,dtype,toTypedArray(values,dtype))};Array2D.prototype.get=function(i,j){return this.dataSync()[this.strides[0]*i+j]};Array2D.prototype.add=function(value,i,j){this.dataSync()[this.strides[0]*i+j]+=value};Array2D.prototype.val=function(i,j){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.data()];case 1:_a.sent();return[2,this.get(i,j)]}})})};Array2D.prototype.locToIndex=function(locs){return this.strides[0]*locs[0]+locs[1]};Array2D.prototype.indexToLoc=function(index){return[Math.floor(index/this.strides[0]),index%this.strides[0]]};Array2D.prototype.asType=function(dtype){return _super.prototype.asType.call(this,dtype)};Array2D.ones=function(shape,dtype){return NDArray.ones(shape,dtype)};Array2D.zeros=function(shape,dtype){return NDArray.zeros(shape,dtype)};Array2D.randNormal=function(shape,mean,stdDev,dtype,seed){if(mean===void 0){mean=0}if(stdDev===void 0){stdDev=1}if(dtype!=null&&dtype==="bool"){throw new Error("Unsupported data type "+dtype)}var randGauss=new rand_1.MPRandGauss(mean,stdDev,dtype,false,seed);return NDArray.rand(shape,function(){return randGauss.nextValue()},dtype)};Array2D.randTruncatedNormal=function(shape,mean,stdDev,dtype,seed){if(mean===void 0){mean=0}if(stdDev===void 0){stdDev=1}if(dtype!=null&&dtype==="bool"){throw new Error("Unsupported data type "+dtype)}var randGauss=new rand_1.MPRandGauss(mean,stdDev,dtype,true,seed);return NDArray.rand(shape,function(){return randGauss.nextValue()},dtype)};Array2D.randUniform=function(shape,a,b,dtype){return NDArray.rand(shape,function(){return util.randUniform(a,b)},dtype)};return Array2D}(NDArray);exports.Array2D=Array2D;var Array3D=function(_super){__extends(Array3D,_super);function Array3D(shape,dtype,values,dataId,math){var _this=this;util.assert(shape.length===3,"Shape should be of length 3");_this=_super.call(this,shape,dtype,values,dataId,math)||this;return _this}Array3D.new=function(shape,values,dtype){if(!instanceofTypedArray(values)){var inferredShape=util.inferShape(values);if(inferredShape.length>1){util.assertShapesMatch(shape,inferredShape,"Error when constructing Array3D. Shape of values "+(inferredShape+" does not match the provided shape ")+(shape+". "))}}return new Array3D(shape,dtype,toTypedArray(values,dtype))};Array3D.prototype.get=function(i,j,k){return this.dataSync()[this.strides[0]*i+this.strides[1]*j+k]};Array3D.prototype.val=function(i,j,k){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.data()];case 1:_a.sent();return[2,this.get(i,j,k)]}})})};Array3D.prototype.add=function(value,i,j,k){this.dataSync()[this.strides[0]*i+this.strides[1]*j+k]+=value};Array3D.prototype.locToIndex=function(locs){return this.strides[0]*locs[0]+this.strides[1]*locs[1]+locs[2]};Array3D.prototype.indexToLoc=function(index){var i=Math.floor(index/this.strides[0]);index-=i*this.strides[0];return[i,Math.floor(index/this.strides[1]),index%this.strides[1]]};Array3D.ones=function(shape,dtype){return NDArray.ones(shape,dtype)};Array3D.prototype.asType=function(dtype){return _super.prototype.asType.call(this,dtype)};Array3D.zeros=function(shape,dtype){return NDArray.zeros(shape,dtype)};Array3D.randNormal=function(shape,mean,stdDev,dtype,seed){if(mean===void 0){mean=0}if(stdDev===void 0){stdDev=1}if(dtype!=null&&dtype==="bool"){throw new Error("Unsupported data type "+dtype)}var randGauss=new rand_1.MPRandGauss(mean,stdDev,dtype,false,seed);return NDArray.rand(shape,function(){return randGauss.nextValue()},dtype)};Array3D.randTruncatedNormal=function(shape,mean,stdDev,dtype,seed){if(mean===void 0){mean=0}if(stdDev===void 0){stdDev=1}if(dtype!=null&&dtype==="bool"){throw new Error("Unsupported data type "+dtype)}var randGauss=new rand_1.MPRandGauss(mean,stdDev,dtype,true,seed);return NDArray.rand(shape,function(){return randGauss.nextValue()},dtype)};Array3D.randUniform=function(shape,a,b,dtype){return NDArray.rand(shape,function(){return util.randUniform(a,b)},dtype)};return Array3D}(NDArray);exports.Array3D=Array3D;var Array4D=function(_super){__extends(Array4D,_super);function Array4D(shape,dtype,values,dataId,math){var _this=this;util.assert(shape.length===4,"Shape should be of length 4");_this=_super.call(this,shape,dtype,values,dataId,math)||this;return _this}Array4D.new=function(shape,values,dtype){if(!instanceofTypedArray(values)){var inferredShape=util.inferShape(values);if(inferredShape.length>1){util.assertShapesMatch(shape,inferredShape,"Error when constructing Array4D. Shape of values "+(inferredShape+" does not match the provided shape ")+(shape+". "))}}return new Array4D(shape,dtype,toTypedArray(values,dtype))};Array4D.prototype.get=function(i,j,k,l){return this.dataSync()[this.strides[0]*i+this.strides[1]*j+this.strides[2]*k+l]};Array4D.prototype.val=function(i,j,k,l){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.data()];case 1:_a.sent();return[2,this.get(i,j,k,l)]}})})};Array4D.prototype.add=function(value,i,j,k,l){this.dataSync()[this.strides[0]*i+this.strides[1]*j+this.strides[2]*k+l]+=value};Array4D.prototype.locToIndex=function(locs){return this.strides[0]*locs[0]+this.strides[1]*locs[1]+this.strides[2]*locs[2]+locs[3]};Array4D.prototype.indexToLoc=function(index){var i=Math.floor(index/this.strides[0]);index-=i*this.strides[0];var j=Math.floor(index/this.strides[1]);index-=j*this.strides[1];return[i,j,Math.floor(index/this.strides[2]),index%this.strides[2]]};Array4D.prototype.asType=function(dtype){return _super.prototype.asType.call(this,dtype)};Array4D.ones=function(shape,dtype){return NDArray.ones(shape,dtype)};Array4D.zeros=function(shape,dtype){return NDArray.zeros(shape,dtype)};Array4D.randNormal=function(shape,mean,stdDev,dtype,seed){if(mean===void 0){mean=0}if(stdDev===void 0){stdDev=1}if(dtype!=null&&dtype==="bool"){throw new Error("Unsupported data type "+dtype)}var randGauss=new rand_1.MPRandGauss(mean,stdDev,dtype,false,seed);return NDArray.rand(shape,function(){return randGauss.nextValue()},dtype)};Array4D.randTruncatedNormal=function(shape,mean,stdDev,dtype,seed){if(mean===void 0){mean=0}if(stdDev===void 0){stdDev=1}if(dtype!=null&&dtype==="bool"){throw new Error("Unsupported data type "+dtype)}var randGauss=new rand_1.MPRandGauss(mean,stdDev,dtype,true,seed);return NDArray.rand(shape,function(){return randGauss.nextValue()},dtype)};Array4D.randUniform=function(shape,a,b,dtype){return NDArray.rand(shape,function(){return util.randUniform(a,b)},dtype)};return Array4D}(NDArray);exports.Array4D=Array4D;var Variable=function(_super){__extends(Variable,_super);function Variable(initialValue,trainable,name){if(trainable===void 0){trainable=true}var _this=_super.call(this,initialValue.shape,initialValue.dtype,null,initialValue.dataId)||this;_this.trainable=trainable;_this.name=name;if(_this.name==null){_this.name=Variable.nextVarId.toString();Variable.nextVarId++}environment_1.ENV.math.registerVariable(_this);return _this}Variable.variable=function(initialValue,trainable,name,dtype){if(trainable===void 0){trainable=true}if(dtype!=null&&dtype!==initialValue.dtype){initialValue=initialValue.asType(dtype)}return new Variable(initialValue,trainable,name)};Variable.prototype.assign=function(newValue){if(newValue.dtype!==this.dtype){throw new Error("dtype of the new value ("+newValue.dtype+") and "+("previous value ("+this.dtype+") must match"))}if(!util.arraysEqual(newValue.shape,this.shape)){throw new Error("shape of the new value ("+newValue.shape+") and "+("previous value ("+this.shape+") must match"))}this.math.disposeData(this.dataId);this.dataId=newValue.dataId;environment_1.ENV.math.register(this)};Variable.nextVarId=0;return Variable}(NDArray);exports.Variable=Variable;var variable=Variable.variable;exports.variable=variable;function copyTypedArray(array,dtype){if(dtype==null||dtype==="float32"){return new Float32Array(array)}else if(dtype==="int32"){var vals=new Int32Array(array.length);for(var i=0;i<vals.length;++i){var val=array[i];if(util.isValNaN(val,"int32")){vals[i]=util.getNaN("int32")}else{vals[i]=val}}return vals}else if(dtype==="bool"){var bool=new Uint8Array(array.length);for(var i=0;i<bool.length;++i){var val=array[i];if(util.isValNaN(val,"bool")){bool[i]=util.getNaN("bool")}else if(Math.round(val)!==0){bool[i]=1}}return bool}else{throw new Error("Unknown data type "+dtype)}}function instanceofTypedArray(a){return a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array}function noConversionNeeded(a,dtype){return a instanceof Float32Array&&dtype==="float32"||a instanceof Int32Array&&dtype==="int32"||a instanceof Uint8Array&&dtype==="bool"}function toTypedArray(a,dtype){if(noConversionNeeded(a,dtype)){return a}if(Array.isArray(a)){a=util.flatten(a)}return copyTypedArray(a,dtype)}function makeZerosTypedArray(size,dtype){if(dtype==null||dtype==="float32"){return new Float32Array(size)}else if(dtype==="int32"){return new Int32Array(size)}else if(dtype==="bool"){return new Uint8Array(size)}else{throw new Error("Unknown data type "+dtype)}}function makeOnesTypedArray(size,dtype){var array=makeZerosTypedArray(size,dtype);for(var i=0;i<array.length;i++){array[i]=1}return array}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ndarray_1=__webpack_require__(3);function shuffle(array){var counter=array.length;var temp=0;var index=0;while(counter>0){index=Math.random()*counter|0;counter--;temp=array[counter];array[counter]=array[index];array[index]=temp}}exports.shuffle=shuffle;function clamp(min,x,max){return Math.max(min,Math.min(x,max))}exports.clamp=clamp;function randUniform(a,b){return Math.random()*(b-a)+a}exports.randUniform=randUniform;function distSquared(a,b){var result=0;for(var i=0;i<a.length;i++){var diff=Number(a[i])-Number(b[i]);result+=diff*diff}return result}exports.distSquared=distSquared;function assert(expr,msg){if(!expr){throw new Error(msg)}}exports.assert=assert;function assertShapesMatch(shapeA,shapeB,errorMessagePrefix){if(errorMessagePrefix===void 0){errorMessagePrefix=""}assert(arraysEqual(shapeA,shapeB),errorMessagePrefix+("Shapes "+shapeA+" and "+shapeB+" must match"))}exports.assertShapesMatch=assertShapesMatch;function assertTypesMatch(a,b){assert(a.dtype===b.dtype,"The dtypes of the first ("+a.dtype+") and "+("second ("+b.dtype+") input must match"))}exports.assertTypesMatch=assertTypesMatch;function flatten(arr,ret){if(ret===void 0){ret=[]}if(Array.isArray(arr)){for(var i=0;i<arr.length;++i){flatten(arr[i],ret)}}else{ret.push(arr)}return ret}exports.flatten=flatten;function inferShape(arr){var shape=[];while(arr instanceof Array){shape.push(arr.length);arr=arr[0]}return shape}exports.inferShape=inferShape;function sizeFromShape(shape){if(shape.length===0){return 1}var size=shape[0];for(var i=1;i<shape.length;i++){size*=shape[i]}return size}exports.sizeFromShape=sizeFromShape;function isScalarShape(shape){return shape.length===0}exports.isScalarShape=isScalarShape;function arraysEqual(n1,n2){if(n1.length!==n2.length){return false}for(var i=0;i<n1.length;i++){if(n1[i]!==n2[i]){return false}}return true}exports.arraysEqual=arraysEqual;function isInt(a){return a%1===0}exports.isInt=isInt;function tanh(x){if(Math.tanh!=null){return Math.tanh(x)}if(x===Infinity){return 1}else if(x===-Infinity){return-1}else{var e2x=Math.exp(2*x);return(e2x-1)/(e2x+1)}}exports.tanh=tanh;function sizeToSquarishShape(size){for(var a=Math.floor(Math.sqrt(size));a>1;--a){if(size%a===0){return[a,size/a]}}return[1,size]}exports.sizeToSquarishShape=sizeToSquarishShape;function createShuffledIndices(n){var shuffledIndices=new Uint32Array(n);for(var i=0;i<n;++i){shuffledIndices[i]=i}shuffle(shuffledIndices);return shuffledIndices}exports.createShuffledIndices=createShuffledIndices;function rightPad(a,size){if(size<=a.length){return a}return a+" ".repeat(size-a.length)}exports.rightPad=rightPad;function repeatedTry(checkFn,delayFn,maxCounter){if(delayFn===void 0){delayFn=function(counter){return 0}}return new Promise(function(resolve,reject){var tryCount=0;var tryFn=function(){if(checkFn()){resolve();return}tryCount++;var nextBackoff=delayFn(tryCount);if(maxCounter!=null&&tryCount>=maxCounter){reject();return}setTimeout(tryFn,nextBackoff)};setTimeout(tryFn,0)})}exports.repeatedTry=repeatedTry;function getQueryParams(queryString){var params={};queryString.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(s){var t=[];for(var _i=1;_i<arguments.length;_i++){t[_i-1]=arguments[_i]}decodeParam(params,t[0],t[1]);return t.join("=")});return params}exports.getQueryParams=getQueryParams;function decodeParam(params,name,value){params[decodeURIComponent(name)]=decodeURIComponent(value||"")}function inferFromImplicitShape(shape,size){var shapeProd=1;var implicitIdx=-1;for(var i=0;i<shape.length;++i){if(shape[i]>0){shapeProd*=shape[i]}else if(shape[i]===-1){if(implicitIdx!==-1){throw Error("Shapes can only have 1 implicit size. "+("Found -1 at dim "+implicitIdx+" and dim "+i))}implicitIdx=i}else if(shape[i]<=0){throw Error("Shapes can not be <= 0. Found "+shape[i]+" at dim "+i)}}if(implicitIdx===-1){if(size>0&&size!==shapeProd){throw Error("Size ("+size+") must match the product of shape "+shape)}return shape}if(size%shapeProd!==0){throw Error("The implicit shape can't be a fractional number. "+("Got "+size+" / "+shapeProd))}var newShape=shape.slice();newShape[implicitIdx]=size/shapeProd;return newShape}exports.inferFromImplicitShape=inferFromImplicitShape;exports.NAN_INT32=1<<31;exports.NAN_BOOL=255;exports.NAN_FLOAT32=NaN;function getNaN(dtype){if(dtype==="float32"){return exports.NAN_FLOAT32}else if(dtype==="int32"){return exports.NAN_INT32}else if(dtype==="bool"){return exports.NAN_BOOL}else{throw new Error("Unknown dtype "+dtype)}}exports.getNaN=getNaN;function isValNaN(val,dtype){if(isNaN(val)){return true}if(dtype==="float32"){return false}else if(dtype==="int32"){return val===exports.NAN_INT32}else if(dtype==="bool"){return val===exports.NAN_BOOL}else{throw new Error("Unknown dtype "+dtype)}}exports.isValNaN=isValNaN;function squeezeShape(shape){var newShape=[];var keptDims=[];for(var i=0;i<shape.length;++i){if(shape[i]>1){newShape.push(shape[i]);keptDims.push(i)}}return{newShape:newShape,keptDims:keptDims}}exports.squeezeShape=squeezeShape;function getTypedArrayFromDType(dtype,size){var values=null;if(dtype==null||dtype==="float32"){values=new Float32Array(size)}else if(dtype==="int32"){values=new Int32Array(size)}else if(dtype==="bool"){values=new Uint8Array(size)}else{throw new Error("Unknown data type "+dtype)}return values}exports.getTypedArrayFromDType=getTypedArrayFromDType;function isNDArrayInList(ndarray,ndarrayList){for(var i=0;i<ndarrayList.length;i++){if(ndarrayList[i].id===ndarray.id){return true}}return false}exports.isNDArrayInList=isNDArrayInList;function checkForNaN(vals,dtype,name){for(var i=0;i<vals.length;i++){if(isValNaN(vals[i],dtype)){throw Error("The result of the last math."+name+" has NaNs.")}}}exports.checkForNaN=checkForNaN;function flattenNameArrayMap(nameArrayMap,keys){var xs=[];if(nameArrayMap instanceof ndarray_1.NDArray){xs.push(nameArrayMap)}else{var xMap=nameArrayMap;for(var i=0;i<keys.length;i++){xs.push(xMap[keys[i]])}}return xs}exports.flattenNameArrayMap=flattenNameArrayMap;function unflattenToNameArrayMap(keys,flatArrays){if(keys.length!==flatArrays.length){throw new Error("Cannot unflatten NDArray[], keys and arrays are not of same length.")}var result={};for(var i=0;i<keys.length;i++){result[keys[i]]=flatArrays[i]}return result}exports.unflattenToNameArrayMap=unflattenToNameArrayMap;function hasEncodingLoss(oldType,newType){if(newType==="float32"){return false}if(newType==="int32"&&oldType!=="float32"){return false}if(newType==="bool"&&oldType==="bool"){return false}return true}exports.hasEncodingLoss=hasEncodingLoss;function nextFrame(){return new Promise(function(resolve){return requestAnimationFrame(function(){return resolve()})})}exports.nextFrame=nextFrame},function(module,exports){module.exports=function(exec){try{return!!exec()}catch(e){return true}}},function(module,exports){module.exports=function(it){return typeof it==="object"?it!==null:typeof it==="function"}},function(module,exports,__webpack_require__){var store=__webpack_require__(70)("wks");var uid=__webpack_require__(40);var Symbol=__webpack_require__(2).Symbol;var USE_SYMBOL=typeof Symbol=="function";var $exports=module.exports=function(name){return store[name]||(store[name]=USE_SYMBOL&&Symbol[name]||(USE_SYMBOL?Symbol:uid)("Symbol."+name))};$exports.store=store},function(module,exports,__webpack_require__){module.exports=!__webpack_require__(5)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(module,exports,__webpack_require__){var anObject=__webpack_require__(1);var IE8_DOM_DEFINE=__webpack_require__(114);var toPrimitive=__webpack_require__(29);var dP=Object.defineProperty;exports.f=__webpack_require__(8)?Object.defineProperty:function defineProperty(O,P,Attributes){anObject(O);P=toPrimitive(P,true);anObject(Attributes);if(IE8_DOM_DEFINE)try{return dP(O,P,Attributes)}catch(e){}if("get"in Attributes||"set"in Attributes)throw TypeError("Accessors not supported!");if("value"in Attributes)O[P]=Attributes.value;return O}},function(module,exports,__webpack_require__){var toInteger=__webpack_require__(31);var min=Math.min;module.exports=function(it){return it>0?min(toInteger(it),9007199254740991):0}},function(module,exports,__webpack_require__){"use strict";(function(global){Object.defineProperty(exports,"__esModule",{value:true});var device_util=__webpack_require__(366);var math_1=__webpack_require__(60);var util=__webpack_require__(4);var Type;(function(Type){Type[Type["NUMBER"]=0]="NUMBER";Type[Type["BOOLEAN"]=1]="BOOLEAN"})(Type=exports.Type||(exports.Type={}));exports.URL_PROPERTIES=[{name:"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_ENABLED",type:Type.BOOLEAN},{name:"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",type:Type.BOOLEAN},{name:"WEBGL_VERSION",type:Type.NUMBER},{name:"WEBGL_FLOAT_TEXTURE_ENABLED",type:Type.BOOLEAN},{name:"WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED",type:Type.BOOLEAN}];function getWebGLRenderingContext(webGLVersion){if(webGLVersion===0){throw new Error("Cannot get WebGL rendering context, WebGL is disabled.")}var tempCanvas=document.createElement("canvas");if(webGLVersion===1){return tempCanvas.getContext("webgl")||tempCanvas.getContext("experimental-webgl")}return tempCanvas.getContext("webgl2")}function loseContext(gl){if(gl!=null){var loseContextExtension=gl.getExtension("WEBGL_lose_context");if(loseContextExtension==null){throw new Error("Extension WEBGL_lose_context not supported on this browser.")}loseContextExtension.loseContext()}}function isWebGLVersionEnabled(webGLVersion){var gl=getWebGLRenderingContext(webGLVersion);if(gl!=null){loseContext(gl);return true}return false}function isWebGLDisjointQueryTimerEnabled(webGLVersion){var gl=getWebGLRenderingContext(webGLVersion);var extensionName=webGLVersion===1?"EXT_disjoint_timer_query":"EXT_disjoint_timer_query_webgl2";var ext=gl.getExtension(extensionName);var isExtEnabled=ext!=null;if(gl!=null){loseContext(gl)}return isExtEnabled}function isFloatTextureReadPixelsEnabled(webGLVersion){if(webGLVersion===0){return false}var gl=getWebGLRenderingContext(webGLVersion);if(webGLVersion===1){if(gl.getExtension("OES_texture_float")==null){return false}}else{if(gl.getExtension("EXT_color_buffer_float")==null){return false}}var frameBuffer=gl.createFramebuffer();var texture=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,texture);var internalFormat=webGLVersion===2?gl.RGBA32F:gl.RGBA;gl.texImage2D(gl.TEXTURE_2D,0,internalFormat,1,1,0,gl.RGBA,gl.FLOAT,null);gl.bindFramebuffer(gl.FRAMEBUFFER,frameBuffer);gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,texture,0);var frameBufferComplete=gl.checkFramebufferStatus(gl.FRAMEBUFFER)===gl.FRAMEBUFFER_COMPLETE;gl.readPixels(0,0,1,1,gl.RGBA,gl.FLOAT,new Float32Array(4));var readPixelsNoError=gl.getError()===gl.NO_ERROR;loseContext(gl);return frameBufferComplete&&readPixelsNoError}function isWebGLGetBufferSubDataAsyncExtensionEnabled(webGLVersion){if(webGLVersion!==2){return false}var gl=getWebGLRenderingContext(webGLVersion);var ext=gl.getExtension("WEBGL_get_buffer_sub_data_async");var isEnabled=ext!=null;loseContext(gl);return isEnabled}var Environment=function(){function Environment(features){this.features={};this.globalMath=null;this.backendRegistry={};this.prevBackendRegistry=this.backendRegistry;if(features!=null){this.features=features}}Environment.prototype.get=function(feature){if(feature in this.features){return this.features[feature]}this.features[feature]=this.evaluateFeature(feature);return this.features[feature]};Environment.prototype.getBestBackend=function(){var orderedBackends=["webgl","cpu"];for(var i=0;i<orderedBackends.length;++i){var backendId=orderedBackends[i];if(backendId in this.backendRegistry){return this.backendRegistry[backendId]}}throw new Error("No backend found in registry.")};Environment.prototype.evaluateFeature=function(feature){if(feature==="WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_ENABLED"){var webGLVersion=this.get("WEBGL_VERSION");if(webGLVersion===0){return false}return isWebGLDisjointQueryTimerEnabled(webGLVersion)}else if(feature==="WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE"){return this.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_ENABLED")&&!device_util.isMobile()}else if(feature==="WEBGL_VERSION"){if(isWebGLVersionEnabled(2)){return 2}else if(isWebGLVersionEnabled(1)){return 1}return 0}else if(feature==="WEBGL_FLOAT_TEXTURE_ENABLED"){return isFloatTextureReadPixelsEnabled(this.get("WEBGL_VERSION"))}else if(feature==="WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED"){return isWebGLGetBufferSubDataAsyncExtensionEnabled(this.get("WEBGL_VERSION"))}throw new Error("Unknown feature "+feature+".")};Environment.prototype.setFeatures=function(features){this.empty();this.features=features};Environment.prototype.reset=function(){this.globalMath=null;this.backendRegistry=this.prevBackendRegistry;this.features=getFeaturesFromURL()};Environment.prototype.setMath=function(math){this.globalMath=math};Environment.prototype.getBackend=function(name){return this.backendRegistry[name]};Environment.prototype.registerBackend=function(name,factory){if(name in this.backendRegistry){throw new Error(name+" backend was already registered")}try{var backend=factory();this.backendRegistry[name]=backend;return true}catch(err){return false}};Object.defineProperty(Environment.prototype,"math",{get:function(){if(this.globalMath==null){var bestBackend=this.getBestBackend();var safeMode=false;this.globalMath=new math_1.NDArrayMath(bestBackend,safeMode)}return this.globalMath},enumerable:true,configurable:true});Environment.prototype.empty=function(){this.globalMath=null;this.prevBackendRegistry=this.backendRegistry;this.backendRegistry={};this.features=null};return Environment}();exports.Environment=Environment;var DEEPLEARNJS_FLAGS_PREFIX="dljsflags";function getFeaturesFromURL(){var features={};if(typeof window==="undefined"){return features}var urlParams=util.getQueryParams(window.location.search);if(DEEPLEARNJS_FLAGS_PREFIX in urlParams){var urlFlags_1={};var keyValues=urlParams[DEEPLEARNJS_FLAGS_PREFIX].split(",");keyValues.forEach(function(keyValue){var _a=keyValue.split(":"),key=_a[0],value=_a[1];urlFlags_1[key]=value});exports.URL_PROPERTIES.forEach(function(urlProperty){if(urlProperty.name in urlFlags_1){console.log("Setting feature override from URL "+urlProperty.name+": "+(""+urlFlags_1[urlProperty.name]));if(urlProperty.type===Type.NUMBER){features[urlProperty.name]=+urlFlags_1[urlProperty.name]}else if(urlProperty.type===Type.BOOLEAN){features[urlProperty.name]=urlFlags_1[urlProperty.name]==="true"}else{console.warn("Unknown URL param: "+urlProperty.name+".")}}})}return features}function getGlobalNamespace(){var ns;if(typeof window!=="undefined"){ns=window}else if(typeof global!=="undefined"){ns=global}else{throw new Error("Could not find a global object")}return ns}function getOrMakeEnvironment(){var ns=getGlobalNamespace();ns.ENV=ns.ENV||new Environment(getFeaturesFromURL());return ns.ENV}exports.ENV=getOrMakeEnvironment()}).call(exports,__webpack_require__(69))},function(module,exports,__webpack_require__){var defined=__webpack_require__(30);module.exports=function(it){return Object(defined(it))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Operation=function(){function Operation(){}Operation.prototype.disposeTransientArrays=function(inferenceArrays,gradientArrays){};Operation.prototype.dispose=function(){};return Operation}();exports.Operation=Operation},function(module,exports){module.exports=function(it){if(typeof it!="function")throw TypeError(it+" is not a function!");return it}},function(module,exports){var hasOwnProperty={}.hasOwnProperty;module.exports=function(it,key){return hasOwnProperty.call(it,key)}},function(module,exports,__webpack_require__){var dP=__webpack_require__(9);var createDesc=__webpack_require__(39);module.exports=__webpack_require__(8)?function(object,key,value){return dP.f(object,key,createDesc(1,value))}:function(object,key,value){object[key]=value;return object}},function(module,exports,__webpack_require__){var global=__webpack_require__(2);var hide=__webpack_require__(16);var has=__webpack_require__(15);var SRC=__webpack_require__(40)("src");var TO_STRING="toString";var $toString=Function[TO_STRING];var TPL=(""+$toString).split(TO_STRING);__webpack_require__(28).inspectSource=function(it){return $toString.call(it)};(module.exports=function(O,key,val,safe){var isFunction=typeof val=="function";if(isFunction)has(val,"name")||hide(val,"name",key);if(O[key]===val)return;if(isFunction)has(val,SRC)||hide(val,SRC,O[key]?""+O[key]:TPL.join(String(key)));if(O===global){O[key]=val}else if(!safe){delete O[key];hide(O,key,val)}else if(O[key]){O[key]=val}else{hide(O,key,val)}})(Function.prototype,TO_STRING,function toString(){return typeof this=="function"&&this[SRC]||$toString.call(this)})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var fails=__webpack_require__(5);var defined=__webpack_require__(30);var quot=/"/g;var createHTML=function(string,tag,attribute,value){var S=String(defined(string));var p1="<"+tag;if(attribute!=="")p1+=" "+attribute+'="'+String(value).replace(quot,"&quot;")+'"';return p1+">"+S+"</"+tag+">"};module.exports=function(NAME,exec){var O={};O[NAME]=exec(createHTML);$export($export.P+$export.F*fails(function(){var test=""[NAME]('"');return test!==test.toLowerCase()||test.split('"').length>3}),"String",O)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var graph_1=__webpack_require__(68);var priority_queue=__webpack_require__(158);var priority_queue_1=__webpack_require__(158);function getUnorderedEvaluationSet(nodes,terminatingNodes){var terminatingNodeMap={};var seen={};var set=[];var visit=nodes.slice();terminatingNodes.forEach(function(node){return terminatingNodeMap[node.id]=node});var _loop_1=function(){var cur=visit.pop();if(seen[cur.id]==null){if(terminatingNodeMap[cur.id]==null){Object.keys(cur.inputs).map(function(inputName){return cur.inputs[inputName]}).forEach(function(input){return visit.push(input.node)})}set.push(cur);seen[cur.id]=cur}};while(visit.length!==0){_loop_1()}return set}exports.getUnorderedEvaluationSet=getUnorderedEvaluationSet;function getOrderedEvaluationSet(unorderedEvaluationSet){var set=[];var nodeIndices={};var pendingDependencies={};var nodeQueue=new priority_queue_1.PriorityQueue(function(a,b){return priority_queue.defaultCompare(pendingDependencies[a.id],pendingDependencies[b.id])},function(node,newIndex){return nodeIndices[node.id]=newIndex});unorderedEvaluationSet.forEach(function(node){return pendingDependencies[node.id]=0});unorderedEvaluationSet.forEach(function(node){return Object.keys(node.inputs).map(function(key){return node.inputs[key]}).forEach(function(input){if(unorderedEvaluationSet.indexOf(input.node)!==-1){pendingDependencies[input.node.id]++}})});unorderedEvaluationSet.forEach(function(node){return nodeQueue.enqueue(node)});while(!nodeQueue.empty()){set.unshift(nodeQueue.dequeue());Object.keys(set[0].inputs).map(function(key){return set[0].inputs[key]}).forEach(function(input){if(unorderedEvaluationSet.indexOf(input.node)===-1){return}pendingDependencies[input.node.id]--;nodeQueue.update(input.node,nodeIndices[input.node.id])})}return set}exports.getOrderedEvaluationSet=getOrderedEvaluationSet;function isInputNode(node){return Object.keys(node.inputs).length===0}exports.isInputNode=isInputNode;function shouldBackProp(t){return!(t.node instanceof graph_1.ConstantNode)}exports.shouldBackProp=shouldBackProp;function isPassthroughNode(node,map){var keys=Object.keys(node.inputs);for(var i=0;i<keys.length;i++){var input=node.inputs[keys[i]];if(map.get(input,true)===map.get(node.output,true)){return true}}return false}exports.isPassthroughNode=isPassthroughNode},function(module,exports,__webpack_require__){var IObject=__webpack_require__(57);var defined=__webpack_require__(30);module.exports=function(it){return IObject(defined(it))}},function(module,exports,__webpack_require__){var pIE=__webpack_require__(58);var createDesc=__webpack_require__(39);var toIObject=__webpack_require__(20);var toPrimitive=__webpack_require__(29);var has=__webpack_require__(15);var IE8_DOM_DEFINE=__webpack_require__(114);var gOPD=Object.getOwnPropertyDescriptor;exports.f=__webpack_require__(8)?gOPD:function getOwnPropertyDescriptor(O,P){O=toIObject(O);P=toPrimitive(P,true);if(IE8_DOM_DEFINE)try{return gOPD(O,P)}catch(e){}if(has(O,P))return createDesc(!pIE.f.call(O,P),O[P])}},function(module,exports,__webpack_require__){var has=__webpack_require__(15);var toObject=__webpack_require__(12);var IE_PROTO=__webpack_require__(87)("IE_PROTO");var ObjectProto=Object.prototype;module.exports=Object.getPrototypeOf||function(O){O=toObject(O);if(has(O,IE_PROTO))return O[IE_PROTO];if(typeof O.constructor=="function"&&O instanceof O.constructor){return O.constructor.prototype}return O instanceof Object?ObjectProto:null}},function(module,exports){module.exports=function(){throw new Error("define cannot be used indirect")}},function(module,exports,__webpack_require__){var aFunction=__webpack_require__(14);module.exports=function(fn,that,length){aFunction(fn);if(that===undefined)return fn;switch(length){case 1:return function(a){return fn.call(that,a)};case 2:return function(a,b){return fn.call(that,a,b)};case 3:return function(a,b,c){return fn.call(that,a,b,c)}}return function(){return fn.apply(that,arguments)}}},function(module,exports){var toString={}.toString;module.exports=function(it){return toString.call(it).slice(8,-1)}},function(module,exports,__webpack_require__){"use strict";var fails=__webpack_require__(5);module.exports=function(method,arg){return!!method&&fails(function(){arg?method.call(null,function(){},1):method.call(null)})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var xhr_dataset=__webpack_require__(148);exports.xhr_dataset=xhr_dataset;var environment=__webpack_require__(11);exports.environment=environment;var gpgpu_util=__webpack_require__(113);exports.gpgpu_util=gpgpu_util;var render_ndarray_gpu_util=__webpack_require__(380);exports.render_ndarray_gpu_util=render_ndarray_gpu_util;var webgl_util=__webpack_require__(66);exports.webgl_util=webgl_util;var conv_util=__webpack_require__(64);exports.conv_util=conv_util;var test_util=__webpack_require__(381);exports.test_util=test_util;var util=__webpack_require__(4);exports.util=util;var version_1=__webpack_require__(403);exports.version=version_1.version;var checkpoint_loader_1=__webpack_require__(404);exports.CheckpointLoader=checkpoint_loader_1.CheckpointLoader;var dataset_1=__webpack_require__(150);exports.InMemoryDataset=dataset_1.InMemoryDataset;var input_provider_1=__webpack_require__(405);exports.InCPUMemoryShuffledInputProviderBuilder=input_provider_1.InCPUMemoryShuffledInputProviderBuilder;exports.InGPUMemoryShuffledInputProviderBuilder=input_provider_1.InGPUMemoryShuffledInputProviderBuilder;var xhr_dataset_1=__webpack_require__(148);exports.XhrDataset=xhr_dataset_1.XhrDataset;var environment_1=__webpack_require__(11);exports.ENV=environment_1.ENV;exports.Environment=environment_1.Environment;var graph_1=__webpack_require__(68);exports.Graph=graph_1.Graph;exports.Tensor=graph_1.Tensor;var graph_runner_1=__webpack_require__(406);exports.GraphRunner=graph_runner_1.GraphRunner;exports.MetricReduction=graph_runner_1.MetricReduction;var adadelta_optimizer_1=__webpack_require__(428);exports.AdadeltaOptimizer=adadelta_optimizer_1.AdadeltaOptimizer;var adagrad_optimizer_1=__webpack_require__(429);exports.AdagradOptimizer=adagrad_optimizer_1.AdagradOptimizer;var adam_optimizer_1=__webpack_require__(430);exports.AdamOptimizer=adam_optimizer_1.AdamOptimizer;var adamax_optimizer_1=__webpack_require__(431);exports.AdamaxOptimizer=adamax_optimizer_1.AdamaxOptimizer;var momentum_optimizer_1=__webpack_require__(432);exports.MomentumOptimizer=momentum_optimizer_1.MomentumOptimizer;var rmsprop_optimizer_1=__webpack_require__(433);exports.RMSPropOptimizer=rmsprop_optimizer_1.RMSPropOptimizer;var session_1=__webpack_require__(157);exports.CostReduction=session_1.CostReduction;exports.Session=session_1.Session;var initializers_1=__webpack_require__(156);exports.ConstantInitializer=initializers_1.ConstantInitializer;exports.NDArrayInitializer=initializers_1.NDArrayInitializer;exports.OnesInitializer=initializers_1.OnesInitializer;exports.RandomNormalInitializer=initializers_1.RandomNormalInitializer;exports.RandomTruncatedNormalInitializer=initializers_1.RandomTruncatedNormalInitializer;exports.RandomUniformInitializer=initializers_1.RandomUniformInitializer;exports.VarianceScalingInitializer=initializers_1.VarianceScalingInitializer;exports.ZerosInitializer=initializers_1.ZerosInitializer;var backend_cpu_1=__webpack_require__(151);exports.MathBackendCPU=backend_cpu_1.MathBackendCPU;exports.NDArrayMathCPU=backend_cpu_1.NDArrayMathCPU;var backend_webgl_1=__webpack_require__(152);exports.MathBackendWebGL=backend_webgl_1.MathBackendWebGL;exports.NDArrayMathGPU=backend_webgl_1.NDArrayMathGPU;var matmul_1=__webpack_require__(61);exports.MatrixOrientation=matmul_1.MatrixOrientation;var gpgpu_context_1=__webpack_require__(154);exports.GPGPUContext=gpgpu_context_1.GPGPUContext;var math_1=__webpack_require__(60);exports.NDArrayMath=math_1.NDArrayMath;var ndarray_1=__webpack_require__(3);exports.Array1D=ndarray_1.Array1D;exports.Array2D=ndarray_1.Array2D;exports.Array3D=ndarray_1.Array3D;exports.Array4D=ndarray_1.Array4D;exports.NDArray=ndarray_1.NDArray;exports.Scalar=ndarray_1.Scalar;var ndarray_2=__webpack_require__(3);exports.variable=ndarray_2.variable;var optimizer_1=__webpack_require__(50);exports.Optimizer=optimizer_1.Optimizer;var sgd_optimizer_1=__webpack_require__(160);exports.SGDOptimizer=sgd_optimizer_1.SGDOptimizer},function(module,exports){var core=module.exports={version:"2.5.3"};if(typeof __e=="number")__e=core},function(module,exports,__webpack_require__){var isObject=__webpack_require__(6);module.exports=function(it,S){if(!isObject(it))return it;var fn,val;if(S&&typeof(fn=it.toString)=="function"&&!isObject(val=fn.call(it)))return val;if(typeof(fn=it.valueOf)=="function"&&!isObject(val=fn.call(it)))return val;if(!S&&typeof(fn=it.toString)=="function"&&!isObject(val=fn.call(it)))return val;throw TypeError("Can't convert object to primitive value")}},function(module,exports){module.exports=function(it){if(it==undefined)throw TypeError("Can't call method on  "+it);return it}},function(module,exports){var ceil=Math.ceil;var floor=Math.floor;module.exports=function(it){return isNaN(it=+it)?0:(it>0?floor:ceil)(it)}},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var core=__webpack_require__(28);var fails=__webpack_require__(5);module.exports=function(KEY,exec){var fn=(core.Object||{})[KEY]||Object[KEY];var exp={};exp[KEY]=exec(fn);$export($export.S+$export.F*fails(function(){fn(1)}),"Object",exp)}},function(module,exports,__webpack_require__){var ctx=__webpack_require__(24);var IObject=__webpack_require__(57);var toObject=__webpack_require__(12);var toLength=__webpack_require__(10);var asc=__webpack_require__(104);module.exports=function(TYPE,$create){var IS_MAP=TYPE==1;var IS_FILTER=TYPE==2;var IS_SOME=TYPE==3;var IS_EVERY=TYPE==4;var IS_FIND_INDEX=TYPE==6;var NO_HOLES=TYPE==5||IS_FIND_INDEX;var create=$create||asc;return function($this,callbackfn,that){var O=toObject($this);var self=IObject(O);var f=ctx(callbackfn,that,3);var length=toLength(self.length);var index=0;var result=IS_MAP?create($this,length):IS_FILTER?create($this,0):undefined;var val,res;for(;length>index;index++)if(NO_HOLES||index in self){val=self[index];res=f(val,index,O);if(TYPE){if(IS_MAP)result[index]=res;else if(res)switch(TYPE){case 3:return true;case 5:return val;case 6:return index;case 2:result.push(val)}else if(IS_EVERY)return false}}return IS_FIND_INDEX?-1:IS_SOME||IS_EVERY?IS_EVERY:result}}},function(module,exports,__webpack_require__){"use strict";if(__webpack_require__(8)){var LIBRARY=__webpack_require__(41);var global=__webpack_require__(2);var fails=__webpack_require__(5);var $export=__webpack_require__(0);var $typed=__webpack_require__(80);var $buffer=__webpack_require__(110);var ctx=__webpack_require__(24);var anInstance=__webpack_require__(47);var propertyDesc=__webpack_require__(39);var hide=__webpack_require__(16);var redefineAll=__webpack_require__(49);var toInteger=__webpack_require__(31);var toLength=__webpack_require__(10);var toIndex=__webpack_require__(140);var toAbsoluteIndex=__webpack_require__(43);var toPrimitive=__webpack_require__(29);var has=__webpack_require__(15);var classof=__webpack_require__(59);var isObject=__webpack_require__(6);var toObject=__webpack_require__(12);var isArrayIter=__webpack_require__(101);var create=__webpack_require__(44);var getPrototypeOf=__webpack_require__(22);var gOPN=__webpack_require__(45).f;var getIterFn=__webpack_require__(103);var uid=__webpack_require__(40);var wks=__webpack_require__(7);var createArrayMethod=__webpack_require__(33);var createArrayIncludes=__webpack_require__(71);var speciesConstructor=__webpack_require__(78);var ArrayIterators=__webpack_require__(106);var Iterators=__webpack_require__(53);var $iterDetect=__webpack_require__(75);var setSpecies=__webpack_require__(46);var arrayFill=__webpack_require__(105);var arrayCopyWithin=__webpack_require__(130);var $DP=__webpack_require__(9);var $GOPD=__webpack_require__(21);var dP=$DP.f;var gOPD=$GOPD.f;var RangeError=global.RangeError;var TypeError=global.TypeError;var Uint8Array=global.Uint8Array;var ARRAY_BUFFER="ArrayBuffer";var SHARED_BUFFER="Shared"+ARRAY_BUFFER;var BYTES_PER_ELEMENT="BYTES_PER_ELEMENT";var PROTOTYPE="prototype";var ArrayProto=Array[PROTOTYPE];var $ArrayBuffer=$buffer.ArrayBuffer;var $DataView=$buffer.DataView;var arrayForEach=createArrayMethod(0);var arrayFilter=createArrayMethod(2);var arraySome=createArrayMethod(3);var arrayEvery=createArrayMethod(4);var arrayFind=createArrayMethod(5);var arrayFindIndex=createArrayMethod(6);var arrayIncludes=createArrayIncludes(true);var arrayIndexOf=createArrayIncludes(false);var arrayValues=ArrayIterators.values;var arrayKeys=ArrayIterators.keys;var arrayEntries=ArrayIterators.entries;var arrayLastIndexOf=ArrayProto.lastIndexOf;var arrayReduce=ArrayProto.reduce;var arrayReduceRight=ArrayProto.reduceRight;var arrayJoin=ArrayProto.join;var arraySort=ArrayProto.sort;var arraySlice=ArrayProto.slice;var arrayToString=ArrayProto.toString;var arrayToLocaleString=ArrayProto.toLocaleString;var ITERATOR=wks("iterator");var TAG=wks("toStringTag");var TYPED_CONSTRUCTOR=uid("typed_constructor");var DEF_CONSTRUCTOR=uid("def_constructor");var ALL_CONSTRUCTORS=$typed.CONSTR;var TYPED_ARRAY=$typed.TYPED;var VIEW=$typed.VIEW;var WRONG_LENGTH="Wrong length!";var $map=createArrayMethod(1,function(O,length){return allocate(speciesConstructor(O,O[DEF_CONSTRUCTOR]),length)});var LITTLE_ENDIAN=fails(function(){return new Uint8Array(new Uint16Array([1]).buffer)[0]===1});var FORCED_SET=!!Uint8Array&&!!Uint8Array[PROTOTYPE].set&&fails(function(){new Uint8Array(1).set({})});var toOffset=function(it,BYTES){var offset=toInteger(it);if(offset<0||offset%BYTES)throw RangeError("Wrong offset!");return offset};var validate=function(it){if(isObject(it)&&TYPED_ARRAY in it)return it;throw TypeError(it+" is not a typed array!")};var allocate=function(C,length){if(!(isObject(C)&&TYPED_CONSTRUCTOR in C)){throw TypeError("It is not a typed array constructor!")}return new C(length)};var speciesFromList=function(O,list){return fromList(speciesConstructor(O,O[DEF_CONSTRUCTOR]),list)};var fromList=function(C,list){var index=0;var length=list.length;var result=allocate(C,length);while(length>index)result[index]=list[index++];return result};var addGetter=function(it,key,internal){dP(it,key,{get:function(){return this._d[internal]}})};var $from=function from(source){var O=toObject(source);var aLen=arguments.length;var mapfn=aLen>1?arguments[1]:undefined;var mapping=mapfn!==undefined;var iterFn=getIterFn(O);var i,length,values,result,step,iterator;if(iterFn!=undefined&&!isArrayIter(iterFn)){for(iterator=iterFn.call(O),values=[],i=0;!(step=iterator.next()).done;i++){values.push(step.value)}O=values}if(mapping&&aLen>2)mapfn=ctx(mapfn,arguments[2],2);for(i=0,length=toLength(O.length),result=allocate(this,length);length>i;i++){result[i]=mapping?mapfn(O[i],i):O[i]}return result};var $of=function of(){var index=0;var length=arguments.length;var result=allocate(this,length);while(length>index)result[index]=arguments[index++];return result};var TO_LOCALE_BUG=!!Uint8Array&&fails(function(){arrayToLocaleString.call(new Uint8Array(1))});var $toLocaleString=function toLocaleString(){return arrayToLocaleString.apply(TO_LOCALE_BUG?arraySlice.call(validate(this)):validate(this),arguments)};var proto={copyWithin:function copyWithin(target,start){return arrayCopyWithin.call(validate(this),target,start,arguments.length>2?arguments[2]:undefined)},every:function every(callbackfn){return arrayEvery(validate(this),callbackfn,arguments.length>1?arguments[1]:undefined)},fill:function fill(value){return arrayFill.apply(validate(this),arguments)},filter:function filter(callbackfn){return speciesFromList(this,arrayFilter(validate(this),callbackfn,arguments.length>1?arguments[1]:undefined))},find:function find(predicate){return arrayFind(validate(this),predicate,arguments.length>1?arguments[1]:undefined)},findIndex:function findIndex(predicate){return arrayFindIndex(validate(this),predicate,arguments.length>1?arguments[1]:undefined)},forEach:function forEach(callbackfn){arrayForEach(validate(this),callbackfn,arguments.length>1?arguments[1]:undefined)},indexOf:function indexOf(searchElement){return arrayIndexOf(validate(this),searchElement,arguments.length>1?arguments[1]:undefined)},includes:function includes(searchElement){return arrayIncludes(validate(this),searchElement,arguments.length>1?arguments[1]:undefined)},join:function join(separator){return arrayJoin.apply(validate(this),arguments)},lastIndexOf:function lastIndexOf(searchElement){return arrayLastIndexOf.apply(validate(this),arguments)},map:function map(mapfn){return $map(validate(this),mapfn,arguments.length>1?arguments[1]:undefined)},reduce:function reduce(callbackfn){return arrayReduce.apply(validate(this),arguments)},reduceRight:function reduceRight(callbackfn){return arrayReduceRight.apply(validate(this),arguments)},reverse:function reverse(){var that=this;var length=validate(that).length;var middle=Math.floor(length/2);var index=0;var value;while(index<middle){value=that[index];that[index++]=that[--length];that[length]=value}return that},some:function some(callbackfn){return arraySome(validate(this),callbackfn,arguments.length>1?arguments[1]:undefined)},sort:function sort(comparefn){return arraySort.call(validate(this),comparefn)},subarray:function subarray(begin,end){var O=validate(this);var length=O.length;var $begin=toAbsoluteIndex(begin,length);return new(speciesConstructor(O,O[DEF_CONSTRUCTOR]))(O.buffer,O.byteOffset+$begin*O.BYTES_PER_ELEMENT,toLength((end===undefined?length:toAbsoluteIndex(end,length))-$begin))}};var $slice=function slice(start,end){return speciesFromList(this,arraySlice.call(validate(this),start,end))};var $set=function set(arrayLike){validate(this);var offset=toOffset(arguments[1],1);var length=this.length;var src=toObject(arrayLike);var len=toLength(src.length);var index=0;if(len+offset>length)throw RangeError(WRONG_LENGTH);while(index<len)this[offset+index]=src[index++]};var $iterators={entries:function entries(){return arrayEntries.call(validate(this))},keys:function keys(){return arrayKeys.call(validate(this))},values:function values(){return arrayValues.call(validate(this))}};var isTAIndex=function(target,key){return isObject(target)&&target[TYPED_ARRAY]&&typeof key!="symbol"&&key in target&&String(+key)==String(key)};var $getDesc=function getOwnPropertyDescriptor(target,key){return isTAIndex(target,key=toPrimitive(key,true))?propertyDesc(2,target[key]):gOPD(target,key)};var $setDesc=function defineProperty(target,key,desc){if(isTAIndex(target,key=toPrimitive(key,true))&&isObject(desc)&&has(desc,"value")&&!has(desc,"get")&&!has(desc,"set")&&!desc.configurable&&(!has(desc,"writable")||desc.writable)&&(!has(desc,"enumerable")||desc.enumerable)){target[key]=desc.value;return target}return dP(target,key,desc)};if(!ALL_CONSTRUCTORS){$GOPD.f=$getDesc;$DP.f=$setDesc}$export($export.S+$export.F*!ALL_CONSTRUCTORS,"Object",{getOwnPropertyDescriptor:$getDesc,defineProperty:$setDesc});if(fails(function(){arrayToString.call({})})){arrayToString=arrayToLocaleString=function toString(){return arrayJoin.call(this)}}var $TypedArrayPrototype$=redefineAll({},proto);redefineAll($TypedArrayPrototype$,$iterators);hide($TypedArrayPrototype$,ITERATOR,$iterators.values);redefineAll($TypedArrayPrototype$,{slice:$slice,set:$set,constructor:function(){},toString:arrayToString,toLocaleString:$toLocaleString});addGetter($TypedArrayPrototype$,"buffer","b");addGetter($TypedArrayPrototype$,"byteOffset","o");addGetter($TypedArrayPrototype$,"byteLength","l");addGetter($TypedArrayPrototype$,"length","e");dP($TypedArrayPrototype$,TAG,{get:function(){return this[TYPED_ARRAY]}});module.exports=function(KEY,BYTES,wrapper,CLAMPED){CLAMPED=!!CLAMPED;var NAME=KEY+(CLAMPED?"Clamped":"")+"Array";var GETTER="get"+KEY;var SETTER="set"+KEY;var TypedArray=global[NAME];var Base=TypedArray||{};var TAC=TypedArray&&getPrototypeOf(TypedArray);var FORCED=!TypedArray||!$typed.ABV;var O={};var TypedArrayPrototype=TypedArray&&TypedArray[PROTOTYPE];var getter=function(that,index){var data=that._d;return data.v[GETTER](index*BYTES+data.o,LITTLE_ENDIAN)};var setter=function(that,index,value){var data=that._d;if(CLAMPED)value=(value=Math.round(value))<0?0:value>255?255:value&255;data.v[SETTER](index*BYTES+data.o,value,LITTLE_ENDIAN)};var addElement=function(that,index){dP(that,index,{get:function(){return getter(this,index)},set:function(value){return setter(this,index,value)},enumerable:true})};if(FORCED){TypedArray=wrapper(function(that,data,$offset,$length){anInstance(that,TypedArray,NAME,"_d");var index=0;var offset=0;var buffer,byteLength,length,klass;if(!isObject(data)){length=toIndex(data);byteLength=length*BYTES;buffer=new $ArrayBuffer(byteLength)}else if(data instanceof $ArrayBuffer||(klass=classof(data))==ARRAY_BUFFER||klass==SHARED_BUFFER){buffer=data;offset=toOffset($offset,BYTES);var $len=data.byteLength;if($length===undefined){if($len%BYTES)throw RangeError(WRONG_LENGTH);byteLength=$len-offset;if(byteLength<0)throw RangeError(WRONG_LENGTH)}else{byteLength=toLength($length)*BYTES;if(byteLength+offset>$len)throw RangeError(WRONG_LENGTH)}length=byteLength/BYTES}else if(TYPED_ARRAY in data){return fromList(TypedArray,data)}else{return $from.call(TypedArray,data)}hide(that,"_d",{b:buffer,o:offset,l:byteLength,e:length,v:new $DataView(buffer)});while(index<length)addElement(that,index++)});TypedArrayPrototype=TypedArray[PROTOTYPE]=create($TypedArrayPrototype$);hide(TypedArrayPrototype,"constructor",TypedArray)}else if(!fails(function(){TypedArray(1)})||!fails(function(){new TypedArray(-1)})||!$iterDetect(function(iter){new TypedArray;new TypedArray(null);new TypedArray(1.5);new TypedArray(iter)},true)){TypedArray=wrapper(function(that,data,$offset,$length){anInstance(that,TypedArray,NAME);var klass;if(!isObject(data))return new Base(toIndex(data));if(data instanceof $ArrayBuffer||(klass=classof(data))==ARRAY_BUFFER||klass==SHARED_BUFFER){return $length!==undefined?new Base(data,toOffset($offset,BYTES),$length):$offset!==undefined?new Base(data,toOffset($offset,BYTES)):new Base(data)}if(TYPED_ARRAY in data)return fromList(TypedArray,data);return $from.call(TypedArray,data)});arrayForEach(TAC!==Function.prototype?gOPN(Base).concat(gOPN(TAC)):gOPN(Base),function(key){if(!(key in TypedArray))hide(TypedArray,key,Base[key])});TypedArray[PROTOTYPE]=TypedArrayPrototype;if(!LIBRARY)TypedArrayPrototype.constructor=TypedArray}var $nativeIterator=TypedArrayPrototype[ITERATOR];var CORRECT_ITER_NAME=!!$nativeIterator&&($nativeIterator.name=="values"||$nativeIterator.name==undefined);var $iterator=$iterators.values;hide(TypedArray,TYPED_CONSTRUCTOR,true);hide(TypedArrayPrototype,TYPED_ARRAY,NAME);hide(TypedArrayPrototype,VIEW,true);hide(TypedArrayPrototype,DEF_CONSTRUCTOR,TypedArray);if(CLAMPED?new TypedArray(1)[TAG]!=NAME:!(TAG in TypedArrayPrototype)){dP(TypedArrayPrototype,TAG,{get:function(){return NAME}})}O[NAME]=TypedArray;$export($export.G+$export.W+$export.F*(TypedArray!=Base),O);$export($export.S,NAME,{BYTES_PER_ELEMENT:BYTES});$export($export.S+$export.F*fails(function(){Base.of.call(TypedArray,1)}),NAME,{from:$from,of:$of});if(!(BYTES_PER_ELEMENT in TypedArrayPrototype))hide(TypedArrayPrototype,BYTES_PER_ELEMENT,BYTES);$export($export.P,NAME,proto);setSpecies(NAME);$export($export.P+$export.F*FORCED_SET,NAME,{set:$set});$export($export.P+$export.F*!CORRECT_ITER_NAME,NAME,$iterators);if(!LIBRARY&&TypedArrayPrototype.toString!=arrayToString)TypedArrayPrototype.toString=arrayToString;$export($export.P+$export.F*fails(function(){new TypedArray(1).slice()}),NAME,{slice:$slice});$export($export.P+$export.F*(fails(function(){return[1,2].toLocaleString()!=new TypedArray([1,2]).toLocaleString()})||!fails(function(){TypedArrayPrototype.toLocaleString.call([1,2])})),NAME,{toLocaleString:$toLocaleString});Iterators[NAME]=CORRECT_ITER_NAME?$nativeIterator:$iterator;if(!LIBRARY&&!CORRECT_ITER_NAME)hide(TypedArrayPrototype,ITERATOR,$iterator)}}else module.exports=function(){}},function(module,exports,__webpack_require__){var Map=__webpack_require__(135);var $export=__webpack_require__(0);var shared=__webpack_require__(70)("metadata");var store=shared.store||(shared.store=new(__webpack_require__(138)));var getOrCreateMetadataMap=function(target,targetKey,create){var targetMetadata=store.get(target);if(!targetMetadata){if(!create)return undefined;store.set(target,targetMetadata=new Map)}var keyMetadata=targetMetadata.get(targetKey);if(!keyMetadata){if(!create)return undefined;targetMetadata.set(targetKey,keyMetadata=new Map)}return keyMetadata};var ordinaryHasOwnMetadata=function(MetadataKey,O,P){var metadataMap=getOrCreateMetadataMap(O,P,false);return metadataMap===undefined?false:metadataMap.has(MetadataKey)};var ordinaryGetOwnMetadata=function(MetadataKey,O,P){var metadataMap=getOrCreateMetadataMap(O,P,false);return metadataMap===undefined?undefined:metadataMap.get(MetadataKey)};var ordinaryDefineOwnMetadata=function(MetadataKey,MetadataValue,O,P){getOrCreateMetadataMap(O,P,true).set(MetadataKey,MetadataValue)};var ordinaryOwnMetadataKeys=function(target,targetKey){var metadataMap=getOrCreateMetadataMap(target,targetKey,false);var keys=[];if(metadataMap)metadataMap.forEach(function(_,key){keys.push(key)});return keys};var toMetaKey=function(it){return it===undefined||typeof it=="symbol"?it:String(it)};var exp=function(O){$export($export.S,"Reflect",O)};module.exports={store:store,map:getOrCreateMetadataMap,has:ordinaryHasOwnMetadata,get:ordinaryGetOwnMetadata,set:ordinaryDefineOwnMetadata,keys:ordinaryOwnMetadataKeys,key:toMetaKey,exp:exp}},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var TensorArrayMapBase=function(){function TensorArrayMapBase(){this.dict={}}TensorArrayMapBase.prototype.get=function(tensor,skipChecks){if(skipChecks===void 0){skipChecks=false}if(!skipChecks&&this.dict[tensor.id]===undefined){throw new Error("tensor "+tensor.id+" not in array map.")}var nda=this.dict[tensor.id];if(!skipChecks&&nda===null){throw new Error("tensor "+tensor.id+" has null array.")}return nda};TensorArrayMapBase.prototype.delete=function(tensor){delete this.dict[tensor.id]};TensorArrayMapBase.prototype.nullify=function(tensor){this.dict[tensor.id]=null};TensorArrayMapBase.prototype.disposeArray=function(tensor){if(this.dict[tensor.id]===undefined){return}var nda=this.dict[tensor.id];if(nda===null){return}nda.dispose();this.dict[tensor.id]=null};TensorArrayMapBase.prototype.size=function(){return Object.keys(this.dict).length};TensorArrayMapBase.prototype.dispose=function(){var _this=this;Object.keys(this.dict).forEach(function(tensorID){var nda=_this.dict[+tensorID];if(nda){nda.dispose()}});this.dict={}};TensorArrayMapBase.prototype.hasNullArray=function(tensor){if(this.dict[tensor.id]===undefined){throw new Error("tensor "+tensor.id+" not in array map.")}return this.dict[tensor.id]===null};return TensorArrayMapBase}();exports.TensorArrayMapBase=TensorArrayMapBase;var TensorArrayMap=function(_super){__extends(TensorArrayMap,_super);function TensorArrayMap(){return _super!==null&&_super.apply(this,arguments)||this}TensorArrayMap.prototype.set=function(tensor,array){this.dict[tensor.id]=array};return TensorArrayMap}(TensorArrayMapBase);exports.TensorArrayMap=TensorArrayMap;var SummedTensorArrayMap=function(_super){__extends(SummedTensorArrayMap,_super);function SummedTensorArrayMap(math){var _this=_super.call(this)||this;_this.math=math;return _this}SummedTensorArrayMap.prototype.add=function(tensor,array){if(this.dict[tensor.id]==null){this.dict[tensor.id]=this.math.keep(array)}else{var oldValue=this.get(tensor);var newValue=this.math.keep(this.math.addStrict(oldValue,array));this.dict[tensor.id]=newValue;oldValue.dispose()}};return SummedTensorArrayMap}(TensorArrayMapBase);exports.SummedTensorArrayMap=SummedTensorArrayMap},function(module,exports,__webpack_require__){var META=__webpack_require__(40)("meta");var isObject=__webpack_require__(6);var has=__webpack_require__(15);var setDesc=__webpack_require__(9).f;var id=0;var isExtensible=Object.isExtensible||function(){return true};var FREEZE=!__webpack_require__(5)(function(){return isExtensible(Object.preventExtensions({}))});var setMeta=function(it){setDesc(it,META,{value:{i:"O"+ ++id,w:{}}})};var fastKey=function(it,create){if(!isObject(it))return typeof it=="symbol"?it:(typeof it=="string"?"S":"P")+it;if(!has(it,META)){if(!isExtensible(it))return"F";if(!create)return"E";setMeta(it)}return it[META].i};var getWeak=function(it,create){if(!has(it,META)){if(!isExtensible(it))return true;if(!create)return false;setMeta(it)}return it[META].w};var onFreeze=function(it){if(FREEZE&&meta.NEED&&isExtensible(it)&&!has(it,META))setMeta(it);return it};var meta=module.exports={KEY:META,NEED:false,fastKey:fastKey,getWeak:getWeak,onFreeze:onFreeze}},function(module,exports,__webpack_require__){var UNSCOPABLES=__webpack_require__(7)("unscopables");var ArrayProto=Array.prototype;if(ArrayProto[UNSCOPABLES]==undefined)__webpack_require__(16)(ArrayProto,UNSCOPABLES,{});module.exports=function(key){ArrayProto[UNSCOPABLES][key]=true}},function(module,exports){module.exports=function(bitmap,value){return{enumerable:!(bitmap&1),configurable:!(bitmap&2),writable:!(bitmap&4),value:value}}},function(module,exports){var id=0;var px=Math.random();module.exports=function(key){return"Symbol(".concat(key===undefined?"":key,")_",(++id+px).toString(36))}},function(module,exports){module.exports=false},function(module,exports,__webpack_require__){var $keys=__webpack_require__(116);var enumBugKeys=__webpack_require__(88);module.exports=Object.keys||function keys(O){return $keys(O,enumBugKeys)}},function(module,exports,__webpack_require__){var toInteger=__webpack_require__(31);var max=Math.max;var min=Math.min;module.exports=function(index,length){index=toInteger(index);return index<0?max(index+length,0):min(index,length)}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(1);var dPs=__webpack_require__(117);var enumBugKeys=__webpack_require__(88);var IE_PROTO=__webpack_require__(87)("IE_PROTO");var Empty=function(){};var PROTOTYPE="prototype";var createDict=function(){var iframe=__webpack_require__(85)("iframe");var i=enumBugKeys.length;var lt="<";var gt=">";var iframeDocument;iframe.style.display="none";__webpack_require__(89).appendChild(iframe);iframe.src="javascript:";iframeDocument=iframe.contentWindow.document;iframeDocument.open();iframeDocument.write(lt+"script"+gt+"document.F=Object"+lt+"/script"+gt);iframeDocument.close();createDict=iframeDocument.F;while(i--)delete createDict[PROTOTYPE][enumBugKeys[i]];return createDict()};module.exports=Object.create||function create(O,Properties){var result;if(O!==null){Empty[PROTOTYPE]=anObject(O);result=new Empty;Empty[PROTOTYPE]=null;result[IE_PROTO]=O}else result=createDict();return Properties===undefined?result:dPs(result,Properties)}},function(module,exports,__webpack_require__){var $keys=__webpack_require__(116);var hiddenKeys=__webpack_require__(88).concat("length","prototype");exports.f=Object.getOwnPropertyNames||function getOwnPropertyNames(O){return $keys(O,hiddenKeys)}},function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(2);var dP=__webpack_require__(9);var DESCRIPTORS=__webpack_require__(8);var SPECIES=__webpack_require__(7)("species");module.exports=function(KEY){var C=global[KEY];if(DESCRIPTORS&&C&&!C[SPECIES])dP.f(C,SPECIES,{configurable:true,get:function(){return this}})}},function(module,exports){module.exports=function(it,Constructor,name,forbiddenField){if(!(it instanceof Constructor)||forbiddenField!==undefined&&forbiddenField in it){throw TypeError(name+": incorrect invocation!")}return it}},function(module,exports,__webpack_require__){var ctx=__webpack_require__(24);var call=__webpack_require__(128);var isArrayIter=__webpack_require__(101);var anObject=__webpack_require__(1);var toLength=__webpack_require__(10);var getIterFn=__webpack_require__(103);var BREAK={};var RETURN={};var exports=module.exports=function(iterable,entries,fn,that,ITERATOR){var iterFn=ITERATOR?function(){return iterable}:getIterFn(iterable);var f=ctx(fn,that,entries?2:1);var index=0;var length,step,iterator,result;if(typeof iterFn!="function")throw TypeError(iterable+" is not iterable!");if(isArrayIter(iterFn))for(length=toLength(iterable.length);length>index;index++){result=entries?f(anObject(step=iterable[index])[0],step[1]):f(iterable[index]);if(result===BREAK||result===RETURN)return result}else for(iterator=iterFn.call(iterable);!(step=iterator.next()).done;){result=call(iterator,f,step.value,entries);if(result===BREAK||result===RETURN)return result}};exports.BREAK=BREAK;exports.RETURN=RETURN},function(module,exports,__webpack_require__){var redefine=__webpack_require__(17);module.exports=function(target,src,safe){for(var key in src)redefine(target,key,src[key],safe);return target}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var environment_1=__webpack_require__(11);var session_util=__webpack_require__(159);var tensor_array_map_1=__webpack_require__(36);var ndarray_1=__webpack_require__(3);var Optimizer=function(){function Optimizer(learningRate,specifiedVariableList){this.learningRate=learningRate;this.variableGradients=new tensor_array_map_1.TensorArrayMap;if(specifiedVariableList!=null){this.specifiedVariableNodes=specifiedVariableList}this.one=environment_1.ENV.math.keep(ndarray_1.Scalar.new(1))}Optimizer.prototype.minimize=function(f,returnCost){if(returnCost===void 0){returnCost=false}var _a=this.computeGradients(f),value=_a.value,gradients=_a.gradients;this.applyGradients(gradients);var varNames=Object.keys(gradients);varNames.forEach(function(varName){return gradients[varName].dispose()});if(returnCost){return value}else{value.dispose();return null}};Optimizer.prototype.computeGradients=function(f){return environment_1.ENV.math.variableGradients(f)};Optimizer.prototype.beforeBatch=function(math,batchSize,runtime,activationArrayMap,gradientArrayMap){var _this=this;this.variableNodes=this.specifiedVariableNodes==null?session_util.getVariableNodesFromEvaluationSet(runtime.nodes):this.specifiedVariableNodes;if(batchSize!==this.prevBatchSize){if(this.cGraph!=null){this.cGraph.dispose()}this.prevBatchSize=batchSize;this.cGraph=math.keep(ndarray_1.Scalar.new(-this.learningRate/batchSize))}this.variableNodes.forEach(function(node){return _this.variableGradients.set(node.output,math.keep(ndarray_1.NDArray.zeros(node.output.shape)))})};Optimizer.prototype.afterExample=function(math,runtime,activationArrayMap,gradientArrayMap){var _this=this;math.scope(function(keep){_this.variableNodes.forEach(function(node){var gradient=gradientArrayMap.get(node.output);var accumulatedGradient=_this.variableGradients.get(node.output);_this.variableGradients.set(node.output,keep(math.add(gradient,accumulatedGradient)));accumulatedGradient.dispose()})})};Optimizer.prototype.dispose=function(){if(this.cGraph!=null){this.cGraph.dispose()}this.one.dispose();if(this.variableNodes!=null){this.variableNodes.forEach(function(node){node.data.dispose()})}if(this.specifiedVariableNodes!=null){this.specifiedVariableNodes.forEach(function(node){node.data.dispose()})}};return Optimizer}();exports.Optimizer=Optimizer},function(module,exports,__webpack_require__){var def=__webpack_require__(9).f;var has=__webpack_require__(15);var TAG=__webpack_require__(7)("toStringTag");module.exports=function(it,tag,stat){if(it&&!has(it=stat?it:it.prototype,TAG))def(it,TAG,{configurable:true,value:tag})}},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var defined=__webpack_require__(30);var fails=__webpack_require__(5);var spaces=__webpack_require__(91);var space="["+spaces+"]";var non="";var ltrim=RegExp("^"+space+space+"*");var rtrim=RegExp(space+space+"*$");var exporter=function(KEY,exec,ALIAS){var exp={};var FORCE=fails(function(){return!!spaces[KEY]()||non[KEY]()!=non});var fn=exp[KEY]=FORCE?exec(trim):spaces[KEY];if(ALIAS)exp[ALIAS]=fn;$export($export.P+$export.F*FORCE,"String",exp)};var trim=exporter.trim=function(string,TYPE){string=String(defined(string));if(TYPE&1)string=string.replace(ltrim,"");if(TYPE&2)string=string.replace(rtrim,"");return string};module.exports=exporter},function(module,exports){module.exports={}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(6);module.exports=function(it,TYPE){if(!isObject(it)||it._t!==TYPE)throw TypeError("Incompatible receiver, "+TYPE+" required!");return it}},function(module,exports){module.exports=function(module){if(!module.webpackPolyfill){module.deprecate=function(){};module.paths=[];if(!module.children)module.children=[];Object.defineProperty(module,"loaded",{enumerable:true,get:function(){return module.l}});Object.defineProperty(module,"id",{enumerable:true,get:function(){return module.i}});module.webpackPolyfill=1}return module}},function(module,exports){(function(__webpack_amd_options__){module.exports=__webpack_amd_options__}).call(exports,{})},function(module,exports,__webpack_require__){var cof=__webpack_require__(25);module.exports=Object("z").propertyIsEnumerable(0)?Object:function(it){return cof(it)=="String"?it.split(""):Object(it)}},function(module,exports){exports.f={}.propertyIsEnumerable},function(module,exports,__webpack_require__){var cof=__webpack_require__(25);var TAG=__webpack_require__(7)("toStringTag");var ARG=cof(function(){return arguments}())=="Arguments";var tryGet=function(it,key){try{return it[key]}catch(e){}};module.exports=function(it){var O,T,B;return it===undefined?"Undefined":it===null?"Null":typeof(T=tryGet(O=Object(it),TAG))=="string"?T:ARG?cof(O):(B=cof(O))=="Object"&&typeof O.callee=="function"?"Arguments":B}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var environment_1=__webpack_require__(11);var util=__webpack_require__(4);var axis_util=__webpack_require__(112);var backend_engine_1=__webpack_require__(367);var matmul_1=__webpack_require__(61);var broadcast_util=__webpack_require__(62);var concat_util=__webpack_require__(63);var conv_util=__webpack_require__(64);var ndarray_1=__webpack_require__(3);var slice_util=__webpack_require__(370);var NDArrayMath=function(){function NDArrayMath(backend,safeMode){this.registeredArrays=new Map;this.customBackend=false;this.registeredVariables={};if(typeof backend==="string"){this.backend=environment_1.ENV.getBackend(backend)}else{this.customBackend=true;this.backend=backend}this.backendEngine=new backend_engine_1.BackendEngine(this.backend,safeMode)}NDArrayMath.prototype.time=function(query){return this.backend.time(query)};NDArrayMath.prototype.getNumArrays=function(){return this.registeredArrays.size};NDArrayMath.prototype.register=function(a){var refCount=this.registeredArrays.has(a.dataId)?this.registeredArrays.get(a.dataId):0;if(refCount===0){this.backend.register(a.dataId,a.shape,a.dtype)}this.registeredArrays.set(a.dataId,refCount+1);if(!(a instanceof ndarray_1.Variable)){this.backendEngine.track(a)}};NDArrayMath.prototype.registerVariable=function(v){if(this.registeredVariables[v.name]!=null){throw new Error("Variable with name "+v.name+" was already registered")}this.registeredVariables[v.name]=v};NDArrayMath.prototype.writePixels=function(dataId,pixels,numChannels){this.backend.writePixels(dataId,pixels,numChannels)};NDArrayMath.prototype.write=function(dataId,values){this.backend.write(dataId,values)};NDArrayMath.prototype.readSync=function(dataId){return this.backend.readSync(dataId)};NDArrayMath.prototype.read=function(dataId){return this.backend.read(dataId)};NDArrayMath.prototype.enableDebugMode=function(){this.backendEngine.enableDebugMode();console.warn("Debugging mode is ON. The output of every math call will "+"be downloaded to CPU and checked for NaNs. "+"This significantly impacts performance.")};NDArrayMath.prototype.scope=function(scopeFn){var gradientsMode=false;return this.backendEngine.scope("scope",scopeFn,gradientsMode)};NDArrayMath.prototype.gradientsScope=function(scopeFn){var gradientsMode=true;return this.backendEngine.scope("gradientsScope",scopeFn,gradientsMode)};NDArrayMath.prototype.startScope=function(){var gradientsMode=false;this.backendEngine.startScope(gradientsMode)};NDArrayMath.prototype.endScope=function(result){var gradientsMode=false;this.backendEngine.endScope(result,gradientsMode)};NDArrayMath.prototype.keep=function(result){return this.backendEngine.keep(result)};NDArrayMath.prototype.track=function(result){return result};NDArrayMath.prototype.dispose=function(){if(this.customBackend){this.backend.dispose()}};NDArrayMath.prototype.matMul=function(a,b,aOrientation,bOrientation){var _this=this;if(aOrientation===void 0){aOrientation=matmul_1.MatrixOrientation.REGULAR}if(bOrientation===void 0){bOrientation=matmul_1.MatrixOrientation.REGULAR}var innerShapeA=aOrientation===matmul_1.MatrixOrientation.REGULAR?a.shape[1]:a.shape[0];var innerShapeB=bOrientation===matmul_1.MatrixOrientation.REGULAR?b.shape[0]:b.shape[1];util.assert(a.rank===2&&b.rank===2,"Error in matMul: inputs must be rank 2, got ranks "+a.rank+(" and "+b.rank+"."));util.assert(innerShapeA===innerShapeB,"Error in matMul: inner shapes ("+innerShapeA+") and ("+(innerShapeB+") of NDArrays with shapes "+a.shape+" and ")+(b.shape+" and orientations "+matmul_1.MatrixOrientation[aOrientation])+(" and "+matmul_1.MatrixOrientation[bOrientation]+" must match."));return this.backendEngine.executeKernel("MatMul",{inputs:{a:a,b:b},args:{aOrientation:aOrientation,bOrientation:bOrientation}},function(dy,y){if(aOrientation===matmul_1.MatrixOrientation.TRANSPOSED||bOrientation===matmul_1.MatrixOrientation.TRANSPOSED){throw new Error("Backprop for transposed MatMul not yet implemented.")}return{a:function(){return _this.matMul(dy,b,matmul_1.MatrixOrientation.REGULAR,matmul_1.MatrixOrientation.TRANSPOSED)},b:function(){return _this.matMul(a,dy,matmul_1.MatrixOrientation.TRANSPOSED,matmul_1.MatrixOrientation.REGULAR)}}})};NDArrayMath.prototype.executeOp=function(name,f){return f()};NDArrayMath.prototype.vectorTimesMatrix=function(v,matrix){util.assert(v.rank===1,"Error in vectorTimesMatrix: first input must be rank 1, but got "+("rank "+v.rank+"."));util.assert(matrix.rank===2,"Error in vectorTimesMatrix: second input must be rank 2, but got "+("rank "+matrix.rank+"."));util.assert(v.size===matrix.shape[0],"Error in vectorTimesMatrix: size of vector ("+v.size+") "+("must match first dimension of matrix ("+matrix.shape[0]+")"));return this.matMul(v.as2D(1,-1),matrix).as1D()};NDArrayMath.prototype.matrixTimesVector=function(matrix,v){util.assert(v.rank===1,"Error in matrixTimesVector: second input must rank 1, but got "+("rank "+v.rank+"."));util.assert(matrix.rank===2,"Error in matrixTimesVector: first input must be a rank 2, but got "+("rank "+matrix.rank+"."));util.assert(v.size===matrix.shape[1],"Error in matrixTimesVector: size of first rank 1 input "+v.size+" "+"must match inner dimension of second rank 2 input, but got "+("shape "+matrix.shape+"."));return this.matMul(matrix,v.as2D(-1,1)).as1D()};NDArrayMath.prototype.dotProduct=function(v1,v2){util.assert(v1.rank===1&&v2.rank===1,"Error in dotProduct: inputs must be rank 1, but got ranks "+(v1.rank+" and "+v2.rank+"."));util.assert(v1.size===v2.size,"Error in dotProduct: size of inputs ("+v1.size+") and ("+(v2.size+") must match."));return this.matMul(v1.as2D(1,-1),v2.as2D(-1,1)).asScalar()};NDArrayMath.prototype.outerProduct=function(v1,v2){util.assert(v1.rank===1&&v2.rank===1,"Error in outerProduct: inputs must be rank 1, but got ranks "+(v1.rank+" and "+v2.rank+"."));return this.matMul(v1.as2D(-1,1),v2.as2D(1,-1))};NDArrayMath.prototype.clone=function(x){return this.backendEngine.executeKernel("Clone",{inputs:{x:x}})};NDArrayMath.prototype.reshape=function(x,newShape){newShape=util.inferFromImplicitShape(newShape,x.size);util.assert(x.size===util.sizeFromShape(newShape),"new shape and old shape must have the same number of elements.");var grad=function(dy,y){return{x:function(){return dy.reshape(x.shape)}}};return this.backendEngine.executeKernel("Reshape",{inputs:{x:x},args:{newShape:newShape}},grad)};NDArrayMath.prototype.cast=function(x,newDType){var grad=function(dy,y){return{x:function(){return dy.reshape(dy.shape)}}};return this.backendEngine.executeKernel("Cast",{inputs:{x:x},args:{newDType:newDType}},grad)};NDArrayMath.prototype.slice1D=function(x,begin,size){slice_util.assertParamsValid(x,[begin],[size]);return this.backendEngine.executeKernel("Slice1D",{inputs:{x:x},args:{begin:begin,size:size}})};NDArrayMath.prototype.slice2D=function(x,begin,size){slice_util.assertParamsValid(x,begin,size);return this.backendEngine.executeKernel("Slice2D",{inputs:{x:x},args:{begin:begin,size:size}})};NDArrayMath.prototype.slice3D=function(x,begin,size){slice_util.assertParamsValid(x,begin,size);return this.backendEngine.executeKernel("Slice3D",{inputs:{x:x},args:{begin:begin,size:size}})};NDArrayMath.prototype.slice4D=function(x,begin,size){slice_util.assertParamsValid(x,begin,size);return this.backendEngine.executeKernel("Slice4D",{inputs:{x:x},args:{begin:begin,size:size}})};NDArrayMath.prototype.concat1D=function(a,b){concat_util.assertParams(a.shape,b.shape,0);return this.backendEngine.executeKernel("Concat1D",{inputs:{a:a,b:b}})};NDArrayMath.prototype.concat2D=function(a,b,axis){concat_util.assertParams(a.shape,b.shape,axis);return this.backendEngine.executeKernel("Concat2D",{inputs:{a:a,b:b},args:{axis:axis}})};NDArrayMath.prototype.concat3D=function(a,b,axis){concat_util.assertParams(a.shape,b.shape,axis);return this.backendEngine.executeKernel("Concat3D",{inputs:{a:a,b:b},args:{axis:axis}})};NDArrayMath.prototype.concat4D=function(a,b,axis){concat_util.assertParams(a.shape,b.shape,axis);return this.backendEngine.executeKernel("Concat4D",{inputs:{a:a,b:b},args:{axis:axis}})};NDArrayMath.prototype.logSumExp=function(input,axis,keepDims){var _this=this;if(axis===void 0){axis=null}if(keepDims===void 0){keepDims=false}var axes=axis_util.parseAxisParam(axis,input.shape);return this.executeOp("logSumExp",function(){var xMax=_this.max(input,axes,true);var a=_this.subtract(input,xMax);var b=_this.exp(a);var c=_this.sum(b,axes);var d=_this.log(c);var res=_this.add(xMax.reshape(d.shape),d);if(keepDims){var newShape=axis_util.expandShapeToKeepDim(res.shape,axes);return res.reshape(newShape)}return res})};NDArrayMath.prototype.sum=function(x,axis,keepDims){var _this=this;if(axis===void 0){axis=null}if(keepDims===void 0){keepDims=false}var origAxes=axis_util.parseAxisParam(axis,x.shape);var axes=origAxes;var permutedAxes=axis_util.getPermutedAxes(axes,x.rank);return this.executeOp("sum",function(){if(permutedAxes!=null){x=_this.transpose(x,permutedAxes);axes=axis_util.getInnerMostAxes(axes.length,x.rank)}var res=_this.backendEngine.executeKernel("Sum",{inputs:{x:x},args:{axes:axes}},function(dy,y){return{x:function(){if(axis!=null){throw new Error("Gradients for sum with axis reduction not yet "+"supported.")}return _this.multiply(dy,ndarray_1.NDArray.ones(x.shape,dy.dtype))}}});if(keepDims){var newShape=axis_util.expandShapeToKeepDim(res.shape,origAxes);return res.reshape(newShape)}return res})};NDArrayMath.prototype.mean=function(x,axis,keepDims){var _this=this;if(axis===void 0){axis=null}if(keepDims===void 0){keepDims=false}var axes=axis_util.parseAxisParam(axis,x.shape);var shapes=axis_util.computeOutAndReduceShapes(x.shape,axes);var reduceShape=shapes[1];var reduceSize=util.sizeFromShape(reduceShape);return this.executeOp("mean",function(){return _this.customGradient(function(){var res=_this.divide(x,ndarray_1.Scalar.new(reduceSize));var value=_this.sum(res,axis,keepDims);var gradients=function(dy,y){if(axis!=null){throw new Error("Gradient for mean not yet implemented for axis.")}return{x:function(){return _this.multiply(ndarray_1.NDArray.onesLike(x),_this.divide(dy,ndarray_1.Scalar.new(x.size)))}}};return{value:value,gradients:gradients}},{x:x},"mean")})};NDArrayMath.prototype.argMin=function(x,axis){var _this=this;if(axis===void 0){axis=null}var axes=axis_util.parseAxisParam(axis,x.shape);var permutedAxes=axis_util.getPermutedAxes(axes,x.rank);return this.executeOp("argMin",function(){if(permutedAxes!=null){x=_this.transpose(x,permutedAxes);axes=axis_util.getInnerMostAxes(axes.length,x.rank)}return _this.backendEngine.executeKernel("ArgMin",{inputs:{x:x},args:{axes:axes}})})};NDArrayMath.prototype.argMax=function(x,axis){var _this=this;if(axis===void 0){axis=null}var axes=axis_util.parseAxisParam(axis,x.shape);var permutedAxes=axis_util.getPermutedAxes(axes,x.rank);return this.executeOp("argMax",function(){if(permutedAxes!=null){x=_this.transpose(x,permutedAxes);axes=axis_util.getInnerMostAxes(axes.length,x.rank)}return _this.backendEngine.executeKernel("ArgMax",{inputs:{x:x},args:{axes:axes}})})};NDArrayMath.prototype.argMaxEquals=function(x1,x2){var _this=this;util.assertShapesMatch(x1.shape,x2.shape,"Error in argMaxEquals: ");return this.executeOp("argMaxEquals",function(){return _this.scope(function(){return _this.equal(_this.argMax(x1),_this.argMax(x2))})})};NDArrayMath.prototype.equal=function(a,b){util.assertTypesMatch(a,b);broadcast_util.assertAndGetBroadcastShape(a.shape,b.shape);return this.backendEngine.executeKernel("Equal",{inputs:{a:a,b:b}})};NDArrayMath.prototype.equalStrict=function(a,b){util.assertShapesMatch(a.shape,b.shape,"Error in equalStrict: ");return this.equal(a,b)};NDArrayMath.prototype.notEqual=function(a,b){util.assertTypesMatch(a,b);broadcast_util.assertAndGetBroadcastShape(a.shape,b.shape);return this.backendEngine.executeKernel("NotEqual",{inputs:{a:a,b:b}})};NDArrayMath.prototype.notEqualStrict=function(a,b){util.assertShapesMatch(a.shape,b.shape,"Error in notEqualStrict: ");return this.notEqual(a,b)};NDArrayMath.prototype.topK=function(x,k){var _this=this;util.assert(k<=x.size,"Error in topK: k value ("+k+") must be less than size of input "+("ndarray, got shape "+x.shape+"."));var values;var indices;this.executeOp("topK",function(){values=_this.backendEngine.executeKernel("TopKValues",{inputs:{x:x},args:{k:k}});indices=_this.backendEngine.executeKernel("TopKIndices",{inputs:{x:x},args:{k:k}});return values});var result={values:values,indices:indices};return result};NDArrayMath.prototype.min=function(x,axis,keepDims){var _this=this;if(axis===void 0){axis=null}if(keepDims===void 0){keepDims=false}var origAxes=axis_util.parseAxisParam(axis,x.shape);var axes=origAxes;var permutedAxes=axis_util.getPermutedAxes(axes,x.rank);return this.executeOp("min",function(){if(permutedAxes!=null){x=_this.transpose(x,permutedAxes);axes=axis_util.getInnerMostAxes(axes.length,x.rank)}var res=_this.backendEngine.executeKernel("Min",{inputs:{x:x},args:{axes:axes}});if(keepDims){var newShape=axis_util.expandShapeToKeepDim(res.shape,origAxes);return res.reshape(newShape)}return res})};NDArrayMath.prototype.minimum=function(a,b){util.assertTypesMatch(a,b);broadcast_util.assertAndGetBroadcastShape(a.shape,b.shape);return this.backendEngine.executeKernel("Minimum",{inputs:{a:a,b:b}})};NDArrayMath.prototype.max=function(x,axis,keepDims){var _this=this;if(axis===void 0){axis=null}if(keepDims===void 0){keepDims=false}var origAxes=axis_util.parseAxisParam(axis,x.shape);var axes=origAxes;var permutedAxes=axis_util.getPermutedAxes(axes,x.rank);return this.executeOp("max",function(){if(permutedAxes!=null){x=_this.transpose(x,permutedAxes);axes=axis_util.getInnerMostAxes(axes.length,x.rank)}var res=_this.backendEngine.executeKernel("Max",{inputs:{x:x},args:{axes:axes}});if(keepDims){var newShape=axis_util.expandShapeToKeepDim(res.shape,origAxes);return res.reshape(newShape)}return res})};NDArrayMath.prototype.maximum=function(a,b){util.assertTypesMatch(a,b);broadcast_util.assertAndGetBroadcastShape(a.shape,b.shape);return this.backendEngine.executeKernel("Maximum",{inputs:{a:a,b:b}})};NDArrayMath.prototype.softmax=function(logits,dim){var _this=this;if(dim===void 0){dim=-1}if(dim===-1){dim=logits.rank-1}if(dim!==logits.rank-1){throw Error("Softmax along a non-last dimension is not yet supported. "+("Logits was rank "+logits.rank+" and dim was "+dim))}var gradients=function(dy,y){return{logits:function(){var dyTimesY=_this.multiply(dy,y);var keepDims=true;return _this.subtract(dyTimesY,_this.multiply(_this.sum(dyTimesY,[dim],keepDims),y))}}};return this.executeOp("softmax",function(){return _this.customGradient(function(){var keepDims=true;var lse=_this.logSumExp(logits,[dim],keepDims);var logResult=_this.subtract(logits,lse);var value=_this.exp(logResult);return{value:value,gradients:gradients}},{logits:logits},"softmax")})};NDArrayMath.prototype.softmaxCrossEntropyWithLogits=function(labels,logits,dim){var _this=this;if(dim===void 0){dim=-1}util.assertShapesMatch(labels.shape,logits.shape,"Error in softmaxCrossEntropyWithLogits: ");if(dim===-1){dim=logits.rank-1}if(dim!==logits.rank-1){throw Error("Softmax cross entropy along a non-last dimension is not yet "+("supported. Labels / logits was rank "+logits.rank+" ")+("and dim was "+dim))}return this.executeOp("softmaxCrossEntropyWithLogits",function(){return _this.customGradient(function(){var softmaxLogits=_this.softmax(logits,dim);var yPlusEps=_this.add(ndarray_1.Scalar.new(1e-5),softmaxLogits);var logOutput=_this.log(yPlusEps);var tarLogOutput=_this.multiply(labels,logOutput);var costVector=_this.neg(tarLogOutput);var value=_this.sum(costVector,[dim]);var gradients=function(dy,y){var dyShape=axis_util.expandShapeToKeepDim(dy.shape,[dim]);return{logits:function(){return _this.multiply(dy.reshape(dyShape),_this.subtract(softmaxLogits,labels))},labels:function(){return _this.multiply(dy.reshape(dyShape),_this.subtract(labels,softmaxLogits))}}};return{value:value,gradients:gradients}},{labels:labels,logits:logits},"softmaxCrossEntropyWithLogits")})};NDArrayMath.prototype.switchDim=function(a,newDim){return this.transpose(a,newDim)};NDArrayMath.prototype.tile=function(x,reps){util.assert(x.rank===reps.length,"Error in transpose: rank of input "+x.rank+" "+("must match length of reps "+reps+"."));return this.backendEngine.executeKernel("Tile",{inputs:{x:x},args:{reps:reps}})};NDArrayMath.prototype.transpose=function(x,perm){if(perm==null){perm=x.shape.map(function(s,i){return i}).reverse()}util.assert(x.rank===perm.length,"Error in transpose: rank of input "+x.rank+" "+("must match length of perm "+perm+"."));return this.backendEngine.executeKernel("Transpose",{inputs:{x:x},args:{perm:perm}})};NDArrayMath.prototype.scalarPlusArray=function(c,a){util.assert(c.size===1,"Error in scalarPlusArray: first argument must be rank 0, but got "+("rank "+c.rank+"."));return this.add(c,a)};NDArrayMath.prototype.scalarMinusArray=function(c,a){util.assert(c.size===1,"Error in scalarMinusArray: first argument must be rank 0, but got "+("rank "+c.rank+"."));return this.subtract(c,a)};NDArrayMath.prototype.arrayMinusScalar=function(a,c){util.assert(c.size===1,"Error in arrayMinusScalar: second argument must be rank 0, but "+("got rank "+c.rank+"."));return this.subtract(a,c)};NDArrayMath.prototype.neg=function(x){return this.backendEngine.executeKernel("Neg",{inputs:{x:x}})};NDArrayMath.prototype.add=function(a,b){util.assertTypesMatch(a,b);broadcast_util.assertAndGetBroadcastShape(a.shape,b.shape);return this.backendEngine.executeKernel("Add",{inputs:{a:a,b:b}})};NDArrayMath.prototype.addStrict=function(a,b){util.assertShapesMatch(a.shape,b.shape,"Error in addStrict: ");return this.add(a,b)};NDArrayMath.prototype.subtract=function(a,b){var _this=this;util.assertTypesMatch(a,b);broadcast_util.assertAndGetBroadcastShape(a.shape,b.shape);return this.backendEngine.executeKernel("Sub",{inputs:{a:a,b:b}},function(dy,y){if(!util.arraysEqual(a.shape,b.shape)){throw new Error("Backprop through broadcasted subtract not "+"yet supported.")}return{a:function(){return _this.multiply(dy,ndarray_1.NDArray.onesLike(a))},b:function(){return _this.scope(function(){return _this.multiply(dy,_this.neg(ndarray_1.NDArray.onesLike(b)))})}}})};NDArrayMath.prototype.pow=function(a,b){var _this=this;util.assert(b.dtype==="int32","only supports int32 data type for the exponent parameter.");broadcast_util.assertAndGetBroadcastShape(a.shape,b.shape);var gradient=function(dy,y){if(!util.arraysEqual(a.shape,b.shape)){throw new Error("Gradient of pow not yet supported for broadcasted shapes.")}var derA=function(){return _this.scope(function(){return _this.multiply(dy,_this.multiply(b.asType(a.dtype),_this.pow(a,_this.subtract(b,ndarray_1.Scalar.new(1,"int32")))))})};var derB=function(){throw new Error("Backprop through exponent of math.pow not "+"implemented yet.")};return{a:derA,b:derB}};return this.backendEngine.executeKernel("Pow",{inputs:{a:a,b:b}},gradient)};NDArrayMath.prototype.powStrict=function(a,b){util.assertShapesMatch(a.shape,b.shape,"Error in powStrict: ");return this.pow(a,b)};NDArrayMath.prototype.sub=function(a,b){return this.subtract(a,b)};NDArrayMath.prototype.subStrict=function(a,b){util.assertShapesMatch(a.shape,b.shape,"Error in subStrict: ");return this.subtract(a,b)};NDArrayMath.prototype.multiply=function(a,b){var _this=this;util.assertTypesMatch(a,b);broadcast_util.assertAndGetBroadcastShape(a.shape,b.shape);return this.backendEngine.executeKernel("Mul",{inputs:{a:a,b:b}},function(dy,y){if(!util.arraysEqual(a.shape,b.shape)){throw new Error("Backprop through broadcasted multiply not "+"supported yet.")}return{a:function(){return _this.multiply(dy,b)},b:function(){return _this.multiply(dy,a)}}})};NDArrayMath.prototype.elementWiseMul=function(a,b){return this.multiplyStrict(a,b)};NDArrayMath.prototype.multiplyStrict=function(a,b){util.assertShapesMatch(a.shape,b.shape,"Error in multiplyStrict: ");return this.multiply(a,b)};NDArrayMath.prototype.divide=function(a,b){broadcast_util.assertAndGetBroadcastShape(a.shape,b.shape);return this.backendEngine.executeKernel("Div",{inputs:{a:a,b:b}})};NDArrayMath.prototype.divideStrict=function(a,b){util.assertShapesMatch(a.shape,b.shape,"Error in divideStrict: ");return this.divide(a,b)};NDArrayMath.prototype.scalarDividedByArray=function(c,a){util.assert(c.size===1,"Error in scalarDividedByArray: first argument must be rank 0, but "+("got NDArray of rank "+c.rank+"."));return this.divide(c,a)};NDArrayMath.prototype.arrayDividedByScalar=function(a,c){util.assert(c.size===1,"Error in arrayDividedByScalar: second argument must be rank 0, "+("but got NDArray of rank "+c.rank+"."));return this.divide(a,c)};NDArrayMath.prototype.ceil=function(x){return this.backendEngine.executeKernel("Ceil",{inputs:{x:x}})};NDArrayMath.prototype.floor=function(x){return this.backendEngine.executeKernel("Floor",{inputs:{x:x}})};NDArrayMath.prototype.exp=function(x){return this.backendEngine.executeKernel("Exp",{inputs:{x:x}})};NDArrayMath.prototype.log=function(x){return this.backendEngine.executeKernel("Log",{inputs:{x:x}})};NDArrayMath.prototype.sqrt=function(x){return this.backendEngine.executeKernel("Sqrt",{inputs:{x:x}})};NDArrayMath.prototype.square=function(x){var _this=this;return this.backendEngine.executeKernel("Square",{inputs:{x:x}},function(dy,y){return{x:function(){return _this.multiply(dy,_this.multiply(x,ndarray_1.Scalar.new(2)))}}})};NDArrayMath.prototype.abs=function(x){return this.backendEngine.executeKernel("Abs",{inputs:{x:x}})};NDArrayMath.prototype.clip=function(x,min,max){util.assert(min<=max,"Error in clip: min ("+min+") must be"+("less than or equal to max ("+max+")."));return this.backendEngine.executeKernel("Clip",{inputs:{x:x},args:{min:min,max:max}})};NDArrayMath.prototype.relu=function(x){var _this=this;return this.backendEngine.executeKernel("Relu",{inputs:{x:x}},function(dy,y){return{x:function(){return _this.multiply(dy,_this.step(x))}}})};NDArrayMath.prototype.elu=function(x){return this.backendEngine.executeKernel("Elu",{inputs:{x:x}})};NDArrayMath.prototype.eluDer=function(x){return this.backendEngine.executeKernel("EluDer",{inputs:{x:x}})};NDArrayMath.prototype.selu=function(x){return this.backendEngine.executeKernel("Selu",{inputs:{x:x}})};NDArrayMath.prototype.leakyRelu=function(x,alpha){if(alpha===void 0){alpha=.2}return this.backendEngine.executeKernel("LeakyRelu",{inputs:{x:x},args:{alpha:alpha}})};NDArrayMath.prototype.prelu=function(x,alpha){return this.backendEngine.executeKernel("PReLU",{inputs:{x:x,alpha:alpha}})};NDArrayMath.prototype.preluDer=function(x,alpha){return this.backendEngine.executeKernel("PReLUDer",{inputs:{x:x,alpha:alpha}})};NDArrayMath.prototype.sigmoid=function(x){return this.backendEngine.executeKernel("Sigmoid",{inputs:{x:x}})};NDArrayMath.prototype.sin=function(x){return this.backendEngine.executeKernel("Sin",{inputs:{x:x}})};NDArrayMath.prototype.cos=function(x){return this.backendEngine.executeKernel("Cos",{inputs:{x:x}})};NDArrayMath.prototype.tan=function(x){return this.backendEngine.executeKernel("Tan",{inputs:{x:x}})};NDArrayMath.prototype.asin=function(x){return this.backendEngine.executeKernel("Asin",{inputs:{x:x}})};NDArrayMath.prototype.acos=function(x){return this.backendEngine.executeKernel("Acos",{inputs:{x:x}})};NDArrayMath.prototype.atan=function(x){return this.backendEngine.executeKernel("Atan",{inputs:{x:x}})};NDArrayMath.prototype.sinh=function(x){return this.backendEngine.executeKernel("Sinh",{inputs:{x:x}})};NDArrayMath.prototype.cosh=function(x){return this.backendEngine.executeKernel("Cosh",{inputs:{x:x}})};NDArrayMath.prototype.tanh=function(x){return this.backendEngine.executeKernel("Tanh",{inputs:{x:x}})};NDArrayMath.prototype.step=function(x,alpha){if(alpha===void 0){alpha=0}return this.backendEngine.executeKernel("Step",{inputs:{x:x},args:{alpha:alpha}})};NDArrayMath.prototype.scaledArrayAdd=function(c1,a,c2,b){var _this=this;util.assert(c1.size===1,"Error in scaledArrayAdd: first argument must rank 0, but got "+(" rank "+c1.rank+"."));util.assert(c2.size===1,"Error in scaledArrayAdd: third argument must be rank 0, but got "+("NDArray of rank "+c2.rank+"."));util.assertShapesMatch(a.shape,b.shape,"Error in scaledArrayAdd: ");return this.executeOp("scaledArrayAdd",function(){return _this.scope(function(){return _this.add(_this.multiply(c1,a),_this.multiply(c2,b))})})};NDArrayMath.prototype.scalarTimesArray=function(c,a){util.assert(c.size===1,"Error in arrayDividedByScalar: first argument must be rank 0, but "+("got rank "+c.rank+"."));return this.multiply(c,a)};NDArrayMath.prototype.elementWiseMulBroadcast=function(a,b){util.assert(a.rank===2,"Error in elementWiseMulBroadcast: first argument must be "+("rank 2, but got rank "+a.rank+"."));util.assert(b.rank===2,"Error in elementWiseMulBroadcast: second argument must be "+("rank 2, but got rank "+b.rank+"."));return this.multiply(a,b)};NDArrayMath.prototype.conv1d=function(input,filter,bias,stride,pad){var _this=this;var input3D=input;var reshapedTo3D=false;if(input.rank===2){reshapedTo3D=true;input3D=input.as3D(1,input.shape[0],input.shape[1])}util.assert(input3D.rank===3,"Error in conv1d: input must be rank 3, but got rank "+input3D.rank+".");util.assert(filter.rank===3,"Error in conv1d: filter must be rank 3, but got rank "+(filter.rank+"."));if(bias!=null){util.assert(bias.rank===1,"Error in conv1d: bias must be rank 1, but got rank "+(bias.rank+"."))}util.assert(input3D.shape[2]===filter.shape[1],"Error in conv1d: depth of input ("+input3D.shape[2]+") must match  "+("input depth for filter "+filter.shape[1]+"."));var filter4D=filter.as4D(1,filter.shape[0],filter.shape[1],filter.shape[2]);var input4D=input3D.as4D(input3D.shape[0],1,input3D.shape[1],input3D.shape[2]);var strides=[1,stride];return this.executeOp("Conv1D",function(){var res=_this.conv2d(input4D,filter4D,bias,strides,pad);if(reshapedTo3D){return res.as2D(res.shape[2],res.shape[3])}return res.as3D(res.shape[0],res.shape[2],res.shape[3])})};NDArrayMath.prototype.conv2d=function(input,filter,bias,strides,pad){var _this=this;var input4D=input;var reshapedTo4D=false;if(input.rank===3){reshapedTo4D=true;input4D=input.as4D(1,input.shape[0],input.shape[1],input.shape[2])}util.assert(input4D.rank===4,"Error in conv2d: input must be rank 4, but got rank "+input4D.rank+".");util.assert(filter.rank===4,"Error in conv2d: filter must be rank 4, but got rank "+(filter.rank+"."));if(bias!=null){util.assert(bias.rank===1,"Error in conv2d: bias must be rank 1, but got rank "+(bias.rank+"."))}util.assert(input4D.shape[3]===filter.shape[2],"Error in conv2d: depth of input ("+input4D.shape[3]+") must match  "+("input depth for filter "+filter.shape[2]+"."));var convInfo=conv_util.computeConv2DInfo(input4D.shape,filter.shape,strides,pad);return this.executeOp("Conv2D",function(){var res=_this.backendEngine.executeKernel("Conv2D",{inputs:{x:input4D,filter:filter,bias:bias},args:{convInfo:convInfo}});if(reshapedTo4D){return res.as3D(res.shape[1],res.shape[2],res.shape[3])}return res})};NDArrayMath.prototype.conv2dDerInput=function(inShape,dy,filter,strides,pad){var _this=this;util.assert(inShape.length===dy.rank,"Length of inShape "+("("+inShape.length+") and rank of dy ("+dy.rank+") must match"));var inShape4D=inShape;var dy4D=dy;var reshapedTo4D=false;if(dy.rank===3){reshapedTo4D=true;dy4D=dy.as4D(1,dy.shape[0],dy.shape[1],dy.shape[2]);inShape4D=[1,inShape[0],inShape[1],inShape[2]]}var inDepth=inShape4D[3];var outDepth=dy4D.shape[3];util.assert(inShape4D.length===4,"Error in conv2dDerInput: inShape must be length 4, but got length "+(inShape4D.length+"."));util.assert(dy4D.rank===4,"Error in conv2dDerInput: dy must be rank 4, but got "+("rank "+dy4D.rank));util.assert(filter.rank===4,"Error in conv2dDerInput: filter must be rank 4, but got "+("rank "+filter.rank));util.assert(inDepth===filter.shape[2],"Error in conv2dDerInput: depth of input ("+inDepth+") must "+("match input depth for filter "+filter.shape[2]+"."));util.assert(outDepth===filter.shape[3],"Error in conv2dDerInput: depth of output ("+outDepth+") must"+("match output depth for filter "+filter.shape[3]+"."));var convInfo=conv_util.computeConv2DInfo(inShape4D,filter.shape,strides,pad);return this.executeOp("conv2dDerInput",function(){var res=_this.backendEngine.executeKernel("Conv2DDerInput",{inputs:{dy:dy4D,filter:filter},args:{convInfo:convInfo}});if(reshapedTo4D){return res.as3D(res.shape[1],res.shape[2],res.shape[3])}return res})};NDArrayMath.prototype.conv2dDerBias=function(dy){var dy4D=dy;if(dy.rank===3){dy4D=dy.as4D(1,dy.shape[0],dy.shape[1],dy.shape[2])}return this.backendEngine.executeKernel("Conv2DDerBias",{inputs:{dy:dy4D}})};NDArrayMath.prototype.conv2dDerFilter=function(input,dy,filterShape,strides,pad){var input4D=input;if(input.rank===3){input4D=input.as4D(1,input.shape[0],input.shape[1],input.shape[2])}var dy4D=dy;if(dy4D.rank===3){dy4D=dy.as4D(1,dy.shape[0],dy.shape[1],dy.shape[2])}util.assert(input4D.rank===4,"Error in conv2dDerFilter: input must be rank 4, but got shape "+(input4D.shape+"."));util.assert(dy4D.rank===4,"Error in conv2dDerFilter: dy must be rank 4, but got shape "+(dy4D.shape+"."));util.assert(filterShape.length===4,"Error in conv2dDerFilter: filterShape must be length 4, but got "+(filterShape+"."));util.assert(input4D.shape[3]===filterShape[2],"Error in conv2dDerFilter: depth of input "+input4D.shape[3]+") must "+("match input depth in filter ("+filterShape[2]+"."));util.assert(dy4D.shape[3]===filterShape[3],"Error in conv2dDerFilter: depth of dy ("+dy4D.shape[3]+") must "+("match output depth for filter ("+filterShape[3]+")."));var convInfo=conv_util.computeConv2DInfo(input4D.shape,filterShape,strides,pad);return this.backendEngine.executeKernel("Conv2DDerFilter",{inputs:{x:input4D,dy:dy4D},args:{convInfo:convInfo}})};NDArrayMath.prototype.conv2dTranspose=function(x,filter,outputShape,strides,pad){return this.conv2dDerInput(outputShape,x,filter,strides,pad)};NDArrayMath.prototype.depthwiseConv2D=function(input,filter,strides,pad,rates){var _this=this;if(rates===void 0){rates=[1,1]}var input4D=input;var reshapedTo4D=false;if(input.rank===3){reshapedTo4D=true;input4D=input.as4D(1,input.shape[0],input.shape[1],input.shape[2])}util.assert(input4D.rank===4,"Error in depthwiseConv2D: input must be rank 4, but got "+("rank "+input4D.rank+"."));util.assert(filter.rank===4,"Error in depthwiseConv2D: filter must be rank 4, but got rank "+(filter.rank+"."));util.assert(input4D.shape[3]===filter.shape[2],"Error in depthwiseConv2D: number of input channels "+("("+input4D.shape[3]+") must match the inChannels dimension in ")+("filter "+filter.shape[2]+"."));rates=rates||[1,1];var _a=parseTupleParam(rates),rateHeight=_a[0],rateWidth=_a[1];util.assert(rateHeight===1&&rateWidth===1,"Error in depthwiseConv2D: rates greater than 1 are not yet "+("supported. Got rates '"+rates+"'"));var convInfo=conv_util.computeConv2DInfo(input4D.shape,filter.shape,strides,pad,true);return this.executeOp("depthwiseConv2D",function(){var res=_this.backendEngine.executeKernel("DepthwiseConv2D",{inputs:{x:input4D,filter:filter},args:{convInfo:convInfo}});if(reshapedTo4D){return res.as3D(res.shape[1],res.shape[2],res.shape[3])}return res})};NDArrayMath.prototype.maxPool=function(input,filterSize,strides,pad){var _this=this;var input4D=input;var reshapedTo4D=false;if(input.rank===3){reshapedTo4D=true;input4D=input.as4D(1,input.shape[0],input.shape[1],input.shape[2])}util.assert(input4D.rank===4,"Error in maxPool: input must be rank 4 but got rank "+input4D.rank+".");var convInfo=conv_util.computePool2DInfo(input4D.shape,filterSize,strides,pad);return this.executeOp("maxPool",function(){var res=_this.backendEngine.executeKernel("MaxPool",{inputs:{x:input4D},args:{convInfo:convInfo}});if(reshapedTo4D){return res.as3D(res.shape[1],res.shape[2],res.shape[3])}return res})};NDArrayMath.prototype.maxPoolBackprop=function(dy,input,filterSize,strides,pad){var _this=this;util.assert(input.rank===dy.rank,"Rank of input ("+input.rank+") does not match rank of dy ("+dy.rank+")");var input4D=input;var dy4D=dy;var reshapedTo4D=false;if(input.rank===3){reshapedTo4D=true;input4D=input.as4D(1,input.shape[0],input.shape[1],input.shape[2]);dy4D=dy.as4D(1,dy.shape[0],dy.shape[1],dy.shape[2])}util.assert(dy4D.rank===4,"Error in maxPoolBackprop: dy must be rank 4 but got rank "+(dy4D.rank+"."));util.assert(input4D.rank===4,"Error in maxPoolBackprop: input must be rank 4 but got rank "+(input4D.rank+"."));var convInfo=conv_util.computePool2DInfo(input4D.shape,filterSize,strides,pad);return this.executeOp("maxPoolBackprop",function(){var res=_this.backendEngine.executeKernel("MaxPoolBackprop",{inputs:{dy:dy4D,x:input4D},args:{convInfo:convInfo}});if(reshapedTo4D){return res.as3D(res.shape[1],res.shape[2],res.shape[3])}return res})};NDArrayMath.prototype.minPool=function(input,filterSize,strides,pad){var _this=this;var input4D=input;var reshapedTo4D=false;if(input.rank===3){reshapedTo4D=true;input4D=input.as4D(1,input.shape[0],input.shape[1],input.shape[2])}util.assert(input4D.rank===4,"Error in minPool: x must be rank 4 but got rank "+input4D.rank+".");var convInfo=conv_util.computePool2DInfo(input4D.shape,filterSize,strides,pad);return this.executeOp("minPool",function(){var res=_this.backendEngine.executeKernel("MinPool",{inputs:{x:input4D},args:{convInfo:convInfo}});if(reshapedTo4D){return res.as3D(res.shape[1],res.shape[2],res.shape[3])}return res})};NDArrayMath.prototype.avgPool=function(input,filterSize,strides,pad){var _this=this;var input4D=input;var reshapedTo4D=false;if(input.rank===3){reshapedTo4D=true;input4D=input.as4D(1,input.shape[0],input.shape[1],input.shape[2])}util.assert(input4D.rank===4,"Error in avgPool: x must be rank 4 but got rank "+input4D.rank+".");var convInfo=conv_util.computePool2DInfo(input4D.shape,filterSize,strides,pad);return this.executeOp("avgPool",function(){var res=_this.backendEngine.executeKernel("AvgPool",{inputs:{x:input4D},args:{convInfo:convInfo}});if(reshapedTo4D){return res.as3D(res.shape[1],res.shape[2],res.shape[3])}return res})};NDArrayMath.prototype.resizeBilinear3D=function(x,newShape2D,alignCorners){if(alignCorners===void 0){alignCorners=false}util.assert(x.rank===3,"Error in resizeBilinear3D: x must be rank 3 but got rank "+x.rank+".");util.assert(newShape2D.length===2,"Error in resizeBilinear3D: new shape must 2D, but got shape "+(newShape2D+"."));return this.backendEngine.executeKernel("ResizeBilinear3D",{inputs:{x:x},args:{newShape2D:newShape2D,alignCorners:alignCorners}})};NDArrayMath.prototype.batchNormalization2D=function(x,mean,variance,varianceEpsilon,scale,offset){if(varianceEpsilon===void 0){varianceEpsilon=.001}util.assert(x.rank===2,"Error in batchNormalization3D: x must be rank 3 but got rank "+(x.rank+"."));util.assert(mean.rank===2||mean.rank===1,"Error in batchNormalization2D: mean must be rank 2 or rank 1 but "+("got rank "+mean.rank+"."));util.assert(variance.rank===2||variance.rank===1,"Error in batchNormalization2D: variance must be rank 2 or rank 1 "+("but got rank "+variance.rank+"."));if(scale!=null){util.assert(scale.rank===2||scale.rank===1,"Error in batchNormalization2D: scale must be rank 2 or rank 1 "+("but got rank "+scale.rank+"."))}if(offset!=null){util.assert(offset.rank===2||offset.rank===1,"Error in batchNormalization2D: offset must be rank 2 or rank 1 "+("but got rank "+offset.rank+"."))}return this.backendEngine.executeKernel("BatchNorm2D",{inputs:{x:x,mean:mean,variance:variance,scale:scale,offset:offset},args:{varianceEpsilon:varianceEpsilon}})};NDArrayMath.prototype.batchNormalization3D=function(x,mean,variance,varianceEpsilon,scale,offset){if(varianceEpsilon===void 0){varianceEpsilon=.001}util.assert(x.rank===3,"Error in batchNormalization3D: x must be rank 3 but got rank "+(x.rank+"."));util.assert(mean.rank===3||mean.rank===1,"Error in batchNormalization3D: mean must be rank 3 or rank 1 but "+("got rank "+mean.rank+"."));util.assert(variance.rank===3||variance.rank===1,"Error in batchNormalization3D: variance must be rank 3 or rank 1 "+("but got rank "+variance.rank+"."));if(scale!=null){util.assert(scale.rank===3||scale.rank===1,"Error in batchNormalization3D: scale must be rank 3 or rank 1 "+("but got rank "+scale.rank+"."))}if(offset!=null){util.assert(offset.rank===3||offset.rank===1,"Error in batchNormalization3D: offset must be rank 3 or rank 1 "+("but got rank "+offset.rank+"."))}return this.backendEngine.executeKernel("BatchNorm3D",{inputs:{x:x,mean:mean,variance:variance,scale:scale,offset:offset},args:{varianceEpsilon:varianceEpsilon}})};NDArrayMath.prototype.batchNormalization4D=function(x,mean,variance,varianceEpsilon,scale,offset){if(varianceEpsilon===void 0){varianceEpsilon=.001}util.assert(x.rank===4,"Error in batchNormalization4D: x must be rank 4 but got rank "+(x.rank+"."));util.assert(mean.rank===4||mean.rank===1,"Error in batchNormalization4D: mean must be rank 4 or rank 1 but "+("got rank "+mean.rank+"."));util.assert(variance.rank===4||variance.rank===1,"Error in batchNormalization4D: variance must be rank 4 or rank 1 "+("but got rank "+variance.rank+"."));if(scale!=null){util.assert(scale.rank===4||scale.rank===1,"Error in batchNormalization4D: scale must be rank 4 or rank 1 "+("but got rank "+scale.rank+"."))}if(offset!=null){util.assert(offset.rank===4||offset.rank===1,"Error in batchNormalization4D: offset must be rank 4 or rank 1 "+("but got rank "+offset.rank+"."))}return this.backendEngine.executeKernel("BatchNorm4D",{inputs:{x:x,mean:mean,variance:variance,scale:scale,offset:offset},args:{varianceEpsilon:varianceEpsilon}})};NDArrayMath.prototype.multiRNNCell=function(lstmCells,data,c,h){var res=this.scope(function(){var input=data;var newStates=[];for(var i=0;i<lstmCells.length;i++){var output=lstmCells[i](input,c[i],h[i]);newStates.push(output[0]);newStates.push(output[1]);input=output[1]}return newStates});var newC=[];var newH=[];for(var i=0;i<res.length;i+=2){newC.push(res[i]);newH.push(res[i+1])}return[newC,newH]};NDArrayMath.prototype.basicLSTMCell=function(forgetBias,lstmKernel,lstmBias,data,c,h){var _this=this;var res=this.scope(function(){var combined=_this.concat2D(data,h,1);var weighted=_this.matMul(combined,lstmKernel);var res=_this.add(weighted,lstmBias);var batchSize=res.shape[0];var sliceCols=res.shape[1]/4;var sliceSize=[batchSize,sliceCols];var i=_this.slice2D(res,[0,0],sliceSize);var j=_this.slice2D(res,[0,sliceCols],sliceSize);var f=_this.slice2D(res,[0,sliceCols*2],sliceSize);var o=_this.slice2D(res,[0,sliceCols*3],sliceSize);var newC=_this.addStrict(_this.multiplyStrict(c,_this.sigmoid(_this.scalarPlusArray(forgetBias,f))),_this.multiplyStrict(_this.sigmoid(i),_this.tanh(j)));var newH=_this.multiplyStrict(_this.tanh(newC),_this.sigmoid(o));return[newC,newH]});return[res[0],res[1]]};NDArrayMath.prototype.multinomial=function(probabilities,numSamples,seed){var _this=this;var numOutcomes=probabilities.size;if(numOutcomes<2){throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+(numOutcomes+"."))}if(probabilities.rank>2){throw new Error("Rank of probabilities must be 1 or 2, but is "+probabilities.rank)}seed=seed||Math.random();var origRank=probabilities.rank;if(probabilities.rank===1){probabilities=probabilities.as2D(1,-1)}return this.executeOp("multinomial",function(){var res=_this.backendEngine.executeKernel("Multinomial",{inputs:{probs:probabilities},args:{numSamples:numSamples,seed:seed}});if(origRank===1){return res.as1D()}return res})};NDArrayMath.prototype.oneHot=function(indices,depth,onValue,offValue){if(onValue===void 0){onValue=1}if(offValue===void 0){offValue=0}if(depth<2){throw new Error("Error in oneHot: depth must be >=2, but it is "+depth)}return this.backendEngine.executeKernel("OneHot",{inputs:{indices:indices},args:{depth:depth,onValue:onValue,offValue:offValue}})};NDArrayMath.prototype.moments=function(x,axis,keepDims){var _this=this;if(axis===void 0){axis=null}if(keepDims===void 0){keepDims=false}var axes=axis_util.parseAxisParam(axis,x.shape);var result=this.scope(function(){var mean=_this.mean(x,axes,keepDims);var keepDimsShape=mean.shape;if(!keepDims){keepDimsShape=axis_util.expandShapeToKeepDim(mean.shape,axes)}var devSquared=_this.square(_this.subtract(x.asType("float32"),mean.reshape(keepDimsShape)));var variance=_this.mean(devSquared,axes,keepDims);return{mean:mean,variance:variance}});return result};NDArrayMath.prototype.norm=function(x,ord,axis,keepDims){var _this=this;if(ord===void 0){ord="euclidean"}if(axis===void 0){axis=null}if(keepDims===void 0){keepDims=false}return this.scope(function(){var norm=_this.normInternal(x,ord,axis);var keepDimsShape=norm.shape;if(keepDims){var axes=axis_util.parseAxisParam(axis,x.shape);keepDimsShape=axis_util.expandShapeToKeepDim(norm.shape,axes)}return norm.reshape(keepDimsShape)})};NDArrayMath.prototype.normInternal=function(x,p,axis){if(axis===void 0){axis=null}if(x.rank===0){return this.abs(x)}if(x.rank!==1&&axis===null){return this.normInternal(x.reshape([-1]),p,axis)}if(x.rank===1||typeof axis==="number"||axis instanceof Array&&axis.length===1){if(p===1){return this.sum(this.abs(x),axis)}if(p===Infinity){return this.max(this.abs(x),axis)}if(p===-Infinity){return this.min(this.abs(x),axis)}if(p==="euclidean"||p===2){return this.sqrt(this.sum(this.pow(this.abs(x),ndarray_1.Scalar.new(2,"int32")),axis))}throw new Error("Error in norm: invalid ord value: "+p)}if(axis instanceof Array&&axis.length===2){if(p===1){return this.max(this.sum(this.abs(x),axis[0]),axis[1]-1)}if(p===Infinity){return this.max(this.sum(this.abs(x),axis[1]),axis[0])}if(p===-Infinity){return this.min(this.sum(this.abs(x),axis[1]),axis[0])}if(p==="fro"||p==="euclidean"){return this.sqrt(this.sum(this.pow(x,ndarray_1.Scalar.new(2,"int32")),axis))}throw new Error("Error in norm: invalid ord value: "+p)}throw new Error("Error in norm: invalid axis: "+axis)};NDArrayMath.prototype.vjp=function(f,x,dy){var keys=x instanceof ndarray_1.NDArray?null:Object.keys(x);var xs=util.flattenNameArrayMap(x,keys);var vjp=this.backendEngine.vjp(f,xs,dy);if(x instanceof ndarray_1.NDArray){return vjp[0]}else{return util.unflattenToNameArrayMap(keys,vjp)}};NDArrayMath.prototype.gradients=function(f,x){var keys=x instanceof ndarray_1.NDArray?null:Object.keys(x);var xs=util.flattenNameArrayMap(x,keys);var returnValue=false;var gradients=this.backendEngine.gradients(f,xs,returnValue);if(x instanceof ndarray_1.NDArray){return gradients[0]}else{return util.unflattenToNameArrayMap(keys,gradients)}};NDArrayMath.prototype.variableGradients=function(f){return this.valueAndGradients(f,this.registeredVariables)};NDArrayMath.prototype.valueAndGradients=function(f,x){var keys=x instanceof ndarray_1.NDArray?null:Object.keys(x);var xs=util.flattenNameArrayMap(x,keys);var returnValue=true;var valueAndGradients=this.backendEngine.gradients(f,xs,returnValue);var gradients;if(x instanceof ndarray_1.NDArray){gradients=valueAndGradients.gradients[0]}else{gradients=util.unflattenToNameArrayMap(keys,valueAndGradients.gradients)}return{value:valueAndGradients.value,gradients:gradients}};NDArrayMath.prototype.customGradient=function(f,inputs,name){return this.backendEngine.customGradient(f,inputs,name==null?"":name)};NDArrayMath.prototype.disposeData=function(dataId){if(!this.registeredArrays.has(dataId)){return}var refCount=this.registeredArrays.get(dataId);if(refCount<=1){this.registeredArrays.delete(dataId);this.backend.disposeData(dataId)}else{this.registeredArrays.set(dataId,refCount-1)}};return NDArrayMath}();exports.NDArrayMath=NDArrayMath;function parseTupleParam(param){return typeof param==="number"?[param,param]:param}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var MatrixOrientation;(function(MatrixOrientation){MatrixOrientation[MatrixOrientation["REGULAR"]=0]="REGULAR";MatrixOrientation[MatrixOrientation["TRANSPOSED"]=1]="TRANSPOSED"})(MatrixOrientation=exports.MatrixOrientation||(exports.MatrixOrientation={}))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function getBroadcastDims(inShape,outShape){var inRank=inShape.length;var dims=[];for(var i=0;i<inRank;i++){var dim=inRank-1-i;var a=inShape[dim]||1;var b=outShape[outShape.length-1-i]||1;if(b>1&&a===1){dims.unshift(dim)}}return dims}exports.getBroadcastDims=getBroadcastDims;function broadcastDimsAreOuter(dims){for(var i=0;i<dims.length;i++){if(dims[i]!==i){return false}}return true}exports.broadcastDimsAreOuter=broadcastDimsAreOuter;function assertAndGetBroadcastShape(shapeA,shapeB){var result=[];var errMsg="Operands could not be broadcast together with shapes "+(shapeA+" and "+shapeB+".");var l=Math.max(shapeA.length,shapeB.length);for(var i=0;i<l;i++){var a=shapeA[shapeA.length-i-1]||1;var b=shapeB[shapeB.length-i-1]||1;if(a>1&&b>1&&a!==b){throw Error(errMsg)}result.unshift(Math.max(a,b))}return result}exports.assertAndGetBroadcastShape=assertAndGetBroadcastShape},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util=__webpack_require__(4);function assertParams(aShape,bShape,axis){var aRank=aShape.length;var bRank=bShape.length;util.assert(aShape.length===bShape.length,"Error in concat"+aRank+"D: rank of x1 ("+aRank+") and x2 ("+bRank+") "+"must be the same.");util.assert(axis>=0&&axis<aRank,"Error in concat"+aRank+"D: axis must be "+("between 0 and "+(aRank-1)+"."));for(var i=0;i<aRank;i++){util.assert(i===axis||aShape[i]===bShape[i],"Error in concat"+aRank+"D: Shape ("+aShape+") does not match "+("("+bShape+") along the non-concatenated axis "+i+"."))}}exports.assertParams=assertParams;function computeOutShape(x1Shape,x2Shape,axis){util.assert(x1Shape.length===x2Shape.length,"x1 and x2 should have the same rank.");var outputShape=x1Shape.slice();outputShape[axis]+=x2Shape[axis];return outputShape}exports.computeOutShape=computeOutShape},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util=__webpack_require__(4);function computePool2DInfo(inShape,filterSize,strides,pad,dataFormat){if(dataFormat===void 0){dataFormat="channelsLast"}var _a=parseTupleParam(filterSize),filterHeight=_a[0],filterWidth=_a[1];var filterShape;if(dataFormat==="channelsLast"){filterShape=[filterHeight,filterWidth,inShape[3],inShape[3]]}else if(dataFormat==="channelsFirst"){filterShape=[filterHeight,filterWidth,inShape[1],inShape[1]]}else{throw new Error("Unknown dataFormat "+dataFormat)}return computeConv2DInfo(inShape,filterShape,strides,pad,false,dataFormat)}exports.computePool2DInfo=computePool2DInfo;function computeConv2DInfo(inShape,filterShape,strides,pad,depthwise,dataFormat){if(depthwise===void 0){depthwise=false}if(dataFormat===void 0){dataFormat="channelsLast"}var _a=[-1,-1,-1,-1],batchSize=_a[0],inHeight=_a[1],inWidth=_a[2],inChannels=_a[3];if(dataFormat==="channelsLast"){batchSize=inShape[0],inHeight=inShape[1],inWidth=inShape[2],inChannels=inShape[3]}else if(dataFormat==="channelsFirst"){batchSize=inShape[0],inChannels=inShape[1],inHeight=inShape[2],inWidth=inShape[3]}else{throw new Error("Unknown dataFormat "+dataFormat)}var filterHeight=filterShape[0],filterWidth=filterShape[1],filterChannels=filterShape[3];var _b=parseTupleParam(strides),strideHeight=_b[0],strideWidth=_b[1];var _c=getPadAndOutInfo(pad,inHeight,inWidth,strideHeight,strideWidth,filterHeight,filterWidth),padInfo=_c.padInfo,outHeight=_c.outHeight,outWidth=_c.outWidth;var outChannels=depthwise?filterChannels*inChannels:filterChannels;var outShape;if(dataFormat==="channelsFirst"){outShape=[batchSize,outChannels,outHeight,outWidth]}else if(dataFormat==="channelsLast"){outShape=[batchSize,outHeight,outWidth,outChannels]}return{batchSize:batchSize,dataFormat:dataFormat,inHeight:inHeight,inWidth:inWidth,inChannels:inChannels,outHeight:outHeight,outWidth:outWidth,outChannels:outChannels,padInfo:padInfo,strideHeight:strideHeight,strideWidth:strideWidth,filterHeight:filterHeight,filterWidth:filterWidth,inShape:inShape,outShape:outShape,filterShape:filterShape}}exports.computeConv2DInfo=computeConv2DInfo;function computeOutputShape3D(inShape,fieldSize,outDepth,stride,zeroPad){if(zeroPad==null){zeroPad=computeDefaultPad(inShape,fieldSize,stride)}var inputRows=inShape[0];var inputCols=inShape[1];var outputRows=(inputRows-fieldSize+2*zeroPad)/stride+1;util.assert(util.isInt(outputRows),"The output # of rows ("+outputRows+") must be an integer. Change the "+"stride and/or zero pad parameters");var outputCols=(inputCols-fieldSize+2*zeroPad)/stride+1;util.assert(util.isInt(outputCols),"The output # of columns ("+outputCols+") must be an integer. Change "+"the stride and/or zero pad parameters");return[outputRows,outputCols,outDepth]}exports.computeOutputShape3D=computeOutputShape3D;function computeDefaultPad(inputShape,fieldSize,stride){return Math.floor((inputShape[0]*(stride-1)-stride+fieldSize)/2)}exports.computeDefaultPad=computeDefaultPad;function computeWeightsShape4D(inputDepth,outputDepth,filterHeight,filterWidth){return[filterHeight,filterWidth,inputDepth,outputDepth]}exports.computeWeightsShape4D=computeWeightsShape4D;function computeDilatedRC(rc,origStride){var rowsDilated=(rc[0]-1)*origStride+1;var colsDilated=(rc[1]-1)*origStride+1;return[rowsDilated,colsDilated]}exports.computeDilatedRC=computeDilatedRC;function parseTupleParam(param){return typeof param==="number"?[param,param]:param}function getPadAndOutInfo(pad,inHeight,inWidth,strideHeight,strideWidth,filterHeight,filterWidth){var padInfo;var outHeight;var outWidth;if(typeof pad==="number"){padInfo={top:pad,bottom:pad,left:pad,right:pad};var outShape=computeOutputShape3D([inHeight,inWidth,1],filterHeight,1,strideHeight,pad);outHeight=outShape[0];outWidth=outShape[1]}else if(pad==="same"){outHeight=Math.ceil(inHeight/strideHeight);outWidth=Math.ceil(inWidth/strideWidth);var padAlongHeight=(outHeight-1)*strideHeight+filterHeight-inHeight;var padAlongWidth=(outWidth-1)*strideWidth+filterWidth-inWidth;var top_1=Math.floor(padAlongHeight/2);var bottom=padAlongHeight-top_1;var left=Math.floor(padAlongWidth/2);var right=padAlongWidth-left;padInfo={top:top_1,bottom:bottom,left:left,right:right}}else if(pad==="valid"){padInfo={top:0,bottom:0,left:0,right:0};outHeight=Math.ceil((inHeight-filterHeight+1)/strideHeight);outWidth=Math.ceil((inWidth-filterWidth+1)/strideWidth)}else{throw Error("Unknown padding parameter: "+pad)}return{padInfo:padInfo,outHeight:outHeight,outWidth:outWidth}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var TextureType;(function(TextureType){TextureType[TextureType["DEFAULT"]=0]="DEFAULT";TextureType[TextureType["RGBA_COLOR"]=1]="RGBA_COLOR"})(TextureType=exports.TextureType||(exports.TextureType={}));function getUnpackedMatrixTextureShapeWidthHeight(rows,columns){return[columns,rows]}exports.getUnpackedMatrixTextureShapeWidthHeight=getUnpackedMatrixTextureShapeWidthHeight;function getUnpackedArraySizeFromMatrixSize(matrixSize,channelsPerTexture){return matrixSize*channelsPerTexture}exports.getUnpackedArraySizeFromMatrixSize=getUnpackedArraySizeFromMatrixSize;function getColorMatrixTextureShapeWidthHeight(rows,columns){return[columns*4,rows]}exports.getColorMatrixTextureShapeWidthHeight=getColorMatrixTextureShapeWidthHeight;function getMatrixSizeFromUnpackedArraySize(unpackedSize,channelsPerTexture){if(unpackedSize%channelsPerTexture!==0){throw new Error("unpackedSize ("+unpackedSize+") must be a multiple of "+(""+channelsPerTexture))}return unpackedSize/channelsPerTexture}exports.getMatrixSizeFromUnpackedArraySize=getMatrixSizeFromUnpackedArraySize;function encodeMatrixToUnpackedArray(matrix,unpackedArray,channelsPerTexture){var requiredSize=getUnpackedArraySizeFromMatrixSize(matrix.length,channelsPerTexture);if(unpackedArray.length<requiredSize){throw new Error("unpackedArray length ("+unpackedArray.length+") must be >= "+(""+requiredSize))}var dst=0;for(var src=0;src<matrix.length;++src){unpackedArray[dst]=matrix[src];dst+=channelsPerTexture}}exports.encodeMatrixToUnpackedArray=encodeMatrixToUnpackedArray;exports.FLOAT_MAX=2e4;exports.FLOAT_MIN=-exports.FLOAT_MAX;var FLOAT_RANGE=(exports.FLOAT_MAX-exports.FLOAT_MIN)/255;var FLOAT_DELTAS=[1,1/255,1/(255*255),1/(255*255*255)];var FLOAT_POWERS=[1,255,255*255];exports.BYTE_NAN_VALUE=0;function encodeFloatArray(floatArray){var uintArray=new Uint8Array(floatArray.length*4);var _loop_1=function(i){var value=floatArray[i/4];if(isNaN(value)){uintArray[i]=exports.BYTE_NAN_VALUE;uintArray[i+1]=exports.BYTE_NAN_VALUE;uintArray[i+2]=exports.BYTE_NAN_VALUE;uintArray[i+3]=exports.BYTE_NAN_VALUE;return"continue"}var normalizedValue=(value-exports.FLOAT_MIN)/FLOAT_RANGE;var enc=FLOAT_POWERS.map(function(pow){return pow*normalizedValue});var buckets=enc.map(function(value){return Math.floor(value%1*255)});uintArray[i]=Math.floor(normalizedValue);uintArray[i+1]=buckets[0];uintArray[i+2]=buckets[1];uintArray[i+3]=buckets[2]};for(var i=0;i<uintArray.length;i+=4){_loop_1(i)}return uintArray}exports.encodeFloatArray=encodeFloatArray;function decodeToFloatArray(uintArray){var floatArray=new Float32Array(uintArray.length/4);var _loop_2=function(i){if(uintArray[i]===exports.BYTE_NAN_VALUE&&uintArray[i+1]===exports.BYTE_NAN_VALUE&&uintArray[i+2]===exports.BYTE_NAN_VALUE&&uintArray[i+3]===exports.BYTE_NAN_VALUE){floatArray[i/4]=NaN;return"continue"}var dot=0;FLOAT_DELTAS.forEach(function(delta,j){dot+=delta*uintArray[i+j]});var value=dot*FLOAT_RANGE+exports.FLOAT_MIN;floatArray[i/4]=value};for(var i=0;i<uintArray.length;i+=4){_loop_2(i)}return floatArray}exports.decodeToFloatArray=decodeToFloatArray;function decodeMatrixFromUnpackedArray(unpackedArray,matrix,channelsPerTexture){var requiredSize=getMatrixSizeFromUnpackedArraySize(unpackedArray.length,channelsPerTexture);if(matrix.length<requiredSize){throw new Error("matrix length ("+matrix.length+") must be >= "+requiredSize)}var dst=0;for(var src=0;src<unpackedArray.length;src+=channelsPerTexture){matrix[dst++]=unpackedArray[src]}}exports.decodeMatrixFromUnpackedArray=decodeMatrixFromUnpackedArray;function decodeMatrixFromUnpackedColorRGBAArray(unpackedArray,matrix,channels){var requiredSize=unpackedArray.length*channels/4;if(matrix.length<requiredSize){throw new Error("matrix length ("+matrix.length+") must be >= "+requiredSize)}var dst=0;for(var src=0;src<unpackedArray.length;src+=4){for(var c=0;c<channels;c++){matrix[dst++]=unpackedArray[src+c]}}}exports.decodeMatrixFromUnpackedColorRGBAArray=decodeMatrixFromUnpackedColorRGBAArray;function getPackedMatrixTextureShapeWidthHeight(rows,columns){return[Math.ceil(columns/2),Math.ceil(rows/2)]}exports.getPackedMatrixTextureShapeWidthHeight=getPackedMatrixTextureShapeWidthHeight;function getPackedRGBAArraySizeFromMatrixShape(rows,columns){var _a=getPackedMatrixTextureShapeWidthHeight(rows,columns),w=_a[0],h=_a[1];return w*h*4}exports.getPackedRGBAArraySizeFromMatrixShape=getPackedRGBAArraySizeFromMatrixShape;function encodeMatrixToPackedRGBA(matrix,rows,columns,packedRGBA){var requiredSize=getPackedRGBAArraySizeFromMatrixShape(rows,columns);if(packedRGBA.length<requiredSize){throw new Error("packedRGBA length ("+packedRGBA.length+") must be >= "+requiredSize)}var _a=getPackedMatrixTextureShapeWidthHeight(rows,columns),textureWidth=_a[0],textureHeight=_a[1];var oddWidth=columns%2===1;var oddHeight=rows%2===1;var widthInFullBlocks=Math.floor(columns/2);var heightInFullBlocks=Math.floor(rows/2);{var dstStride=oddWidth?4:0;var oneRow=columns;var dst=0;for(var blockY=0;blockY<heightInFullBlocks;++blockY){var matrixSrcRow=blockY*2*columns;for(var blockX=0;blockX<widthInFullBlocks;++blockX){var matrixSrcCol=blockX*2;var src=matrixSrcRow+matrixSrcCol;packedRGBA[dst]=matrix[src];packedRGBA[dst+1]=matrix[src+1];packedRGBA[dst+2]=matrix[src+oneRow];packedRGBA[dst+3]=matrix[src+oneRow+1];dst+=4}dst+=dstStride}}if(oddWidth){var src=columns-1;var dst=(textureWidth-1)*4;var srcStride=2*columns;var dstStride=textureWidth*4;for(var blockY=0;blockY<heightInFullBlocks;++blockY){packedRGBA[dst]=matrix[src];packedRGBA[dst+2]=matrix[src+columns];src+=srcStride;dst+=dstStride}}if(oddHeight){var src=(rows-1)*columns;var dst=(textureHeight-1)*textureWidth*4;for(var blockX=0;blockX<widthInFullBlocks;++blockX){packedRGBA[dst++]=matrix[src++];packedRGBA[dst++]=matrix[src++];dst+=2}}if(oddWidth&&oddHeight){packedRGBA[packedRGBA.length-4]=matrix[matrix.length-1]}return packedRGBA}exports.encodeMatrixToPackedRGBA=encodeMatrixToPackedRGBA;function decodeMatrixFromPackedRGBA(packedRGBA,rows,columns,matrix){var requiredSize=rows*columns;if(requiredSize<matrix.length){throw new Error("matrix length ("+matrix.length+") must be >= "+requiredSize)}var oddWidth=columns%2===1;var oddHeight=rows%2===1;var widthInFullBlocks=Math.floor(columns/2);var heightInFullBlocks=Math.floor(rows/2);var _a=getPackedMatrixTextureShapeWidthHeight(rows,columns),textureWidth=_a[0],textureHeight=_a[1];{var srcStride=oddWidth?4:0;var dstStride=columns+(oddWidth?1:0);var src=0;var dstRow1=0;var dstRow2=columns;for(var blockY=0;blockY<heightInFullBlocks;++blockY){for(var blockX=0;blockX<widthInFullBlocks;++blockX){matrix[dstRow1++]=packedRGBA[src++];matrix[dstRow1++]=packedRGBA[src++];matrix[dstRow2++]=packedRGBA[src++];matrix[dstRow2++]=packedRGBA[src++]}src+=srcStride;dstRow1+=dstStride;dstRow2+=dstStride}}if(oddWidth){var src=(textureWidth-1)*4;var dst=columns-1;var srcStride=textureWidth*4;var dstStride=2*columns;for(var blockY=0;blockY<heightInFullBlocks;++blockY){matrix[dst]=packedRGBA[src];matrix[dst+columns]=packedRGBA[src+2];src+=srcStride;dst+=dstStride}}if(oddHeight){var src=(textureHeight-1)*textureWidth*4;var dst=(rows-1)*columns;for(var blockX=0;blockX<widthInFullBlocks;++blockX){matrix[dst++]=packedRGBA[src++];matrix[dst++]=packedRGBA[src++];src+=2}}if(oddWidth&&oddHeight){matrix[matrix.length-1]=packedRGBA[packedRGBA.length-4]}return matrix}exports.decodeMatrixFromPackedRGBA=decodeMatrixFromPackedRGBA},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var MAX_TEXTURE_SIZE=null;var util=__webpack_require__(4);var environment_1=__webpack_require__(11);function createWebGLRenderingContext(attributes){var canvas=document.createElement("canvas");canvas.width=1;canvas.height=1;return createWebGLRenderingContextFromCanvas(canvas,attributes)}exports.createWebGLRenderingContext=createWebGLRenderingContext;function createWebGLRenderingContextFromCanvas(canvas,attributes){var gl;var webglVersion=environment_1.ENV.get("WEBGL_VERSION");if(webglVersion===2){gl=canvas.getContext("webgl2",attributes)}else if(webglVersion===1){gl=canvas.getContext("webgl",attributes)||canvas.getContext("experimental-webgl",attributes)}if(webglVersion===0||gl==null){throw new Error("This browser does not support WebGL.")}return gl}exports.createWebGLRenderingContextFromCanvas=createWebGLRenderingContextFromCanvas;function callAndCheck(gl,func){var returnValue=func();checkWebGLError(gl);return returnValue}exports.callAndCheck=callAndCheck;var webGLDebugErrorCheckingEnabled=false;function enableDebugWebGLErrorChecking(enabled){webGLDebugErrorCheckingEnabled=enabled}exports.enableDebugWebGLErrorChecking=enableDebugWebGLErrorChecking;function checkWebGLError(gl){if(webGLDebugErrorCheckingEnabled){var error=gl.getError();if(error!==gl.NO_ERROR){throw new Error("WebGL Error: "+getWebGLErrorMessage(gl,error))}}}exports.checkWebGLError=checkWebGLError;function getWebGLErrorMessage(gl,status){switch(status){case gl.NO_ERROR:return"NO_ERROR";case gl.INVALID_ENUM:return"INVALID_ENUM";case gl.INVALID_VALUE:return"INVALID_VALUE";case gl.INVALID_OPERATION:return"INVALID_OPERATION";case gl.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case gl.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case gl.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+status}}exports.getWebGLErrorMessage=getWebGLErrorMessage;function getExtensionOrThrow(gl,extensionName){return throwIfNull(gl,function(){return gl.getExtension(extensionName)},'Extension "'+extensionName+'" not supported on this browser.')}exports.getExtensionOrThrow=getExtensionOrThrow;function createVertexShader(gl,vertexShaderSource){var vertexShader=throwIfNull(gl,function(){return gl.createShader(gl.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");callAndCheck(gl,function(){return gl.shaderSource(vertexShader,vertexShaderSource)});callAndCheck(gl,function(){return gl.compileShader(vertexShader)});if(gl.getShaderParameter(vertexShader,gl.COMPILE_STATUS)===false){console.log(gl.getShaderInfoLog(vertexShader));throw new Error("Failed to compile vertex shader.")}return vertexShader}exports.createVertexShader=createVertexShader;function createFragmentShader(gl,fragmentShaderSource){var fragmentShader=throwIfNull(gl,function(){return gl.createShader(gl.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");callAndCheck(gl,function(){return gl.shaderSource(fragmentShader,fragmentShaderSource)});callAndCheck(gl,function(){return gl.compileShader(fragmentShader)});if(gl.getShaderParameter(fragmentShader,gl.COMPILE_STATUS)===false){logShaderSourceAndInfoLog(fragmentShaderSource,gl.getShaderInfoLog(fragmentShader));throw new Error("Failed to compile fragment shader.")}return fragmentShader}exports.createFragmentShader=createFragmentShader;var lineNumberRegex=/ERROR: [0-9]+:([0-9]+):/g;function logShaderSourceAndInfoLog(shaderSource,shaderInfoLog){var lineNumberRegexResult=lineNumberRegex.exec(shaderInfoLog);if(lineNumberRegexResult==null){console.log("Couldn't parse line number in error: "+shaderInfoLog);console.log(shaderSource);return}var lineNumber=+lineNumberRegexResult[1];var shaderLines=shaderSource.split("\n");var pad=shaderLines.length.toString().length+2;var linesWithLineNumbers=shaderLines.map(function(line,lineNumber){return util.rightPad((lineNumber+1).toString(),pad)+line});var maxLineLength=0;for(var i=0;i<linesWithLineNumbers.length;i++){maxLineLength=Math.max(linesWithLineNumbers[i].length,maxLineLength)}var beforeErrorLines=linesWithLineNumbers.slice(0,lineNumber-1);var errorLine=linesWithLineNumbers.slice(lineNumber-1,lineNumber);var afterErrorLines=linesWithLineNumbers.slice(lineNumber);console.log(beforeErrorLines.join("\n"));console.log(shaderInfoLog.split("\n")[0]);console.log("%c "+util.rightPad(errorLine[0],maxLineLength),"border:1px solid red; background-color:#e3d2d2; color:#a61717");console.log(afterErrorLines.join("\n"))}function createProgram(gl){return throwIfNull(gl,function(){return gl.createProgram()},"Unable to create WebGLProgram.")}exports.createProgram=createProgram;function linkProgram(gl,program){callAndCheck(gl,function(){return gl.linkProgram(program)});if(gl.getProgramParameter(program,gl.LINK_STATUS)===false){console.log(gl.getProgramInfoLog(program));throw new Error("Failed to link vertex and fragment shaders.")}}exports.linkProgram=linkProgram;function validateProgram(gl,program){callAndCheck(gl,function(){return gl.validateProgram(program)});if(gl.getProgramParameter(program,gl.VALIDATE_STATUS)===false){console.log(gl.getProgramInfoLog(program));throw new Error("Shader program validation failed.")}}exports.validateProgram=validateProgram;function createStaticVertexBuffer(gl,data){var buffer=throwIfNull(gl,function(){return gl.createBuffer()},"Unable to create WebGLBuffer");callAndCheck(gl,function(){return gl.bindBuffer(gl.ARRAY_BUFFER,buffer)});callAndCheck(gl,function(){return gl.bufferData(gl.ARRAY_BUFFER,data,gl.STATIC_DRAW)});return buffer}exports.createStaticVertexBuffer=createStaticVertexBuffer;function createStaticIndexBuffer(gl,data){var buffer=throwIfNull(gl,function(){return gl.createBuffer()},"Unable to create WebGLBuffer");callAndCheck(gl,function(){return gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,buffer)});callAndCheck(gl,function(){return gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,data,gl.STATIC_DRAW)});return buffer}exports.createStaticIndexBuffer=createStaticIndexBuffer;function queryMaxTextureSize(gl){if(MAX_TEXTURE_SIZE!=null){return MAX_TEXTURE_SIZE}MAX_TEXTURE_SIZE=callAndCheck(gl,function(){return gl.getParameter(gl.MAX_TEXTURE_SIZE)});return MAX_TEXTURE_SIZE}exports.queryMaxTextureSize=queryMaxTextureSize;function getChannelsPerTexture(){if(!environment_1.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")){return 4}if(environment_1.ENV.get("WEBGL_VERSION")===2){return 1}return 4}exports.getChannelsPerTexture=getChannelsPerTexture;function createTexture(gl){return throwIfNull(gl,function(){return gl.createTexture()},"Unable to create WebGLTexture.")}exports.createTexture=createTexture;function validateTextureSize(gl,width,height){var maxTextureSize=queryMaxTextureSize(gl);if(width<=0||height<=0){var requested="["+width+"x"+height+"]";throw new Error("Requested texture size "+requested+" is invalid.")}if(width>maxTextureSize||height>maxTextureSize){var requested="["+width+"x"+height+"]";var max="["+maxTextureSize+"x"+maxTextureSize+"]";throw new Error("Requested texture size "+requested+" greater than WebGL maximum on this browser / GPU "+max+".")}}exports.validateTextureSize=validateTextureSize;function createFramebuffer(gl){return throwIfNull(gl,function(){return gl.createFramebuffer()},"Unable to create WebGLFramebuffer.")}exports.createFramebuffer=createFramebuffer;function bindVertexBufferToProgramAttribute(gl,program,attribute,buffer,arrayEntriesPerItem,itemStrideInBytes,itemOffsetInBytes,attribLocations){var loc=-1;if(attribLocations!=null&&attribute in attribLocations){loc=attribLocations[attribute]}else{loc=gl.getAttribLocation(program,attribute)}if(loc===-1){return}callAndCheck(gl,function(){return gl.bindBuffer(gl.ARRAY_BUFFER,buffer)});callAndCheck(gl,function(){return gl.vertexAttribPointer(loc,arrayEntriesPerItem,gl.FLOAT,false,itemStrideInBytes,itemOffsetInBytes)});callAndCheck(gl,function(){return gl.enableVertexAttribArray(loc)})}exports.bindVertexBufferToProgramAttribute=bindVertexBufferToProgramAttribute;function bindTextureUnit(gl,texture,textureUnit){validateTextureUnit(gl,textureUnit);callAndCheck(gl,function(){return gl.activeTexture(gl.TEXTURE0+textureUnit)});callAndCheck(gl,function(){return gl.bindTexture(gl.TEXTURE_2D,texture)})}exports.bindTextureUnit=bindTextureUnit;function unbindTextureUnit(gl,textureUnit){validateTextureUnit(gl,textureUnit);callAndCheck(gl,function(){return gl.activeTexture(gl.TEXTURE0+textureUnit)});callAndCheck(gl,function(){return gl.bindTexture(gl.TEXTURE_2D,null)})}exports.unbindTextureUnit=unbindTextureUnit;function getProgramUniformLocationOrThrow(gl,program,uniformName){return throwIfNull(gl,function(){return gl.getUniformLocation(program,uniformName)},'uniform "'+uniformName+'" not present in program.')}exports.getProgramUniformLocationOrThrow=getProgramUniformLocationOrThrow;function bindTextureToProgramUniformSampler(gl,program,texture,uniformSamplerLocation,textureUnit){callAndCheck(gl,function(){return bindTextureUnit(gl,texture,textureUnit)});callAndCheck(gl,function(){return gl.uniform1i(uniformSamplerLocation,textureUnit)})}exports.bindTextureToProgramUniformSampler=bindTextureToProgramUniformSampler;function bindCanvasToFramebuffer(gl){callAndCheck(gl,function(){return gl.bindFramebuffer(gl.FRAMEBUFFER,null)});callAndCheck(gl,function(){return gl.viewport(0,0,gl.canvas.width,gl.canvas.height)});callAndCheck(gl,function(){return gl.scissor(0,0,gl.canvas.width,gl.canvas.height)})}exports.bindCanvasToFramebuffer=bindCanvasToFramebuffer;function bindColorTextureToFramebuffer(gl,texture,framebuffer){callAndCheck(gl,function(){return gl.bindFramebuffer(gl.FRAMEBUFFER,framebuffer)});callAndCheck(gl,function(){return gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,texture,0)})}exports.bindColorTextureToFramebuffer=bindColorTextureToFramebuffer;function unbindColorTextureFromFramebuffer(gl,framebuffer){callAndCheck(gl,function(){return gl.bindFramebuffer(gl.FRAMEBUFFER,framebuffer)});callAndCheck(gl,function(){return gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,null,0)})}exports.unbindColorTextureFromFramebuffer=unbindColorTextureFromFramebuffer;function validateFramebuffer(gl){var status=gl.checkFramebufferStatus(gl.FRAMEBUFFER);if(status!==gl.FRAMEBUFFER_COMPLETE){throw new Error("Error binding framebuffer: "+getFramebufferErrorMessage(gl,status))}}exports.validateFramebuffer=validateFramebuffer;function getFramebufferErrorMessage(gl,status){switch(status){case gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case gl.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+status}}exports.getFramebufferErrorMessage=getFramebufferErrorMessage;function throwIfNull(gl,returnTOrNull,failureMessage){var tOrNull=callAndCheck(gl,function(){return returnTOrNull()});if(tOrNull==null){throw new Error(failureMessage)}return tOrNull}function validateTextureUnit(gl,textureUnit){var maxTextureUnit=gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1;var glTextureUnit=textureUnit+gl.TEXTURE0;if(glTextureUnit<gl.TEXTURE0||glTextureUnit>maxTextureUnit){var textureUnitRange="[gl.TEXTURE0, gl.TEXTURE"+maxTextureUnit+"]";throw new Error("textureUnit must be in "+textureUnitRange+".")}}function getTextureShapeFromLogicalShape(gl,logShape){if(logShape.length!==2){var squeezeResult=util.squeezeShape(logShape);logShape=squeezeResult.newShape}var maxTexSize=queryMaxTextureSize(gl);var size=util.sizeFromShape(logShape);if(logShape.length<=1&&size<=maxTexSize){return[size,1]}else if(logShape.length===2&&logShape[0]<=maxTexSize&&logShape[1]<=maxTexSize){return logShape}else if(logShape.length===3&&logShape[0]<=maxTexSize&&logShape[1]*logShape[2]<=maxTexSize){return[logShape[0],logShape[1]*logShape[2]]}else if(logShape.length===4&&logShape[0]<=maxTexSize&&logShape[1]*logShape[2]*logShape[3]<=maxTexSize){return[logShape[0],logShape[1]*logShape[2]*logShape[3]]}else{return util.sizeToSquarishShape(size)}}exports.getTextureShapeFromLogicalShape=getTextureShapeFromLogicalShape},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var environment_1=__webpack_require__(11);var util=__webpack_require__(4);var broadcast_util=__webpack_require__(62);var tex_util=__webpack_require__(65);var tex_util_1=__webpack_require__(65);function makeShader(inputsInfo,outputShape,userCode,broadcast){var sampleSnippet=getSampleSnippet();var setOutputSnippet=getSetOutputSnippet();var inputPrefixSnippet=inputsInfo.map(function(x){return"uniform sampler2D "+x.name+";"}).join("\n");var inputSamplingSnippet=inputsInfo.map(function(x){return getInputSamplingSnippet(x,outputShape,broadcast)}).join("\n");var outTexShape=outputShape.texShape;var outputSamplingSnippet=getOutputSamplingSnippet(outputShape.logicalShape,outTexShape);var source=[SHADER_PREFIX,sampleSnippet,setOutputSnippet,inputPrefixSnippet,outputSamplingSnippet,inputSamplingSnippet,userCode].join("\n");return source}exports.makeShader=makeShader;function getSampleSnippet(){return environment_1.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?FLOAT_TEXTURE_SAMPLE_SNIPPET:UNSIGNED_BYTE_TEXTURE_SAMPLE_SNIPPET}function getSetOutputSnippet(){return environment_1.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?FLOAT_TEXTURE_SETOUTPUT_SNIPPET:UNSIGNED_BYTE_TEXTURE_SETOUTPUT_SNIPPET}function getSamplerFromInInfo(inInfo){var shape=inInfo.shapeInfo.logicalShape;switch(shape.length){case 0:return getSamplerScalar(inInfo);case 1:return getSampler1D(inInfo);case 2:return getSampler2D(inInfo);case 3:return getSampler3D(inInfo);case 4:return getSampler4D(inInfo);default:throw new Error(shape.length+"-D input sampling"+" is not yet supported")}}function getInputSamplingSnippet(inInfo,outShapeInfo,broadcast){var res=getSamplerFlat(inInfo);res+=getSamplerFromInInfo(inInfo);if(broadcast||util.arraysEqual(inInfo.shapeInfo.logicalShape,outShapeInfo.logicalShape)){res+=getSamplerAtOutputCoords(inInfo,outShapeInfo,broadcast)}return res}function getOutputSamplingSnippet(outShape,outTexShape){switch(outShape.length){case 0:return getOutputScalarCoords();case 1:return getOutput1DCoords(outShape,outTexShape);case 2:return getOutput2DCoords(outShape,outTexShape);case 3:return getOutput3DCoords(outShape,outTexShape);case 4:return getOutput4DCoords(outShape,outTexShape);default:throw new Error(outShape.length+"-D output sampling is not yet supported")}}var SAMPLE_1D_SNIPPET="\nvec2 UVfrom1D(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n";var SAMPLE_2D_SNIPPET="\nvec2 UVfrom2D(int texNumR, int texNumC, int numC, int row, int col) {\n  int index = row * numC + col;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n";var SAMPLE_3D_SNIPPET="\nvec2 UVfrom3D(int texNumR, int texNumC, int stride0,\n    int stride1, int row, int col, int depth) {\n  // Explicitly use integer operations as dot() only works on floats.\n  int index = row * stride0 + col * stride1 + depth;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n";var SAMPLE_4D_SNIPPET="\nvec2 UVfrom4D(int texNumR, int texNumC, int stride0,\n    int stride1, int stride2, int row, int col, int depth,\n    int depth2) {\n  // Explicitly use integer operations as dot() only works on floats.\n  int index = row * stride0 + col * stride1 + depth * stride2 + depth2;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n";var UNSIGNED_BYTE_TEXTURE_SAMPLE_SNIPPET="\n  uniform float NaN;\n\n  const vec4 floatDeltas = vec4(\n      1.0,\n      1.0 / 255.0,\n      1.0 / (255.0 * 255.0),\n      1.0 / (255.0 * 255.0 * 255.0)\n  );\n  const float minValue = "+tex_util.FLOAT_MIN+".0;\n  const float maxValue = "+tex_util.FLOAT_MAX+".0;\n  const float range = (maxValue - minValue) / 255.0;\n  const vec2 dotRange = vec2(1.0, range);\n\n  float sample(sampler2D texture, vec2 uv) {\n    vec4 sampleValue = texture2D(texture, uv);\n    if (all(equal(sampleValue, vec4("+tex_util.BYTE_NAN_VALUE+")))) {\n      return NaN;\n    }\n\n    vec4 encValue = floor(sampleValue * 255.0 + 0.5);\n    float decodedValue = dot(encValue, floatDeltas);\n    return dot(vec2(minValue, decodedValue), dotRange);\n  }\n";var UNSIGNED_BYTE_TEXTURE_SETOUTPUT_SNIPPET="\n  const vec4 floatPowers = vec4(\n    1.0,\n    255.0,\n    255.0 * 255.0,\n    255.0 * 255.0 * 255.0\n  );\n  const vec2 recipRange = vec2(1.0/range);\n  const vec2 recipRange255 = vec2(1.0/(maxValue - minValue));\n\n  void setOutput(float decodedValue) {\n    if (isNaN(decodedValue)) {\n      gl_FragColor = vec4("+tex_util.BYTE_NAN_VALUE+");\n      return;\n    }\n\n    float a = dot(vec2(decodedValue, -minValue), recipRange);\n    float b = fract(a) * 255.0;\n    float c = fract(b) * 255.0;\n    float d = fract(c) * 255.0;\n    gl_FragColor = floor(vec4(a, b, c, d)) / 255.0;\n\n    // TODO(dsmilkov): Version above gets better accuracy but probably slower\n    // than the version below. Benchmark to determine if the accuracy is worth\n    // the cost.\n\n    // float normValue = dot(vec2(decodedValue, -minValue), recipRange255);\n    // vec4 f = normValue * floatPowers;\n    // gl_FragColor = floor(fract(f) * 255.0) / 255.0;\n  }\n";var FLOAT_TEXTURE_SAMPLE_SNIPPET="\n  float sample(sampler2D texture, vec2 uv) {\n    return texture2D(texture, uv).r;\n  }\n";var FLOAT_TEXTURE_SETOUTPUT_SNIPPET="\n  void setOutput(float val) {\n    gl_FragColor = vec4(val, 0, 0, 0);\n  }\n";var SHADER_PREFIX="\n  precision highp float;\n  precision highp int;\n  varying vec2 resultUV;\n  const vec2 halfCR = vec2(0.5, 0.5);\n\n  bool isNaN(float val) {\n    float v1 = val * val;\n    float v2 = val * val;\n    return v1 == v2 ? false : true;\n  }\n\n  bool hasNaN(vec4 values) {\n    vec4 v1 = values * values;\n    vec4 v2 = values * values;\n    return any(notEqual(v1, v2));\n  }\n\n  float getNaN(vec4 values) {\n    return dot(vec4(1), values);\n  }\n\n  int round(float value) {\n    return int(floor(value + 0.5));\n  }\n\n  int imod(int x, int y) {\n    return x - y * (x / y);\n  }\n\n  const vec2 randomConst = vec2(\n    23.14069263277926, // e^pi (Gelfond's constant)\n     2.665144142690225 // 2^sqrt(2) (GelfondSchneider constant)\n  );\n\n  float random(float seed) {\n      return fract(cos(dot(resultUV * seed, randomConst)) * 12345.6789);\n  }\n\n  float sampleUVAndDepth(sampler2D texture, vec2 uv, int depth) {\n    float value;\n    if (depth == 0) {\n      value = texture2D(texture, uv).r;\n    } else if (depth == 1) {\n      value = texture2D(texture, uv).g;\n    } else if (depth == 2) {\n      value = texture2D(texture, uv).b;\n    } else if (depth == 3) {\n      value = texture2D(texture, uv).a;\n    }\n    return floor(value * 255.0 + 0.5);\n  }\n\n  "+SAMPLE_1D_SNIPPET+"\n  "+SAMPLE_2D_SNIPPET+"\n  "+SAMPLE_3D_SNIPPET+"\n  "+SAMPLE_4D_SNIPPET+"\n";function getOutputScalarCoords(){return"\n    int getOutputCoords() {\n      return 0;\n    }\n  "}function getOutput1DCoords(shape,texShape){if(texShape[0]===1){return"\n      int getOutputCoords() {\n        return int(resultUV.x * "+texShape[1]+".0);\n      }\n    "}if(texShape[1]===1){return"\n      int getOutputCoords() {\n        return int(resultUV.y * "+texShape[0]+".0);\n      }\n    "}return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+texShape[0]+", "+texShape[1]+"));\n      return resTexRC.x * "+texShape[1]+" + resTexRC.y;\n    }\n  "}function getOutput3DCoords(shape,texShape){var stride0=shape[1]*shape[2];var stride1=shape[2];return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+texShape[0]+", "+texShape[1]+"));\n      int index = resTexRC.x * "+texShape[1]+" + resTexRC.y;\n      int r = index / "+stride0+";\n      index -= r * "+stride0+";\n      int c = index / "+stride1+";\n      int d = index - c * "+stride1+";\n      return ivec3(r, c, d);\n    }\n  "}function getOutput4DCoords(shape,texShape){var stride2=shape[3];var stride1=shape[2]*stride2;var stride0=shape[1]*stride1;return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+texShape[0]+", "+texShape[1]+"));\n      int index = resTexRC.x * "+texShape[1]+" + resTexRC.y;\n\n      int r = index / "+stride0+";\n      index -= r * "+stride0+";\n\n      int c = index / "+stride1+";\n      index -= c * "+stride1+";\n\n      int d = index / "+stride2+";\n      int d2 = index - d * "+stride2+";\n\n      return ivec4(r, c, d, d2);\n    }\n  "}function getOutput2DCoords(shape,texShape){if(util.arraysEqual(shape,texShape)){return"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+texShape[0]+", "+texShape[1]+"));\n      }\n    "}if(shape[1]===1){return"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+texShape[0]+", "+texShape[1]+"));\n        int index = resTexRC.x * "+texShape[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    "}if(shape[0]===1){return"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+texShape[0]+", "+texShape[1]+"));\n        int index = resTexRC.x * "+texShape[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    "}return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+texShape[0]+", "+texShape[1]+"));\n      int index = resTexRC.x * "+texShape[1]+" + resTexRC.y;\n      int r = index / "+shape[1]+";\n      int c = index - r * "+shape[1]+";\n      return ivec2(r, c);\n    }\n  "}function getSamplerScalar(inputInfo){var texName=inputInfo.name;var funcName="get"+texName.charAt(0).toUpperCase()+texName.slice(1);return"\n    float "+funcName+"() {\n      return sample("+texName+", halfCR);\n    }\n  "}function getSampler1D(inputInfo){var texName=inputInfo.name;var funcName="get"+texName.charAt(0).toUpperCase()+texName.slice(1);return"\n    float "+funcName+"(int index) {\n      return "+funcName+"Flat(index);\n    }\n  "}function getSampler2D(inputInfo){var shape=inputInfo.shapeInfo.logicalShape;var texShape=inputInfo.shapeInfo.texShape;var texName=inputInfo.name;var funcName="get"+texName.charAt(0).toUpperCase()+texName.slice(1);var texNumR=texShape[0];var texNumC=texShape[1];if(util.arraysEqual(shape,texShape)){return"\n    float "+funcName+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+texNumC+".0, "+texNumR+".0);\n      return sample("+texName+", uv);\n    }\n  "}var _a=util.squeezeShape(shape),newShape=_a.newShape,keptDims=_a.keptDims;var squeezedShape=newShape;if(squeezedShape.length<shape.length){var newInputInfo=squeezeInputInfo(inputInfo,squeezedShape);var params=["row","col"];return"\n      "+getSamplerFromInInfo(newInputInfo)+"\n      float "+funcName+"(int row, int col) {\n        return "+funcName+"("+getSqueezedParams(params,keptDims)+");\n      }\n    "}if(texNumC===1){return"\n    float "+funcName+"(int row, int col) {\n      int index = row * "+shape[1]+" + col;\n      vec2 uv = vec2(0.5, (float(index) + 0.5) / "+texNumR+".0);\n      return sample("+texName+", uv);\n    }\n  "}if(texNumR===1){return"\n    float "+funcName+"(int row, int col) {\n      int index = row * "+shape[1]+" + col;\n      vec2 uv = vec2((float(index) + 0.5) / "+texNumC+".0, 0.5);\n      return sample("+texName+", uv);\n    }\n  "}return"\n  float "+funcName+"(int row, int col) {\n    vec2 uv = UVfrom2D("+texNumR+", "+texNumC+", "+shape[1]+", row, col);\n    return sample("+texName+", uv);\n  }\n"}function getSampler3D(inputInfo){var texShape=inputInfo.shapeInfo.texShape;var shape=inputInfo.shapeInfo.logicalShape;var texName=inputInfo.name;var funcName="get"+texName.charAt(0).toUpperCase()+texName.slice(1);var texNumR=texShape[0];var texNumC=texShape[1];var stride0=shape[1]*shape[2];var stride1=shape[2];var texType=inputInfo.shapeInfo.textureType;if(texType===tex_util_1.TextureType.DEFAULT){var _a=util.squeezeShape(shape),newShape=_a.newShape,keptDims=_a.keptDims;var squeezedShape=newShape;if(squeezedShape.length<shape.length){var newInputInfo=squeezeInputInfo(inputInfo,squeezedShape);var params=["row","col","depth"];return"\n        "+getSamplerFromInInfo(newInputInfo)+"\n        float "+funcName+"(int row, int col, int depth) {\n          return "+funcName+"("+getSqueezedParams(params,keptDims)+");\n        }\n      "}}if(texNumC===stride0){if(texType===tex_util_1.TextureType.DEFAULT){return"\n        float "+funcName+"(int row, int col, int depth) {\n          int texR = row;\n          int texC = col * "+stride1+" + depth;\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+texNumC+".0, "+texNumR+".0);\n          return sample("+texName+", uv);\n        }\n      "}else if(texType===tex_util_1.TextureType.RGBA_COLOR){return"\n        float "+funcName+"(int row, int col, int depth) {\n          vec2 uv = (vec2(col, row) + halfCR) /\n                     vec2("+texNumC+".0, "+texNumR+".0);\n          return sampleUVAndDepth("+texName+", uv, depth);\n        }\n      "}else{throw new Error("Unknown TextureType "+texType+".")}}if(texNumC===stride1&&texType===tex_util_1.TextureType.DEFAULT){return"\n    float "+funcName+"(int row, int col, int depth) {\n      int texR = row * "+shape[1]+" + col;\n      int texC = depth;\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+texNumC+".0, "+texNumR+".0);\n      return sample("+texName+", uv);\n    }\n  "}if(texType===tex_util_1.TextureType.DEFAULT){return"\n      float "+funcName+"(int row, int col, int depth) {\n        vec2 uv = UVfrom3D(\n            "+texNumR+", "+texNumC+", "+stride0+", "+stride1+", row, col, depth);\n        return sample("+texName+", uv);\n      }\n  "}else if(texType===tex_util_1.TextureType.RGBA_COLOR){return"\n      float "+funcName+"(int row, int col, int depth) {\n        vec2 uv = UVfrom2D("+texNumR+", "+texNumC+", "+shape[1]+", row, col);\n        return sampleUVAndDepth("+texName+", uv, depth);\n      }\n    "}else{throw new Error("Unknown TextureType "+texType+".")}}function getSampler4D(inputInfo){var shape=inputInfo.shapeInfo.logicalShape;var texShape=inputInfo.shapeInfo.texShape;var texName=inputInfo.name;var funcName="get"+texName.charAt(0).toUpperCase()+texName.slice(1);var texNumR=texShape[0];var texNumC=texShape[1];var stride2=shape[3];var stride1=shape[2]*stride2;var stride0=shape[1]*stride1;var _a=util.squeezeShape(shape),newShape=_a.newShape,keptDims=_a.keptDims;if(newShape.length<shape.length){var newInputInfo=squeezeInputInfo(inputInfo,newShape);var params=["row","col","depth","depth2"];return"\n      "+getSamplerFromInInfo(newInputInfo)+"\n      float "+funcName+"(int row, int col, int depth, int depth2) {\n        return "+funcName+"("+getSqueezedParams(params,keptDims)+");\n      }\n    "}if(texNumC===stride0){return"\n      float "+funcName+"(int row, int col, int depth, int depth2) {\n        int texR = row;\n        int texC = col * "+stride1+" + depth * "+stride2+" + depth2;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+texNumC+".0, "+texNumR+".0);\n        return sample("+texName+", uv);\n      }\n    "}if(texNumC===stride2){return"\n      float "+funcName+"(int row, int col, int depth, int depth2) {\n        int texR = row * "+shape[1]*shape[2]+" + col * "+shape[2]+" + depth;\n        int texC = depth2;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+texNumC+".0, "+texNumR+".0);\n        return sample("+texName+", uv);\n      }\n    "}return"\n    float "+funcName+"(int row, int col, int depth, int depth2) {\n      vec2 uv = UVfrom4D("+texNumR+", "+texNumC+", "+stride0+", "+stride1+",\n          "+stride2+", row, col, depth, depth2);\n      return sample("+texName+", uv);\n    }\n  "}function getSamplerFlat(inputInfo){var texName=inputInfo.name;var texShape=inputInfo.shapeInfo.texShape;var funcName="get"+texName.charAt(0).toUpperCase()+texName.slice(1)+"Flat";var tNumR=texShape[0];var tNumC=texShape[1];if(tNumC===1&&tNumR===1){return"\n      float "+funcName+"(int index) {\n        return sample("+texName+", halfCR);\n      }\n    "}if(tNumC===1){return"\n      float "+funcName+"(int index) {\n        vec2 uv = vec2(0.5, (float(index) + 0.5) / "+tNumR+".0);\n        return sample("+texName+", uv);\n      }\n    "}if(tNumR===1){return"\n      float "+funcName+"(int index) {\n        vec2 uv = vec2((float(index) + 0.5) / "+tNumC+".0, 0.5);\n        return sample("+texName+", uv);\n      }\n    "}return"\n    float "+funcName+"(int index) {\n      vec2 uv = UVfrom1D("+tNumR+", "+tNumC+", index);\n      return sample("+texName+", uv);\n    }\n  "}function getBroadcastOutputCoordsSampler(inputInfo,outShapeInfo,texFuncSnippet,funcName){var inRank=inputInfo.shapeInfo.logicalShape.length;var outRank=outShapeInfo.logicalShape.length;var type="int";if(outRank===2){type="ivec2"}else if(outRank===3){type="ivec3"}else if(outRank===4){type="ivec4"}var broadcastDims=broadcast_util.getBroadcastDims(inputInfo.shapeInfo.logicalShape,outShapeInfo.logicalShape);var rankDiff=outRank-inRank;var coordsSnippet;if(inRank===0){coordsSnippet=""}else if(outRank<2&&broadcastDims.length>=1){coordsSnippet="coords = 0;"}else{coordsSnippet=broadcastDims.map(function(d){return"coords["+(d+rankDiff)+"] = 0;"}).join("\n")}var unpackedCoordsSnippet="";if(outRank<2&&inRank>0){unpackedCoordsSnippet="coords"}else{unpackedCoordsSnippet=inputInfo.shapeInfo.logicalShape.map(function(s,i){return"coords["+(i+rankDiff)+"]"}).join(", ")}return"\n    float "+funcName+"() {\n      "+type+" coords = getOutputCoords();\n      "+coordsSnippet+"\n      return get"+texFuncSnippet+"("+unpackedCoordsSnippet+");\n    }\n  "}function getSamplerAtOutputCoords(inputInfo,outShapeInfo,supportsBroadcasting){var inTexShape=inputInfo.shapeInfo.texShape;var texName=inputInfo.name;var isRGBAColorTexture=inputInfo.shapeInfo.textureType===tex_util_1.TextureType.RGBA_COLOR;var texFuncSnippet=texName.charAt(0).toUpperCase()+texName.slice(1);var funcName="get"+texFuncSnippet+"AtOutCoords";var broadcastDims=broadcast_util.getBroadcastDims(inputInfo.shapeInfo.logicalShape,outShapeInfo.logicalShape);var inRank=inputInfo.shapeInfo.logicalShape.length;var outRank=outShapeInfo.logicalShape.length;var doBroadcast=supportsBroadcasting&&(outRank>inRank||broadcastDims.length>0);var broadcastOverOuter=broadcast_util.broadcastDimsAreOuter(broadcastDims);if(doBroadcast&&!broadcastOverOuter){return getBroadcastOutputCoordsSampler(inputInfo,outShapeInfo,texFuncSnippet,funcName)}var outTexShape=outShapeInfo.texShape;if(util.arraysEqual(inTexShape,outTexShape)&&!isRGBAColorTexture){return"\n      float "+funcName+"() {\n        return sample("+texName+", resultUV);\n      }\n    "}var inTexExpandedShape=isRGBAColorTexture?[inTexShape[0],inTexShape[1]*inputInfo.shapeInfo.logicalShape[2]]:inTexShape;var sampleSnippet="return sample("+texName+", uv);";var rgbaColorSnippet="";if(isRGBAColorTexture){rgbaColorSnippet="\n      int col = texC / "+inputInfo.shapeInfo.logicalShape[2]+";\n      int texD = texC - col * "+inputInfo.shapeInfo.logicalShape[2]+";\n      texC = col;\n    ";sampleSnippet="return sampleUVAndDepth("+texName+", uv, texD);"}var inSize=util.sizeFromShape(inTexExpandedShape);var broadcastSnippet="";if(doBroadcast&&broadcastOverOuter){broadcastSnippet="\n        int mainPart = index / "+inSize+";\n        index -= mainPart * "+inSize+";\n      "}return"\n    float "+funcName+"() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+outTexShape[0]+", "+outTexShape[1]+"));\n      int index = resTexRC.x * "+outTexShape[1]+" + resTexRC.y;\n      "+broadcastSnippet+"\n      int texR = index / "+inTexExpandedShape[1]+";\n      int texC = index - texR * "+inTexExpandedShape[1]+";\n\n      "+rgbaColorSnippet+"\n\n      vec2 uv = (vec2(texC, texR) + halfCR) /\n                 vec2("+inTexShape[1]+".0, "+inTexShape[0]+".0);\n\n      "+sampleSnippet+"\n    }\n  "}function getCoordsDataType(rank){if(rank===1){return"int"}else if(rank===2){return"ivec2"}else if(rank===3){return"ivec3"}else if(rank===4){return"ivec4"}else{throw Error("GPU for rank "+rank+" is not yet supported")}}exports.getCoordsDataType=getCoordsDataType;function squeezeInputInfo(inInfo,squeezedShape){var newInputInfo=JSON.parse(JSON.stringify(inInfo));newInputInfo.shapeInfo.logicalShape=squeezedShape;return newInputInfo}function getSqueezedParams(params,keptDims){return keptDims.map(function(d){return params[d]}).join(", ")}},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var initializers_1=__webpack_require__(156);var concat_util=__webpack_require__(63);var conv_util=__webpack_require__(64);var ndarray_1=__webpack_require__(3);var util=__webpack_require__(4);var GraphLayers=function(){function GraphLayers(g){this.g=g}GraphLayers.prototype.dense=function(name,x,units,activation,useBias,kernelInitializer,biasInitializer){if(activation===void 0){activation=null}if(useBias===void 0){useBias=true}if(kernelInitializer===void 0){kernelInitializer=new initializers_1.VarianceScalingInitializer}if(biasInitializer===void 0){biasInitializer=new initializers_1.ZerosInitializer}var weights=this.g.variable(name+"-weights",kernelInitializer.initialize([x.shape[0],units],x.shape[0],units));var out=this.g.matmul(x,weights);if(useBias){var bias=this.g.variable(name+"-bias",biasInitializer.initialize([units],x.shape[0],units));out=this.g.add(out,bias)}if(activation!=null){out=activation(out)}return out};return GraphLayers}();exports.GraphLayers=GraphLayers;var Graph=function(){function Graph(){this.nodes=[];this.layers=new GraphLayers(this)}Graph.prototype.variable=function(name,data){return this.addNodeAndReturnOutput(new VariableNode(this,name,data))};Graph.prototype.placeholder=function(name,shape){return this.addNodeAndReturnOutput(new PlaceholderNode(this,name,shape))};Graph.prototype.constant=function(value){var finalValue;if(typeof value==="number"){finalValue=ndarray_1.Scalar.new(value)}else if(value instanceof ndarray_1.NDArray){finalValue=value}else if(value instanceof Array){var flatValues=util.flatten(value);var vals=new Float32Array(flatValues);finalValue=ndarray_1.NDArray.make(util.inferShape(value),{values:vals})}else{throw new Error("unimplemented constant type.")}return this.addNodeAndReturnOutput(new ConstantNode(this,finalValue))};Graph.prototype.reshape=function(x,shape){return this.addNodeAndReturnOutput(new ReshapeNode(this,"Reshape",x,shape))};Graph.prototype.fusedLinearCombination=function(x1,x2,c1,c2){return this.addNodeAndReturnOutput(new FusedLinearCombinationNode(this,x1,x2,c1,c2))};Graph.prototype.add=function(x1,x2){return this.addNodeAndReturnOutput(new AddNode(this,x1,x2))};Graph.prototype.subtract=function(x1,x2){return this.addNodeAndReturnOutput(new SubtractNode(this,x1,x2))};Graph.prototype.multiply=function(x1,x2){return this.addNodeAndReturnOutput(new MultiplyNode(this,x1,x2))};Graph.prototype.divide=function(x1,x2){return this.addNodeAndReturnOutput(new DivideNode(this,x1,x2))};Graph.prototype.reduceSum=function(x){return this.addNodeAndReturnOutput(new ReduceSumNode(this,x))};Graph.prototype.concat3d=function(x1,x2,axis){return this.addNodeAndReturnOutput(new Concat3DNode(this,x1,x2,axis))};Graph.prototype.matmul=function(x1,x2){return this.addNodeAndReturnOutput(new MatMulNode(this,x1,x2))};Graph.prototype.conv2d=function(x,w,b,fieldSize,outputDepth,stride,zeroPad){if(stride===void 0){stride=1}return this.addNodeAndReturnOutput(new Convolution2DNode(this,x,w,b,fieldSize,outputDepth,stride,zeroPad))};Graph.prototype.maxPool=function(x,fieldSize,stride,zeroPad){if(stride===void 0){stride=1}return this.addNodeAndReturnOutput(new MaxPoolNode(this,x,fieldSize,stride,zeroPad))};Graph.prototype.exp=function(x){return this.addNodeAndReturnOutput(new ExpNode(this,x))};Graph.prototype.log=function(x){return this.addNodeAndReturnOutput(new LogNode(this,x))};Graph.prototype.relu=function(x){return this.addNodeAndReturnOutput(new ReLUNode(this,x))};Graph.prototype.leakyRelu=function(x,alpha){return this.addNodeAndReturnOutput(new LeakyReLUNode(this,x,alpha))};Graph.prototype.prelu=function(x,alpha){return this.addNodeAndReturnOutput(new PReLUNode(this,x,alpha))};Graph.prototype.elu=function(x){return this.addNodeAndReturnOutput(new EluNode(this,x))};Graph.prototype.tanh=function(x){return this.addNodeAndReturnOutput(new TanHNode(this,x))};Graph.prototype.sigmoid=function(x){return this.addNodeAndReturnOutput(new SigmoidNode(this,x))};Graph.prototype.square=function(x){return this.addNodeAndReturnOutput(new SquareNode(this,x))};Graph.prototype.softmax=function(x){return this.addNodeAndReturnOutput(new SoftmaxNode(this,x))};Graph.prototype.softmaxCrossEntropyCost=function(x,target){return this.addNodeAndReturnOutput(new SoftmaxCrossEntropyCostNode(this,x,target))};Graph.prototype.meanSquaredCost=function(label,prediction){return this.addNodeAndReturnOutput(new MeanSquaredCostNode(this,label,prediction))};Graph.prototype.argmax=function(x){return this.addNodeAndReturnOutput(new ArgMaxNode(this,x))};Graph.prototype.argmaxEquals=function(x1,x2){return this.addNodeAndReturnOutput(new ArgMaxEqualsNode(this,x1,x2))};Graph.prototype.addNodeAndReturnOutput=function(node){this.nodes.push(node);node.validate();return node.output};Graph.prototype.getNodes=function(){return this.nodes};return Graph}();exports.Graph=Graph;var Tensor=function(){function Tensor(shape){this.shape=shape;this.id=Tensor.nextID++}Tensor.nextID=0;return Tensor}();exports.Tensor=Tensor;var Node=function(){function Node(graph,name,inputs,output){this.graph=graph;this.name=name;this.inputs=inputs;this.output=output;this.id=Node.nextID++;output.node=this}Node.nextID=0;return Node}();exports.Node=Node;var VariableNode=function(_super){__extends(VariableNode,_super);function VariableNode(graph,name,data){var _this=_super.call(this,graph,name,{},new Tensor(data.shape))||this;_this.data=data;return _this}VariableNode.prototype.validate=function(){util.assert(this.data!=null,"Error adding variable op: Data for variable '"+this.name+"' is null or undefined")};return VariableNode}(Node);exports.VariableNode=VariableNode;var PlaceholderNode=function(_super){__extends(PlaceholderNode,_super);function PlaceholderNode(graph,name,shape){return _super.call(this,graph,name,{},new Tensor(shape))||this}PlaceholderNode.prototype.validate=function(){};return PlaceholderNode}(Node);exports.PlaceholderNode=PlaceholderNode;var ConstantNode=function(_super){__extends(ConstantNode,_super);function ConstantNode(graph,data){var _this=_super.call(this,graph,"Constant",{},new Tensor(data.shape))||this;_this.data=data;return _this}ConstantNode.prototype.validate=function(){util.assert(this.data!=null,"Error adding constant: data for placeholder '"+this.name+"' is null or undefined")};return ConstantNode}(Node);exports.ConstantNode=ConstantNode;var ReshapeNode=function(_super){__extends(ReshapeNode,_super);function ReshapeNode(graph,name,x,shape){var _this=_super.call(this,graph,name,{x:x},new Tensor(shape))||this;_this.name=name;_this.x=x;_this.shape=shape;return _this}ReshapeNode.prototype.validate=function(){var xSize=util.sizeFromShape(this.x.shape);var shapeSize=util.sizeFromShape(this.shape);util.assert(xSize===shapeSize,"Error making reshape operation: input to reshape '"+this.name+"'"+(" of shape ("+this.x.shape+") does not match size of ")+("requested shape "+this.shape+"."))};ReshapeNode.X="x";return ReshapeNode}(Node);exports.ReshapeNode=ReshapeNode;var FusedLinearCombinationNode=function(_super){__extends(FusedLinearCombinationNode,_super);function FusedLinearCombinationNode(graph,t1,t2,c1,c2){var _this=_super.call(this,graph,"Linear Combination",{t1:t1,t2:t2,c1:c1,c2:c2},new Tensor(t1.shape))||this;_this.t1=t1;_this.t2=t2;_this.c1=c1;_this.c2=c2;return _this}FusedLinearCombinationNode.prototype.validate=function(){util.assertShapesMatch(this.t1.shape,this.t2.shape);if(!util.isScalarShape(this.c1.shape)){throw new Error("Error adding fusedLinearCombination: c1 is not a scalar, got "+("shape: "+this.c1.shape))}if(!util.isScalarShape(this.c2.shape)){throw new Error("Error adding fusedLinearCombination: c2 is not a scalar, got "+("shape: "+this.c2.shape))}};FusedLinearCombinationNode.T1="t1";FusedLinearCombinationNode.T2="t2";FusedLinearCombinationNode.C1="c1";FusedLinearCombinationNode.C2="c2";return FusedLinearCombinationNode}(Node);exports.FusedLinearCombinationNode=FusedLinearCombinationNode;var AddNode=function(_super){__extends(AddNode,_super);function AddNode(graph,t1,t2){var _this=_super.call(this,graph,"Add",{t1:t1,t2:t2},new Tensor(util.sizeFromShape(t1.shape)===1?t2.shape:t1.shape.length<t2.shape.length?t2.shape:t1.shape))||this;_this.t1=t1;_this.t2=t2;return _this}AddNode.prototype.validate=function(){util.assert(util.sizeFromShape(this.t1.shape)===1||util.sizeFromShape(this.t2.shape)===1||util.arraysEqual(this.t1.shape,this.t2.shape)||this.t1.shape.length===2&&this.t2.shape.length===1&&this.t1.shape[1]===this.t2.shape[0]||this.t1.shape.length===1&&this.t2.shape.length===2&&this.t1.shape[0]===this.t2.shape[1],"Error adding add operation op: one of inputs must be scalar, "+("shapes "+this.t1.shape+" and "+this.t2.shape+" must match,")+"or one of them can be broadcasted (2D and 1D).")};AddNode.T1="t1";AddNode.T2="t2";return AddNode}(Node);exports.AddNode=AddNode;var SubtractNode=function(_super){__extends(SubtractNode,_super);function SubtractNode(graph,t1,t2){var _this=_super.call(this,graph,"Subtract",{t1:t1,t2:t2},new Tensor(util.sizeFromShape(t1.shape)===1?t2.shape:t1.shape))||this;_this.t1=t1;_this.t2=t2;return _this}SubtractNode.prototype.validate=function(){util.assert(util.sizeFromShape(this.t1.shape)===1||util.sizeFromShape(this.t2.shape)===1||util.arraysEqual(this.t1.shape,this.t2.shape),"Error adding subtract op: one of inputs must be scalar or the "+("shapes "+this.t1.shape+" and "+this.t2.shape+" must match."))};SubtractNode.T1="t1";SubtractNode.T2="t2";return SubtractNode}(Node);exports.SubtractNode=SubtractNode;var MultiplyNode=function(_super){__extends(MultiplyNode,_super);function MultiplyNode(graph,t1,t2){var _this=_super.call(this,graph,"Multiply",{t1:t1,t2:t2},new Tensor(util.sizeFromShape(t1.shape)===1?t2.shape:t1.shape))||this;_this.t1=t1;_this.t2=t2;return _this}MultiplyNode.prototype.validate=function(){util.assert(util.sizeFromShape(this.t1.shape)===1||util.sizeFromShape(this.t2.shape)===1||util.arraysEqual(this.t1.shape,this.t2.shape),"Error adding multiply op: one of inputs must be scalar or the "+("shapes "+this.t1.shape+" and "+this.t2.shape+" must match."))};MultiplyNode.T1="t1";MultiplyNode.T2="t2";return MultiplyNode}(Node);exports.MultiplyNode=MultiplyNode;var DivideNode=function(_super){__extends(DivideNode,_super);function DivideNode(graph,t1,t2){var _this=_super.call(this,graph,"Divide",{t1:t1,t2:t2},new Tensor(util.sizeFromShape(t1.shape)===1?t2.shape:t1.shape))||this;_this.t1=t1;_this.t2=t2;return _this}DivideNode.prototype.validate=function(){util.assert(util.sizeFromShape(this.t1.shape)===1||util.sizeFromShape(this.t2.shape)===1||util.arraysEqual(this.t1.shape,this.t2.shape),"Error adding divide op: one of inputs must be scalar or the "+("shapes "+this.t1.shape+" and "+this.t2.shape+" must match."))};DivideNode.T1="t1";DivideNode.T2="t2";return DivideNode}(Node);exports.DivideNode=DivideNode;var ReduceSumNode=function(_super){__extends(ReduceSumNode,_super);function ReduceSumNode(graph,x){return _super.call(this,graph,"ReduceSum",{x:x},new Tensor([]))||this}ReduceSumNode.prototype.validate=function(){};ReduceSumNode.X="x";return ReduceSumNode}(Node);exports.ReduceSumNode=ReduceSumNode;var Concat3DNode=function(_super){__extends(Concat3DNode,_super);function Concat3DNode(graph,x1,x2,axis){var _this=_super.call(this,graph,"Concat3D",{x1:x1,x2:x2},new Tensor(concat_util.computeOutShape(x1.shape,x2.shape,axis)))||this;_this.x1=x1;_this.x2=x2;_this.axis=axis;return _this}Concat3DNode.prototype.validate=function(){concat_util.assertParams(this.x1.shape,this.x2.shape,this.axis)};Concat3DNode.X1="x1";Concat3DNode.X2="x2";Concat3DNode.AXIS="axis";return Concat3DNode}(Node);exports.Concat3DNode=Concat3DNode;function getMatMulOutputShape(x1Shape,x2Shape){if(x1Shape.length===1&&x2Shape.length===1){return[1]}else if(x1Shape.length===1&&x2Shape.length===2){return[x2Shape[1]]}else if(x1Shape.length===2&&x2Shape.length===1){return[x1Shape[0]]}return[x1Shape[0],x2Shape[1]]}var MatMulNode=function(_super){__extends(MatMulNode,_super);function MatMulNode(graph,x1,x2){var _this=_super.call(this,graph,"MatMul",{x1:x1,x2:x2},new Tensor(getMatMulOutputShape(x1.shape,x2.shape)))||this;_this.x1=x1;_this.x2=x2;return _this}MatMulNode.prototype.validate=function(){if(this.x1.shape.length===2&&this.x2.shape.length===2){util.assert(this.x1.shape[1]===this.x2.shape[0],"Error adding matmul op: inner shapes of matrices with shapes "+(this.x1.shape+" and "+this.x2.shape+" must match."))}else if(this.x1.shape.length===2&&this.x2.shape.length===1){util.assert(this.x1.shape[1]===this.x2.shape[0],"Error adding matmul op: second dimension of matrix with shape "+this.x1.shape.toString()+(" must match size of vector with shape "+this.x2.shape+"."))}else if(this.x1.shape.length===1&&this.x2.shape.length===2){util.assert(this.x1.shape[0]===this.x2.shape[0],"Error adding matmul op: size of vector with shape "+this.x1.shape+" must match first dimension of matrix with "+("shape "+this.x2.shape+"."))}else{throw new Error("Error adding matmul op: inputs must be vectors or matrices.")}};MatMulNode.X1="x1";MatMulNode.X2="x2";return MatMulNode}(Node);exports.MatMulNode=MatMulNode;var Convolution2DNode=function(_super){__extends(Convolution2DNode,_super);function Convolution2DNode(graph,x,w,b,fieldSize,outputDepth,stride,zeroPad){if(stride===void 0){stride=1}var _this=_super.call(this,graph,"Convolution 2D",{x:x,w:w,b:b},new Tensor(conv_util.computeOutputShape3D(x.shape,fieldSize,outputDepth,stride,zeroPad)))||this;_this.x=x;_this.w=w;_this.b=b;_this.fieldSize=fieldSize;_this.outputDepth=outputDepth;_this.stride=stride;_this.zeroPad=zeroPad;return _this}Convolution2DNode.prototype.validate=function(){util.assert(this.x.shape.length===3,"Error adding conv2d op: input must be of rank 3, but got shape: "+(this.x.shape+"."));util.assert(this.w.shape.length===4,"Error adding conv2d op: weights must be of rank 4, but got shape: "+(this.w.shape+"."));util.assert(this.b.shape.length===1,"Error adding conv2d op: biases must be of rank 1, but got shape: "+(this.b.shape+"."));util.assert(this.x.shape[2]===this.w.shape[2],"Error adding conv2d op: depth of input ("+this.x.shape[2]+") "+("must match input depth for weights ("+this.w.shape[2]+")."))};Convolution2DNode.X="x";Convolution2DNode.W="w";Convolution2DNode.B="b";return Convolution2DNode}(Node);exports.Convolution2DNode=Convolution2DNode;var MaxPoolNode=function(_super){__extends(MaxPoolNode,_super);function MaxPoolNode(graph,x,fieldSize,stride,zeroPad){if(stride===void 0){stride=1}var _this=_super.call(this,graph,"Max pool",{x:x},new Tensor(conv_util.computeOutputShape3D(x.shape,fieldSize,x.shape[2],stride,zeroPad)))||this;_this.x=x;_this.fieldSize=fieldSize;_this.stride=stride;_this.zeroPad=zeroPad;return _this}MaxPoolNode.prototype.validate=function(){util.assert(this.x.shape.length===3,"Error adding maxPool op: input must be of rank 3, but got shape: "+(this.x.shape+"."))};MaxPoolNode.X="x";return MaxPoolNode}(Node);exports.MaxPoolNode=MaxPoolNode;var ReLUNode=function(_super){__extends(ReLUNode,_super);function ReLUNode(graph,x){return _super.call(this,graph,"ReLU",{x:x},new Tensor(x.shape))||this}ReLUNode.prototype.validate=function(){};ReLUNode.X="x";return ReLUNode}(Node);exports.ReLUNode=ReLUNode;var LeakyReLUNode=function(_super){__extends(LeakyReLUNode,_super);function LeakyReLUNode(graph,x,alpha){var _this=_super.call(this,graph,"LeakyReLU",{x:x},new Tensor(x.shape))||this;_this.alpha=alpha;return _this}LeakyReLUNode.prototype.validate=function(){};LeakyReLUNode.X="x";return LeakyReLUNode}(Node);exports.LeakyReLUNode=LeakyReLUNode;var PReLUNode=function(_super){__extends(PReLUNode,_super);function PReLUNode(graph,x,alpha){var _this=_super.call(this,graph,"PReLU",{x:x,alpha:alpha},new Tensor(x.shape))||this;_this.x=x;_this.alpha=alpha;return _this}PReLUNode.prototype.validate=function(){util.assert(util.arraysEqual(this.x.shape,this.alpha.shape),"Error adding pRelu op: the "+("shapes x: "+this.x.shape+" and alpha: "+this.alpha.shape+" must match."))};PReLUNode.X="x";PReLUNode.ALPHA="alpha";return PReLUNode}(Node);exports.PReLUNode=PReLUNode;var EluNode=function(_super){__extends(EluNode,_super);function EluNode(graph,x){return _super.call(this,graph,"Elu",{x:x},new Tensor(x.shape))||this}EluNode.prototype.validate=function(){};EluNode.X="x";return EluNode}(Node);exports.EluNode=EluNode;var ExpNode=function(_super){__extends(ExpNode,_super);function ExpNode(graph,x){return _super.call(this,graph,"Exp",{x:x},new Tensor(x.shape))||this}ExpNode.prototype.validate=function(){};ExpNode.X="x";return ExpNode}(Node);exports.ExpNode=ExpNode;var LogNode=function(_super){__extends(LogNode,_super);function LogNode(graph,x){return _super.call(this,graph,"Log",{x:x},new Tensor(x.shape))||this}LogNode.prototype.validate=function(){};LogNode.X="x";return LogNode}(Node);exports.LogNode=LogNode;var TanHNode=function(_super){__extends(TanHNode,_super);function TanHNode(graph,x){return _super.call(this,graph,"TanH",{x:x},new Tensor(x.shape))||this}TanHNode.prototype.validate=function(){};TanHNode.X="x";return TanHNode}(Node);exports.TanHNode=TanHNode;var SigmoidNode=function(_super){__extends(SigmoidNode,_super);function SigmoidNode(graph,x){return _super.call(this,graph,"Sigmoid",{x:x},new Tensor(x.shape))||this}SigmoidNode.prototype.validate=function(){};SigmoidNode.X="x";return SigmoidNode}(Node);exports.SigmoidNode=SigmoidNode;var SquareNode=function(_super){__extends(SquareNode,_super);function SquareNode(graph,x){return _super.call(this,graph,"Square",{x:x},new Tensor(x.shape))||this}SquareNode.prototype.validate=function(){};SquareNode.X="x";return SquareNode}(Node);exports.SquareNode=SquareNode;var SoftmaxCrossEntropyCostNode=function(_super){__extends(SoftmaxCrossEntropyCostNode,_super);function SoftmaxCrossEntropyCostNode(graph,x,target){var _this=_super.call(this,graph,"SoftmaxCrossEntropyCost",{x:x,target:target},new Tensor([]))||this;_this.x=x;_this.target=target;return _this}SoftmaxCrossEntropyCostNode.prototype.validate=function(){util.assert(util.arraysEqual(this.x.shape,this.target.shape),"Error adding softmaxCrossEntropyCost op: x shape ("+this.x.shape+") "+("must match target shape ("+this.target.shape+")."))};SoftmaxCrossEntropyCostNode.X="x";SoftmaxCrossEntropyCostNode.TARGET="target";return SoftmaxCrossEntropyCostNode}(Node);exports.SoftmaxCrossEntropyCostNode=SoftmaxCrossEntropyCostNode;var SoftmaxNode=function(_super){__extends(SoftmaxNode,_super);function SoftmaxNode(graph,x){var _this=_super.call(this,graph,"Softmax",{x:x},new Tensor(x.shape))||this;_this.x=x;return _this}SoftmaxNode.prototype.validate=function(){util.assert(this.x.shape.length===1,"The input to a softmax must be a 1-D tensor");util.assert(this.x.shape[0]>=2,"The input to a softmax must have at least 2 values")};SoftmaxNode.X="x";return SoftmaxNode}(Node);exports.SoftmaxNode=SoftmaxNode;var MeanSquaredCostNode=function(_super){__extends(MeanSquaredCostNode,_super);function MeanSquaredCostNode(graph,label,prediction){var _this=_super.call(this,graph,"Mean Squared Cost",{label:label,prediction:prediction},new Tensor([]))||this;_this.label=label;_this.prediction=prediction;return _this}MeanSquaredCostNode.prototype.validate=function(){util.assert(util.arraysEqual(this.label.shape,this.prediction.shape),"Error adding meanSquaredCost op: label shape ("+this.label.shape+") "+("must match prediction shape ("+this.prediction.shape+")."))};MeanSquaredCostNode.LABEL="label";MeanSquaredCostNode.PREDICTION="prediction";return MeanSquaredCostNode}(Node);exports.MeanSquaredCostNode=MeanSquaredCostNode;var ArgMaxNode=function(_super){__extends(ArgMaxNode,_super);function ArgMaxNode(graph,x){var _this=_super.call(this,graph,"ArgMax",{x:x},new Tensor([1]))||this;_this.x=x;return _this}ArgMaxNode.prototype.validate=function(){util.assert(util.sizeFromShape(this.x.shape)>0,"Error adding argmax op: input tensor must have at least one entry.")};ArgMaxNode.X="x";return ArgMaxNode}(Node);exports.ArgMaxNode=ArgMaxNode;var ArgMaxEqualsNode=function(_super){__extends(ArgMaxEqualsNode,_super);function ArgMaxEqualsNode(graph,x1,x2){var _this=_super.call(this,graph,"ArgMaxEquals",{x1:x1,x2:x2},new Tensor([1]))||this;_this.x1=x1;_this.x2=x2;return _this}ArgMaxEqualsNode.prototype.validate=function(){util.assert(util.arraysEqual(this.x1.shape,this.x2.shape),"Error adding ArgMaxEquals op: x1 shape ("+this.x1.shape+") "+("must match x2 shape ("+this.x2.shape+")."))};ArgMaxEqualsNode.X1="x1";ArgMaxEqualsNode.X2="x2";return ArgMaxEqualsNode}(Node);exports.ArgMaxEqualsNode=ArgMaxEqualsNode},function(module,exports){var g;g=function(){return this}();try{g=g||Function("return this")()||(1,eval)("this")}catch(e){if(typeof window==="object")g=window}module.exports=g},function(module,exports,__webpack_require__){var global=__webpack_require__(2);var SHARED="__core-js_shared__";var store=global[SHARED]||(global[SHARED]={});module.exports=function(key){return store[key]||(store[key]={})}},function(module,exports,__webpack_require__){var toIObject=__webpack_require__(20);var toLength=__webpack_require__(10);var toAbsoluteIndex=__webpack_require__(43);module.exports=function(IS_INCLUDES){return function($this,el,fromIndex){var O=toIObject($this);var length=toLength(O.length);var index=toAbsoluteIndex(fromIndex,length);var value;if(IS_INCLUDES&&el!=el)while(length>index){value=O[index++];if(value!=value)return true}else for(;length>index;index++)if(IS_INCLUDES||index in O){if(O[index]===el)return IS_INCLUDES||index||0}return!IS_INCLUDES&&-1}}},function(module,exports){exports.f=Object.getOwnPropertySymbols},function(module,exports,__webpack_require__){var cof=__webpack_require__(25);module.exports=Array.isArray||function isArray(arg){return cof(arg)=="Array"}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(6);var cof=__webpack_require__(25);var MATCH=__webpack_require__(7)("match");module.exports=function(it){var isRegExp;return isObject(it)&&((isRegExp=it[MATCH])!==undefined?!!isRegExp:cof(it)=="RegExp")}},function(module,exports,__webpack_require__){var ITERATOR=__webpack_require__(7)("iterator");var SAFE_CLOSING=false;try{var riter=[7][ITERATOR]();riter["return"]=function(){SAFE_CLOSING=true};Array.from(riter,function(){throw 2})}catch(e){}module.exports=function(exec,skipClosing){if(!skipClosing&&!SAFE_CLOSING)return false;var safe=false;try{var arr=[7];var iter=arr[ITERATOR]();iter.next=function(){return{done:safe=true}};arr[ITERATOR]=function(){return iter};exec(arr)}catch(e){}return safe}},function(module,exports,__webpack_require__){"use strict";var anObject=__webpack_require__(1);module.exports=function(){var that=anObject(this);var result="";if(that.global)result+="g";if(that.ignoreCase)result+="i";if(that.multiline)result+="m";if(that.unicode)result+="u";if(that.sticky)result+="y";return result}},function(module,exports,__webpack_require__){"use strict";var hide=__webpack_require__(16);var redefine=__webpack_require__(17);var fails=__webpack_require__(5);var defined=__webpack_require__(30);var wks=__webpack_require__(7);module.exports=function(KEY,length,exec){var SYMBOL=wks(KEY);var fns=exec(defined,SYMBOL,""[KEY]);var strfn=fns[0];var rxfn=fns[1];if(fails(function(){var O={};O[SYMBOL]=function(){return 7};return""[KEY](O)!=7})){redefine(String.prototype,KEY,strfn);hide(RegExp.prototype,SYMBOL,length==2?function(string,arg){return rxfn.call(string,this,arg)}:function(string){return rxfn.call(string,this)})}}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(1);var aFunction=__webpack_require__(14);var SPECIES=__webpack_require__(7)("species");module.exports=function(O,D){var C=anObject(O).constructor;var S;return C===undefined||(S=anObject(C)[SPECIES])==undefined?D:aFunction(S)}},function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(2);var $export=__webpack_require__(0);var redefine=__webpack_require__(17);var redefineAll=__webpack_require__(49);var meta=__webpack_require__(37);var forOf=__webpack_require__(48);var anInstance=__webpack_require__(47);var isObject=__webpack_require__(6);var fails=__webpack_require__(5);var $iterDetect=__webpack_require__(75);var setToStringTag=__webpack_require__(51);var inheritIfRequired=__webpack_require__(92);module.exports=function(NAME,wrapper,methods,common,IS_MAP,IS_WEAK){var Base=global[NAME];var C=Base;var ADDER=IS_MAP?"set":"add";var proto=C&&C.prototype;var O={};var fixMethod=function(KEY){var fn=proto[KEY];redefine(proto,KEY,KEY=="delete"?function(a){return IS_WEAK&&!isObject(a)?false:fn.call(this,a===0?0:a)}:KEY=="has"?function has(a){return IS_WEAK&&!isObject(a)?false:fn.call(this,a===0?0:a)}:KEY=="get"?function get(a){return IS_WEAK&&!isObject(a)?undefined:fn.call(this,a===0?0:a)}:KEY=="add"?function add(a){fn.call(this,a===0?0:a);return this}:function set(a,b){fn.call(this,a===0?0:a,b);return this})};if(typeof C!="function"||!(IS_WEAK||proto.forEach&&!fails(function(){(new C).entries().next()}))){C=common.getConstructor(wrapper,NAME,IS_MAP,ADDER);redefineAll(C.prototype,methods);meta.NEED=true}else{var instance=new C;var HASNT_CHAINING=instance[ADDER](IS_WEAK?{}:-0,1)!=instance;var THROWS_ON_PRIMITIVES=fails(function(){instance.has(1)});var ACCEPT_ITERABLES=$iterDetect(function(iter){new C(iter)});var BUGGY_ZERO=!IS_WEAK&&fails(function(){var $instance=new C;var index=5;while(index--)$instance[ADDER](index,index);return!$instance.has(-0)});if(!ACCEPT_ITERABLES){C=wrapper(function(target,iterable){anInstance(target,C,NAME);var that=inheritIfRequired(new Base,target,C);if(iterable!=undefined)forOf(iterable,IS_MAP,that[ADDER],that);return that});C.prototype=proto;proto.constructor=C}if(THROWS_ON_PRIMITIVES||BUGGY_ZERO){fixMethod("delete");fixMethod("has");IS_MAP&&fixMethod("get")}if(BUGGY_ZERO||HASNT_CHAINING)fixMethod(ADDER);if(IS_WEAK&&proto.clear)delete proto.clear}setToStringTag(C,NAME);O[NAME]=C;$export($export.G+$export.W+$export.F*(C!=Base),O);if(!IS_WEAK)common.setStrong(C,NAME,IS_MAP);return C}},function(module,exports,__webpack_require__){var global=__webpack_require__(2);var hide=__webpack_require__(16);var uid=__webpack_require__(40);var TYPED=uid("typed_array");var VIEW=uid("view");var ABV=!!(global.ArrayBuffer&&global.DataView);var CONSTR=ABV;var i=0;var l=9;var Typed;var TypedArrayConstructors="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");while(i<l){if(Typed=global[TypedArrayConstructors[i++]]){hide(Typed.prototype,TYPED,true);hide(Typed.prototype,VIEW,true)}else CONSTR=false}module.exports={ABV:ABV,CONSTR:CONSTR,TYPED:TYPED,VIEW:VIEW}},function(module,exports,__webpack_require__){"use strict";module.exports=__webpack_require__(41)||!__webpack_require__(5)(function(){var K=Math.random();__defineSetter__.call(null,K,function(){});delete __webpack_require__(2)[K]})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);module.exports=function(COLLECTION){$export($export.S,COLLECTION,{of:function of(){var length=arguments.length;var A=new Array(length);while(length--)A[length]=arguments[length];return new this(A)}})}},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var aFunction=__webpack_require__(14);var ctx=__webpack_require__(24);var forOf=__webpack_require__(48);module.exports=function(COLLECTION){$export($export.S,COLLECTION,{from:function from(source){var mapFn=arguments[1];var mapping,A,n,cb;aFunction(this);mapping=mapFn!==undefined;if(mapping)aFunction(mapFn);if(source==undefined)return new this;A=[];if(mapping){n=0;cb=ctx(mapFn,arguments[2],2);forOf(source,false,function(nextItem){A.push(cb(nextItem,n++))})}else{forOf(source,false,A.push,A)}return new this(A)}})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var SumTypesMap;(function(SumTypesMap){SumTypesMap["float32"]="float32";SumTypesMap["int32"]="int32";SumTypesMap["bool"]="int32"})(SumTypesMap=exports.SumTypesMap||(exports.SumTypesMap={}));var UpcastInt32AndMap;(function(UpcastInt32AndMap){UpcastInt32AndMap["float32"]="float32";UpcastInt32AndMap["int32"]="int32";UpcastInt32AndMap["bool"]="int32"})(UpcastInt32AndMap=exports.UpcastInt32AndMap||(exports.UpcastInt32AndMap={}));var UpcastBoolAndMap;(function(UpcastBoolAndMap){UpcastBoolAndMap["float32"]="float32";UpcastBoolAndMap["int32"]="int32";UpcastBoolAndMap["bool"]="bool"})(UpcastBoolAndMap=exports.UpcastBoolAndMap||(exports.UpcastBoolAndMap={}));var UpcastFloat32AndMap;(function(UpcastFloat32AndMap){UpcastFloat32AndMap["float32"]="float32";UpcastFloat32AndMap["int32"]="float32";UpcastFloat32AndMap["bool"]="float32"})(UpcastFloat32AndMap=exports.UpcastFloat32AndMap||(exports.UpcastFloat32AndMap={}));var upcastTypeMap={float32:UpcastFloat32AndMap,int32:UpcastInt32AndMap,bool:UpcastBoolAndMap};function upcastType(typeA,typeB){return upcastTypeMap[typeA][typeB]}exports.upcastType=upcastType},function(module,exports,__webpack_require__){var isObject=__webpack_require__(6);var document=__webpack_require__(2).document;var is=isObject(document)&&isObject(document.createElement);module.exports=function(it){return is?document.createElement(it):{}}},function(module,exports,__webpack_require__){var global=__webpack_require__(2);var core=__webpack_require__(28);var LIBRARY=__webpack_require__(41);var wksExt=__webpack_require__(115);var defineProperty=__webpack_require__(9).f;module.exports=function(name){var $Symbol=core.Symbol||(core.Symbol=LIBRARY?{}:global.Symbol||{});if(name.charAt(0)!="_"&&!(name in $Symbol))defineProperty($Symbol,name,{value:wksExt.f(name)})}},function(module,exports,__webpack_require__){var shared=__webpack_require__(70)("keys");var uid=__webpack_require__(40);module.exports=function(key){return shared[key]||(shared[key]=uid(key))}},function(module,exports){module.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(module,exports,__webpack_require__){var document=__webpack_require__(2).document;module.exports=document&&document.documentElement},function(module,exports,__webpack_require__){var isObject=__webpack_require__(6);var anObject=__webpack_require__(1);var check=function(O,proto){anObject(O);if(!isObject(proto)&&proto!==null)throw TypeError(proto+": can't set as prototype!")};module.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(test,buggy,set){try{set=__webpack_require__(24)(Function.call,__webpack_require__(21).f(Object.prototype,"__proto__").set,2);set(test,[]);buggy=!(test instanceof Array)}catch(e){buggy=true}return function setPrototypeOf(O,proto){check(O,proto);if(buggy)O.__proto__=proto;else set(O,proto);return O}}({},false):undefined),check:check}},function(module,exports){module.exports="\t\n\v\f\r "+"\u2028\u2029\ufeff"},function(module,exports,__webpack_require__){var isObject=__webpack_require__(6);var setPrototypeOf=__webpack_require__(90).set;module.exports=function(that,target,C){var S=target.constructor;var P;if(S!==C&&typeof S=="function"&&(P=S.prototype)!==C.prototype&&isObject(P)&&setPrototypeOf){setPrototypeOf(that,P)}return that}},function(module,exports,__webpack_require__){"use strict";var toInteger=__webpack_require__(31);var defined=__webpack_require__(30);module.exports=function repeat(count){var str=String(defined(this));var res="";var n=toInteger(count);if(n<0||n==Infinity)throw RangeError("Count can't be negative");for(;n>0;(n>>>=1)&&(str+=str))if(n&1)res+=str;return res}},function(module,exports){module.exports=Math.sign||function sign(x){return(x=+x)==0||x!=x?x:x<0?-1:1}},function(module,exports){var $expm1=Math.expm1;module.exports=!$expm1||$expm1(10)>22025.465794806718||$expm1(10)<22025.465794806718||$expm1(-2e-17)!=-2e-17?function expm1(x){return(x=+x)==0?x:x>-1e-6&&x<1e-6?x+x*x/2:Math.exp(x)-1}:$expm1},function(module,exports,__webpack_require__){var toInteger=__webpack_require__(31);var defined=__webpack_require__(30);module.exports=function(TO_STRING){return function(that,pos){var s=String(defined(that));var i=toInteger(pos);var l=s.length;var a,b;if(i<0||i>=l)return TO_STRING?"":undefined;a=s.charCodeAt(i);return a<55296||a>56319||i+1===l||(b=s.charCodeAt(i+1))<56320||b>57343?TO_STRING?s.charAt(i):a:TO_STRING?s.slice(i,i+2):(a-55296<<10)+(b-56320)+65536}}},function(module,exports,__webpack_require__){"use strict";var LIBRARY=__webpack_require__(41);var $export=__webpack_require__(0);var redefine=__webpack_require__(17);var hide=__webpack_require__(16);var has=__webpack_require__(15);var Iterators=__webpack_require__(53);var $iterCreate=__webpack_require__(98);var setToStringTag=__webpack_require__(51);var getPrototypeOf=__webpack_require__(22);var ITERATOR=__webpack_require__(7)("iterator");var BUGGY=!([].keys&&"next"in[].keys());var FF_ITERATOR="@@iterator";var KEYS="keys";var VALUES="values";var returnThis=function(){return this};module.exports=function(Base,NAME,Constructor,next,DEFAULT,IS_SET,FORCED){$iterCreate(Constructor,NAME,next);var getMethod=function(kind){if(!BUGGY&&kind in proto)return proto[kind];switch(kind){case KEYS:return function keys(){return new Constructor(this,kind)};case VALUES:return function values(){return new Constructor(this,kind)}}return function entries(){return new Constructor(this,kind)}};var TAG=NAME+" Iterator";var DEF_VALUES=DEFAULT==VALUES;var VALUES_BUG=false;var proto=Base.prototype;var $native=proto[ITERATOR]||proto[FF_ITERATOR]||DEFAULT&&proto[DEFAULT];var $default=!BUGGY&&$native||getMethod(DEFAULT);var $entries=DEFAULT?!DEF_VALUES?$default:getMethod("entries"):undefined;var $anyNative=NAME=="Array"?proto.entries||$native:$native;var methods,key,IteratorPrototype;if($anyNative){IteratorPrototype=getPrototypeOf($anyNative.call(new Base));if(IteratorPrototype!==Object.prototype&&IteratorPrototype.next){setToStringTag(IteratorPrototype,TAG,true);if(!LIBRARY&&!has(IteratorPrototype,ITERATOR))hide(IteratorPrototype,ITERATOR,returnThis)}}if(DEF_VALUES&&$native&&$native.name!==VALUES){VALUES_BUG=true;$default=function values(){return $native.call(this)}}if((!LIBRARY||FORCED)&&(BUGGY||VALUES_BUG||!proto[ITERATOR])){hide(proto,ITERATOR,$default)}Iterators[NAME]=$default;Iterators[TAG]=returnThis;if(DEFAULT){methods={values:DEF_VALUES?$default:getMethod(VALUES),keys:IS_SET?$default:getMethod(KEYS),entries:$entries};if(FORCED)for(key in methods){if(!(key in proto))redefine(proto,key,methods[key])}else $export($export.P+$export.F*(BUGGY||VALUES_BUG),NAME,methods)}return methods}},function(module,exports,__webpack_require__){"use strict";var create=__webpack_require__(44);var descriptor=__webpack_require__(39);var setToStringTag=__webpack_require__(51);var IteratorPrototype={};__webpack_require__(16)(IteratorPrototype,__webpack_require__(7)("iterator"),function(){return this});module.exports=function(Constructor,NAME,next){Constructor.prototype=create(IteratorPrototype,{next:descriptor(1,next)});setToStringTag(Constructor,NAME+" Iterator")}},function(module,exports,__webpack_require__){var isRegExp=__webpack_require__(74);var defined=__webpack_require__(30);module.exports=function(that,searchString,NAME){if(isRegExp(searchString))throw TypeError("String#"+NAME+" doesn't accept regex!");return String(defined(that))}},function(module,exports,__webpack_require__){var MATCH=__webpack_require__(7)("match");module.exports=function(KEY){var re=/./;try{"/./"[KEY](re)}catch(e){try{re[MATCH]=false;return!"/./"[KEY](re)}catch(f){}}return true}},function(module,exports,__webpack_require__){var Iterators=__webpack_require__(53);var ITERATOR=__webpack_require__(7)("iterator");var ArrayProto=Array.prototype;module.exports=function(it){return it!==undefined&&(Iterators.Array===it||ArrayProto[ITERATOR]===it)}},function(module,exports,__webpack_require__){"use strict";var $defineProperty=__webpack_require__(9);var createDesc=__webpack_require__(39);module.exports=function(object,index,value){if(index in object)$defineProperty.f(object,index,createDesc(0,value));else object[index]=value}},function(module,exports,__webpack_require__){var classof=__webpack_require__(59);var ITERATOR=__webpack_require__(7)("iterator");var Iterators=__webpack_require__(53);module.exports=__webpack_require__(28).getIteratorMethod=function(it){if(it!=undefined)return it[ITERATOR]||it["@@iterator"]||Iterators[classof(it)]}},function(module,exports,__webpack_require__){var speciesConstructor=__webpack_require__(255);module.exports=function(original,length){return new(speciesConstructor(original))(length)}},function(module,exports,__webpack_require__){"use strict";var toObject=__webpack_require__(12);var toAbsoluteIndex=__webpack_require__(43);var toLength=__webpack_require__(10);module.exports=function fill(value){var O=toObject(this);var length=toLength(O.length);var aLen=arguments.length;var index=toAbsoluteIndex(aLen>1?arguments[1]:undefined,length);var end=aLen>2?arguments[2]:undefined;var endPos=end===undefined?length:toAbsoluteIndex(end,length);while(endPos>index)O[index++]=value;return O}},function(module,exports,__webpack_require__){"use strict";var addToUnscopables=__webpack_require__(38);var step=__webpack_require__(131);var Iterators=__webpack_require__(53);var toIObject=__webpack_require__(20);module.exports=__webpack_require__(97)(Array,"Array",function(iterated,kind){this._t=toIObject(iterated);this._i=0;this._k=kind},function(){var O=this._t;var kind=this._k;var index=this._i++;if(!O||index>=O.length){this._t=undefined;return step(1)}if(kind=="keys")return step(0,index);if(kind=="values")return step(0,O[index]);return step(0,[index,O[index]])},"values");Iterators.Arguments=Iterators.Array;addToUnscopables("keys");addToUnscopables("values");addToUnscopables("entries")},function(module,exports,__webpack_require__){var ctx=__webpack_require__(24);var invoke=__webpack_require__(121);var html=__webpack_require__(89);var cel=__webpack_require__(85);var global=__webpack_require__(2);var process=global.process;var setTask=global.setImmediate;var clearTask=global.clearImmediate;var MessageChannel=global.MessageChannel;var Dispatch=global.Dispatch;var counter=0;var queue={};var ONREADYSTATECHANGE="onreadystatechange";var defer,channel,port;var run=function(){var id=+this;if(queue.hasOwnProperty(id)){var fn=queue[id];delete queue[id];fn()}};var listener=function(event){run.call(event.data)};if(!setTask||!clearTask){setTask=function setImmediate(fn){var args=[];var i=1;while(arguments.length>i)args.push(arguments[i++]);queue[++counter]=function(){invoke(typeof fn=="function"?fn:Function(fn),args)};defer(counter);return counter};clearTask=function clearImmediate(id){delete queue[id]};if(__webpack_require__(25)(process)=="process"){defer=function(id){process.nextTick(ctx(run,id,1))}}else if(Dispatch&&Dispatch.now){defer=function(id){Dispatch.now(ctx(run,id,1))}}else if(MessageChannel){channel=new MessageChannel;port=channel.port2;channel.port1.onmessage=listener;defer=ctx(port.postMessage,port,1)}else if(global.addEventListener&&typeof postMessage=="function"&&!global.importScripts){defer=function(id){global.postMessage(id+"","*")};global.addEventListener("message",listener,false)}else if(ONREADYSTATECHANGE in cel("script")){defer=function(id){html.appendChild(cel("script"))[ONREADYSTATECHANGE]=function(){html.removeChild(this);run.call(id)}}}else{defer=function(id){setTimeout(ctx(run,id,1),0)}}}module.exports={set:setTask,clear:clearTask}},function(module,exports,__webpack_require__){var global=__webpack_require__(2);var macrotask=__webpack_require__(107).set;var Observer=global.MutationObserver||global.WebKitMutationObserver;var process=global.process;var Promise=global.Promise;var isNode=__webpack_require__(25)(process)=="process";module.exports=function(){var head,last,notify;var flush=function(){var parent,fn;if(isNode&&(parent=process.domain))parent.exit();while(head){fn=head.fn;head=head.next;try{fn()}catch(e){if(head)notify();else last=undefined;throw e}}last=undefined;if(parent)parent.enter()};if(isNode){notify=function(){process.nextTick(flush)}}else if(Observer&&!(global.navigator&&global.navigator.standalone)){var toggle=true;var node=document.createTextNode("");new Observer(flush).observe(node,{characterData:true});notify=function(){node.data=toggle=!toggle}}else if(Promise&&Promise.resolve){var promise=Promise.resolve();notify=function(){promise.then(flush)}}else{notify=function(){macrotask.call(global,flush)}}return function(fn){var task={fn:fn,next:undefined};if(last)last.next=task;if(!head){head=task;notify()}last=task}}},function(module,exports,__webpack_require__){"use strict";var aFunction=__webpack_require__(14);function PromiseCapability(C){var resolve,reject;this.promise=new C(function($$resolve,$$reject){if(resolve!==undefined||reject!==undefined)throw TypeError("Bad Promise constructor");resolve=$$resolve;reject=$$reject});this.resolve=aFunction(resolve);this.reject=aFunction(reject)}module.exports.f=function(C){return new PromiseCapability(C)}},function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(2);var DESCRIPTORS=__webpack_require__(8);var LIBRARY=__webpack_require__(41);var $typed=__webpack_require__(80);var hide=__webpack_require__(16);var redefineAll=__webpack_require__(49);var fails=__webpack_require__(5);var anInstance=__webpack_require__(47);var toInteger=__webpack_require__(31);var toLength=__webpack_require__(10);var toIndex=__webpack_require__(140);var gOPN=__webpack_require__(45).f;var dP=__webpack_require__(9).f;var arrayFill=__webpack_require__(105);var setToStringTag=__webpack_require__(51);var ARRAY_BUFFER="ArrayBuffer";var DATA_VIEW="DataView";var PROTOTYPE="prototype";var WRONG_LENGTH="Wrong length!";var WRONG_INDEX="Wrong index!";var $ArrayBuffer=global[ARRAY_BUFFER];var $DataView=global[DATA_VIEW];var Math=global.Math;var RangeError=global.RangeError;var Infinity=global.Infinity;var BaseBuffer=$ArrayBuffer;var abs=Math.abs;var pow=Math.pow;var floor=Math.floor;var log=Math.log;var LN2=Math.LN2;var BUFFER="buffer";var BYTE_LENGTH="byteLength";var BYTE_OFFSET="byteOffset";var $BUFFER=DESCRIPTORS?"_b":BUFFER;var $LENGTH=DESCRIPTORS?"_l":BYTE_LENGTH;var $OFFSET=DESCRIPTORS?"_o":BYTE_OFFSET;function packIEEE754(value,mLen,nBytes){var buffer=new Array(nBytes);var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var rt=mLen===23?pow(2,-24)-pow(2,-77):0;var i=0;var s=value<0||value===0&&1/value<0?1:0;var e,m,c;value=abs(value);if(value!=value||value===Infinity){m=value!=value?1:0;e=eMax}else{e=floor(log(value)/LN2);if(value*(c=pow(2,-e))<1){e--;c*=2}if(e+eBias>=1){value+=rt/c}else{value+=rt*pow(2,1-eBias)}if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*pow(2,mLen);e=e+eBias}else{m=value*pow(2,eBias-1)*pow(2,mLen);e=0}}for(;mLen>=8;buffer[i++]=m&255,m/=256,mLen-=8);e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[i++]=e&255,e/=256,eLen-=8);buffer[--i]|=s*128;return buffer}function unpackIEEE754(buffer,mLen,nBytes){var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var nBits=eLen-7;var i=nBytes-1;var s=buffer[i--];var e=s&127;var m;s>>=7;for(;nBits>0;e=e*256+buffer[i],i--,nBits-=8);m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[i],i--,nBits-=8);if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:s?-Infinity:Infinity}else{m=m+pow(2,mLen);e=e-eBias}return(s?-1:1)*m*pow(2,e-mLen)}function unpackI32(bytes){return bytes[3]<<24|bytes[2]<<16|bytes[1]<<8|bytes[0]}function packI8(it){return[it&255]}function packI16(it){return[it&255,it>>8&255]}function packI32(it){return[it&255,it>>8&255,it>>16&255,it>>24&255]}function packF64(it){return packIEEE754(it,52,8)}function packF32(it){return packIEEE754(it,23,4)}function addGetter(C,key,internal){dP(C[PROTOTYPE],key,{get:function(){return this[internal]}})}function get(view,bytes,index,isLittleEndian){var numIndex=+index;var intIndex=toIndex(numIndex);if(intIndex+bytes>view[$LENGTH])throw RangeError(WRONG_INDEX);var store=view[$BUFFER]._b;var start=intIndex+view[$OFFSET];var pack=store.slice(start,start+bytes);return isLittleEndian?pack:pack.reverse()}function set(view,bytes,index,conversion,value,isLittleEndian){var numIndex=+index;var intIndex=toIndex(numIndex);if(intIndex+bytes>view[$LENGTH])throw RangeError(WRONG_INDEX);var store=view[$BUFFER]._b;var start=intIndex+view[$OFFSET];var pack=conversion(+value);for(var i=0;i<bytes;i++)store[start+i]=pack[isLittleEndian?i:bytes-i-1]}if(!$typed.ABV){$ArrayBuffer=function ArrayBuffer(length){anInstance(this,$ArrayBuffer,ARRAY_BUFFER);var byteLength=toIndex(length);this._b=arrayFill.call(new Array(byteLength),0);this[$LENGTH]=byteLength};$DataView=function DataView(buffer,byteOffset,byteLength){anInstance(this,$DataView,DATA_VIEW);anInstance(buffer,$ArrayBuffer,DATA_VIEW);var bufferLength=buffer[$LENGTH];var offset=toInteger(byteOffset);if(offset<0||offset>bufferLength)throw RangeError("Wrong offset!");byteLength=byteLength===undefined?bufferLength-offset:toLength(byteLength);if(offset+byteLength>bufferLength)throw RangeError(WRONG_LENGTH);this[$BUFFER]=buffer;this[$OFFSET]=offset;this[$LENGTH]=byteLength};if(DESCRIPTORS){addGetter($ArrayBuffer,BYTE_LENGTH,"_l");addGetter($DataView,BUFFER,"_b");addGetter($DataView,BYTE_LENGTH,"_l");addGetter($DataView,BYTE_OFFSET,"_o")}redefineAll($DataView[PROTOTYPE],{getInt8:function getInt8(byteOffset){return get(this,1,byteOffset)[0]<<24>>24},getUint8:function getUint8(byteOffset){return get(this,1,byteOffset)[0]},getInt16:function getInt16(byteOffset){var bytes=get(this,2,byteOffset,arguments[1]);return(bytes[1]<<8|bytes[0])<<16>>16},getUint16:function getUint16(byteOffset){var bytes=get(this,2,byteOffset,arguments[1]);return bytes[1]<<8|bytes[0]},getInt32:function getInt32(byteOffset){return unpackI32(get(this,4,byteOffset,arguments[1]))},getUint32:function getUint32(byteOffset){return unpackI32(get(this,4,byteOffset,arguments[1]))>>>0},getFloat32:function getFloat32(byteOffset){return unpackIEEE754(get(this,4,byteOffset,arguments[1]),23,4)},getFloat64:function getFloat64(byteOffset){return unpackIEEE754(get(this,8,byteOffset,arguments[1]),52,8)},setInt8:function setInt8(byteOffset,value){set(this,1,byteOffset,packI8,value)},setUint8:function setUint8(byteOffset,value){set(this,1,byteOffset,packI8,value)},setInt16:function setInt16(byteOffset,value){set(this,2,byteOffset,packI16,value,arguments[2])},setUint16:function setUint16(byteOffset,value){set(this,2,byteOffset,packI16,value,arguments[2])},setInt32:function setInt32(byteOffset,value){set(this,4,byteOffset,packI32,value,arguments[2])},setUint32:function setUint32(byteOffset,value){set(this,4,byteOffset,packI32,value,arguments[2])},setFloat32:function setFloat32(byteOffset,value){set(this,4,byteOffset,packF32,value,arguments[2])},setFloat64:function setFloat64(byteOffset,value){set(this,8,byteOffset,packF64,value,arguments[2])}})}else{if(!fails(function(){$ArrayBuffer(1)})||!fails(function(){new $ArrayBuffer(-1)})||fails(function(){new $ArrayBuffer;new $ArrayBuffer(1.5);new $ArrayBuffer(NaN);return $ArrayBuffer.name!=ARRAY_BUFFER})){$ArrayBuffer=function ArrayBuffer(length){anInstance(this,$ArrayBuffer);return new BaseBuffer(toIndex(length))};var ArrayBufferProto=$ArrayBuffer[PROTOTYPE]=BaseBuffer[PROTOTYPE];for(var keys=gOPN(BaseBuffer),j=0,key;keys.length>j;){if(!((key=keys[j++])in $ArrayBuffer))hide($ArrayBuffer,key,BaseBuffer[key])}if(!LIBRARY)ArrayBufferProto.constructor=$ArrayBuffer}var view=new $DataView(new $ArrayBuffer(2));var $setInt8=$DataView[PROTOTYPE].setInt8;view.setInt8(0,2147483648);view.setInt8(1,2147483649);if(view.getInt8(0)||!view.getInt8(1))redefineAll($DataView[PROTOTYPE],{setInt8:function setInt8(byteOffset,value){$setInt8.call(this,byteOffset,value<<24>>24)},setUint8:function setUint8(byteOffset,value){$setInt8.call(this,byteOffset,value<<24>>24)}},true)}setToStringTag($ArrayBuffer,ARRAY_BUFFER);setToStringTag($DataView,DATA_VIEW);hide($DataView[PROTOTYPE],$typed.VIEW,true);exports[ARRAY_BUFFER]=$ArrayBuffer;exports[DATA_VIEW]=$DataView},function(module,exports,__webpack_require__){var global=__webpack_require__(2);var navigator=global.navigator;module.exports=navigator&&navigator.userAgent||""},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function axesAreInnerMostDims(axes,rank){for(var i=0;i<axes.length;++i){if(axes[axes.length-i-1]!==rank-1-i){return false}}return true}exports.axesAreInnerMostDims=axesAreInnerMostDims;function combineLocations(outputLoc,reduceLoc,axes){var rank=outputLoc.length+reduceLoc.length;var loc=[];var outIdx=0;var reduceIdx=0;for(var dim=0;dim<rank;dim++){if(axes.indexOf(dim)===-1){loc.push(outputLoc[outIdx++])}else{loc.push(reduceLoc[reduceIdx++])}}return loc}exports.combineLocations=combineLocations;function computeOutAndReduceShapes(aShape,axes){var outShape=[];var rank=aShape.length;for(var dim=0;dim<rank;dim++){if(axes.indexOf(dim)===-1){outShape.push(aShape[dim])}}var reduceShape=axes.map(function(dim){return aShape[dim]});return[outShape,reduceShape]}exports.computeOutAndReduceShapes=computeOutAndReduceShapes;function expandShapeToKeepDim(shape,axes){var reduceSubShape=axes.map(function(x){return 1});return combineLocations(shape,reduceSubShape,axes)}exports.expandShapeToKeepDim=expandShapeToKeepDim;function parseAxisParam(axis,shape){if(axis==null){axis=shape.map(function(s,i){return i})}else if(typeof axis==="number"){axis=[axis]}var rank=shape.length;axis.forEach(function(a,i){if(a<-rank||a>=rank){throw new Error("Axis must be between -rank and rank-1. "+("Got axis["+i+"]="+a+" where rank is "+rank))}});return axis.map(function(a){return a<0?rank+a:a})}exports.parseAxisParam=parseAxisParam;function assertAxesAreInnerMostDims(msg,axes,rank){if(!axesAreInnerMostDims(axes,rank)){throw new Error(msg+" supports only inner-most axes for now. "+("Got axes "+axes+" and rank-"+rank+" input."))}}exports.assertAxesAreInnerMostDims=assertAxesAreInnerMostDims;function getPermutedAxes(axes,rank){if(axesAreInnerMostDims(axes,rank)){return null}var result=[];for(var i=0;i<rank;++i){if(axes.indexOf(i)===-1){result.push(i)}}axes.forEach(function(axis){return result.push(axis)});return result}exports.getPermutedAxes=getPermutedAxes;function getInnerMostAxes(numAxes,rank){var res=[];for(var i=rank-numAxes;i<rank;++i){res.push(i)}return res}exports.getInnerMostAxes=getInnerMostAxes},function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=y[op[0]&2?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[0,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var environment_1=__webpack_require__(11);var tex_util=__webpack_require__(65);var webgl_util=__webpack_require__(66);function getWebGLContextAttributes(){return{alpha:false,antialias:false,premultipliedAlpha:false,preserveDrawingBuffer:false,depth:false,stencil:false,failIfMajorPerformanceCaveat:true}}exports.getWebGLContextAttributes=getWebGLContextAttributes;function createWebGLContext(canvas){var attributes=getWebGLContextAttributes();var gl;if(canvas!=null){gl=webgl_util.createWebGLRenderingContextFromCanvas(canvas,attributes)}else{gl=webgl_util.createWebGLRenderingContext(attributes)}webgl_util.callAndCheck(gl,function(){return gl.disable(gl.DEPTH_TEST)});webgl_util.callAndCheck(gl,function(){return gl.disable(gl.STENCIL_TEST)});webgl_util.callAndCheck(gl,function(){return gl.disable(gl.BLEND)});webgl_util.callAndCheck(gl,function(){return gl.disable(gl.DITHER)});webgl_util.callAndCheck(gl,function(){return gl.disable(gl.POLYGON_OFFSET_FILL)});webgl_util.callAndCheck(gl,function(){return gl.disable(gl.SAMPLE_COVERAGE)});webgl_util.callAndCheck(gl,function(){return gl.enable(gl.SCISSOR_TEST)});webgl_util.callAndCheck(gl,function(){return gl.enable(gl.CULL_FACE)});webgl_util.callAndCheck(gl,function(){return gl.cullFace(gl.BACK)});return gl}exports.createWebGLContext=createWebGLContext;function createVertexShader(gl){var vertexShaderSource="\n    precision highp float;\n    attribute vec3 clipSpacePos;\n    attribute vec2 uv;\n    varying vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }";return webgl_util.createVertexShader(gl,vertexShaderSource)}exports.createVertexShader=createVertexShader;function createVertexBuffer(gl){var vertexArray=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return webgl_util.createStaticVertexBuffer(gl,vertexArray)}exports.createVertexBuffer=createVertexBuffer;function createIndexBuffer(gl){var triangleVertexIndices=new Uint16Array([0,1,2,2,1,3]);return webgl_util.createStaticIndexBuffer(gl,triangleVertexIndices)}exports.createIndexBuffer=createIndexBuffer;function getTextureInternalFormat(gl,numChannels){if(!environment_1.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")){return gl.RGBA}if(environment_1.ENV.get("WEBGL_VERSION")===2){if(numChannels===4){return gl.RGBA32F}return gl.R32F}return gl.RGBA}function getTextureFormat(gl,numChannels){if(!environment_1.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")){return gl.RGBA}if(environment_1.ENV.get("WEBGL_VERSION")===2){if(numChannels===4){return gl.RGBA}return gl.RED}return gl.RGBA}function getTextureType(gl){if(!environment_1.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")){return gl.UNSIGNED_BYTE}return gl.FLOAT}function createAndConfigureTexture(gl,width,height,numChannels){webgl_util.validateTextureSize(gl,width,height);var texture=webgl_util.createTexture(gl);var tex2d=gl.TEXTURE_2D;var internalFormat=getTextureInternalFormat(gl,numChannels);var format=getTextureFormat(gl,numChannels);webgl_util.callAndCheck(gl,function(){return gl.bindTexture(tex2d,texture)});webgl_util.callAndCheck(gl,function(){return gl.texParameteri(tex2d,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE)});webgl_util.callAndCheck(gl,function(){return gl.texParameteri(tex2d,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE)});webgl_util.callAndCheck(gl,function(){return gl.texParameteri(tex2d,gl.TEXTURE_MIN_FILTER,gl.NEAREST)});webgl_util.callAndCheck(gl,function(){return gl.texParameteri(tex2d,gl.TEXTURE_MAG_FILTER,gl.NEAREST)});webgl_util.callAndCheck(gl,function(){return gl.texImage2D(tex2d,0,internalFormat,width,height,0,format,getTextureType(gl),null)});webgl_util.callAndCheck(gl,function(){return gl.bindTexture(gl.TEXTURE_2D,null)});return texture}function createMatrixTexture(gl,rows,columns){var _a=tex_util.getUnpackedMatrixTextureShapeWidthHeight(rows,columns),width=_a[0],height=_a[1];var numChannels=1;return createAndConfigureTexture(gl,width,height,numChannels)}exports.createMatrixTexture=createMatrixTexture;function createColorMatrixTexture(gl,rows,columns){var _a=tex_util.getColorMatrixTextureShapeWidthHeight(rows,columns),width=_a[0],height=_a[1];var numChannels=4;return createAndConfigureTexture(gl,width,height,numChannels)}exports.createColorMatrixTexture=createColorMatrixTexture;function createPackedMatrixTexture(gl,rows,columns){var _a=tex_util.getPackedMatrixTextureShapeWidthHeight(rows,columns),width=_a[0],height=_a[1];var numChannels=4;return createAndConfigureTexture(gl,width,height,numChannels)}exports.createPackedMatrixTexture=createPackedMatrixTexture;function bindVertexProgramAttributeStreams(gl,program,vertexBuffer,attribLocations){var posOffset=0;var uvOffset=3*4;var stride=3*4+2*4;webgl_util.callAndCheck(gl,function(){return gl.bindBuffer(gl.ARRAY_BUFFER,vertexBuffer)});webgl_util.bindVertexBufferToProgramAttribute(gl,program,"clipSpacePos",vertexBuffer,3,stride,posOffset,attribLocations);webgl_util.bindVertexBufferToProgramAttribute(gl,program,"uv",vertexBuffer,2,stride,uvOffset,attribLocations)}exports.bindVertexProgramAttributeStreams=bindVertexProgramAttributeStreams;function uploadPixelDataToTexture(gl,texture,pixels){webgl_util.callAndCheck(gl,function(){return gl.bindTexture(gl.TEXTURE_2D,texture)});webgl_util.callAndCheck(gl,function(){return gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,pixels)});webgl_util.callAndCheck(gl,function(){return gl.bindTexture(gl.TEXTURE_2D,null)})}exports.uploadPixelDataToTexture=uploadPixelDataToTexture;function uploadDataToTexture(gl,texture,width,height,data,numChannels){var textureFormat=getTextureFormat(gl,numChannels);webgl_util.validateTextureSize(gl,width,height);webgl_util.callAndCheck(gl,function(){return gl.bindTexture(gl.TEXTURE_2D,texture)});webgl_util.callAndCheck(gl,function(){return gl.texSubImage2D(gl.TEXTURE_2D,0,0,0,width,height,textureFormat,getTextureType(gl),data)});webgl_util.callAndCheck(gl,function(){return gl.bindTexture(gl.TEXTURE_2D,null)})}function uploadMatrixToTexture(gl,texture,rows,columns,matrix,numChannels){var _a=tex_util.getUnpackedMatrixTextureShapeWidthHeight(rows,columns),w=_a[0],h=_a[1];var unpackedArray;if(environment_1.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")){var channelsPerTexture=numChannels===1?webgl_util.getChannelsPerTexture():numChannels;if(channelsPerTexture===1){unpackedArray=matrix}else{unpackedArray=new Float32Array(tex_util.getUnpackedArraySizeFromMatrixSize(matrix.length,channelsPerTexture));tex_util.encodeMatrixToUnpackedArray(matrix,unpackedArray,channelsPerTexture)}}else{unpackedArray=tex_util.encodeFloatArray(matrix)}uploadDataToTexture(gl,texture,w,h,unpackedArray,numChannels)}exports.uploadMatrixToTexture=uploadMatrixToTexture;function uploadMatrixToPackedTexture(gl,texture,rows,columns,matrix){var _a=tex_util.getPackedMatrixTextureShapeWidthHeight(rows,columns),w=_a[0],h=_a[1];var packedRGBA=new Float32Array(tex_util.getPackedRGBAArraySizeFromMatrixShape(rows,columns));tex_util.encodeMatrixToPackedRGBA(matrix,rows,columns,packedRGBA);var numChannels=4;uploadDataToTexture(gl,texture,w,h,packedRGBA,numChannels)}exports.uploadMatrixToPackedTexture=uploadMatrixToPackedTexture;function getDownloadTargetArrayBuffer(rows,columns,channelsPerTexture){var isFloatTexture=environment_1.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED");var downloadTarget;if(isFloatTexture){downloadTarget=new Float32Array(tex_util.getUnpackedArraySizeFromMatrixSize(rows*columns,channelsPerTexture))}else{downloadTarget=new Uint8Array(rows*columns*channelsPerTexture)}return downloadTarget}function decodeDownloadTargetArrayBuffer(downloadTarget,rows,columns,channelsPerPixel){var isFloatTexture=environment_1.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED");if(isFloatTexture){var matrix=new Float32Array(rows*columns);tex_util.decodeMatrixFromUnpackedArray(downloadTarget,matrix,channelsPerPixel);return matrix}else{return tex_util.decodeToFloatArray(downloadTarget)}}function downloadMatrixFromOutputTextureAsync(gl,getBufferSubDataAsyncExtension,rows,columns){return __awaiter(this,void 0,void 0,function(){var gl2,channelsPerPixel,downloadTarget,bufferSizeBytes,buffer;return __generator(this,function(_a){switch(_a.label){case 0:gl2=gl;channelsPerPixel=4;downloadTarget=getDownloadTargetArrayBuffer(rows,columns,channelsPerPixel);bufferSizeBytes=downloadTarget instanceof Float32Array?downloadTarget.length*4:downloadTarget;buffer=gl.createBuffer();webgl_util.callAndCheck(gl,function(){return gl.bindBuffer(gl2.PIXEL_PACK_BUFFER,buffer)});webgl_util.callAndCheck(gl,function(){return gl.bufferData(gl2.PIXEL_PACK_BUFFER,bufferSizeBytes,gl.STATIC_DRAW)});webgl_util.callAndCheck(gl,function(){return gl2.readPixels(0,0,columns,rows,gl.RGBA,getTextureType(gl),0)});return[4,getBufferSubDataAsyncExtension.getBufferSubDataAsync(gl2.PIXEL_PACK_BUFFER,0,downloadTarget)];case 1:_a.sent();return[2,decodeDownloadTargetArrayBuffer(downloadTarget,rows,columns,channelsPerPixel)]}})})}exports.downloadMatrixFromOutputTextureAsync=downloadMatrixFromOutputTextureAsync;function downloadMatrixFromOutputTexture(gl,rows,columns){var _a=tex_util.getUnpackedMatrixTextureShapeWidthHeight(rows,columns),w=_a[0],h=_a[1];var channelsPerPixel=4;var downloadTarget=getDownloadTargetArrayBuffer(rows,columns,channelsPerPixel);webgl_util.callAndCheck(gl,function(){return gl.readPixels(0,0,w,h,gl.RGBA,getTextureType(gl),downloadTarget)});return decodeDownloadTargetArrayBuffer(downloadTarget,rows,columns,channelsPerPixel)}exports.downloadMatrixFromOutputTexture=downloadMatrixFromOutputTexture;function downloadMatrixFromRGBAColorTexture(gl,rows,columns,channels){var size=rows*columns*4;var downloadTarget=new Uint8Array(size);webgl_util.callAndCheck(gl,function(){return gl.readPixels(0,0,columns,rows,gl.RGBA,gl.UNSIGNED_BYTE,downloadTarget)});var packedRGBA=new Float32Array(size);for(var i=0;i<downloadTarget.length;i++){packedRGBA[i]=downloadTarget[i]}var matrix=new Float32Array(rows*columns*channels);tex_util.decodeMatrixFromUnpackedColorRGBAArray(packedRGBA,matrix,channels);return matrix}exports.downloadMatrixFromRGBAColorTexture=downloadMatrixFromRGBAColorTexture;function downloadMatrixFromPackedOutputTexture(gl,rows,columns){var _a=tex_util.getPackedMatrixTextureShapeWidthHeight(rows,columns),w=_a[0],h=_a[1];var packedRGBA=new Float32Array(tex_util.getPackedRGBAArraySizeFromMatrixShape(rows,columns));webgl_util.callAndCheck(gl,function(){return gl.readPixels(0,0,w,h,gl.RGBA,getTextureType(gl),packedRGBA)});var matrix=new Float32Array(rows*columns);return tex_util.decodeMatrixFromPackedRGBA(packedRGBA,rows,columns,matrix)}exports.downloadMatrixFromPackedOutputTexture=downloadMatrixFromPackedOutputTexture},function(module,exports,__webpack_require__){module.exports=!__webpack_require__(8)&&!__webpack_require__(5)(function(){return Object.defineProperty(__webpack_require__(85)("div"),"a",{get:function(){return 7}}).a!=7})},function(module,exports,__webpack_require__){exports.f=__webpack_require__(7)},function(module,exports,__webpack_require__){var has=__webpack_require__(15);var toIObject=__webpack_require__(20);var arrayIndexOf=__webpack_require__(71)(false);var IE_PROTO=__webpack_require__(87)("IE_PROTO");module.exports=function(object,names){var O=toIObject(object);var i=0;var result=[];var key;for(key in O)if(key!=IE_PROTO)has(O,key)&&result.push(key);while(names.length>i)if(has(O,key=names[i++])){~arrayIndexOf(result,key)||result.push(key)}return result}},function(module,exports,__webpack_require__){var dP=__webpack_require__(9);var anObject=__webpack_require__(1);var getKeys=__webpack_require__(42);module.exports=__webpack_require__(8)?Object.defineProperties:function defineProperties(O,Properties){anObject(O);var keys=getKeys(Properties);var length=keys.length;var i=0;var P;while(length>i)dP.f(O,P=keys[i++],Properties[P]);return O}},function(module,exports,__webpack_require__){var toIObject=__webpack_require__(20);var gOPN=__webpack_require__(45).f;var toString={}.toString;var windowNames=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];var getWindowNames=function(it){try{return gOPN(it)}catch(e){return windowNames.slice()}};module.exports.f=function getOwnPropertyNames(it){return windowNames&&toString.call(it)=="[object Window]"?getWindowNames(it):gOPN(toIObject(it))}},function(module,exports,__webpack_require__){"use strict";var getKeys=__webpack_require__(42);var gOPS=__webpack_require__(72);var pIE=__webpack_require__(58);var toObject=__webpack_require__(12);var IObject=__webpack_require__(57);var $assign=Object.assign;module.exports=!$assign||__webpack_require__(5)(function(){var A={};var B={};var S=Symbol();var K="abcdefghijklmnopqrst";A[S]=7;K.split("").forEach(function(k){B[k]=k});return $assign({},A)[S]!=7||Object.keys($assign({},B)).join("")!=K})?function assign(target,source){var T=toObject(target);var aLen=arguments.length;var index=1;var getSymbols=gOPS.f;var isEnum=pIE.f;while(aLen>index){var S=IObject(arguments[index++]);var keys=getSymbols?getKeys(S).concat(getSymbols(S)):getKeys(S);var length=keys.length;var j=0;var key;while(length>j)if(isEnum.call(S,key=keys[j++]))T[key]=S[key]}return T}:$assign},function(module,exports,__webpack_require__){"use strict";var aFunction=__webpack_require__(14);var isObject=__webpack_require__(6);var invoke=__webpack_require__(121);var arraySlice=[].slice;var factories={};var construct=function(F,len,args){if(!(len in factories)){for(var n=[],i=0;i<len;i++)n[i]="a["+i+"]";factories[len]=Function("F,a","return new F("+n.join(",")+")")}return factories[len](F,args)};module.exports=Function.bind||function bind(that){var fn=aFunction(this);var partArgs=arraySlice.call(arguments,1);var bound=function(){var args=partArgs.concat(arraySlice.call(arguments));return this instanceof bound?construct(fn,args.length,args):invoke(fn,args,that)};if(isObject(fn.prototype))bound.prototype=fn.prototype;return bound}},function(module,exports){module.exports=function(fn,args,that){var un=that===undefined;switch(args.length){case 0:return un?fn():fn.call(that);case 1:return un?fn(args[0]):fn.call(that,args[0]);case 2:return un?fn(args[0],args[1]):fn.call(that,args[0],args[1]);case 3:return un?fn(args[0],args[1],args[2]):fn.call(that,args[0],args[1],args[2]);case 4:return un?fn(args[0],args[1],args[2],args[3]):fn.call(that,args[0],args[1],args[2],args[3])}return fn.apply(that,args)}},function(module,exports,__webpack_require__){var $parseInt=__webpack_require__(2).parseInt;var $trim=__webpack_require__(52).trim;var ws=__webpack_require__(91);var hex=/^[-+]?0[xX]/;module.exports=$parseInt(ws+"08")!==8||$parseInt(ws+"0x16")!==22?function parseInt(str,radix){var string=$trim(String(str),3);return $parseInt(string,radix>>>0||(hex.test(string)?16:10))}:$parseInt},function(module,exports,__webpack_require__){var $parseFloat=__webpack_require__(2).parseFloat;var $trim=__webpack_require__(52).trim;module.exports=1/$parseFloat(__webpack_require__(91)+"-0")!==-Infinity?function parseFloat(str){var string=$trim(String(str),3);var result=$parseFloat(string);return result===0&&string.charAt(0)=="-"?-0:result}:$parseFloat},function(module,exports,__webpack_require__){var cof=__webpack_require__(25);module.exports=function(it,msg){if(typeof it!="number"&&cof(it)!="Number")throw TypeError(msg);return+it}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(6);var floor=Math.floor;module.exports=function isInteger(it){return!isObject(it)&&isFinite(it)&&floor(it)===it}},function(module,exports){module.exports=Math.log1p||function log1p(x){return(x=+x)>-1e-8&&x<1e-8?x-x*x/2:Math.log(1+x)}},function(module,exports,__webpack_require__){var sign=__webpack_require__(94);var pow=Math.pow;var EPSILON=pow(2,-52);var EPSILON32=pow(2,-23);var MAX32=pow(2,127)*(2-EPSILON32);var MIN32=pow(2,-126);var roundTiesToEven=function(n){return n+1/EPSILON-1/EPSILON};module.exports=Math.fround||function fround(x){var $abs=Math.abs(x);var $sign=sign(x);var a,result;if($abs<MIN32)return $sign*roundTiesToEven($abs/MIN32/EPSILON32)*MIN32*EPSILON32;a=(1+EPSILON32/EPSILON)*$abs;result=a-(a-$abs);if(result>MAX32||result!=result)return $sign*Infinity;return $sign*result}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(1);module.exports=function(iterator,fn,value,entries){try{return entries?fn(anObject(value)[0],value[1]):fn(value)}catch(e){var ret=iterator["return"];if(ret!==undefined)anObject(ret.call(iterator));throw e}}},function(module,exports,__webpack_require__){var aFunction=__webpack_require__(14);var toObject=__webpack_require__(12);var IObject=__webpack_require__(57);var toLength=__webpack_require__(10);module.exports=function(that,callbackfn,aLen,memo,isRight){aFunction(callbackfn);var O=toObject(that);var self=IObject(O);var length=toLength(O.length);var index=isRight?length-1:0;var i=isRight?-1:1;if(aLen<2)for(;;){if(index in self){memo=self[index];index+=i;break}index+=i;if(isRight?index<0:length<=index){throw TypeError("Reduce of empty array with no initial value")}}for(;isRight?index>=0:length>index;index+=i)if(index in self){memo=callbackfn(memo,self[index],index,O)}return memo}},function(module,exports,__webpack_require__){"use strict";var toObject=__webpack_require__(12);var toAbsoluteIndex=__webpack_require__(43);var toLength=__webpack_require__(10);module.exports=[].copyWithin||function copyWithin(target,start){var O=toObject(this);var len=toLength(O.length);var to=toAbsoluteIndex(target,len);var from=toAbsoluteIndex(start,len);var end=arguments.length>2?arguments[2]:undefined;var count=Math.min((end===undefined?len:toAbsoluteIndex(end,len))-from,len-to);var inc=1;if(from<to&&to<from+count){inc=-1;from+=count-1;to+=count-1}while(count-- >0){if(from in O)O[to]=O[from];else delete O[to];to+=inc;from+=inc}return O}},function(module,exports){module.exports=function(done,value){return{value:value,done:!!done}}},function(module,exports,__webpack_require__){if(__webpack_require__(8)&&/./g.flags!="g")__webpack_require__(9).f(RegExp.prototype,"flags",{configurable:true,get:__webpack_require__(76)})},function(module,exports){module.exports=function(exec){try{return{e:false,v:exec()}}catch(e){return{e:true,v:e}}}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(1);var isObject=__webpack_require__(6);var newPromiseCapability=__webpack_require__(109);module.exports=function(C,x){anObject(C);if(isObject(x)&&x.constructor===C)return x;var promiseCapability=newPromiseCapability.f(C);var resolve=promiseCapability.resolve;resolve(x);return promiseCapability.promise}},function(module,exports,__webpack_require__){"use strict";var strong=__webpack_require__(136);var validate=__webpack_require__(54);var MAP="Map";module.exports=__webpack_require__(79)(MAP,function(get){return function Map(){return get(this,arguments.length>0?arguments[0]:undefined)}},{get:function get(key){var entry=strong.getEntry(validate(this,MAP),key);return entry&&entry.v},set:function set(key,value){return strong.def(validate(this,MAP),key===0?0:key,value)}},strong,true)},function(module,exports,__webpack_require__){"use strict";var dP=__webpack_require__(9).f;var create=__webpack_require__(44);var redefineAll=__webpack_require__(49);var ctx=__webpack_require__(24);var anInstance=__webpack_require__(47);var forOf=__webpack_require__(48);var $iterDefine=__webpack_require__(97);var step=__webpack_require__(131);var setSpecies=__webpack_require__(46);var DESCRIPTORS=__webpack_require__(8);var fastKey=__webpack_require__(37).fastKey;var validate=__webpack_require__(54);var SIZE=DESCRIPTORS?"_s":"size";var getEntry=function(that,key){var index=fastKey(key);var entry;if(index!=="F")return that._i[index];for(entry=that._f;entry;entry=entry.n){if(entry.k==key)return entry}};module.exports={getConstructor:function(wrapper,NAME,IS_MAP,ADDER){var C=wrapper(function(that,iterable){anInstance(that,C,NAME,"_i");that._t=NAME;that._i=create(null);that._f=undefined;that._l=undefined;that[SIZE]=0;if(iterable!=undefined)forOf(iterable,IS_MAP,that[ADDER],that)});redefineAll(C.prototype,{clear:function clear(){for(var that=validate(this,NAME),data=that._i,entry=that._f;entry;entry=entry.n){entry.r=true;if(entry.p)entry.p=entry.p.n=undefined;delete data[entry.i]}that._f=that._l=undefined;that[SIZE]=0},delete:function(key){var that=validate(this,NAME);var entry=getEntry(that,key);if(entry){var next=entry.n;var prev=entry.p;delete that._i[entry.i];entry.r=true;if(prev)prev.n=next;if(next)next.p=prev;if(that._f==entry)that._f=next;if(that._l==entry)that._l=prev;that[SIZE]--}return!!entry},forEach:function forEach(callbackfn){validate(this,NAME);var f=ctx(callbackfn,arguments.length>1?arguments[1]:undefined,3);var entry;while(entry=entry?entry.n:this._f){f(entry.v,entry.k,this);while(entry&&entry.r)entry=entry.p}},has:function has(key){return!!getEntry(validate(this,NAME),key)}});if(DESCRIPTORS)dP(C.prototype,"size",{get:function(){return validate(this,NAME)[SIZE]}});return C},def:function(that,key,value){var entry=getEntry(that,key);var prev,index;if(entry){entry.v=value}else{that._l=entry={i:index=fastKey(key,true),k:key,v:value,p:prev=that._l,n:undefined,r:false};if(!that._f)that._f=entry;if(prev)prev.n=entry;that[SIZE]++;if(index!=="F")that._i[index]=entry}return that},getEntry:getEntry,setStrong:function(C,NAME,IS_MAP){$iterDefine(C,NAME,function(iterated,kind){this._t=validate(iterated,NAME);this._k=kind;this._l=undefined},function(){var that=this;var kind=that._k;var entry=that._l;while(entry&&entry.r)entry=entry.p;if(!that._t||!(that._l=entry=entry?entry.n:that._t._f)){that._t=undefined;return step(1)}if(kind=="keys")return step(0,entry.k);if(kind=="values")return step(0,entry.v);return step(0,[entry.k,entry.v])},IS_MAP?"entries":"values",!IS_MAP,true);setSpecies(NAME)}}},function(module,exports,__webpack_require__){"use strict";var strong=__webpack_require__(136);var validate=__webpack_require__(54);var SET="Set";module.exports=__webpack_require__(79)(SET,function(get){return function Set(){return get(this,arguments.length>0?arguments[0]:undefined)}},{add:function add(value){return strong.def(validate(this,SET),value=value===0?0:value,value)}},strong)},function(module,exports,__webpack_require__){"use strict";var each=__webpack_require__(33)(0);var redefine=__webpack_require__(17);var meta=__webpack_require__(37);var assign=__webpack_require__(119);var weak=__webpack_require__(139);var isObject=__webpack_require__(6);var fails=__webpack_require__(5);var validate=__webpack_require__(54);var WEAK_MAP="WeakMap";var getWeak=meta.getWeak;var isExtensible=Object.isExtensible;var uncaughtFrozenStore=weak.ufstore;var tmp={};var InternalMap;var wrapper=function(get){return function WeakMap(){return get(this,arguments.length>0?arguments[0]:undefined)}};var methods={get:function get(key){if(isObject(key)){var data=getWeak(key);if(data===true)return uncaughtFrozenStore(validate(this,WEAK_MAP)).get(key);return data?data[this._i]:undefined}},set:function set(key,value){return weak.def(validate(this,WEAK_MAP),key,value)}};var $WeakMap=module.exports=__webpack_require__(79)(WEAK_MAP,wrapper,methods,weak,true,true);if(fails(function(){return(new $WeakMap).set((Object.freeze||Object)(tmp),7).get(tmp)!=7})){InternalMap=weak.getConstructor(wrapper,WEAK_MAP);assign(InternalMap.prototype,methods);meta.NEED=true;each(["delete","has","get","set"],function(key){var proto=$WeakMap.prototype;var method=proto[key];redefine(proto,key,function(a,b){if(isObject(a)&&!isExtensible(a)){if(!this._f)this._f=new InternalMap;var result=this._f[key](a,b);return key=="set"?this:result}return method.call(this,a,b)})})}},function(module,exports,__webpack_require__){"use strict";var redefineAll=__webpack_require__(49);var getWeak=__webpack_require__(37).getWeak;var anObject=__webpack_require__(1);var isObject=__webpack_require__(6);var anInstance=__webpack_require__(47);var forOf=__webpack_require__(48);var createArrayMethod=__webpack_require__(33);var $has=__webpack_require__(15);var validate=__webpack_require__(54);var arrayFind=createArrayMethod(5);var arrayFindIndex=createArrayMethod(6);var id=0;var uncaughtFrozenStore=function(that){return that._l||(that._l=new UncaughtFrozenStore)};var UncaughtFrozenStore=function(){this.a=[]};var findUncaughtFrozen=function(store,key){return arrayFind(store.a,function(it){return it[0]===key})};UncaughtFrozenStore.prototype={get:function(key){var entry=findUncaughtFrozen(this,key);if(entry)return entry[1]},has:function(key){return!!findUncaughtFrozen(this,key)},set:function(key,value){var entry=findUncaughtFrozen(this,key);if(entry)entry[1]=value;else this.a.push([key,value])},delete:function(key){var index=arrayFindIndex(this.a,function(it){return it[0]===key});if(~index)this.a.splice(index,1);return!!~index}};module.exports={getConstructor:function(wrapper,NAME,IS_MAP,ADDER){var C=wrapper(function(that,iterable){anInstance(that,C,NAME,"_i");that._t=NAME;that._i=id++;that._l=undefined;if(iterable!=undefined)forOf(iterable,IS_MAP,that[ADDER],that)});redefineAll(C.prototype,{delete:function(key){if(!isObject(key))return false;var data=getWeak(key);if(data===true)return uncaughtFrozenStore(validate(this,NAME))["delete"](key);return data&&$has(data,this._i)&&delete data[this._i]},has:function has(key){if(!isObject(key))return false;var data=getWeak(key);if(data===true)return uncaughtFrozenStore(validate(this,NAME)).has(key);return data&&$has(data,this._i)}});return C},def:function(that,key,value){var data=getWeak(anObject(key),true);if(data===true)uncaughtFrozenStore(that).set(key,value);else data[that._i]=value;return that},ufstore:uncaughtFrozenStore}},function(module,exports,__webpack_require__){var toInteger=__webpack_require__(31);var toLength=__webpack_require__(10);module.exports=function(it){if(it===undefined)return 0;var number=toInteger(it);var length=toLength(number);if(number!==length)throw RangeError("Wrong length!");return length}},function(module,exports,__webpack_require__){var gOPN=__webpack_require__(45);var gOPS=__webpack_require__(72);var anObject=__webpack_require__(1);var Reflect=__webpack_require__(2).Reflect;module.exports=Reflect&&Reflect.ownKeys||function ownKeys(it){var keys=gOPN.f(anObject(it));var getSymbols=gOPS.f;return getSymbols?keys.concat(getSymbols(it)):keys}},function(module,exports,__webpack_require__){"use strict";var isArray=__webpack_require__(73);var isObject=__webpack_require__(6);var toLength=__webpack_require__(10);var ctx=__webpack_require__(24);var IS_CONCAT_SPREADABLE=__webpack_require__(7)("isConcatSpreadable");function flattenIntoArray(target,original,source,sourceLen,start,depth,mapper,thisArg){var targetIndex=start;var sourceIndex=0;var mapFn=mapper?ctx(mapper,thisArg,3):false;var element,spreadable;while(sourceIndex<sourceLen){if(sourceIndex in source){element=mapFn?mapFn(source[sourceIndex],sourceIndex,original):source[sourceIndex];spreadable=false;if(isObject(element)){spreadable=element[IS_CONCAT_SPREADABLE];spreadable=spreadable!==undefined?!!spreadable:isArray(element)}if(spreadable&&depth>0){targetIndex=flattenIntoArray(target,original,element,toLength(element.length),targetIndex,depth-1)-1}else{if(targetIndex>=9007199254740991)throw TypeError();target[targetIndex]=element}targetIndex++}sourceIndex++}return targetIndex}module.exports=flattenIntoArray},function(module,exports,__webpack_require__){var toLength=__webpack_require__(10);var repeat=__webpack_require__(93);var defined=__webpack_require__(30);module.exports=function(that,maxLength,fillString,left){var S=String(defined(that));var stringLength=S.length;var fillStr=fillString===undefined?" ":String(fillString);var intMaxLength=toLength(maxLength);if(intMaxLength<=stringLength||fillStr=="")return S;var fillLen=intMaxLength-stringLength;var stringFiller=repeat.call(fillStr,Math.ceil(fillLen/fillStr.length));if(stringFiller.length>fillLen)stringFiller=stringFiller.slice(0,fillLen);return left?stringFiller+S:S+stringFiller}},function(module,exports,__webpack_require__){var getKeys=__webpack_require__(42);var toIObject=__webpack_require__(20);var isEnum=__webpack_require__(58).f;module.exports=function(isEntries){return function(it){var O=toIObject(it);var keys=getKeys(O);var length=keys.length;var i=0;var result=[];var key;while(length>i)if(isEnum.call(O,key=keys[i++])){result.push(isEntries?[key,O[key]]:O[key])}return result}}},function(module,exports,__webpack_require__){var classof=__webpack_require__(59);var from=__webpack_require__(146);module.exports=function(NAME){return function toJSON(){if(classof(this)!=NAME)throw TypeError(NAME+"#toJSON isn't generic");return from(this)}}},function(module,exports,__webpack_require__){var forOf=__webpack_require__(48);module.exports=function(iter,ITERATOR){var result=[];forOf(iter,false,result.push,result,ITERATOR);return result}},function(module,exports){module.exports=Math.scale||function scale(x,inLow,inHigh,outLow,outHigh){if(arguments.length===0||x!=x||inLow!=inLow||inHigh!=inHigh||outLow!=outLow||outHigh!=outHigh)return NaN;if(x===Infinity||x===-Infinity)return x;return(x-inLow)*(outHigh-outLow)/(inHigh-inLow)+outLow}},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var ndarray_1=__webpack_require__(3);var util=__webpack_require__(4);var dataset_1=__webpack_require__(150);var PARSING_IMAGE_CANVAS_HEIGHT_PX=1e3;function getXhrDatasetConfig(jsonConfigPath){return new Promise(function(resolve,reject){var xhr=new XMLHttpRequest;xhr.open("GET",jsonConfigPath);xhr.onload=function(){resolve(JSON.parse(xhr.responseText))};xhr.onerror=function(error){reject(error)};xhr.send()})}exports.getXhrDatasetConfig=getXhrDatasetConfig;var XhrDataset=function(_super){__extends(XhrDataset,_super);function XhrDataset(xhrDatasetConfig){var _this=_super.call(this,xhrDatasetConfig.data.map(function(x){return x.shape}))||this;_this.xhrDatasetConfig=xhrDatasetConfig;return _this}XhrDataset.prototype.getNDArray=function(info){var dataPromise=info.dataType==="png"?parseTypedArrayFromPng(info,info.shape):parseTypedArrayFromBinary(info);var inputSize=util.sizeFromShape(info.shape);return dataPromise.then(function(data){var ndarrays=[];for(var i=0;i<data.length/inputSize;i++){var values=data.subarray(i*inputSize,(i+1)*inputSize);var ndarray=ndarray_1.NDArray.make(info.shape,{values:new Float32Array(values)},"float32");ndarrays.push(ndarray)}return ndarrays})};XhrDataset.prototype.fetchData=function(){var _this=this;return new Promise(function(resolve,reject){var promises=_this.xhrDatasetConfig.data.map(function(x){return _this.getNDArray(x)});Promise.all(promises).then(function(data){_this.dataset=data;resolve()})})};return XhrDataset}(dataset_1.InMemoryDataset);exports.XhrDataset=XhrDataset;function parseTypedArrayFromBinary(info){return new Promise(function(resolve,reject){var xhr=new XMLHttpRequest;xhr.open("GET",info.path);xhr.responseType="arraybuffer";xhr.onload=function(event){var data=info.dataType==="float32"?new Float32Array(xhr.response):new Uint8Array(xhr.response);resolve(data)};xhr.onerror=function(err){return reject(err)};xhr.send()})}function parseGrayscaleImageData(data,result,resultOffset){var idx=resultOffset;for(var i=0;i<data.length;i+=4){result[idx++]=data[i]}}function parseRGBImageData(data,result,resultOffset){var idx=resultOffset;for(var i=0;i<data.length;i+=4){result[idx]=data[i];result[idx+1]=data[i+1];result[idx+2]=data[i+2];idx+=3}}function parseImage(img,shape){var canvas=document.createElement("canvas");var ctx=canvas.getContext("2d");var N=img.height;var inputSize=util.sizeFromShape(shape);var result=new Uint8Array(N*inputSize);if(img.width!==shape[0]*shape[1]){throw new Error("Image width ("+img.width+") must be multiple of "+("rows*columns ("+shape[0]+"*"+shape[1]+") of the ndarray"))}canvas.width=img.width;canvas.height=PARSING_IMAGE_CANVAS_HEIGHT_PX;var sx=0;var sWidth=canvas.width;var sHeight=canvas.height;var dx=0;var dy=0;var dWidth=sWidth;var dHeight=sHeight;var depth=shape[2];var offset=0;var numPasses=Math.ceil(N/canvas.height);for(var pass=0;pass<numPasses;++pass){var sy=pass*canvas.height;if(pass===numPasses-1&&N%canvas.height>0){canvas.height=N%canvas.height;sHeight=canvas.height;dHeight=sHeight}ctx.drawImage(img,sx,sy,sWidth,sHeight,dx,dy,dWidth,dHeight);var data=ctx.getImageData(0,0,canvas.width,canvas.height).data;depth===1?parseGrayscaleImageData(data,result,offset):parseRGBImageData(data,result,offset);offset+=canvas.height*inputSize}return result}function parseTypedArrayFromPng(info,shape){return new Promise(function(resolve,reject){var img=new Image;img.setAttribute("crossOrigin","");img.onload=function(){var result=parseImage(img,shape);img.src="";img=null;resolve(result)};img.src=info.path})}},function(module,exports,__webpack_require__){var alea=__webpack_require__(372);var xor128=__webpack_require__(373);var xorwow=__webpack_require__(374);var xorshift7=__webpack_require__(375);var xor4096=__webpack_require__(376);var tychei=__webpack_require__(377);var sr=__webpack_require__(378);sr.alea=alea;sr.xor128=xor128;sr.xorwow=xorwow;sr.xorshift7=xorshift7;sr.xor4096=xor4096;sr.tychei=tychei;module.exports=sr},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ndarray_1=__webpack_require__(3);var util=__webpack_require__(4);var STATS_SAMPLE_PERCENTAGE=.1;var InMemoryDataset=function(){function InMemoryDataset(dataShapes){this.dataShapes=dataShapes;this.normalizationInfo={}}InMemoryDataset.prototype.getDataShape=function(dataIndex){return this.dataShapes[dataIndex]};InMemoryDataset.prototype.getData=function(){return this.dataset};InMemoryDataset.prototype.getStats=function(){var _this=this;if(this.dataset==null){throw new Error("Data is null.")}return this.dataset.map(function(d){return _this.getStatsForData(d)})};InMemoryDataset.prototype.getStatsForData=function(data){var inputMin=Number.POSITIVE_INFINITY;var inputMax=Number.NEGATIVE_INFINITY;var exampleIndices=data.map(function(example,i){return i});util.shuffle(exampleIndices);exampleIndices=exampleIndices.slice(exampleIndices.length*STATS_SAMPLE_PERCENTAGE);for(var i=0;i<exampleIndices.length;i++){var inputValues=data[exampleIndices[i]].dataSync();for(var j=0;j<inputValues.length;j++){inputMin=Math.min(inputMin,inputValues[j]);inputMax=Math.max(inputMax,inputValues[j])}}return{inputMin:inputMin,inputMax:inputMax,exampleCount:data.length,shape:data[0].shape}};InMemoryDataset.prototype.normalizeExamplesToRange=function(examples,curLowerBounds,curUpperBounds,newLowerBounds,newUpperBounds){var curBoundsIsPerDimension=curUpperBounds instanceof Float32Array&&curLowerBounds instanceof Float32Array;var newBoundsIsPerDimension=newLowerBounds instanceof Float32Array&&newUpperBounds instanceof Float32Array;var inputSize=util.sizeFromShape(examples[0].shape);var newExamples=[];examples.forEach(function(example){var inputValues=example.dataSync();var normalizedValues=new Float32Array(inputSize);for(var j=0;j<inputSize;j++){var curLowerBound=curBoundsIsPerDimension?curLowerBounds[j]:curLowerBounds;var curUpperBound=curBoundsIsPerDimension?curUpperBounds[j]:curUpperBounds;var curRange=curUpperBound-curLowerBound;var newLowerBound=newBoundsIsPerDimension?newLowerBounds[j]:newLowerBounds;var newUpperBound=newBoundsIsPerDimension?newUpperBounds[j]:newUpperBounds;var newRange=newUpperBound-newLowerBound;if(curRange===0){normalizedValues[j]=newLowerBound}else{normalizedValues[j]=newLowerBound+newRange*(inputValues[j]-curLowerBound)/curRange}}newExamples.push(ndarray_1.NDArray.make(example.shape,{values:normalizedValues},"float32"))});return newExamples};InMemoryDataset.prototype.computeBounds=function(dataIndex){var _this=this;if(this.dataset==null){throw new Error("Data is null.")}var size=util.sizeFromShape(this.dataset[dataIndex][0].shape);this.normalizationInfo[dataIndex]={isNormalized:false,minValues:new Float32Array(size),maxValues:new Float32Array(size)};for(var i=0;i<size;i++){this.normalizationInfo[dataIndex].minValues[i]=Number.POSITIVE_INFINITY;this.normalizationInfo[dataIndex].maxValues[i]=Number.NEGATIVE_INFINITY}this.dataset[dataIndex].forEach(function(example){var inputValues=example.dataSync();for(var k=0;k<size;k++){_this.normalizationInfo[dataIndex].minValues[k]=Math.min(_this.normalizationInfo[dataIndex].minValues[k],inputValues[k]);_this.normalizationInfo[dataIndex].maxValues[k]=Math.max(_this.normalizationInfo[dataIndex].maxValues[k],inputValues[k])}})};InMemoryDataset.prototype.normalizeWithinBounds=function(dataIndex,lowerBound,upperBound){if(this.dataset==null){throw new Error("Data is null.")}if(dataIndex>=this.dataset.length){throw new Error("dataIndex out of bounds.")}if(this.normalizationInfo[dataIndex]==null){this.computeBounds(dataIndex)}var curLowerBounds;var curUpperBounds;if(this.normalizationInfo[dataIndex].isNormalized){curLowerBounds=this.normalizationInfo[dataIndex].lowerBound;curUpperBounds=this.normalizationInfo[dataIndex].upperBound}else{curLowerBounds=this.normalizationInfo[dataIndex].minValues;curUpperBounds=this.normalizationInfo[dataIndex].maxValues}this.dataset[dataIndex]=this.normalizeExamplesToRange(this.dataset[dataIndex],curLowerBounds,curUpperBounds,lowerBound,upperBound);this.normalizationInfo[dataIndex].isNormalized=true;this.normalizationInfo[dataIndex].lowerBound=lowerBound;this.normalizationInfo[dataIndex].upperBound=upperBound};InMemoryDataset.prototype.isNormalized=function(dataIndex){return this.normalizationInfo!=null&&this.normalizationInfo[dataIndex].isNormalized};InMemoryDataset.prototype.removeNormalization=function(dataIndex){if(this.dataset==null){throw new Error("Training or test data is null.")}if(!this.isNormalized(dataIndex)){return}this.dataset[dataIndex]=this.normalizeExamplesToRange(this.dataset[dataIndex],this.normalizationInfo[dataIndex].lowerBound,this.normalizationInfo[dataIndex].upperBound,this.normalizationInfo[dataIndex].minValues,this.normalizationInfo[dataIndex].maxValues);this.normalizationInfo[dataIndex].isNormalized=false};InMemoryDataset.prototype.unnormalizeExamples=function(examples,dataIndex){if(!this.isNormalized(dataIndex)){return examples}return this.normalizeExamplesToRange(examples,this.normalizationInfo[dataIndex].lowerBound,this.normalizationInfo[dataIndex].upperBound,this.normalizationInfo[dataIndex].minValues,this.normalizationInfo[dataIndex].maxValues)};InMemoryDataset.prototype.dispose=function(){if(this.dataset==null){return}for(var i=0;i<this.dataset.length;i++){for(var j=0;j<this.dataset[i].length;j++){this.dataset[i][j].dispose()}}this.dataset=[]};return InMemoryDataset}();exports.InMemoryDataset=InMemoryDataset},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=y[op[0]&2?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[0,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var seedrandom=__webpack_require__(149);var environment_1=__webpack_require__(11);var util=__webpack_require__(4);var broadcast_util=__webpack_require__(62);var concat_util=__webpack_require__(63);var math_1=__webpack_require__(60);var ndarray_1=__webpack_require__(3);var types=__webpack_require__(84);var types_1=__webpack_require__(84);var axis_util=__webpack_require__(112);var matmul_1=__webpack_require__(61);var MathBackendCPU=function(){function MathBackendCPU(){this.data={};if(typeof document!=="undefined"){this.canvas=document.createElement("canvas")}}MathBackendCPU.prototype.register=function(dataId,shape,dtype){this.data[dataId]=null};MathBackendCPU.prototype.write=function(dataId,values){if(values==null){throw new Error("MathBackendCPU.write(): values can not be null")}this.throwIfNoData(dataId);this.data[dataId]=values};MathBackendCPU.prototype.writePixels=function(dataId,pixels,numChannels){if(pixels==null){throw new Error("MathBackendCPU.writePixels(): pixels can not be null")}this.throwIfNoData(dataId);var vals;if(pixels instanceof ImageData){vals=pixels.data}else if(pixels instanceof HTMLCanvasElement){vals=pixels.getContext("2d").getImageData(0,0,pixels.width,pixels.height).data}else if(pixels instanceof HTMLImageElement||pixels instanceof HTMLVideoElement){if(this.canvas==null){throw new Error("Can't read pixels from HTMLImageElement outside "+"the browser.")}this.canvas.width=pixels.width;this.canvas.height=pixels.height;this.canvas.getContext("2d").drawImage(pixels,0,0,pixels.width,pixels.height);vals=this.canvas.getContext("2d").getImageData(0,0,pixels.width,pixels.height).data}else{throw new Error("pixels is of unknown type: "+pixels.constructor.name)}var values;if(numChannels===4){values=new Int32Array(vals)}else{var numPixels=pixels.width*pixels.height;values=new Int32Array(numPixels*numChannels);for(var i=0;i<numPixels;i++){for(var channel=0;channel<numChannels;++channel){values[i*numChannels+channel]=vals[i*4+channel]}}}this.data[dataId]=values};MathBackendCPU.prototype.read=function(dataId){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){this.throwIfNoData(dataId);return[2,this.data[dataId]]})})};MathBackendCPU.prototype.readSync=function(dataId){this.throwIfNoData(dataId);return this.data[dataId]};MathBackendCPU.prototype.disposeData=function(dataId){delete this.data[dataId]};MathBackendCPU.prototype.time=function(query){return __awaiter(this,void 0,void 0,function(){var start;return __generator(this,function(_a){start=performance.now();query();return[2,performance.now()-start]})})};MathBackendCPU.prototype.throwIfNoData=function(dataId){if(!(dataId in this.data)){throw new Error("No data found for NDArray with data id "+dataId+". "+"Use dl.ENV.math instead of constructing your own NDArrayMath. "+"If you need to construct your own math, make sure this array is "+"allocated after the math construction")}};MathBackendCPU.prototype.clone=function(x){return ndarray_1.NDArray.make(x.shape,{values:new Float32Array(x.dataSync())})};MathBackendCPU.prototype.slice1D=function(x,begin,size){var newVals=x.dataSync().slice(begin,begin+size);return ndarray_1.Array1D.new(newVals)};MathBackendCPU.prototype.slice2D=function(x,begin,size){var result=ndarray_1.Array2D.zeros(size);var startI=begin[0],startJ=begin[1];for(var i=0;i<size[0];++i){for(var j=0;j<size[1];++j){var val=x.get(i+startI,j+startJ);result.set(val,i,j)}}return result};MathBackendCPU.prototype.slice3D=function(x,begin,size){var result=ndarray_1.Array3D.zeros(size);var startI=begin[0],startJ=begin[1],startK=begin[2];for(var i=0;i<size[0];++i){for(var j=0;j<size[1];++j){for(var k=0;k<size[2];++k){var val=x.get(i+startI,j+startJ,k+startK);result.set(val,i,j,k)}}}return result};MathBackendCPU.prototype.slice4D=function(x,begin,size){var result=ndarray_1.Array4D.zeros(size);var startI=begin[0],startJ=begin[1],startK=begin[2],startL=begin[3];for(var i=0;i<size[0];++i){for(var j=0;j<size[1];++j){for(var k=0;k<size[2];++k){for(var l=0;l<size[3];++l){var val=x.get(i+startI,j+startJ,k+startK,l+startL);result.set(val,i,j,k,l)}}}}return result};MathBackendCPU.prototype.concat1D=function(a,b){var outShape=concat_util.computeOutShape(a.shape,b.shape,0);var result=ndarray_1.Array1D.zeros(outShape);var aVals=a.dataSync();var bVals=b.dataSync();var vals=result.dataSync();vals.set(aVals,0);vals.set(bVals,a.size);return result};MathBackendCPU.prototype.concat2D=function(a,b,axis){var outShape=concat_util.computeOutShape(a.shape,b.shape,axis);var result=ndarray_1.Array2D.zeros(outShape);if(axis===0){var aVals=a.dataSync();var bVals=b.dataSync();var vals=result.dataSync();vals.set(aVals,0);vals.set(bVals,a.size);return result}for(var i=0;i<outShape[0];++i){for(var j=0;j<outShape[1];++j){var index=[i,j];var value=void 0;if(index[axis]<a.shape[axis]){value=a.get(i,j)}else{index[axis]-=a.shape[axis];var i2=index[0],j2=index[1];value=b.get(i2,j2)}result.set(value,i,j)}}return result};MathBackendCPU.prototype.concat3D=function(a,b,axis){var outShape=concat_util.computeOutShape(a.shape,b.shape,axis);var result=ndarray_1.Array3D.zeros(outShape);if(axis===0){var aVals=a.dataSync();var bVals=b.dataSync();var vals=result.dataSync();vals.set(aVals,0);vals.set(bVals,a.size);return result}for(var i=0;i<outShape[0];++i){for(var j=0;j<outShape[1];++j){for(var k=0;k<outShape[2];++k){var index=[i,j,k];var value=void 0;if(index[axis]<a.shape[axis]){value=a.get(i,j,k)}else{index[axis]-=a.shape[axis];var i2=index[0],j2=index[1],k2=index[2];value=b.get(i2,j2,k2)}result.set(value,i,j,k)}}}return result};MathBackendCPU.prototype.concat4D=function(a,b,axis){var outShape=concat_util.computeOutShape(a.shape,b.shape,axis);var result=ndarray_1.Array4D.zeros(outShape);if(axis===0){var aVals=a.dataSync();var bVals=b.dataSync();var vals=result.dataSync();vals.set(aVals,0);vals.set(bVals,a.size);return result}for(var i=0;i<outShape[0];++i){for(var j=0;j<outShape[1];++j){for(var k=0;k<outShape[2];++k){for(var l=0;l<outShape[3];++l){var index=[i,j,k,l];var value=void 0;if(index[axis]<a.shape[axis]){value=a.get(i,j,k,l)}else{index[axis]-=a.shape[axis];var i2=index[0],j2=index[1],k2=index[2],l2=index[3];value=b.get(i2,j2,k2,l2)}result.set(value,i,j,k,l)}}}}return result};MathBackendCPU.prototype.neg=function(x){return this.multiply(ndarray_1.Scalar.new(-1),x)};MathBackendCPU.prototype.add=function(a,b){return this.broadcastedBinaryOp(a,b,types.upcastType(a.dtype,b.dtype),function(aValue,bValue){return aValue+bValue})};MathBackendCPU.prototype.subtract=function(a,b){return this.broadcastedBinaryOp(a,b,types.upcastType(a.dtype,b.dtype),function(aValue,bValue){return aValue-bValue})};MathBackendCPU.prototype.pow=function(a,b){return this.broadcastedBinaryOp(a,b,a.dtype,function(aValue,bValue){return Math.pow(aValue,bValue)})};MathBackendCPU.prototype.matMul=function(a,b,aOrientation,bOrientation){if(aOrientation===void 0){aOrientation=matmul_1.MatrixOrientation.REGULAR}if(bOrientation===void 0){bOrientation=matmul_1.MatrixOrientation.REGULAR}var sharedDim=aOrientation===matmul_1.MatrixOrientation.REGULAR?a.shape[1]:a.shape[0];var leftDim=aOrientation===matmul_1.MatrixOrientation.REGULAR?a.shape[0]:a.shape[1];var rightDim=bOrientation===matmul_1.MatrixOrientation.REGULAR?b.shape[1]:b.shape[0];var normalGetter=function(matrix,i,j){return matrix.get(i,j)};var transposedGetter=function(matrix,i,j){return matrix.get(j,i)};var aGetter=aOrientation===matmul_1.MatrixOrientation.REGULAR?normalGetter:transposedGetter;var bGetter=bOrientation===matmul_1.MatrixOrientation.REGULAR?normalGetter:transposedGetter;var values=new Float32Array(leftDim*rightDim);var index=0;for(var i=0;i<leftDim;++i){for(var j=0;j<rightDim;++j){var sum=0;for(var k=0;k<sharedDim;++k){sum+=aGetter(a,i,k)*bGetter(b,k,j)}values[index++]=sum}}return ndarray_1.Array2D.new([leftDim,rightDim],values)};MathBackendCPU.prototype.multiply=function(a,b){return this.broadcastedBinaryOp(a,b,types.upcastType(a.dtype,b.dtype),function(aValue,bValue){return aValue*bValue})};MathBackendCPU.prototype.divide=function(a,b){return this.broadcastedBinaryOp(a,b,"float32",function(aValue,bValue){return aValue/bValue})};MathBackendCPU.prototype.sum=function(x,axes){axis_util.assertAxesAreInnerMostDims("sum",axes,x.rank);var _a=axis_util.computeOutAndReduceShapes(x.shape,axes),outShape=_a[0],reduceShape=_a[1];var resultDtype=types_1.SumTypesMap[x.dtype];var result=ndarray_1.NDArray.zeros(outShape,resultDtype);var reduceSize=util.sizeFromShape(reduceShape);var vals=result.dataSync();var aVals=x.dataSync();for(var i=0;i<vals.length;++i){var offset=i*reduceSize;var sum=0;for(var j=0;j<reduceSize;++j){sum+=aVals[offset+j]}vals[i]=sum}return result};MathBackendCPU.prototype.argMin=function(x,axes){axis_util.assertAxesAreInnerMostDims("argMin",axes,x.rank);var _a=axis_util.computeOutAndReduceShapes(x.shape,axes),outShape=_a[0],reduceShape=_a[1];var result=ndarray_1.NDArray.zeros(outShape,"int32");var reduceSize=util.sizeFromShape(reduceShape);var vals=result.dataSync();var aVals=x.dataSync();for(var i=0;i<vals.length;++i){var offset=i*reduceSize;var min=aVals[offset];var minIndex=0;for(var j=0;j<reduceSize;++j){var value=aVals[offset+j];if(isNaN(value)){minIndex=util.NAN_INT32;break}if(value<min){min=value;minIndex=j}}vals[i]=minIndex}return result};MathBackendCPU.prototype.argMax=function(x,axes){axis_util.assertAxesAreInnerMostDims("argMax",axes,x.rank);var _a=axis_util.computeOutAndReduceShapes(x.shape,axes),outShape=_a[0],reduceShape=_a[1];var result=ndarray_1.NDArray.zeros(outShape,"int32");var reduceSize=util.sizeFromShape(reduceShape);var vals=result.dataSync();var aVals=x.dataSync();for(var i=0;i<vals.length;++i){var offset=i*reduceSize;var max=aVals[offset];var maxIndex=0;for(var j=0;j<reduceSize;++j){var value=aVals[offset+j];if(isNaN(value)){maxIndex=util.NAN_INT32;break}if(value>max){max=value;maxIndex=j}}vals[i]=maxIndex}return result};MathBackendCPU.prototype.equal=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",function(aVal,bVal){if(util.isValNaN(aVal,a.dtype)||util.isValNaN(bVal,b.dtype)){return util.getNaN("bool")}else{return aVal===bVal?1:0}})};MathBackendCPU.prototype.notEqual=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",function(aVal,bVal){if(util.isValNaN(aVal,a.dtype)||util.isValNaN(bVal,b.dtype)){return util.getNaN("bool")}else{return aVal!==bVal?1:0}})};MathBackendCPU.prototype.topKValues=function(x,k){return this.topK(x,k).values};MathBackendCPU.prototype.topKIndices=function(x,k){return this.topK(x,k).indices};MathBackendCPU.prototype.topK=function(x,k){var values=x.dataSync();var valuesAndIndices=[];for(var i=0;i<values.length;i++){valuesAndIndices.push({value:values[i],index:i})}valuesAndIndices.sort(function(a,b){return b.value-a.value});var topkValues=util.getTypedArrayFromDType(x.dtype,k);var topkIndices=new Int32Array(k);for(var i=0;i<k;i++){topkValues[i]=valuesAndIndices[i].value;topkIndices[i]=valuesAndIndices[i].index}return{values:ndarray_1.Array1D.new(topkValues),indices:ndarray_1.Array1D.new(topkIndices)}};MathBackendCPU.prototype.min=function(x,axes){axis_util.assertAxesAreInnerMostDims("min",axes,x.rank);var _a=axis_util.computeOutAndReduceShapes(x.shape,axes),outShape=_a[0],reduceShape=_a[1];var result=ndarray_1.NDArray.zeros(outShape,x.dtype);var reduceSize=util.sizeFromShape(reduceShape);var vals=result.dataSync();var aVals=x.dataSync();for(var i=0;i<vals.length;++i){var offset=i*reduceSize;var min=aVals[0];for(var j=0;j<reduceSize;++j){var value=aVals[offset+j];if(isNaN(value)){min=Number.NaN;break}if(value<min){min=value}}vals[i]=min}return result};MathBackendCPU.prototype.minimum=function(a,b){return this.broadcastedBinaryOp(a,b,a.dtype,function(aVal,bVal){return Math.min(aVal,bVal)})};MathBackendCPU.prototype.max=function(x,axes){axis_util.assertAxesAreInnerMostDims("max",axes,x.rank);var _a=axis_util.computeOutAndReduceShapes(x.shape,axes),outShape=_a[0],reduceShape=_a[1];var result=ndarray_1.NDArray.zeros(outShape,x.dtype);var reduceSize=util.sizeFromShape(reduceShape);var vals=result.dataSync();var aVals=x.dataSync();for(var i=0;i<vals.length;++i){var offset=i*reduceSize;var max=aVals[offset];for(var j=0;j<reduceSize;++j){var value=aVals[offset+j];if(isNaN(value)){max=Number.NaN;break}if(value>max){max=value}}vals[i]=max}return result};MathBackendCPU.prototype.maximum=function(a,b){return this.broadcastedBinaryOp(a,b,a.dtype,function(aVal,bVal){return Math.max(aVal,bVal)})};MathBackendCPU.prototype.ceil=function(x){var values=x.dataSync();var newValues=new Float32Array(values.length);for(var i=0;i<values.length;++i){newValues[i]=Math.ceil(values[i])}return ndarray_1.NDArray.make(x.shape,{values:newValues})};MathBackendCPU.prototype.floor=function(x){var values=x.dataSync();var newValues=new Float32Array(values.length);for(var i=0;i<values.length;++i){newValues[i]=Math.floor(values[i])}return ndarray_1.NDArray.make(x.shape,{values:newValues})};MathBackendCPU.prototype.exp=function(x){var values=x.dataSync();var newValues=new Float32Array(values.length);for(var i=0;i<values.length;++i){newValues[i]=Math.exp(values[i])}return ndarray_1.NDArray.make(x.shape,{values:newValues})};MathBackendCPU.prototype.log=function(x){var values=x.dataSync();var newValues=new Float32Array(values.length);for(var i=0;i<values.length;++i){var value=values[i];newValues[i]=Math.log(value)}return ndarray_1.NDArray.make(x.shape,{values:newValues})};MathBackendCPU.prototype.sqrt=function(x){var values=x.dataSync();var newValues=new Float32Array(values.length);for(var i=0;i<values.length;++i){var value=values[i];newValues[i]=Math.sqrt(value)}return ndarray_1.NDArray.make(x.shape,{values:newValues})};MathBackendCPU.prototype.square=function(x){var values=x.dataSync();var newValues=new Float32Array(values.length);for(var i=0;i<values.length;++i){var value=values[i];newValues[i]=value*value}return ndarray_1.NDArray.make(x.shape,{values:newValues})};MathBackendCPU.prototype.relu=function(x){var res=ndarray_1.NDArray.zeros(x.shape,x.dtype);var resVals=res.dataSync();var inVals=x.dataSync();for(var i=0;i<inVals.length;++i){var val=inVals[i];if(util.isValNaN(val,x.dtype)){resVals[i]=util.getNaN(res.dtype)}else{resVals[i]=Math.max(0,inVals[i])}}return res};MathBackendCPU.prototype.elu=function(x){var resultValues=new Float32Array(x.size);var values=x.dataSync();for(var i=0;i<values.length;++i){var v=values[i];if(v>=0){resultValues[i]=v}else{resultValues[i]=Math.exp(v)-1}}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.eluDer=function(x){var resultValues=new Float32Array(x.size);var values=x.dataSync();for(var i=0;i<values.length;++i){var v=values[i];if(v>=0){resultValues[i]=1}else{resultValues[i]=Math.exp(v)}}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.selu=function(x){var scaleAlpha=1.7580993408473768;var scale=1.0507009873554805;var resultValues=new Float32Array(x.size);var values=x.dataSync();for(var i=0;i<values.length;++i){var v=values[i];if(v>=0){resultValues[i]=scale*v}else{resultValues[i]=scaleAlpha*(Math.exp(v)-1)}}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.leakyRelu=function(x,alpha){var resultValues=new Float32Array(x.size);var values=x.dataSync();for(var i=0;i<values.length;i++){var v=values[i];if(v>=0){resultValues[i]=v}else{resultValues[i]=alpha*v}}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.prelu=function(x,alpha){var resultValues=new Float32Array(x.size);var values=x.dataSync();var alphas=alpha.dataSync();for(var i=0;i<values.length;i++){var v=values[i];if(v>=0){resultValues[i]=v}else{resultValues[i]=alphas[i]*v}}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.preluDer=function(x,alpha){var resultValues=new Float32Array(x.size);var values=x.dataSync();var alphas=alpha.dataSync();for(var i=0;i<values.length;i++){var v=values[i];if(v>0){resultValues[i]=1}else if(v<0){resultValues[i]=alphas[i]}else{resultValues[i]=v}}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.clip=function(x,min,max){var resultValues=new Float32Array(x.size);var values=x.dataSync();for(var i=0;i<values.length;++i){resultValues[i]=Math.min(max,Math.max(min,values[i]))}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.abs=function(x){var resultValues=new Float32Array(x.size);var values=x.dataSync();for(var i=0;i<values.length;++i){resultValues[i]=Math.abs(values[i])}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.int=function(x){var resultValues=new Int32Array(x.size);var values=x.dataSync();for(var i=0;i<values.length;++i){resultValues[i]=values[i]}return ndarray_1.NDArray.make(x.shape,{values:resultValues},"int32")};MathBackendCPU.prototype.sigmoid=function(x){var resultValues=new Float32Array(x.size);var values=x.dataSync();for(var i=0;i<values.length;++i){resultValues[i]=1/(1+Math.exp(-values[i]))}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.sin=function(x){var resultValues=new Float32Array(x.size);var values=x.dataSync();for(var i=0;i<values.length;++i){resultValues[i]=Math.sin(values[i])}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.cos=function(x){var resultValues=new Float32Array(x.size);var values=x.dataSync();for(var i=0;i<values.length;++i){resultValues[i]=Math.cos(values[i])}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.tan=function(x){var resultValues=new Float32Array(x.size);var values=x.dataSync();for(var i=0;i<values.length;++i){resultValues[i]=Math.tan(values[i])}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.asin=function(x){var resultValues=new Float32Array(x.size);var values=x.dataSync();for(var i=0;i<values.length;++i){resultValues[i]=Math.asin(values[i])}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.acos=function(x){var resultValues=new Float32Array(x.size);var values=x.dataSync();for(var i=0;i<values.length;++i){resultValues[i]=Math.acos(values[i])}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.atan=function(x){var resultValues=new Float32Array(x.size);var values=x.dataSync();for(var i=0;i<values.length;++i){resultValues[i]=Math.atan(values[i])}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.sinh=function(x){var resultValues=new Float32Array(x.size);var values=x.dataSync();for(var i=0;i<values.length;++i){resultValues[i]=Math.sinh(values[i])}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.cosh=function(x){var resultValues=new Float32Array(x.size);var values=x.dataSync();for(var i=0;i<values.length;++i){resultValues[i]=Math.cosh(values[i])}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.tanh=function(x){var resultValues=new Float32Array(x.size);var values=x.dataSync();for(var i=0;i<values.length;++i){resultValues[i]=util.tanh(values[i])}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.step=function(x,alpha){if(alpha===void 0){alpha=0}var resultValues=new Float32Array(x.size);var values=x.dataSync();for(var i=0;i<values.length;++i){var value=values[i];if(util.isValNaN(value,x.dtype)){resultValues[i]=util.getNaN(x.dtype)}else{resultValues[i]=value>0?1:alpha}}return ndarray_1.NDArray.make(x.shape,{values:resultValues})};MathBackendCPU.prototype.conv2d=function(x,filter,bias,convInfo){var filterHeight=convInfo.filterHeight;var filterWidth=convInfo.filterWidth;var padLeft=convInfo.padInfo.left;var padTop=convInfo.padInfo.top;var y=ndarray_1.Array4D.zeros(convInfo.outShape);for(var b=0;b<convInfo.batchSize;++b){for(var d2=0;d2<convInfo.outChannels;++d2){for(var yR=0;yR<convInfo.outHeight;++yR){var xRCorner=yR*convInfo.strideHeight-padLeft;var xRMin=Math.max(0,xRCorner);var xRMax=Math.min(convInfo.inHeight,filterHeight+xRCorner);for(var yC=0;yC<convInfo.outWidth;++yC){var xCCorner=yC*convInfo.strideWidth-padTop;var xCMin=Math.max(0,xCCorner);var xCMax=Math.min(convInfo.inWidth,filterWidth+xCCorner);var dotProd=0;for(var xR=xRMin;xR<xRMax;++xR){var wR=xR-xRCorner;for(var xC=xCMin;xC<xCMax;++xC){var wC=xC-xCCorner;for(var d1=0;d1<convInfo.inChannels;++d1){var pixel=x.get(b,xR,xC,d1);var weight=filter.get(wR,wC,d1,d2);dotProd+=pixel*weight}}}var biasVal=bias!=null?bias.get(d2):0;y.set(dotProd+biasVal,b,yR,yC,d2)}}}}return y};MathBackendCPU.prototype.conv2dDerInput=function(dy,filter,convInfo){var filterHeight=convInfo.filterHeight;var filterWidth=convInfo.filterWidth;var topPad=filterHeight-1-convInfo.padInfo.top;var leftPad=filterWidth-1-convInfo.padInfo.left;var strideHeight=convInfo.strideHeight;var strideWidth=convInfo.strideWidth;var dx=ndarray_1.Array4D.zeros(convInfo.inShape);for(var b=0;b<convInfo.batchSize;++b){for(var d1=0;d1<convInfo.inChannels;++d1){for(var xR=0;xR<convInfo.inHeight;++xR){var xRCorner=xR-leftPad;var xRMin=Math.max(0,Math.ceil(xRCorner/strideHeight));var yRMax=Math.min(convInfo.outHeight,(filterHeight+xRCorner)/strideHeight);for(var xC=0;xC<convInfo.inWidth;++xC){var xCCorner=xC-topPad;var xCMin=Math.max(0,Math.ceil(xCCorner/strideWidth));var yCMax=Math.min(convInfo.outWidth,(filterWidth+xCCorner)/strideWidth);var dotProd=0;for(var yR=xRMin;yR<yRMax;++yR){var wR=yR*strideHeight-xRCorner;for(var yC=xCMin;yC<yCMax;++yC){var wC=yC*strideWidth-xCCorner;for(var d2=0;d2<convInfo.outChannels;++d2){var pixel=dy.get(b,yR,yC,d2);var weight=filter.get(filterHeight-1-wR,filterWidth-1-wC,d1,d2);dotProd+=pixel*weight}}}dx.set(dotProd,b,xR,xC,d1)}}}}return dx};MathBackendCPU.prototype.conv2dDerFilter=function(x,dy,convInfo){var strideHeight=convInfo.strideHeight;var strideWidth=convInfo.strideWidth;var filterHeight=convInfo.filterHeight;var filterWidth=convInfo.filterWidth;var dW=ndarray_1.Array4D.zeros(convInfo.filterShape);var leftPad=convInfo.padInfo.left;var topPad=convInfo.padInfo.top;for(var wR=0;wR<filterHeight;++wR){var yRMin=Math.max(0,Math.ceil((topPad-wR)/strideHeight));var yRMax=Math.min(convInfo.outHeight,(convInfo.inHeight+topPad-wR)/strideHeight);for(var wC=0;wC<filterWidth;++wC){var yCMin=Math.max(0,Math.ceil((leftPad-wC)/strideWidth));var yCMax=Math.min(convInfo.outWidth,(convInfo.inWidth+leftPad-wC)/strideWidth);for(var d1=0;d1<convInfo.inChannels;++d1){for(var d2=0;d2<convInfo.outChannels;++d2){var dotProd=0;for(var b=0;b<convInfo.batchSize;++b){for(var yR=yRMin;yR<yRMax;++yR){var xR=wR+yR*strideHeight-topPad;for(var yC=yCMin;yC<yCMax;++yC){var xC=wC+yC*strideWidth-leftPad;dotProd+=x.get(b,xR,xC,d1)*dy.get(b,yR,yC,d2)}}}dW.set(dotProd,wR,wC,d1,d2)}}}}return dW};MathBackendCPU.prototype.conv2dDerBias=function(dy){var _a=dy.shape,batchSize=_a[0],numRows=_a[1],numCols=_a[2],outDepth=_a[3];var values=new Float32Array(outDepth);for(var d2=0;d2<outDepth;++d2){var sum=0;for(var b=0;b<batchSize;++b){for(var r=0;r<numRows;++r){for(var c=0;c<numCols;++c){sum+=dy.get(b,r,c,d2)}}}values[d2]=sum}return ndarray_1.Array1D.new(values)};MathBackendCPU.prototype.depthwiseConv2D=function(x,filter,convInfo){var filterHeight=convInfo.filterHeight;var filterWidth=convInfo.filterWidth;var padLeft=convInfo.padInfo.left;var padTop=convInfo.padInfo.top;var chMul=convInfo.outChannels/convInfo.inChannels;var y=ndarray_1.Array4D.zeros(convInfo.outShape);for(var b=0;b<convInfo.batchSize;++b){for(var d1=0;d1<convInfo.inChannels;++d1){for(var yR=0;yR<convInfo.outHeight;++yR){var xRCorner=yR*convInfo.strideHeight-padLeft;var xRMin=Math.max(0,xRCorner);var xRMax=Math.min(convInfo.inHeight,filterHeight+xRCorner);for(var yC=0;yC<convInfo.outWidth;++yC){var xCCorner=yC*convInfo.strideWidth-padTop;var xCMin=Math.max(0,xCCorner);var xCMax=Math.min(convInfo.inWidth,filterWidth+xCCorner);for(var q=0;q<chMul;++q){var dotProd=0;for(var xR=xRMin;xR<xRMax;++xR){var wR=xR-xRCorner;for(var xC=xCMin;xC<xCMax;++xC){var wC=xC-xCCorner;var pixel=x.get(b,xR,xC,d1);var weight=filter.get(wR,wC,d1,q);dotProd+=pixel*weight}}y.set(dotProd,b,yR,yC,d1*chMul+q)}}}}}return y};MathBackendCPU.prototype.tile=function(x,reps){var newShape=new Array(x.rank);for(var i=0;i<newShape.length;i++){newShape[i]=x.shape[i]*reps[i]}var dtype;if(x.dtype==="float32"){dtype=Float32Array}else if(x.dtype==="int32"){dtype=Int32Array}else if(x.dtype==="bool"){dtype=Uint8Array}else{throw new Error("Dtype "+x.dtype+" not supported for tile")}var resultValues=new dtype(util.sizeFromShape(newShape));var result=ndarray_1.NDArray.make(newShape,{values:resultValues},x.dtype);var values=x.dataSync();for(var i=0;i<result.size;++i){var newLoc=result.indexToLoc(i);var originalLoc=new Array(x.rank);for(var i_1=0;i_1<originalLoc.length;i_1++){originalLoc[i_1]=newLoc[i_1]%x.shape[i_1]}var originalIndex=x.locToIndex(originalLoc);resultValues[i]=values[originalIndex]}return result};MathBackendCPU.prototype.transpose=function(x,perm){var newShape=new Array(x.rank);for(var i=0;i<newShape.length;i++){newShape[i]=x.shape[perm[i]]}var resultValues=new Float32Array(x.size);var values=x.dataSync();var result=ndarray_1.NDArray.make(newShape,{values:resultValues});for(var i=0;i<x.size;++i){var loc=x.indexToLoc(i);var newLoc=new Array(loc.length);for(var i_2=0;i_2<newLoc.length;i_2++){newLoc[i_2]=loc[perm[i_2]]}var newIndex=result.locToIndex(newLoc);resultValues[newIndex]=values[i]}return result};MathBackendCPU.prototype.pool=function(x,convInfo,poolType){var strideHeight=convInfo.strideHeight;var strideWidth=convInfo.strideWidth;var filterHeight=convInfo.filterHeight;var filterWidth=convInfo.filterWidth;var y=ndarray_1.Array4D.zeros(convInfo.outShape);var padTop=convInfo.padInfo.top;var padLeft=convInfo.padInfo.left;for(var b=0;b<convInfo.batchSize;++b){for(var d=0;d<convInfo.inChannels;++d){for(var yR=0;yR<convInfo.outHeight;++yR){var xRCorner=yR*strideHeight-padTop;var xRMin=Math.max(0,xRCorner);var xRMax=Math.min(convInfo.inHeight,filterHeight+xRCorner);for(var yC=0;yC<convInfo.outWidth;++yC){var xCCorner=yC*strideWidth-padLeft;var xCMin=Math.max(0,xCCorner);var xCMax=Math.min(convInfo.inWidth,filterWidth+xCCorner);var minMaxValue=poolType==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY;var avgValue=0;for(var xR=xRMin;xR<xRMax;++xR){for(var xC=xCMin;xC<xCMax;++xC){var pixel=x.get(b,xR,xC,d);if(isNaN(pixel)){minMaxValue=NaN;avgValue=NaN;break}if(poolType==="max"&&pixel>minMaxValue||poolType==="min"&&pixel<minMaxValue){minMaxValue=pixel}else if(poolType==="avg"){avgValue+=pixel/(filterHeight*filterWidth)}}if(isNaN(minMaxValue)){break}}y.set(poolType==="avg"?avgValue:minMaxValue,b,yR,yC,d)}}}}return y};MathBackendCPU.prototype.maxPool=function(x,convInfo){return this.pool(x,convInfo,"max")};MathBackendCPU.prototype.maxPoolPositions=function(x,convInfo){var maxPositions=ndarray_1.Array4D.zeros(convInfo.outShape);var strideHeight=convInfo.strideHeight;var strideWidth=convInfo.strideWidth;var filterHeight=convInfo.filterHeight;var filterWidth=convInfo.filterWidth;var padTop=convInfo.padInfo.top;var padLeft=convInfo.padInfo.left;for(var b=0;b<convInfo.batchSize;++b){for(var d=0;d<convInfo.inChannels;++d){for(var yR=0;yR<convInfo.outHeight;++yR){var xRCorner=yR*strideHeight-padTop;var xRMin=Math.max(0,xRCorner);var xRMax=Math.min(convInfo.inHeight,filterHeight+xRCorner);for(var yC=0;yC<convInfo.outWidth;++yC){var xCCorner=yC*strideWidth-padLeft;var xCMin=Math.max(0,xCCorner);var xCMax=Math.min(convInfo.inWidth,filterWidth+xCCorner);var maxValue=Number.NEGATIVE_INFINITY;var maxPosition=-1;for(var xR=xRMin;xR<xRMax;++xR){var wR=xR-xRCorner;for(var xC=xCMin;xC<xCMax;++xC){var wC=xC-xCCorner;var pixel=x.get(b,xR,xC,d);if(pixel>maxValue){maxValue=pixel;maxPosition=wR*filterWidth+wC}}}maxPositions.set(maxPosition,b,yR,yC,d)}}}}return maxPositions};MathBackendCPU.prototype.maxPoolBackprop=function(dy,x,convInfo){var maxPositions=this.maxPoolPositions(x,convInfo);var strideHeight=convInfo.strideHeight;var strideWidth=convInfo.strideWidth;var filterHeight=convInfo.filterHeight;var filterWidth=convInfo.filterWidth;var padLeft=filterWidth-1-convInfo.padInfo.left;var padTop=filterHeight-1-convInfo.padInfo.top;var dx=ndarray_1.Array4D.zeros(x.shape);for(var b=0;b<convInfo.batchSize;++b){for(var d=0;d<convInfo.inChannels;++d){for(var dxR=0;dxR<convInfo.inHeight;++dxR){for(var dxC=0;dxC<convInfo.inWidth;++dxC){var dyRCorner=dxR-padTop;var dyCCorner=dxC-padLeft;var dotProd=0;for(var wR=0;wR<filterHeight;++wR){var dyR=(dyRCorner+wR)/strideHeight;if(dyR<0||dyR>=convInfo.outHeight||Math.floor(dyR)!==dyR){continue}for(var wC=0;wC<filterWidth;++wC){var dyC=(dyCCorner+wC)/strideWidth;if(dyC<0||dyC>=convInfo.outWidth||Math.floor(dyC)!==dyC){continue}var maxPos=filterHeight*filterWidth-1-maxPositions.get(b,dyR,dyC,d);var curPos=wR*filterWidth+wC;var mask=maxPos===curPos?1:0;if(mask===0){continue}var pixel=dy.get(b,dyR,dyC,d);dotProd+=pixel*mask}}dx.set(dotProd,b,dxR,dxC,d)}}}}return dx};MathBackendCPU.prototype.minPool=function(x,convInfo){return this.pool(x,convInfo,"min")};MathBackendCPU.prototype.avgPool=function(x,convInfo){return this.pool(x,convInfo,"avg")};MathBackendCPU.prototype.resizeBilinear3D=function(x,newShape2D,alignCorners){var output=ndarray_1.Array3D.zeros([newShape2D[0],newShape2D[1],x.shape[2]]);var effectiveInputSize=alignCorners?[x.shape[0]-1,x.shape[1]-1,x.shape[2]]:x.shape;var effectiveOutputSize=alignCorners?[output.shape[0]-1,output.shape[1]-1,output.shape[2]]:output.shape;for(var r=0;r<output.shape[0];r++){for(var c=0;c<output.shape[1];c++){for(var d=0;d<output.shape[2];d++){var sourceFracRow=effectiveInputSize[0]*r/effectiveOutputSize[0];var sourceFracCol=effectiveInputSize[1]*c/effectiveOutputSize[1];var sourceRowFloor=Math.floor(sourceFracRow);var sourceRowCeil=Math.min(x.shape[0]-1,Math.ceil(sourceFracRow));var sourceColFloor=Math.floor(sourceFracCol);var sourceColCeil=Math.min(x.shape[1]-1,Math.ceil(sourceFracCol));var topLeft=x.get(sourceRowFloor,sourceColFloor,d);var bottomLeft=x.get(sourceRowCeil,sourceColFloor,d);var topRight=x.get(sourceRowFloor,sourceColCeil,d);var bottomRight=x.get(sourceRowCeil,sourceColCeil,d);var rowFrac=sourceFracRow-sourceRowFloor;var colFrac=sourceFracCol-sourceColFloor;var top_1=topLeft+(topRight-topLeft)*colFrac;var bottom=bottomLeft+(bottomRight-bottomLeft)*colFrac;var newValue=top_1+(bottom-top_1)*rowFrac;output.set(newValue,r,c,d)}}}return output};MathBackendCPU.prototype.batchNormalization2D=function(x,mean,variance,varianceEpsilon,scale,offset){var xValues=x.dataSync();var meanValues=mean.dataSync();var varianceValues=variance.dataSync();var scaleValues=scale?scale.dataSync():[1];var offsetValues=offset?offset.dataSync():[0];var outValues=new Float32Array(xValues.length);for(var i=0;i<xValues.length;i++){outValues[i]=offsetValues[i%offsetValues.length]+(xValues[i]-meanValues[i%meanValues.length])*scaleValues[i%scaleValues.length]/Math.sqrt(varianceValues[i%varianceValues.length]+varianceEpsilon)}return ndarray_1.Array2D.new(x.shape,outValues)};MathBackendCPU.prototype.batchNormalization3D=function(x,mean,variance,varianceEpsilon,scale,offset){var xValues=x.dataSync();var meanValues=mean.dataSync();var varianceValues=variance.dataSync();var scaleValues=scale?scale.dataSync():[1];var offsetValues=offset?offset.dataSync():[0];var outValues=new Float32Array(xValues.length);for(var i=0;i<xValues.length;i++){outValues[i]=offsetValues[i%offsetValues.length]+(xValues[i]-meanValues[i%meanValues.length])*scaleValues[i%scaleValues.length]/Math.sqrt(varianceValues[i%varianceValues.length]+varianceEpsilon)}return ndarray_1.Array3D.new(x.shape,outValues)};MathBackendCPU.prototype.batchNormalization4D=function(x,mean,variance,varianceEpsilon,scale,offset){var xValues=x.dataSync();var meanValues=mean.dataSync();var varianceValues=variance.dataSync();var scaleValues=scale?scale.dataSync():new Float32Array([1]);var offsetValues=offset?offset.dataSync():new Float32Array([0]);var outValues=new Float32Array(xValues.length);for(var i=0;i<xValues.length;i++){outValues[i]=offsetValues[i%offsetValues.length]+(xValues[i]-meanValues[i%meanValues.length])*scaleValues[i%scaleValues.length]/Math.sqrt(varianceValues[i%varianceValues.length]+varianceEpsilon)}return ndarray_1.Array4D.new(x.shape,outValues)};MathBackendCPU.prototype.multinomial=function(probabilities,numSamples,seed){var batchSize=probabilities.shape[0];var numEvents=probabilities.shape[1];var res=ndarray_1.Array2D.zeros([batchSize,numSamples],"int32");var resVals=res.dataSync();var probVals=probabilities.dataSync();for(var b=0;b<batchSize;++b){var offset=b*numEvents;var cdf=new Float32Array(numEvents-1);cdf[0]=probVals[offset];for(var event_1=1;event_1<cdf.length;++event_1){cdf[event_1]=cdf[event_1-1]+probVals[offset+event_1]}var random=seedrandom.alea(seed.toString());var outOffset=b*numSamples;for(var sampleId=0;sampleId<numSamples;++sampleId){var r=random();resVals[outOffset+sampleId]=cdf.length;for(var event_2=0;event_2<cdf.length;event_2++){if(r<cdf[event_2]){resVals[outOffset+sampleId]=event_2;break}}}}return res};MathBackendCPU.prototype.oneHot=function(indices,depth,onValue,offValue){var res=new Float32Array(indices.size*depth);res.fill(offValue);for(var event_3=0;event_3<indices.size;++event_3){res[event_3*depth+indices.get(event_3)]=onValue}return ndarray_1.Array2D.new([indices.size,depth],res)};MathBackendCPU.prototype.broadcastedBinaryOp=function(a,b,dtype,op){var newShape=broadcast_util.assertAndGetBroadcastShape(a.shape,b.shape);var result=ndarray_1.NDArray.zeros(newShape,dtype);var newValues=result.dataSync();var aValues=a.dataSync();var bValues=b.dataSync();var aBroadcastDims=broadcast_util.getBroadcastDims(a.shape,newShape);var bBroadcastDims=broadcast_util.getBroadcastDims(b.shape,newShape);var _loop_1=function(i){var loc=result.indexToLoc(i);var aLoc=loc.slice(-a.rank);aBroadcastDims.forEach(function(d){return aLoc[d]=0});var aIndex=a.locToIndex(aLoc);var bLoc=loc.slice(-b.rank);bBroadcastDims.forEach(function(d){return bLoc[d]=0});var bIndex=b.locToIndex(bLoc);newValues[i]=op(aValues[aIndex],bValues[bIndex])};for(var i=0;i<newValues.length;++i){_loop_1(i)}return result};MathBackendCPU.prototype.dispose=function(){};return MathBackendCPU}();exports.MathBackendCPU=MathBackendCPU;environment_1.ENV.registerBackend("cpu",function(){return new MathBackendCPU});var NDArrayMathCPU=function(_super){__extends(NDArrayMathCPU,_super);function NDArrayMathCPU(safeMode){if(safeMode===void 0){safeMode=false}var _this=this;console.warn("new NDArrayMathCPU() is deprecated. Please use the global "+"dl.ENV.math. In rare cases, to construct your own NDArrayMath "+"that runs on CPU, use math = new NDArrayMath('cpu', safeMode); "+"and make sure to set it as global: dl.ENV.setMath(math);");_this=_super.call(this,"cpu",safeMode)||this;environment_1.ENV.setMath(_this);return _this}return NDArrayMathCPU}(math_1.NDArrayMath);exports.NDArrayMathCPU=NDArrayMathCPU},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=y[op[0]&2?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[0,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var environment_1=__webpack_require__(11);var util=__webpack_require__(4);var axis_util=__webpack_require__(112);var math_1=__webpack_require__(60);var ndarray_1=__webpack_require__(3);var reduce_util=__webpack_require__(382);var types=__webpack_require__(84);var types_1=__webpack_require__(84);var argminmax_gpu_1=__webpack_require__(383);var batchnorm_gpu_1=__webpack_require__(384);var binaryop_gpu=__webpack_require__(153);var binaryop_gpu_1=__webpack_require__(153);var clip_gpu_1=__webpack_require__(385);var concat_gpu_1=__webpack_require__(386);var conv_backprop_gpu_1=__webpack_require__(387);var conv_gpu_1=__webpack_require__(388);var conv_gpu_depthwise_1=__webpack_require__(389);var copy_gpu_1=__webpack_require__(390);var gpgpu_context_1=__webpack_require__(154);var gpgpu_math=__webpack_require__(391);var gpgpu_util=__webpack_require__(113);var max_pool_backprop_gpu_1=__webpack_require__(392);var mulmat_gpu_1=__webpack_require__(393);var multinomial_gpu_1=__webpack_require__(394);var onehot_gpu_1=__webpack_require__(395);var pool_gpu_1=__webpack_require__(396);var reduce_gpu_1=__webpack_require__(397);var resize_bilinear_gpu_1=__webpack_require__(398);var slice_gpu_1=__webpack_require__(399);var tex_util_1=__webpack_require__(65);var texture_manager_1=__webpack_require__(400);var tile_gpu_1=__webpack_require__(401);var transpose_gpu_1=__webpack_require__(402);var unary_op=__webpack_require__(155);var unaryop_gpu_1=__webpack_require__(155);var webgl_util=__webpack_require__(66);var MathBackendWebGL=function(){function MathBackendWebGL(gpgpu,delayedStorage){if(delayedStorage===void 0){delayedStorage=true}this.gpgpu=gpgpu;this.delayedStorage=delayedStorage;this.texData={};this.binaryCache={};if(environment_1.ENV.get("WEBGL_VERSION")<1){throw new Error("WebGL is not supported on this device")}if(gpgpu==null){var gl=gpgpu_util.createWebGLContext();this.gpgpu=new gpgpu_context_1.GPGPUContext(gl);this.gpgpuCreatedLocally=true}else{this.gpgpuCreatedLocally=false}if(typeof document!=="undefined"){this.canvas=document.createElement("canvas")}this.textureManager=new texture_manager_1.TextureManager(this.gpgpu)}MathBackendWebGL.prototype.register=function(dataId,shape,dtype){if(dataId in this.texData){throw new Error("data id "+dataId+" already registered")}this.texData[dataId]={shape:shape,dtype:dtype,values:null,texture:null,texShape:null,textureType:null}};MathBackendWebGL.prototype.writePixels=function(dataId,pixels,numChannels){if(pixels==null){throw new Error("MathBackendWebGL.writePixels(): pixels can not be null")}this.throwIfNoData(dataId);var texShape=[pixels.height,pixels.width];var texture=this.texData[dataId].texture||this.textureManager.acquireTexture(texShape);var shape=this.texData[dataId].shape;this.texData[dataId]={shape:shape,values:null,texture:texture,textureType:tex_util_1.TextureType.RGBA_COLOR,texShape:texShape,numChannels:numChannels,dtype:"int32"};if(pixels instanceof HTMLVideoElement){if(this.canvas==null){throw new Error("Can't read pixels from HTMLImageElement outside "+"the browser.")}this.canvas.width=pixels.width;this.canvas.height=pixels.height;this.canvas.getContext("2d").drawImage(pixels,0,0,pixels.width,pixels.height);pixels=this.canvas}this.gpgpu.uploadPixelDataToTexture(texture,pixels)};MathBackendWebGL.prototype.write=function(dataId,values){if(values==null){throw new Error("MathBackendWebGL.write(): values can not be null")}this.throwIfNoData(dataId);var _a=this.texData[dataId],texture=_a.texture,texShape=_a.texShape;if(texture!=null){this.textureManager.releaseTexture(texture,texShape);this.texData[dataId].texture=null;this.texData[dataId].texShape=null;this.texData[dataId].textureType=null}this.texData[dataId].values=values;if(!this.delayedStorage){this.uploadToGPU(dataId)}};MathBackendWebGL.prototype.readSync=function(dataId){this.throwIfNoData(dataId);var _a=this.texData[dataId],texture=_a.texture,values=_a.values,textureType=_a.textureType,texShape=_a.texShape,numChannels=_a.numChannels;if(values!=null){this.cacheOnCPU(dataId);return values}var float32Values;if(textureType===tex_util_1.TextureType.DEFAULT){float32Values=this.gpgpu.downloadMatrixFromTexture(texture,texShape[0],texShape[1])}else{float32Values=this.gpgpu.downloadMatrixFromRGBAColorTexture(texture,texShape[0],texShape[1],numChannels)}this.cacheOnCPU(dataId,float32Values);return this.texData[dataId].values};MathBackendWebGL.prototype.read=function(dataId){return __awaiter(this,void 0,void 0,function(){var _a,texture,values,textureType,texShape,float32Values;return __generator(this,function(_b){switch(_b.label){case 0:this.throwIfNoData(dataId);_a=this.texData[dataId],texture=_a.texture,values=_a.values,textureType=_a.textureType,texShape=_a.texShape;if(values!=null){this.cacheOnCPU(dataId);return[2,values]}if(!(environment_1.ENV.get("WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED")&&textureType===tex_util_1.TextureType.DEFAULT))return[3,2];return[4,this.gpgpu.downloadMatrixFromTextureAsync(texture,texShape[0],texShape[1])];case 1:float32Values=_b.sent();this.cacheOnCPU(dataId,float32Values);return[2,this.texData[dataId].values];case 2:if(!environment_1.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_ENABLED")){return[2,this.readSync(dataId)]}return[4,this.gpgpu.runQuery(function(){})];case 3:_b.sent();return[2,this.readSync(dataId)]}})})};MathBackendWebGL.prototype.time=function(query){return __awaiter(this,void 0,void 0,function(){var start,a;return __generator(this,function(_a){switch(_a.label){case 0:if(!!environment_1.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_ENABLED"))return[3,2];start=performance.now();a=query();return[4,a.data()];case 1:_a.sent();return[2,performance.now()-start];case 2:return[2,this.gpgpu.runQuery(query)]}})})};MathBackendWebGL.prototype.disposeData=function(dataId){if(dataId in this.texData){var _a=this.texData[dataId],texture=_a.texture,texShape=_a.texShape;if(texture!=null){this.textureManager.releaseTexture(texture,texShape)}delete this.texData[dataId]}};MathBackendWebGL.prototype.getTexture=function(dataId){this.uploadToGPU(dataId);return this.texData[dataId].texture};MathBackendWebGL.prototype.getTextureData=function(dataId){this.uploadToGPU(dataId);return this.texData[dataId]};MathBackendWebGL.prototype.getGPGPUContext=function(){return this.gpgpu};MathBackendWebGL.prototype.clone=function(x){this.throwIfNoData(x.dataId);this.uploadToGPU(x.dataId);var texShape=this.texData[x.dataId].texShape;var source=x.as2D(texShape[0],texShape[1]);var output=this.makeOutputArray(texShape,x.dtype);this.copy2D(source,[0,0],texShape,output,[0,0],texShape);return output.reshape(x.shape)};MathBackendWebGL.prototype.slice1D=function(x,begin,size){var program=new slice_gpu_1.SliceProgram([size]);var customSetup=program.getCustomSetupFunc([begin]);return this.compileAndRun(program,[x],null,customSetup)};MathBackendWebGL.prototype.slice2D=function(x,begin,size){var program=new slice_gpu_1.SliceProgram(size);var customSetup=program.getCustomSetupFunc(begin);return this.compileAndRun(program,[x],null,customSetup)};MathBackendWebGL.prototype.slice3D=function(x,begin,size){var program=new slice_gpu_1.SliceProgram(size);var customSetup=program.getCustomSetupFunc(begin);return this.compileAndRun(program,[x],null,customSetup)};MathBackendWebGL.prototype.slice4D=function(x,begin,size){var program=new slice_gpu_1.SliceProgram(size);var customSetup=program.getCustomSetupFunc(begin);return this.compileAndRun(program,[x],null,customSetup)};MathBackendWebGL.prototype.copy2D=function(source,sourceBeginRowCol,sourceSizeRowCol,dest,destBeginRowCol,destSizeRowCol){var program=new copy_gpu_1.Copy2DProgram(sourceSizeRowCol[1],destSizeRowCol[1]);var customSetup=program.getCustomSetupFunc(sourceBeginRowCol,destBeginRowCol,destSizeRowCol);this.compileAndRun(program,[source],dest,customSetup)};MathBackendWebGL.prototype.concat1D=function(a,b){var program=new concat_gpu_1.ConcatProgram(a.shape,b.shape,0);return this.compileAndRun(program,[a,b])};MathBackendWebGL.prototype.concat2D=function(a,b,axis){var program=new concat_gpu_1.ConcatProgram(a.shape,b.shape,axis);return this.compileAndRun(program,[a,b])};MathBackendWebGL.prototype.concat3D=function(a,b,axis){var program=new concat_gpu_1.ConcatProgram(a.shape,b.shape,axis);return this.compileAndRun(program,[a,b])};MathBackendWebGL.prototype.concat4D=function(a,b,axis){var program=new concat_gpu_1.ConcatProgram(a.shape,b.shape,axis);return this.compileAndRun(program,[a,b])};MathBackendWebGL.prototype.neg=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.NEG);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.matMul=function(a,b,aOrientation,bOrientation){var program=new mulmat_gpu_1.MatMulProgram(a.shape,b.shape,aOrientation,bOrientation);return this.compileAndRun(program,[a,b])};MathBackendWebGL.prototype.multiply=function(a,b){var program=new binaryop_gpu_1.BinaryOpProgram(binaryop_gpu.MUL,a.shape,b.shape);var output=this.makeOutputArray(program.outputShape,types.upcastType(a.dtype,b.dtype));return this.compileAndRun(program,[a,b],output)};MathBackendWebGL.prototype.batchNormalization2D=function(x,mean,variance,varianceEpsilon,scale,offset){var inputs=[x,mean,variance];var offsetShape=null;if(offset!=null){offsetShape=offset.shape;inputs.push(offset)}var scaleShape=null;if(scale!=null){scaleShape=scale.shape;inputs.push(scale)}var program=new batchnorm_gpu_1.BatchNormProgram(x.shape,mean.shape,variance.shape,offsetShape,scaleShape,varianceEpsilon);return this.compileAndRun(program,inputs)};MathBackendWebGL.prototype.batchNormalization3D=function(x,mean,variance,varianceEpsilon,scale,offset){var inputs=[x,mean,variance];var offsetShape=null;if(offset!=null){offsetShape=offset.shape;inputs.push(offset)}var scaleShape=null;if(scale!=null){scaleShape=scale.shape;inputs.push(scale)}var program=new batchnorm_gpu_1.BatchNormProgram(x.shape,mean.shape,variance.shape,offsetShape,scaleShape,varianceEpsilon);return this.compileAndRun(program,inputs)};MathBackendWebGL.prototype.batchNormalization4D=function(x,mean,variance,varianceEpsilon,scale,offset){var inputs=[x,mean,variance];var offsetShape=null;if(offset!=null){offsetShape=offset.shape;inputs.push(offset)}var scaleShape=null;if(scale!=null){scaleShape=scale.shape;inputs.push(scale)}var program=new batchnorm_gpu_1.BatchNormProgram(x.shape,mean.shape,variance.shape,offsetShape,scaleShape,varianceEpsilon);return this.compileAndRun(program,inputs)};MathBackendWebGL.prototype.tile=function(x,reps){var program=new tile_gpu_1.TileProgram(x.shape,reps);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.transpose=function(x,perm){var program=new transpose_gpu_1.TransposeProgram(x.shape,perm);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.reduce=function(x,reduceType,dtype){var batchSize=x.shape[0];var inSize=x.shape[1];var windowSize=reduce_util.computeOptimalWindowSize(inSize);var reduceInfo={windowSize:windowSize,inSize:inSize,batchSize:batchSize};var program=new reduce_gpu_1.ReduceProgram(reduceInfo,reduceType);var _a=program.outputShape,rows=_a[0],cols=_a[1];var output=this.makeOutputArray(program.outputShape,dtype).as2D(rows,cols);this.compileAndRun(program,[x],output);if(output.shape[1]===1){return output}return this.reduce(output,reduceType,dtype)};MathBackendWebGL.prototype.argReduce=function(x,reduceType,bestIndicesA){if(bestIndicesA===void 0){bestIndicesA=null}var batchSize=x.shape[0];var inSize=x.shape[1];if(bestIndicesA!=null){batchSize=bestIndicesA.shape[0];inSize=bestIndicesA.shape[1]}var windowSize=reduce_util.computeOptimalWindowSize(inSize);var reduceInfo={windowSize:windowSize,inSize:inSize,batchSize:batchSize};var program=new argminmax_gpu_1.ArgMinMaxProgram(reduceInfo,reduceType,bestIndicesA==null);var _a=program.outputShape,rows=_a[0],cols=_a[1];var output=this.makeOutputArray(program.outputShape,"int32").as2D(rows,cols);var inputs=[x];if(bestIndicesA!=null){inputs.push(bestIndicesA)}this.compileAndRun(program,inputs,output);if(output.shape[1]===1){return output}return this.argReduce(x,reduceType,output)};MathBackendWebGL.prototype.sum=function(x,axes){axis_util.assertAxesAreInnerMostDims("sum",axes,x.rank);var _a=axis_util.computeOutAndReduceShapes(x.shape,axes),outShape=_a[0],reduceShape=_a[1];var inSize=util.sizeFromShape(reduceShape);var a2D=x.as2D(-1,inSize);var outputDType=types_1.SumTypesMap[x.dtype];return this.reduce(a2D,"sum",outputDType).reshape(outShape)};MathBackendWebGL.prototype.argMin=function(x,axes){axis_util.assertAxesAreInnerMostDims("argMin",axes,x.rank);var _a=axis_util.computeOutAndReduceShapes(x.shape,axes),outShape=_a[0],reduceShape=_a[1];var inSize=util.sizeFromShape(reduceShape);var a2D=x.as2D(-1,inSize);return this.argReduce(a2D,"min").reshape(outShape)};MathBackendWebGL.prototype.argMax=function(x,axes){axis_util.assertAxesAreInnerMostDims("argMax",axes,x.rank);var _a=axis_util.computeOutAndReduceShapes(x.shape,axes),outShape=_a[0],reduceShape=_a[1];var inSize=util.sizeFromShape(reduceShape);var a2D=x.as2D(-1,inSize);return this.argReduce(a2D,"max").reshape(outShape)};MathBackendWebGL.prototype.equal=function(a,b){var program=new binaryop_gpu_1.BinaryOpProgram(binaryop_gpu.EQUAL,a.shape,b.shape);var output=this.makeOutputArray(program.outputShape,"bool");return this.compileAndRun(program,[a,b],output)};MathBackendWebGL.prototype.notEqual=function(a,b){var program=new binaryop_gpu_1.BinaryOpProgram(binaryop_gpu.NOT_EQUAL,a.shape,b.shape);var output=this.makeOutputArray(program.outputShape,"bool");return this.compileAndRun(program,[a,b],output)};MathBackendWebGL.prototype.topKValues=function(x,k){throw new Error("topKValues GPU not yet implemented!")};MathBackendWebGL.prototype.topKIndices=function(x,k){throw new Error("topKIndices GPU not yet implemented!")};MathBackendWebGL.prototype.min=function(x,axes){axis_util.assertAxesAreInnerMostDims("min",axes,x.rank);var _a=axis_util.computeOutAndReduceShapes(x.shape,axes),outShape=_a[0],reduceShape=_a[1];var inSize=util.sizeFromShape(reduceShape);var a2D=x.as2D(-1,inSize);return this.reduce(a2D,"min",a2D.dtype).reshape(outShape)};MathBackendWebGL.prototype.minimum=function(a,b){var program=new binaryop_gpu_1.BinaryOpProgram(binaryop_gpu.MIN,a.shape,b.shape);return this.compileAndRun(program,[a,b])};MathBackendWebGL.prototype.max=function(x,axes){axis_util.assertAxesAreInnerMostDims("max",axes,x.rank);var _a=axis_util.computeOutAndReduceShapes(x.shape,axes),outShape=_a[0],reduceShape=_a[1];var inSize=util.sizeFromShape(reduceShape);var a2D=x.as2D(-1,inSize);return this.reduce(a2D,"max",a2D.dtype).reshape(outShape)};MathBackendWebGL.prototype.maximum=function(a,b){var program=new binaryop_gpu_1.BinaryOpProgram(binaryop_gpu.MAX,a.shape,b.shape);return this.compileAndRun(program,[a,b])};MathBackendWebGL.prototype.divide=function(a,b){var program=new binaryop_gpu_1.BinaryOpProgram(binaryop_gpu.DIV,a.shape,b.shape);var output=this.makeOutputArray(program.outputShape,"float32");return this.compileAndRun(program,[a,b],output)};MathBackendWebGL.prototype.add=function(a,b){var program=new binaryop_gpu_1.BinaryOpProgram(binaryop_gpu.ADD,a.shape,b.shape);var output=this.makeOutputArray(program.outputShape,types.upcastType(a.dtype,b.dtype));return this.compileAndRun(program,[a,b],output)};MathBackendWebGL.prototype.subtract=function(a,b){var program=new binaryop_gpu_1.BinaryOpProgram(binaryop_gpu.SUB,a.shape,b.shape);var output=this.makeOutputArray(program.outputShape,types.upcastType(a.dtype,b.dtype));return this.compileAndRun(program,[a,b],output)};MathBackendWebGL.prototype.pow=function(a,b){var program=new binaryop_gpu_1.BinaryOpProgram(binaryop_gpu.POW,a.shape,b.shape);var output=this.makeOutputArray(program.outputShape,types.upcastType(a.dtype,b.dtype));return this.compileAndRun(program,[a,b],output)};MathBackendWebGL.prototype.ceil=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.CEIL);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.floor=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.FLOOR);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.exp=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.EXP);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.log=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.LOG);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.sqrt=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.SQRT);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.square=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.SQUARE);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.relu=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.RELU);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.elu=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.ELU);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.eluDer=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.ELU_DER);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.selu=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.SELU);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.leakyRelu=function(x,alpha){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.LEAKY_RELU(alpha));return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.prelu=function(a,b){var program=new binaryop_gpu_1.BinaryOpProgram(binaryop_gpu.PRELU,a.shape,b.shape);return this.compileAndRun(program,[a,b])};MathBackendWebGL.prototype.preluDer=function(a,b){var program=new binaryop_gpu_1.BinaryOpProgram(binaryop_gpu.PRELU_DER,a.shape,b.shape);return this.compileAndRun(program,[a,b])};MathBackendWebGL.prototype.int=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.TO_INT);var output=this.makeOutputArray(program.outputShape,"int32");return this.compileAndRun(program,[x],output)};MathBackendWebGL.prototype.clip=function(x,min,max){var program=new clip_gpu_1.ClipProgram(x.shape,min,max);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.abs=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.ABS);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.sigmoid=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.SIGMOID);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.sin=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.SIN);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.cos=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.COS);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.tan=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.TAN);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.asin=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.ASIN);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.acos=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.ACOS);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.atan=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.ATAN);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.sinh=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.SINH);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.cosh=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.COSH);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.tanh=function(x){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.TANH);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.step=function(x,alpha){var program=new unaryop_gpu_1.UnaryOpProgram(x.shape,unary_op.STEP(alpha));return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.conv2d=function(x,filter,bias,convInfo){var program=new conv_gpu_1.Conv2DProgram(convInfo,bias!=null);var inputs=bias!=null?[x,filter,bias]:[x,filter];return this.compileAndRun(program,inputs)};MathBackendWebGL.prototype.conv2dDerInput=function(dy,filter,convInfo){var program=new conv_backprop_gpu_1.Conv2DDerInputProgram(convInfo);return this.compileAndRun(program,[dy,filter])};MathBackendWebGL.prototype.conv2dDerFilter=function(x,dy,convInfo){var program=new conv_backprop_gpu_1.Conv2DDerFilterProgram(convInfo);return this.compileAndRun(program,[x,dy])};MathBackendWebGL.prototype.conv2dDerBias=function(dy){var program=new conv_backprop_gpu_1.Conv2DDerBiasProgram(dy.shape);return this.compileAndRun(program,[dy])};MathBackendWebGL.prototype.depthwiseConv2D=function(x,filter,convInfo){var program=new conv_gpu_depthwise_1.DepthwiseConv2DProgram(convInfo);return this.compileAndRun(program,[x,filter])};MathBackendWebGL.prototype.maxPool=function(x,convInfo){var program=new pool_gpu_1.Pool2DProgram(convInfo,"max",false);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.minPool=function(x,convInfo){var program=new pool_gpu_1.Pool2DProgram(convInfo,"min",false);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.avgPool=function(x,convInfo){var program=new pool_gpu_1.Pool2DProgram(convInfo,"avg",false);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.maxPoolBackprop=function(dy,x,convInfo){var getPositions=true;var maxPoolPositionsProgram=new pool_gpu_1.Pool2DProgram(convInfo,"max",getPositions);var maxPoolPositions=this.compileAndRun(maxPoolPositionsProgram,[x]);var maxPoolBackPropProgram=new max_pool_backprop_gpu_1.MaxPool2DBackpropProgram(convInfo);var result=this.compileAndRun(maxPoolBackPropProgram,[dy,maxPoolPositions]);maxPoolPositions.dispose();return result};MathBackendWebGL.prototype.resizeBilinear3D=function(x,newShape2D,alignCorners){var program=new resize_bilinear_gpu_1.ResizeBilinear3DProgram(x.shape,newShape2D,alignCorners);return this.compileAndRun(program,[x])};MathBackendWebGL.prototype.multinomial=function(probs,numSamples,seed){var batchSize=probs.shape[0];var numOutcomes=probs.shape[1];var program=new multinomial_gpu_1.MultinomialProgram(batchSize,numOutcomes,numSamples);var output=this.makeOutputArray(program.outputShape,"int32");var customSetup=program.getCustomSetupFunc(seed);return this.compileAndRun(program,[probs],output,customSetup)};MathBackendWebGL.prototype.oneHot=function(indices,depth,onValue,offValue){var program=new onehot_gpu_1.OneHotProgram(indices.size,depth,onValue,offValue);return this.compileAndRun(program,[indices])};MathBackendWebGL.prototype.makeOutputArray=function(shape,dtype){return ndarray_1.NDArray.make(shape,{},dtype)};MathBackendWebGL.prototype.compileAndRun=function(program,inputs,output,customSetup){var _this=this;if(output==null){output=this.makeOutputArray(program.outputShape,inputs[0].dtype)}var inputsData=inputs.map(function(input){_this.uploadToGPU(input.dataId);return{array:input,texData:_this.texData[input.dataId]}});this.uploadToGPU(output.dataId);var outputData={array:output,texData:this.texData[output.dataId]};var key=gpgpu_math.makeShaderKey(program,inputsData,outputData);var binary=this.getAndSaveBinary(key,function(){return gpgpu_math.compileProgram(_this.gpgpu,program,inputsData,outputData)});gpgpu_math.runProgram(binary,inputsData,outputData,customSetup);return output};MathBackendWebGL.prototype.getAndSaveBinary=function(key,getBinary){if(!(key in this.binaryCache)){this.binaryCache[key]=getBinary()}return this.binaryCache[key]};MathBackendWebGL.prototype.getTextureManager=function(){return this.textureManager};MathBackendWebGL.prototype.dispose=function(){for(var key in this.binaryCache){this.gpgpu.deleteProgram(this.binaryCache[key].webGLProgram)}this.textureManager.dispose();if(this.gpgpuCreatedLocally){this.gpgpu.dispose()}};MathBackendWebGL.prototype.throwIfNoData=function(dataId){if(!(dataId in this.texData)){throw new Error("No data found for NDArray with data id "+dataId+". "+"Use dl.ENV.math instead of constructing your own NDArrayMath. "+"If you need to construct your own math, make sure this array is "+"allocated after the math construction")}};MathBackendWebGL.prototype.uploadToGPU=function(dataId){this.throwIfNoData(dataId);var _a=this.texData[dataId],shape=_a.shape,values=_a.values,texture=_a.texture,dtype=_a.dtype;if(texture!=null){return}var texShape=webgl_util.getTextureShapeFromLogicalShape(this.gpgpu.gl,shape);this.texData[dataId].textureType=tex_util_1.TextureType.DEFAULT;this.texData[dataId].texShape=texShape;var newTexture=this.textureManager.acquireTexture(texShape);this.texData[dataId].texture=newTexture;if(values!=null){this.gpgpu.uploadMatrixToTexture(newTexture,texShape[0],texShape[1],typedArrayToFloat32(values,dtype))}};MathBackendWebGL.prototype.cacheOnCPU=function(dataId,float32Values){var dontKeepCopyOnGPU=this.delayedStorage;var _a=this.texData[dataId],texture=_a.texture,texShape=_a.texShape,dtype=_a.dtype;if(dontKeepCopyOnGPU&&texture!=null){this.textureManager.releaseTexture(texture,texShape);this.texData[dataId].texture=null;this.texData[dataId].texShape=null;this.texData[dataId].textureType=null}if(float32Values!=null){this.texData[dataId].values=float32ToTypedArray(float32Values,dtype)}};return MathBackendWebGL}();exports.MathBackendWebGL=MathBackendWebGL;environment_1.ENV.registerBackend("webgl",function(){return new MathBackendWebGL});var NDArrayMathGPU=function(_super){__extends(NDArrayMathGPU,_super);function NDArrayMathGPU(gpgpu,safeMode){if(safeMode===void 0){safeMode=false}var _this=this;console.warn("new NDArrayMathGPU() is deprecated. Please use the global "+"dl.ENV.math. In rare cases, to construct your own NDArrayMath "+"that runs on GPU, use math = new NDArrayMath('webgl', safeMode); "+"and make sure to set it as global: dl.ENV.setMath(math);");_this=_super.call(this,new MathBackendWebGL(gpgpu),safeMode)||this;environment_1.ENV.setMath(_this);return _this}NDArrayMathGPU.prototype.getGPGPUContext=function(){return this.backendEngine.getBackend().getGPGPUContext()};NDArrayMathGPU.prototype.getTextureManager=function(){return this.backendEngine.getBackend().getTextureManager()};return NDArrayMathGPU}(math_1.NDArrayMath);exports.NDArrayMathGPU=NDArrayMathGPU;function float32ToTypedArray(a,dtype){if(dtype==="float32"){return a}else if(dtype==="int32"||dtype==="bool"){var result=dtype==="int32"?new Int32Array(a.length):new Uint8Array(a.length);for(var i=0;i<result.length;++i){var val=a[i];val=isNaN(val)?util.getNaN(dtype):Math.round(val);result[i]=val}return result}else{throw new Error("Unknown dtype "+dtype)}}function typedArrayToFloat32(a,dtype){if(a instanceof Float32Array){return a}else{var res=new Float32Array(a.length);for(var i=0;i<res.length;i++){var val=a[i];res[i]=util.isValNaN(val,dtype)?NaN:val}return res}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var broadcast_util=__webpack_require__(62);var CHECK_NAN_SNIPPET="\n  if (isNaN(a)) return a;\n  if (isNaN(b)) return b;\n";exports.ADD="return a + b;";exports.SUB="return a - b;";exports.MUL="return a * b;";exports.DIV="return a / b;";exports.POW="\n  return (round(mod(b, 2.0)) == 0 || round(mod(b, 2.0)) == 2) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n";exports.EQUAL=CHECK_NAN_SNIPPET+"\n  return float(a == b);\n";exports.NOT_EQUAL=CHECK_NAN_SNIPPET+"\n  return float(a != b);\n";exports.PRELU="\n  return (a >= 0.0) ? a : b * a;\n";exports.PRELU_DER="\n  return (a > 0.0) ? 1.0 : ((a < 0.0) ? b : a);\n";exports.MAX=CHECK_NAN_SNIPPET+"\n  return max(a, b);\n";exports.MIN=CHECK_NAN_SNIPPET+"\n  return min(a, b);\n";var BinaryOpProgram=function(){function BinaryOpProgram(op,aShape,bShape){this.variableNames=["A","B"];this.supportsBroadcasting=true;this.outputShape=broadcast_util.assertAndGetBroadcastShape(aShape,bShape);this.userCode="\n      float binaryOperation(float a, float b) {\n        "+op+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "}return BinaryOpProgram}();exports.BinaryOpProgram=BinaryOpProgram},function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=y[op[0]&2?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[0,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var environment_1=__webpack_require__(11);var util=__webpack_require__(4);var gpgpu_util=__webpack_require__(113);var tex_util=__webpack_require__(65);var webgl_util=__webpack_require__(66);var GPGPUContext=function(){function GPGPUContext(gl){this.outputTexture=null;this.program=null;this.disposed=false;this.autoDebugValidate=false;if(gl!=null){this.gl=gl}else{this.gl=gpgpu_util.createWebGLContext()}if(environment_1.ENV.get("WEBGL_VERSION")===1){this.textureFloatExtension=webgl_util.getExtensionOrThrow(this.gl,"OES_texture_float");this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float")}else{this.colorBufferFloatExtension=webgl_util.getExtensionOrThrow(this.gl,"EXT_color_buffer_float")}this.loseContextExtension=webgl_util.getExtensionOrThrow(this.gl,"WEBGL_lose_context");if(environment_1.ENV.get("WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED")){this.getBufferSubDataAsyncExtension=this.gl.getExtension("WEBGL_get_buffer_sub_data_async")}this.vertexBuffer=gpgpu_util.createVertexBuffer(this.gl);this.indexBuffer=gpgpu_util.createIndexBuffer(this.gl);this.framebuffer=webgl_util.createFramebuffer(this.gl)}GPGPUContext.prototype.dispose=function(){var _this=this;this.throwIfDisposed();if(this.program!=null){console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram."+" This is probably a resource leak, delete the program with "+"GPGPUContext.deleteProgram before disposing.")}if(this.outputTexture!=null){console.warn("Disposing a GPGPUContext that still has a bound output matrix "+"texture.  This is probably a resource leak, delete the output "+"matrix texture with GPGPUContext.deleteMatrixTexture before "+"disposing.")}var gl=this.gl;webgl_util.callAndCheck(gl,function(){return gl.finish()});webgl_util.callAndCheck(gl,function(){return gl.bindFramebuffer(gl.FRAMEBUFFER,null)});webgl_util.callAndCheck(gl,function(){return gl.deleteFramebuffer(_this.framebuffer)});webgl_util.callAndCheck(gl,function(){return gl.bindBuffer(gl.ARRAY_BUFFER,null)});webgl_util.callAndCheck(gl,function(){return gl.deleteBuffer(_this.vertexBuffer)});webgl_util.callAndCheck(gl,function(){return gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,null)});webgl_util.callAndCheck(gl,function(){return gl.deleteBuffer(_this.indexBuffer)});this.loseContextExtension.loseContext();this.disposed=true};GPGPUContext.prototype.enableAutomaticDebugValidation=function(enabled){this.autoDebugValidate=enabled;webgl_util.enableDebugWebGLErrorChecking(enabled)};GPGPUContext.prototype.createMatrixTexture=function(rows,columns){this.throwIfDisposed();return gpgpu_util.createMatrixTexture(this.gl,rows,columns)};GPGPUContext.prototype.uploadPixelDataToTexture=function(texture,pixels){this.throwIfDisposed();gpgpu_util.uploadPixelDataToTexture(this.gl,texture,pixels)};GPGPUContext.prototype.createPackedMatrixTexture=function(rows,columns){this.throwIfDisposed();return gpgpu_util.createPackedMatrixTexture(this.gl,rows,columns)};GPGPUContext.prototype.deleteMatrixTexture=function(texture){var _this=this;this.throwIfDisposed();if(this.outputTexture===texture){webgl_util.unbindColorTextureFromFramebuffer(this.gl,this.framebuffer);this.outputTexture=null}webgl_util.callAndCheck(this.gl,function(){return _this.gl.deleteTexture(texture)})};GPGPUContext.prototype.uploadMatrixToTexture=function(texture,rows,columns,matrix){this.throwIfDisposed();var numChannels=1;return gpgpu_util.uploadMatrixToTexture(this.gl,texture,rows,columns,matrix,numChannels)};GPGPUContext.prototype.uploadMatrixToPackedTexture=function(texture,rows,columns,matrix){this.throwIfDisposed();return gpgpu_util.uploadMatrixToPackedTexture(this.gl,texture,rows,columns,matrix)};GPGPUContext.prototype.downloadMatrixFromTexture=function(texture,rows,columns){var _this=this;return this.downloadMatrixDriver(texture,function(){return gpgpu_util.downloadMatrixFromOutputTexture(_this.gl,rows,columns)})};GPGPUContext.prototype.downloadMatrixFromTextureAsync=function(texture,rows,columns){return __awaiter(this,void 0,void 0,function(){var _this=this;return __generator(this,function(_a){if(this.getBufferSubDataAsyncExtension==null){throw new Error("Cannot download matrix from output texture asynchronously, "+"WEBGL_get_buffer_sub_data_async is not enabled.")}return[2,this.downloadMatrixDriverAsync(texture,function(){return gpgpu_util.downloadMatrixFromOutputTextureAsync(_this.gl,_this.getBufferSubDataAsyncExtension,rows,columns)})]})})};GPGPUContext.prototype.downloadMatrixFromRGBAColorTexture=function(texture,rows,columns,channels){var _this=this;return this.downloadMatrixDriver(texture,function(){return gpgpu_util.downloadMatrixFromRGBAColorTexture(_this.gl,rows,columns,channels)})};GPGPUContext.prototype.downloadMatrixFromPackedTexture=function(texture,rows,columns){var _this=this;return this.downloadMatrixDriver(texture,function(){return gpgpu_util.downloadMatrixFromPackedOutputTexture(_this.gl,rows,columns)})};GPGPUContext.prototype.createProgram=function(fragmentShaderSource){this.throwIfDisposed();var gl=this.gl;var fragmentShader=webgl_util.createFragmentShader(gl,fragmentShaderSource);var vertexShader=gpgpu_util.createVertexShader(gl);var program=webgl_util.createProgram(gl);webgl_util.callAndCheck(gl,function(){return gl.attachShader(program,vertexShader)});webgl_util.callAndCheck(gl,function(){return gl.attachShader(program,fragmentShader)});webgl_util.linkProgram(gl,program);if(this.autoDebugValidate){webgl_util.validateProgram(gl,program)}return program};GPGPUContext.prototype.deleteProgram=function(program){var _this=this;this.throwIfDisposed();if(program===this.program){this.program=null}if(program!=null){webgl_util.callAndCheck(this.gl,function(){return _this.gl.deleteProgram(program)})}};GPGPUContext.prototype.setProgram=function(program){var _this=this;this.throwIfDisposed();this.program=program;if(this.program!=null&&this.autoDebugValidate){webgl_util.validateProgram(this.gl,this.program)}webgl_util.callAndCheck(this.gl,function(){return _this.gl.useProgram(program)})};GPGPUContext.prototype.getUniformLocation=function(program,uniformName){this.throwIfDisposed();return webgl_util.getProgramUniformLocationOrThrow(this.gl,program,uniformName)};GPGPUContext.prototype.getAttributeLocation=function(program,attribute){var _this=this;this.throwIfDisposed();return webgl_util.callAndCheck(this.gl,function(){return _this.gl.getAttribLocation(program,attribute)})};GPGPUContext.prototype.getUniformLocationNoThrow=function(program,uniformName){this.throwIfDisposed();return this.gl.getUniformLocation(program,uniformName)};GPGPUContext.prototype.setInputMatrixTexture=function(inputMatrixTexture,uniformLocation,textureUnit){this.throwIfDisposed();this.throwIfNoProgram();webgl_util.bindTextureToProgramUniformSampler(this.gl,this.program,inputMatrixTexture,uniformLocation,textureUnit)};GPGPUContext.prototype.setOutputMatrixTexture=function(outputMatrixTexture,rows,columns){this.setOutputMatrixTextureDriver(outputMatrixTexture,columns,rows)};GPGPUContext.prototype.setOutputPackedMatrixTexture=function(outputPackedMatrixTexture,rows,columns){this.throwIfDisposed();var _a=tex_util.getPackedMatrixTextureShapeWidthHeight(rows,columns),width=_a[0],height=_a[1];this.setOutputMatrixTextureDriver(outputPackedMatrixTexture,width,height)};GPGPUContext.prototype.setOutputMatrixWriteRegion=function(startRow,numRows,startColumn,numColumns){this.setOutputMatrixWriteRegionDriver(startColumn,startRow,numColumns,numRows)};GPGPUContext.prototype.setOutputPackedMatrixWriteRegion=function(startRow,numRows,startColumn,numColumns){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")};GPGPUContext.prototype.debugValidate=function(){if(this.program!=null){webgl_util.validateProgram(this.gl,this.program)}webgl_util.validateFramebuffer(this.gl)};GPGPUContext.prototype.executeProgram=function(attribLocations){this.throwIfDisposed();this.throwIfNoProgram();var gl=this.gl;gpgpu_util.bindVertexProgramAttributeStreams(gl,this.program,this.vertexBuffer,attribLocations);if(this.autoDebugValidate){this.debugValidate()}webgl_util.callAndCheck(gl,function(){return gl.drawElements(gl.TRIANGLES,6,gl.UNSIGNED_SHORT,0)})};GPGPUContext.prototype.blockUntilAllProgramsCompleted=function(){var _this=this;this.throwIfDisposed();webgl_util.callAndCheck(this.gl,function(){return _this.gl.finish()})};GPGPUContext.prototype.runQuery=function(queryFn){if(environment_1.ENV.get("WEBGL_VERSION")===2){return this.runQueryWebGL2(queryFn)}return this.runQueryWebGL1(queryFn)};GPGPUContext.prototype.runQueryWebGL2=function(benchmark){var _this=this;var ext=webgl_util.getExtensionOrThrow(this.gl,"EXT_disjoint_timer_query_webgl2");var query=this.gl.createQuery();this.gl.beginQuery(ext.TIME_ELAPSED_EXT,query);benchmark();this.gl.endQuery(ext.TIME_ELAPSED_EXT);return new Promise(function(resolve,reject){var queryGPU=function(){var available=_this.gl.getQueryParameter(query,_this.gl.QUERY_RESULT_AVAILABLE);var disjoint=_this.gl.getParameter(ext.GPU_DISJOINT_EXT);return available&&!disjoint};var getTimeElapsed=function(){var timeElapsedNanos=_this.gl.getQueryParameter(query,_this.gl.QUERY_RESULT);resolve(timeElapsedNanos/1e6)};var resolveWithWarning=function(){console.warn("Disjoint query timer never available.");resolve(-1)};util.repeatedTry(queryGPU).then(getTimeElapsed).catch(resolveWithWarning)})};GPGPUContext.prototype.runQueryWebGL1=function(benchmark){var _this=this;var ext=webgl_util.getExtensionOrThrow(this.gl,"EXT_disjoint_timer_query");var query=ext.createQueryEXT();ext.beginQueryEXT(ext.TIME_ELAPSED_EXT,query);benchmark();ext.endQueryEXT(ext.TIME_ELAPSED_EXT);return new Promise(function(resolve,reject){var queryGPU=function(){var available=ext.getQueryObjectEXT(query,ext.QUERY_RESULT_AVAILABLE_EXT);var disjoint=_this.gl.getParameter(ext.GPU_DISJOINT_EXT);return available&&!disjoint};var getTimeElapsed=function(){var timeElapsedNanos=ext.getQueryObjectEXT(query,ext.QUERY_RESULT_EXT);resolve(timeElapsedNanos/1e6)};var resolveWithWarning=function(){console.warn("Disjoint query timer never available.");resolve(-1)};util.repeatedTry(queryGPU).then(getTimeElapsed).catch(resolveWithWarning)})};GPGPUContext.prototype.downloadMatrixDriverSetup=function(texture){this.throwIfDisposed();webgl_util.bindColorTextureToFramebuffer(this.gl,texture,this.framebuffer);if(this.autoDebugValidate){webgl_util.validateFramebuffer(this.gl)}};GPGPUContext.prototype.downloadMatrixDriverTeardown=function(){if(this.outputTexture!=null){webgl_util.bindColorTextureToFramebuffer(this.gl,this.outputTexture,this.framebuffer);if(this.autoDebugValidate){webgl_util.validateFramebuffer(this.gl)}}else{webgl_util.unbindColorTextureFromFramebuffer(this.gl,this.framebuffer)}};GPGPUContext.prototype.downloadMatrixDriver=function(texture,downloadAndDecode){this.downloadMatrixDriverSetup(texture);var result=downloadAndDecode();this.downloadMatrixDriverTeardown();return result};GPGPUContext.prototype.downloadMatrixDriverAsync=function(texture,downloadAndDecode){return __awaiter(this,void 0,void 0,function(){var result;return __generator(this,function(_a){switch(_a.label){case 0:this.downloadMatrixDriverSetup(texture);return[4,downloadAndDecode()];case 1:result=_a.sent();this.downloadMatrixDriverTeardown();return[2,result]}})})};GPGPUContext.prototype.setOutputMatrixTextureDriver=function(outputMatrixTextureMaybePacked,width,height){this.throwIfDisposed();var gl=this.gl;webgl_util.bindColorTextureToFramebuffer(gl,outputMatrixTextureMaybePacked,this.framebuffer);if(this.autoDebugValidate){webgl_util.validateFramebuffer(gl)}this.outputTexture=outputMatrixTextureMaybePacked;webgl_util.callAndCheck(gl,function(){return gl.viewport(0,0,width,height)});webgl_util.callAndCheck(gl,function(){return gl.scissor(0,0,width,height)})};GPGPUContext.prototype.setOutputMatrixWriteRegionDriver=function(x,y,width,height){var _this=this;this.throwIfDisposed();webgl_util.callAndCheck(this.gl,function(){return _this.gl.scissor(x,y,width,height)})};GPGPUContext.prototype.throwIfDisposed=function(){if(this.disposed){throw new Error("Attempted to use disposed GPGPUContext.")}};GPGPUContext.prototype.throwIfNoProgram=function(){if(this.program==null){throw new Error("No GPU program is currently set.")}};return GPGPUContext}();exports.GPGPUContext=GPGPUContext},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var UnaryOpProgram=function(){function UnaryOpProgram(aShape,opSnippet){this.variableNames=["A"];this.outputShape=aShape;this.userCode="\n      float unaryOperation(float x) {\n        "+opSnippet+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "}return UnaryOpProgram}();exports.UnaryOpProgram=UnaryOpProgram;var CHECK_NAN_SNIPPET="\n  if (isNaN(x)) return x;\n";exports.ABS="\n  return abs(x);\n";exports.RELU=CHECK_NAN_SNIPPET+"\n  return (x < 0.0) ? 0.0 : x;\n";exports.ELU="\n  return (x >= 0.0) ? x : (exp(x) - 1.0);\n";exports.ELU_DER="\n  return (x >= 0.0) ? 1.0 : exp(x);\n";exports.SELU="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = 1.7580993408473768599402175208123;\n  float scale = 1.0507009873554804934193349852946;\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n";function LEAKY_RELU(alpha){return"\n    return (x >= 0.0) ? x : "+alpha+" * x;\n  "}exports.LEAKY_RELU=LEAKY_RELU;function STEP(alpha){if(alpha===void 0){alpha=0}return CHECK_NAN_SNIPPET+("\n    return x > 0.0 ? 1.0 : float("+alpha+");\n  ")}exports.STEP=STEP;exports.NEG="\n  return -x;\n";exports.CEIL="\n  return ceil(x);\n";exports.FLOOR="\n  return floor(x);\n";exports.EXP="\n  return exp(x);\n";exports.LOG="\n  return log(x);\n";exports.SQRT=CHECK_NAN_SNIPPET+"\n  return sqrt(x);\n";exports.SIGMOID="\n  return 1.0 / (1.0 + exp(-1.0 * x));\n";exports.SIN=CHECK_NAN_SNIPPET+"\n  return sin(x);\n";exports.COS=CHECK_NAN_SNIPPET+"\n  return cos(x);\n";exports.TAN="\n  return tan(x);\n";exports.ASIN=CHECK_NAN_SNIPPET+"\n  return asin(x);\n";exports.ACOS=CHECK_NAN_SNIPPET+"\n  return acos(x);\n";exports.ATAN=CHECK_NAN_SNIPPET+"\n  return atan(x);\n";exports.SINH="\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n";exports.COSH="\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n";exports.TANH="\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n";exports.SQUARE="\n  return x * x;\n";exports.TO_INT="\n  return float(int(x));\n"},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ndarray_1=__webpack_require__(3);var VarianceScalingInitializer=function(){function VarianceScalingInitializer(scale,mode,distribution){if(scale===void 0){scale=1}if(mode===void 0){mode="fan_in"}if(distribution===void 0){distribution="normal"}this.scale=scale;this.mode=mode;this.distribution=distribution}VarianceScalingInitializer.prototype.initialize=function(weightsShape,inputUnits,outputUnits){var n=0;if(this.mode==="fan_in"){n=inputUnits}else if(this.mode==="fan_out"){n=outputUnits}else if(this.mode==="fan_avg"){n=(inputUnits+outputUnits)/2}else{throw new Error("Unexpected mode for variance scaling initializer: "+this.mode)}if(this.distribution==="normal"){return ndarray_1.NDArray.randTruncatedNormal(weightsShape,0,Math.sqrt(this.scale/n))}else if(this.distribution==="uniform"){return ndarray_1.NDArray.randUniform(weightsShape,0,Math.sqrt(3*this.scale/n))}else{throw new Error("Unexpected distribution for variance scaling initializer: "+(""+this.distribution))}};return VarianceScalingInitializer}();exports.VarianceScalingInitializer=VarianceScalingInitializer;var ZerosInitializer=function(){function ZerosInitializer(){}ZerosInitializer.prototype.initialize=function(weightsShape,inputUnits,outputUnits){return ndarray_1.NDArray.zeros(weightsShape)};return ZerosInitializer}();exports.ZerosInitializer=ZerosInitializer;var OnesInitializer=function(){function OnesInitializer(){}OnesInitializer.prototype.initialize=function(weightsShape,inputUnits,outputUnits){var values=ndarray_1.NDArray.zeros(weightsShape);values.fill(1);return values};return OnesInitializer}();exports.OnesInitializer=OnesInitializer;var ConstantInitializer=function(){function ConstantInitializer(value){if(value===void 0){value=0}this.value=value}ConstantInitializer.prototype.initialize=function(weightsShape,inputUnits,outputUnits){var values=ndarray_1.NDArray.zeros(weightsShape);values.fill(this.value);return values};return ConstantInitializer}();exports.ConstantInitializer=ConstantInitializer;var NDArrayInitializer=function(){function NDArrayInitializer(ndarray){this.ndarray=ndarray}NDArrayInitializer.prototype.initialize=function(weightsShape,inputUnits,outputUnits){return this.ndarray};return NDArrayInitializer}();exports.NDArrayInitializer=NDArrayInitializer;var RandomNormalInitializer=function(){function RandomNormalInitializer(mean,stdev){if(mean===void 0){mean=0}if(stdev===void 0){stdev=.05}this.mean=mean;this.stdev=stdev}RandomNormalInitializer.prototype.initialize=function(weightsShape,inputUnits,outputUnits){return ndarray_1.NDArray.randNormal(weightsShape,this.mean,this.stdev)};return RandomNormalInitializer}();exports.RandomNormalInitializer=RandomNormalInitializer;var RandomTruncatedNormalInitializer=function(){function RandomTruncatedNormalInitializer(mean,stdev){if(mean===void 0){mean=0}if(stdev===void 0){stdev=.05}this.mean=mean;this.stdev=stdev}RandomTruncatedNormalInitializer.prototype.initialize=function(weightsShape,inputUnits,outputUnits){return ndarray_1.NDArray.randTruncatedNormal(weightsShape,this.mean,this.stdev)};return RandomTruncatedNormalInitializer}();exports.RandomTruncatedNormalInitializer=RandomTruncatedNormalInitializer;var RandomUniformInitializer=function(){function RandomUniformInitializer(minval,maxval){if(minval===void 0){minval=-.05}if(maxval===void 0){maxval=.05}this.minval=minval;this.maxval=maxval}RandomUniformInitializer.prototype.initialize=function(weightsShape,inputUnits,outputUnits){return ndarray_1.NDArray.randUniform(weightsShape,this.minval,this.maxval)};return RandomUniformInitializer}();exports.RandomUniformInitializer=RandomUniformInitializer},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ndarray_1=__webpack_require__(3);var util=__webpack_require__(4);var operation_emitter=__webpack_require__(407);var session_util=__webpack_require__(159);var tensor_array_map_1=__webpack_require__(36);var FeedDictionary=function(){function FeedDictionary(feedEntries){var _this=this;this.dict={};if(feedEntries){feedEntries.forEach(function(entry){return _this.dict[entry.tensor.id]=entry})}}return FeedDictionary}();exports.FeedDictionary=FeedDictionary;var CostReduction;(function(CostReduction){CostReduction[CostReduction["NONE"]=0]="NONE";CostReduction[CostReduction["SUM"]=1]="SUM";CostReduction[CostReduction["MEAN"]=2]="MEAN"})(CostReduction=exports.CostReduction||(exports.CostReduction={}));var Session=function(){function Session(graph,math){this.math=math;this.activationArrayMap=new tensor_array_map_1.TensorArrayMap;this.runtimeCache={};this.oneScalar=ndarray_1.Scalar.new(1);this.gradientArrayMap=new tensor_array_map_1.SummedTensorArrayMap(this.math)}Session.prototype.dispose=function(){var _this=this;this.activationArrayMap.dispose();Object.keys(this.runtimeCache).forEach(function(key){var runtime=_this.runtimeCache[key];if(runtime.operations){runtime.operations.forEach(function(op){return op.dispose()})}});this.runtimeCache={};if(this.batchSizeScalar!=null){this.batchSizeScalar.dispose()}this.oneScalar.dispose()};Session.prototype.evalAll=function(tensors,feedEntries){var _this=this;return this.math.scope(function(){var feed=new FeedDictionary(feedEntries);var runtime=_this.getOrCreateRuntime(tensors,feed);var activations=_this.activationArrayMap;session_util.disposeAndInitializeOperationOutputs(runtime.nodes,activations);session_util.disposeTransientOperationArrays(runtime.operations,_this.activationArrayMap,_this.gradientArrayMap);session_util.addPersistentArraysToTensorArrayMap(runtime.nodes,activations);session_util.loadInputsFromFeedDictionaryToTensorArrayMap(feed,activations,_this.math);runtime.operations.forEach(function(op){return op.feedForward(_this.math,activations)});var results=tensors.map(function(x){return activations.get(x)});tensors.forEach(function(x){return activations.delete(x)});session_util.releaseFeedDictionaryInputsFromTensorArrayMap(feed,activations,_this.math);return results})};Session.prototype.eval=function(tensor,feedEntries){return this.evalAll([tensor],feedEntries)[0]};Session.prototype.train=function(costTensor,feedEntries,batchSize,optimizer,costReduction){var _this=this;if(costReduction===void 0){costReduction=CostReduction.NONE}util.assert(util.isScalarShape(costTensor.shape),"Cost tensor for training must be a scalar value.");if(this.prevBatchSize!==batchSize){this.prevBatchSize=batchSize;if(this.batchSizeScalar!=null){this.batchSizeScalar.dispose()}this.batchSizeScalar=this.math.keep(ndarray_1.Scalar.new(batchSize))}var feed=new FeedDictionary(feedEntries);session_util.throwIfFeedDictionaryContainsNDArrays(feed);var runtime=this.getOrCreateRuntime([costTensor],feed);var inferenceOperations=runtime.operations;var backPropOperations=runtime.operations.slice().reverse();var activations=this.activationArrayMap;var gradients=this.gradientArrayMap;gradients.nullify(costTensor);gradients.add(costTensor,this.oneScalar);session_util.addPersistentArraysToTensorArrayMap(runtime.nodes,activations);optimizer.beforeBatch(this.math,batchSize,runtime,activations,gradients);return this.math.scope(function(){var cost=ndarray_1.Scalar.new(0);for(var i=0;i<batchSize;++i){session_util.disposeAndInitializeOperationOutputs(runtime.nodes,activations);session_util.disposeAndInitializeOperationInputGradients(runtime.nodes,gradients);session_util.disposeTransientOperationArrays(runtime.operations,activations,gradients);session_util.loadInputsFromFeedDictionaryToTensorArrayMap(feed,activations,_this.math);inferenceOperations.forEach(function(op){return op.feedForward(_this.math,activations)});backPropOperations.forEach(function(op){return op.backProp(_this.math,activations,gradients)});optimizer.afterExample(_this.math,runtime,activations,gradients);session_util.releaseFeedDictionaryInputsFromTensorArrayMap(feed,activations,_this.math);cost=_this.updateCostForExample(cost,activations.get(costTensor),costReduction)}optimizer.afterBatch(_this.math,batchSize,runtime,activations,gradients);return _this.updateCostForBatch(cost,costReduction)})};Session.prototype.updateCostForExample=function(totalCost,currCost,costReduction){if(costReduction===CostReduction.MEAN||costReduction===CostReduction.SUM){return this.math.add(totalCost,currCost)}return totalCost};Session.prototype.updateCostForBatch=function(totalCost,costReduction){if(costReduction===CostReduction.MEAN){return this.math.divide(totalCost,this.batchSizeScalar)}return totalCost};Session.prototype.getOrCreateRuntime=function(tensors,feed){var key=this.makeRuntimeCacheKey(tensors,feed);var runtime=this.runtimeCache[key];if(runtime===undefined){var nodes=session_util.getOrderedEvaluationSetFromEvalTensor(tensors,feed);session_util.removeFeedDictionaryNodesFromEvaluationSet(feed,nodes);session_util.throwErrorIfEvaluationSetContainsPlaceholderNodes(nodes);var operations=operation_emitter.emitFromGraphNodes(nodes);runtime={nodes:nodes,operations:operations};this.runtimeCache[key]=runtime}return runtime};Session.prototype.makeRuntimeCacheKey=function(tensors,feed){return tensors.map(function(x){return x.id}).sort().join("_")+"__"+Object.keys(feed.dict).sort().join("_")};return Session}();exports.Session=Session},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function defaultCompare(a,b){if(a===b){return 0}else if(a<b){return-1}else{return 1}}exports.defaultCompare=defaultCompare;var PriorityQueue=function(){function PriorityQueue(comparator,indexObserver){this.comparator=comparator;this.indexObserver=indexObserver;this.heap=[]}PriorityQueue.prototype.enqueue=function(t){this.heap.push(t);this.onIndexChanged(t,this.heap.length-1);this.siftUp(this.heap.length-1)};PriorityQueue.prototype.dequeue=function(){if(this.empty()){throw new Error("dequeue called on empty priority queue.")}var t=this.heap[0];this.swap(0,this.heap.length-1);this.heap.pop();this.siftDown(0);return t};PriorityQueue.prototype.update=function(newT,index){var last=index===this.heap.length-1;if(!last){this.swap(index,this.heap.length-1)}this.heap.pop();if(!last){if(this.siftUpIndex(index)!==-1){this.siftUp(index)}else if(this.siftDownIndex(index)!==-1){this.siftDown(index)}}this.enqueue(newT)};PriorityQueue.prototype.empty=function(){return this.heap.length===0};PriorityQueue.prototype.onIndexChanged=function(t,newIndex){if(this.indexObserver){this.indexObserver(t,newIndex)}};PriorityQueue.prototype.getParentIndex=function(index){if(index===0){return-1}return Math.floor((index-1)/2)};PriorityQueue.prototype.getLeftChildIndex=function(index){var candidate=index*2+1;return candidate<this.heap.length?candidate:-1};PriorityQueue.prototype.getRightChildIndex=function(index){var candidate=index*2+2;return candidate<this.heap.length?candidate:-1};PriorityQueue.prototype.siftUpIndex=function(index){var parentIndex=this.getParentIndex(index);if(parentIndex===-1){return-1}if(this.compare(parentIndex,index)>0){return parentIndex}return-1};PriorityQueue.prototype.siftUp=function(index){var siftIndex=this.siftUpIndex(index);while(siftIndex!==-1){this.swap(index,siftIndex);index=siftIndex;siftIndex=this.siftUpIndex(index)}};PriorityQueue.prototype.siftDownIndex=function(index){if(index>=this.heap.length){return-1}var largestChildIndex=index;var leftChildIndex=this.getLeftChildIndex(index);if(leftChildIndex!==-1&&this.compare(leftChildIndex,largestChildIndex)<0){largestChildIndex=leftChildIndex}var rightChildIndex=this.getRightChildIndex(index);if(rightChildIndex!==-1&&this.compare(rightChildIndex,largestChildIndex)<0){largestChildIndex=rightChildIndex}return largestChildIndex===index?-1:largestChildIndex};PriorityQueue.prototype.siftDown=function(index){var siftIndex=this.siftDownIndex(index);while(siftIndex!==-1){this.swap(index,siftIndex);index=siftIndex;siftIndex=this.siftDownIndex(index)}};PriorityQueue.prototype.compare=function(aIndex,bIndex){return this.comparator(this.heap[aIndex],this.heap[bIndex])};PriorityQueue.prototype.swap=function(a,b){var temp=this.heap[a];this.heap[a]=this.heap[b];this.heap[b]=temp;this.onIndexChanged(this.heap[a],a);this.onIndexChanged(this.heap[b],b)};return PriorityQueue}();exports.PriorityQueue=PriorityQueue},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ndarray_1=__webpack_require__(3);var util=__webpack_require__(4);var graph_1=__webpack_require__(68);var graph_util=__webpack_require__(19);function getTerminatingNodesFromFeedDictionary(feedDictionary){return Object.keys(feedDictionary.dict).map(function(tensorID){return feedDictionary.dict[+tensorID].tensor.node})}exports.getTerminatingNodesFromFeedDictionary=getTerminatingNodesFromFeedDictionary;function getOrderedEvaluationSetFromEvalTensor(evalTensors,feedDictionary){var terminatingNodes=getTerminatingNodesFromFeedDictionary(feedDictionary);var evalNodes=evalTensors.map(function(x){return x.node});var unorderedEvaluationSet=graph_util.getUnorderedEvaluationSet(evalNodes,terminatingNodes);var orderedEvaluationSet=graph_util.getOrderedEvaluationSet(unorderedEvaluationSet);return orderedEvaluationSet}exports.getOrderedEvaluationSetFromEvalTensor=getOrderedEvaluationSetFromEvalTensor;function addPersistentArraysToTensorArrayMap(evaluationSet,tensorArrayMap){evaluationSet.forEach(function(node){if(node instanceof graph_1.VariableNode||node instanceof graph_1.ConstantNode){tensorArrayMap.set(node.output,node.data)}})}exports.addPersistentArraysToTensorArrayMap=addPersistentArraysToTensorArrayMap;function getVariableNodesFromEvaluationSet(evaluationSet){var nodes=[];evaluationSet.forEach(function(node){if(node instanceof graph_1.VariableNode){nodes.push(node)}});return nodes}exports.getVariableNodesFromEvaluationSet=getVariableNodesFromEvaluationSet;function throwIfFeedDictionaryContainsNDArrays(feedDictionary){Object.keys(feedDictionary.dict).forEach(function(tensorID){if(feedDictionary.dict[+tensorID].data instanceof ndarray_1.NDArray){throw new Error("training requires FeedDictionary entries to be InputProviders"+"and not NDArrays.")}})}exports.throwIfFeedDictionaryContainsNDArrays=throwIfFeedDictionaryContainsNDArrays;function loadInputsFromFeedDictionaryToTensorArrayMap(batchFeed,activations,math){Object.keys(batchFeed.dict).forEach(function(tensorID){var feedEntry=batchFeed.dict[+tensorID];var data;if(feedEntry.data instanceof ndarray_1.NDArray){data=feedEntry.data}else{var provider=feedEntry.data;data=provider.getNextCopy(math)}util.assert(util.arraysEqual(feedEntry.tensor.shape,data.shape),"Error loading FeedEntry: feeding NDArray of shape "+data.shape+" "+("does not match Tensor (id: "+feedEntry.tensor.id+") shape: ")+(feedEntry.tensor.shape+"."));activations.set(feedEntry.tensor,data)})}exports.loadInputsFromFeedDictionaryToTensorArrayMap=loadInputsFromFeedDictionaryToTensorArrayMap;function releaseFeedDictionaryInputsFromTensorArrayMap(batchFeed,activations,math){Object.keys(batchFeed.dict).forEach(function(tensorID){var feedEntry=batchFeed.dict[+tensorID];if(!(feedEntry.data instanceof ndarray_1.NDArray)){var provider=feedEntry.data;var feedEntryArray=activations.get(feedEntry.tensor);provider.disposeCopy(math,feedEntryArray)}activations.delete(feedEntry.tensor)})}exports.releaseFeedDictionaryInputsFromTensorArrayMap=releaseFeedDictionaryInputsFromTensorArrayMap;function removeFeedDictionaryNodesFromEvaluationSet(feedDictionary,evaluationSet){var i=0;while(i<evaluationSet.length){var node=evaluationSet[i];if(feedDictionary.dict[node.output.id]!=null){evaluationSet.splice(i,1)}else{++i}}}exports.removeFeedDictionaryNodesFromEvaluationSet=removeFeedDictionaryNodesFromEvaluationSet;function disposeAndInitializeOperationOutputs(evaluationSet,tensorArrayMap){evaluationSet.forEach(function(node){if(!graph_util.isInputNode(node)){if(!graph_util.isPassthroughNode(node,tensorArrayMap)){tensorArrayMap.disposeArray(node.output)}tensorArrayMap.set(node.output,null)}})}exports.disposeAndInitializeOperationOutputs=disposeAndInitializeOperationOutputs;function disposeAndInitializeOperationInputGradients(evaluationSet,gradients){evaluationSet.forEach(function(node){Object.keys(node.inputs).forEach(function(inputName){var input=node.inputs[inputName];if(gradients.get(input,true)!==gradients.get(node.output,true)){gradients.disposeArray(input)}gradients.nullify(input)})})}exports.disposeAndInitializeOperationInputGradients=disposeAndInitializeOperationInputGradients;function disposeTransientOperationArrays(operations,activations,gradients){operations.forEach(function(op){return op.disposeTransientArrays(activations,gradients)})}exports.disposeTransientOperationArrays=disposeTransientOperationArrays;function throwErrorIfEvaluationSetContainsPlaceholderNodes(evaluationSet){evaluationSet.forEach(function(node){if(node instanceof graph_1.PlaceholderNode){var shape="["+node.output.shape.join(", ")+"]";throw new Error('Placeholder node "'+node.name+'" '+shape+" not present in feed dictionary.")}})}exports.throwErrorIfEvaluationSetContainsPlaceholderNodes=throwErrorIfEvaluationSetContainsPlaceholderNodes},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var environment_1=__webpack_require__(11);var tensor_array_map_1=__webpack_require__(36);var ndarray_1=__webpack_require__(3);var optimizer_1=__webpack_require__(50);var SGDOptimizer=function(_super){__extends(SGDOptimizer,_super);function SGDOptimizer(learningRate,specifiedVariableList){var _this=_super.call(this,learningRate,specifiedVariableList)||this;_this.learningRate=learningRate;return _this}SGDOptimizer.prototype.applyGradients=function(variableGradients){var _this=this;var math=environment_1.ENV.math;if(this.c==null){this.c=math.keep(ndarray_1.Scalar.new(-this.learningRate))}var varNames=Object.keys(variableGradients);varNames.forEach(function(varName){var gradient=variableGradients[varName];var value=math.registeredVariables[varName];var newValue=math.scope(function(){return math.add(math.multiply(_this.c,gradient),value)});value.assign(newValue)})};SGDOptimizer.prototype.afterBatch=function(math,batchSize,runtime,activationArrayMap,gradientArrayMap){var _this=this;math.scope(function(keep){_this.variableNodes.forEach(function(node){var oldVariable=activationArrayMap.get(node.output);var gradient=_this.variableGradients.get(node.output);var variable=math.scaledArrayAdd(_this.cGraph,gradient,_this.one,oldVariable);activationArrayMap.set(node.output,keep(variable));node.data=variable;oldVariable.dispose()})});this.variableGradients.dispose();this.variableGradients=new tensor_array_map_1.TensorArrayMap};SGDOptimizer.prototype.dispose=function(){if(this.c!=null){this.c.dispose()}_super.prototype.dispose.call(this)};SGDOptimizer.prototype.setLearningRate=function(learningRate){this.learningRate=learningRate};return SGDOptimizer}(optimizer_1.Optimizer);exports.SGDOptimizer=SGDOptimizer},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var squeezenet_1=__webpack_require__(435);exports.SqueezeNet=squeezenet_1.SqueezeNet},function(module,exports,__webpack_require__){__webpack_require__(163);module.exports=__webpack_require__(365)},function(module,exports,__webpack_require__){"use strict";(function(global){__webpack_require__(164);__webpack_require__(361);__webpack_require__(362);if(global._babelPolyfill){throw new Error("only one instance of babel-polyfill is allowed")}global._babelPolyfill=true;var DEFINE_PROPERTY="defineProperty";function define(O,key,value){O[key]||Object[DEFINE_PROPERTY](O,key,{writable:true,configurable:true,value:value})}define(String.prototype,"padLeft","".padStart);define(String.prototype,"padRight","".padEnd);"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(key){[][key]&&define(Array,key,Function.call.bind([][key]))})}).call(exports,__webpack_require__(69))},function(module,exports,__webpack_require__){__webpack_require__(165);__webpack_require__(167);__webpack_require__(168);__webpack_require__(169);__webpack_require__(170);__webpack_require__(171);__webpack_require__(172);__webpack_require__(173);__webpack_require__(174);__webpack_require__(175);__webpack_require__(176);__webpack_require__(177);__webpack_require__(178);__webpack_require__(179);__webpack_require__(180);__webpack_require__(181);__webpack_require__(183);__webpack_require__(184);__webpack_require__(185);__webpack_require__(186);__webpack_require__(187);__webpack_require__(188);__webpack_require__(189);__webpack_require__(190);__webpack_require__(191);__webpack_require__(192);__webpack_require__(193);__webpack_require__(194);__webpack_require__(195);__webpack_require__(196);__webpack_require__(197);__webpack_require__(198);__webpack_require__(199);__webpack_require__(200);__webpack_require__(201);__webpack_require__(202);__webpack_require__(203);__webpack_require__(204);__webpack_require__(205);__webpack_require__(206);__webpack_require__(207);__webpack_require__(208);__webpack_require__(209);__webpack_require__(210);__webpack_require__(211);__webpack_require__(212);__webpack_require__(213);__webpack_require__(214);__webpack_require__(215);__webpack_require__(216);__webpack_require__(217);__webpack_require__(218);__webpack_require__(219);__webpack_require__(220);__webpack_require__(221);__webpack_require__(222);__webpack_require__(223);__webpack_require__(224);__webpack_require__(225);__webpack_require__(226);__webpack_require__(227);__webpack_require__(228);__webpack_require__(229);__webpack_require__(230);__webpack_require__(231);__webpack_require__(232);__webpack_require__(233);__webpack_require__(234);__webpack_require__(235);__webpack_require__(236);__webpack_require__(237);__webpack_require__(238);__webpack_require__(239);__webpack_require__(240);__webpack_require__(241);__webpack_require__(242);__webpack_require__(243);__webpack_require__(245);__webpack_require__(246);__webpack_require__(248);__webpack_require__(249);__webpack_require__(250);__webpack_require__(251);__webpack_require__(252);__webpack_require__(253);__webpack_require__(254);__webpack_require__(256);__webpack_require__(257);__webpack_require__(258);__webpack_require__(259);__webpack_require__(260);__webpack_require__(261);__webpack_require__(262);__webpack_require__(263);__webpack_require__(264);__webpack_require__(265);__webpack_require__(266);__webpack_require__(267);__webpack_require__(268);__webpack_require__(106);__webpack_require__(269);__webpack_require__(270);__webpack_require__(132);__webpack_require__(271);__webpack_require__(272);__webpack_require__(273);__webpack_require__(274);__webpack_require__(275);__webpack_require__(135);__webpack_require__(137);__webpack_require__(138);__webpack_require__(276);__webpack_require__(277);__webpack_require__(278);__webpack_require__(279);__webpack_require__(280);__webpack_require__(281);__webpack_require__(282);__webpack_require__(283);__webpack_require__(284);__webpack_require__(285);__webpack_require__(286);__webpack_require__(287);__webpack_require__(288);__webpack_require__(289);__webpack_require__(290);__webpack_require__(291);__webpack_require__(292);__webpack_require__(293);__webpack_require__(294);__webpack_require__(295);__webpack_require__(296);__webpack_require__(297);__webpack_require__(298);__webpack_require__(299);__webpack_require__(300);__webpack_require__(301);__webpack_require__(302);__webpack_require__(303);__webpack_require__(304);__webpack_require__(305);__webpack_require__(306);__webpack_require__(307);__webpack_require__(308);__webpack_require__(309);__webpack_require__(310);__webpack_require__(311);__webpack_require__(312);__webpack_require__(313);__webpack_require__(314);__webpack_require__(315);__webpack_require__(316);__webpack_require__(317);__webpack_require__(318);__webpack_require__(319);__webpack_require__(320);__webpack_require__(321);__webpack_require__(322);__webpack_require__(323);__webpack_require__(324);__webpack_require__(325);__webpack_require__(326);__webpack_require__(327);__webpack_require__(328);__webpack_require__(329);__webpack_require__(330);__webpack_require__(331);__webpack_require__(332);__webpack_require__(333);__webpack_require__(334);__webpack_require__(335);__webpack_require__(336);__webpack_require__(337);__webpack_require__(338);__webpack_require__(339);__webpack_require__(340);__webpack_require__(341);__webpack_require__(342);__webpack_require__(343);__webpack_require__(344);__webpack_require__(345);__webpack_require__(346);__webpack_require__(347);__webpack_require__(348);__webpack_require__(349);__webpack_require__(350);__webpack_require__(351);__webpack_require__(352);__webpack_require__(353);__webpack_require__(354);__webpack_require__(355);__webpack_require__(356);__webpack_require__(357);__webpack_require__(358);__webpack_require__(359);__webpack_require__(360);module.exports=__webpack_require__(28)},function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(2);var has=__webpack_require__(15);var DESCRIPTORS=__webpack_require__(8);var $export=__webpack_require__(0);var redefine=__webpack_require__(17);var META=__webpack_require__(37).KEY;var $fails=__webpack_require__(5);var shared=__webpack_require__(70);var setToStringTag=__webpack_require__(51);var uid=__webpack_require__(40);var wks=__webpack_require__(7);var wksExt=__webpack_require__(115);var wksDefine=__webpack_require__(86);var enumKeys=__webpack_require__(166);var isArray=__webpack_require__(73);var anObject=__webpack_require__(1);var isObject=__webpack_require__(6);var toIObject=__webpack_require__(20);var toPrimitive=__webpack_require__(29);var createDesc=__webpack_require__(39);var _create=__webpack_require__(44);var gOPNExt=__webpack_require__(118);var $GOPD=__webpack_require__(21);var $DP=__webpack_require__(9);var $keys=__webpack_require__(42);var gOPD=$GOPD.f;var dP=$DP.f;var gOPN=gOPNExt.f;var $Symbol=global.Symbol;var $JSON=global.JSON;var _stringify=$JSON&&$JSON.stringify;var PROTOTYPE="prototype";var HIDDEN=wks("_hidden");var TO_PRIMITIVE=wks("toPrimitive");var isEnum={}.propertyIsEnumerable;var SymbolRegistry=shared("symbol-registry");var AllSymbols=shared("symbols");var OPSymbols=shared("op-symbols");var ObjectProto=Object[PROTOTYPE];var USE_NATIVE=typeof $Symbol=="function";var QObject=global.QObject;var setter=!QObject||!QObject[PROTOTYPE]||!QObject[PROTOTYPE].findChild;var setSymbolDesc=DESCRIPTORS&&$fails(function(){return _create(dP({},"a",{get:function(){return dP(this,"a",{value:7}).a}})).a!=7})?function(it,key,D){var protoDesc=gOPD(ObjectProto,key);if(protoDesc)delete ObjectProto[key];dP(it,key,D);if(protoDesc&&it!==ObjectProto)dP(ObjectProto,key,protoDesc)}:dP;var wrap=function(tag){var sym=AllSymbols[tag]=_create($Symbol[PROTOTYPE]);sym._k=tag;return sym};var isSymbol=USE_NATIVE&&typeof $Symbol.iterator=="symbol"?function(it){return typeof it=="symbol"}:function(it){return it instanceof $Symbol};var $defineProperty=function defineProperty(it,key,D){if(it===ObjectProto)$defineProperty(OPSymbols,key,D);anObject(it);key=toPrimitive(key,true);anObject(D);if(has(AllSymbols,key)){if(!D.enumerable){if(!has(it,HIDDEN))dP(it,HIDDEN,createDesc(1,{}));it[HIDDEN][key]=true}else{if(has(it,HIDDEN)&&it[HIDDEN][key])it[HIDDEN][key]=false;D=_create(D,{enumerable:createDesc(0,false)})}return setSymbolDesc(it,key,D)}return dP(it,key,D)};var $defineProperties=function defineProperties(it,P){anObject(it);var keys=enumKeys(P=toIObject(P));var i=0;var l=keys.length;var key;while(l>i)$defineProperty(it,key=keys[i++],P[key]);return it};var $create=function create(it,P){return P===undefined?_create(it):$defineProperties(_create(it),P)};var $propertyIsEnumerable=function propertyIsEnumerable(key){var E=isEnum.call(this,key=toPrimitive(key,true));if(this===ObjectProto&&has(AllSymbols,key)&&!has(OPSymbols,key))return false;return E||!has(this,key)||!has(AllSymbols,key)||has(this,HIDDEN)&&this[HIDDEN][key]?E:true};var $getOwnPropertyDescriptor=function getOwnPropertyDescriptor(it,key){it=toIObject(it);key=toPrimitive(key,true);if(it===ObjectProto&&has(AllSymbols,key)&&!has(OPSymbols,key))return;var D=gOPD(it,key);if(D&&has(AllSymbols,key)&&!(has(it,HIDDEN)&&it[HIDDEN][key]))D.enumerable=true;return D};var $getOwnPropertyNames=function getOwnPropertyNames(it){var names=gOPN(toIObject(it));var result=[];var i=0;var key;while(names.length>i){if(!has(AllSymbols,key=names[i++])&&key!=HIDDEN&&key!=META)result.push(key)}return result};var $getOwnPropertySymbols=function getOwnPropertySymbols(it){var IS_OP=it===ObjectProto;var names=gOPN(IS_OP?OPSymbols:toIObject(it));var result=[];var i=0;var key;while(names.length>i){if(has(AllSymbols,key=names[i++])&&(IS_OP?has(ObjectProto,key):true))result.push(AllSymbols[key])}return result};if(!USE_NATIVE){$Symbol=function Symbol(){if(this instanceof $Symbol)throw TypeError("Symbol is not a constructor!");var tag=uid(arguments.length>0?arguments[0]:undefined);var $set=function(value){if(this===ObjectProto)$set.call(OPSymbols,value);if(has(this,HIDDEN)&&has(this[HIDDEN],tag))this[HIDDEN][tag]=false;setSymbolDesc(this,tag,createDesc(1,value))};if(DESCRIPTORS&&setter)setSymbolDesc(ObjectProto,tag,{configurable:true,set:$set});return wrap(tag)};redefine($Symbol[PROTOTYPE],"toString",function toString(){return this._k});$GOPD.f=$getOwnPropertyDescriptor;$DP.f=$defineProperty;__webpack_require__(45).f=gOPNExt.f=$getOwnPropertyNames;__webpack_require__(58).f=$propertyIsEnumerable;__webpack_require__(72).f=$getOwnPropertySymbols;if(DESCRIPTORS&&!__webpack_require__(41)){redefine(ObjectProto,"propertyIsEnumerable",$propertyIsEnumerable,true)}wksExt.f=function(name){return wrap(wks(name))}}$export($export.G+$export.W+$export.F*!USE_NATIVE,{Symbol:$Symbol});for(var es6Symbols="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),j=0;es6Symbols.length>j;)wks(es6Symbols[j++]);for(var wellKnownSymbols=$keys(wks.store),k=0;wellKnownSymbols.length>k;)wksDefine(wellKnownSymbols[k++]);$export($export.S+$export.F*!USE_NATIVE,"Symbol",{for:function(key){return has(SymbolRegistry,key+="")?SymbolRegistry[key]:SymbolRegistry[key]=$Symbol(key)},keyFor:function keyFor(sym){if(!isSymbol(sym))throw TypeError(sym+" is not a symbol!");for(var key in SymbolRegistry)if(SymbolRegistry[key]===sym)return key},useSetter:function(){setter=true},useSimple:function(){setter=false}});$export($export.S+$export.F*!USE_NATIVE,"Object",{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor,getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols});$JSON&&$export($export.S+$export.F*(!USE_NATIVE||$fails(function(){var S=$Symbol();return _stringify([S])!="[null]"||_stringify({a:S})!="{}"||_stringify(Object(S))!="{}"})),"JSON",{stringify:function stringify(it){var args=[it];var i=1;var replacer,$replacer;while(arguments.length>i)args.push(arguments[i++]);$replacer=replacer=args[1];if(!isObject(replacer)&&it===undefined||isSymbol(it))return;if(!isArray(replacer))replacer=function(key,value){if(typeof $replacer=="function")value=$replacer.call(this,key,value);if(!isSymbol(value))return value};args[1]=replacer;return _stringify.apply($JSON,args)}});$Symbol[PROTOTYPE][TO_PRIMITIVE]||__webpack_require__(16)($Symbol[PROTOTYPE],TO_PRIMITIVE,$Symbol[PROTOTYPE].valueOf);setToStringTag($Symbol,"Symbol");setToStringTag(Math,"Math",true);setToStringTag(global.JSON,"JSON",true)},function(module,exports,__webpack_require__){var getKeys=__webpack_require__(42);var gOPS=__webpack_require__(72);var pIE=__webpack_require__(58);module.exports=function(it){var result=getKeys(it);var getSymbols=gOPS.f;if(getSymbols){var symbols=getSymbols(it);var isEnum=pIE.f;var i=0;var key;while(symbols.length>i)if(isEnum.call(it,key=symbols[i++]))result.push(key)}return result}},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Object",{create:__webpack_require__(44)})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S+$export.F*!__webpack_require__(8),"Object",{defineProperty:__webpack_require__(9).f})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S+$export.F*!__webpack_require__(8),"Object",{defineProperties:__webpack_require__(117)})},function(module,exports,__webpack_require__){var toIObject=__webpack_require__(20);var $getOwnPropertyDescriptor=__webpack_require__(21).f;__webpack_require__(32)("getOwnPropertyDescriptor",function(){return function getOwnPropertyDescriptor(it,key){return $getOwnPropertyDescriptor(toIObject(it),key)}})},function(module,exports,__webpack_require__){var toObject=__webpack_require__(12);var $getPrototypeOf=__webpack_require__(22);__webpack_require__(32)("getPrototypeOf",function(){return function getPrototypeOf(it){return $getPrototypeOf(toObject(it))}})},function(module,exports,__webpack_require__){var toObject=__webpack_require__(12);var $keys=__webpack_require__(42);__webpack_require__(32)("keys",function(){return function keys(it){return $keys(toObject(it))}})},function(module,exports,__webpack_require__){__webpack_require__(32)("getOwnPropertyNames",function(){return __webpack_require__(118).f})},function(module,exports,__webpack_require__){var isObject=__webpack_require__(6);var meta=__webpack_require__(37).onFreeze;__webpack_require__(32)("freeze",function($freeze){return function freeze(it){return $freeze&&isObject(it)?$freeze(meta(it)):it}})},function(module,exports,__webpack_require__){var isObject=__webpack_require__(6);var meta=__webpack_require__(37).onFreeze;__webpack_require__(32)("seal",function($seal){return function seal(it){return $seal&&isObject(it)?$seal(meta(it)):it}})},function(module,exports,__webpack_require__){var isObject=__webpack_require__(6);var meta=__webpack_require__(37).onFreeze;__webpack_require__(32)("preventExtensions",function($preventExtensions){return function preventExtensions(it){return $preventExtensions&&isObject(it)?$preventExtensions(meta(it)):it}})},function(module,exports,__webpack_require__){var isObject=__webpack_require__(6);__webpack_require__(32)("isFrozen",function($isFrozen){return function isFrozen(it){return isObject(it)?$isFrozen?$isFrozen(it):false:true}})},function(module,exports,__webpack_require__){var isObject=__webpack_require__(6);__webpack_require__(32)("isSealed",function($isSealed){return function isSealed(it){return isObject(it)?$isSealed?$isSealed(it):false:true}})},function(module,exports,__webpack_require__){var isObject=__webpack_require__(6);__webpack_require__(32)("isExtensible",function($isExtensible){return function isExtensible(it){return isObject(it)?$isExtensible?$isExtensible(it):true:false}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S+$export.F,"Object",{assign:__webpack_require__(119)})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Object",{is:__webpack_require__(182)})},function(module,exports){module.exports=Object.is||function is(x,y){return x===y?x!==0||1/x===1/y:x!=x&&y!=y}},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Object",{setPrototypeOf:__webpack_require__(90).set})},function(module,exports,__webpack_require__){"use strict";var classof=__webpack_require__(59);var test={};test[__webpack_require__(7)("toStringTag")]="z";if(test+""!="[object z]"){__webpack_require__(17)(Object.prototype,"toString",function toString(){return"[object "+classof(this)+"]"},true)}},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.P,"Function",{bind:__webpack_require__(120)})},function(module,exports,__webpack_require__){var dP=__webpack_require__(9).f;var FProto=Function.prototype;var nameRE=/^\s*function ([^ (]*)/;var NAME="name";NAME in FProto||__webpack_require__(8)&&dP(FProto,NAME,{configurable:true,get:function(){try{return(""+this).match(nameRE)[1]}catch(e){return""}}})},function(module,exports,__webpack_require__){"use strict";var isObject=__webpack_require__(6);var getPrototypeOf=__webpack_require__(22);var HAS_INSTANCE=__webpack_require__(7)("hasInstance");var FunctionProto=Function.prototype;if(!(HAS_INSTANCE in FunctionProto))__webpack_require__(9).f(FunctionProto,HAS_INSTANCE,{value:function(O){if(typeof this!="function"||!isObject(O))return false;if(!isObject(this.prototype))return O instanceof this;while(O=getPrototypeOf(O))if(this.prototype===O)return true;return false}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $parseInt=__webpack_require__(122);$export($export.G+$export.F*(parseInt!=$parseInt),{parseInt:$parseInt})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $parseFloat=__webpack_require__(123);$export($export.G+$export.F*(parseFloat!=$parseFloat),{parseFloat:$parseFloat})},function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(2);var has=__webpack_require__(15);var cof=__webpack_require__(25);var inheritIfRequired=__webpack_require__(92);var toPrimitive=__webpack_require__(29);var fails=__webpack_require__(5);var gOPN=__webpack_require__(45).f;var gOPD=__webpack_require__(21).f;var dP=__webpack_require__(9).f;var $trim=__webpack_require__(52).trim;var NUMBER="Number";var $Number=global[NUMBER];var Base=$Number;var proto=$Number.prototype;var BROKEN_COF=cof(__webpack_require__(44)(proto))==NUMBER;var TRIM="trim"in String.prototype;var toNumber=function(argument){var it=toPrimitive(argument,false);if(typeof it=="string"&&it.length>2){it=TRIM?it.trim():$trim(it,3);var first=it.charCodeAt(0);var third,radix,maxCode;if(first===43||first===45){third=it.charCodeAt(2);if(third===88||third===120)return NaN}else if(first===48){switch(it.charCodeAt(1)){case 66:case 98:radix=2;maxCode=49;break;case 79:case 111:radix=8;maxCode=55;break;default:return+it}for(var digits=it.slice(2),i=0,l=digits.length,code;i<l;i++){code=digits.charCodeAt(i);if(code<48||code>maxCode)return NaN}return parseInt(digits,radix)}}return+it};if(!$Number(" 0o1")||!$Number("0b1")||$Number("+0x1")){$Number=function Number(value){var it=arguments.length<1?0:value;var that=this;return that instanceof $Number&&(BROKEN_COF?fails(function(){proto.valueOf.call(that)}):cof(that)!=NUMBER)?inheritIfRequired(new Base(toNumber(it)),that,$Number):toNumber(it)};for(var keys=__webpack_require__(8)?gOPN(Base):("MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,"+"EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,"+"MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger").split(","),j=0,key;keys.length>j;j++){if(has(Base,key=keys[j])&&!has($Number,key)){dP($Number,key,gOPD(Base,key))}}$Number.prototype=proto;proto.constructor=$Number;__webpack_require__(17)(global,NUMBER,$Number)}},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var toInteger=__webpack_require__(31);var aNumberValue=__webpack_require__(124);var repeat=__webpack_require__(93);var $toFixed=1..toFixed;var floor=Math.floor;var data=[0,0,0,0,0,0];var ERROR="Number.toFixed: incorrect invocation!";var ZERO="0";var multiply=function(n,c){var i=-1;var c2=c;while(++i<6){c2+=n*data[i];data[i]=c2%1e7;c2=floor(c2/1e7)}};var divide=function(n){var i=6;var c=0;while(--i>=0){c+=data[i];data[i]=floor(c/n);c=c%n*1e7}};var numToString=function(){var i=6;var s="";while(--i>=0){if(s!==""||i===0||data[i]!==0){var t=String(data[i]);s=s===""?t:s+repeat.call(ZERO,7-t.length)+t}}return s};var pow=function(x,n,acc){return n===0?acc:n%2===1?pow(x,n-1,acc*x):pow(x*x,n/2,acc)};var log=function(x){var n=0;var x2=x;while(x2>=4096){n+=12;x2/=4096}while(x2>=2){n+=1;x2/=2}return n};$export($export.P+$export.F*(!!$toFixed&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||(0xde0b6b3a7640080).toFixed(0)!=="1000000000000000128")||!__webpack_require__(5)(function(){$toFixed.call({})})),"Number",{toFixed:function toFixed(fractionDigits){var x=aNumberValue(this,ERROR);var f=toInteger(fractionDigits);var s="";var m=ZERO;var e,z,j,k;if(f<0||f>20)throw RangeError(ERROR);if(x!=x)return"NaN";if(x<=-1e21||x>=1e21)return String(x);if(x<0){s="-";x=-x}if(x>1e-21){e=log(x*pow(2,69,1))-69;z=e<0?x*pow(2,-e,1):x/pow(2,e,1);z*=4503599627370496;e=52-e;if(e>0){multiply(0,z);j=f;while(j>=7){multiply(1e7,0);j-=7}multiply(pow(10,j,1),0);j=e-1;while(j>=23){divide(1<<23);j-=23}divide(1<<j);multiply(1,1);divide(2);m=numToString()}else{multiply(0,z);multiply(1<<-e,0);m=numToString()+repeat.call(ZERO,f)}}if(f>0){k=m.length;m=s+(k<=f?"0."+repeat.call(ZERO,f-k)+m:m.slice(0,k-f)+"."+m.slice(k-f))}else{m=s+m}return m}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $fails=__webpack_require__(5);var aNumberValue=__webpack_require__(124);var $toPrecision=1..toPrecision;$export($export.P+$export.F*($fails(function(){return $toPrecision.call(1,undefined)!=="1"})||!$fails(function(){$toPrecision.call({})})),"Number",{toPrecision:function toPrecision(precision){var that=aNumberValue(this,"Number#toPrecision: incorrect invocation!");return precision===undefined?$toPrecision.call(that):$toPrecision.call(that,precision)}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Number",{EPSILON:Math.pow(2,-52)})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var _isFinite=__webpack_require__(2).isFinite;$export($export.S,"Number",{isFinite:function isFinite(it){return typeof it=="number"&&_isFinite(it)}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Number",{isInteger:__webpack_require__(125)})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Number",{isNaN:function isNaN(number){return number!=number}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var isInteger=__webpack_require__(125);var abs=Math.abs;$export($export.S,"Number",{isSafeInteger:function isSafeInteger(number){return isInteger(number)&&abs(number)<=9007199254740991}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $parseFloat=__webpack_require__(123);$export($export.S+$export.F*(Number.parseFloat!=$parseFloat),"Number",{parseFloat:$parseFloat})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $parseInt=__webpack_require__(122);$export($export.S+$export.F*(Number.parseInt!=$parseInt),"Number",{parseInt:$parseInt})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var log1p=__webpack_require__(126);var sqrt=Math.sqrt;var $acosh=Math.acosh;$export($export.S+$export.F*!($acosh&&Math.floor($acosh(Number.MAX_VALUE))==710&&$acosh(Infinity)==Infinity),"Math",{acosh:function acosh(x){return(x=+x)<1?NaN:x>94906265.62425156?Math.log(x)+Math.LN2:log1p(x-1+sqrt(x-1)*sqrt(x+1))}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $asinh=Math.asinh;function asinh(x){return!isFinite(x=+x)||x==0?x:x<0?-asinh(-x):Math.log(x+Math.sqrt(x*x+1))}$export($export.S+$export.F*!($asinh&&1/$asinh(0)>0),"Math",{asinh:asinh})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $atanh=Math.atanh;$export($export.S+$export.F*!($atanh&&1/$atanh(-0)<0),"Math",{atanh:function atanh(x){return(x=+x)==0?x:Math.log((1+x)/(1-x))/2}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var sign=__webpack_require__(94);$export($export.S,"Math",{cbrt:function cbrt(x){return sign(x=+x)*Math.pow(Math.abs(x),1/3)}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Math",{clz32:function clz32(x){return(x>>>=0)?31-Math.floor(Math.log(x+.5)*Math.LOG2E):32}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var exp=Math.exp;$export($export.S,"Math",{cosh:function cosh(x){return(exp(x=+x)+exp(-x))/2}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $expm1=__webpack_require__(95);$export($export.S+$export.F*($expm1!=Math.expm1),"Math",{expm1:$expm1})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Math",{fround:__webpack_require__(127)})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var abs=Math.abs;$export($export.S,"Math",{hypot:function hypot(value1,value2){var sum=0;var i=0;var aLen=arguments.length;var larg=0;var arg,div;while(i<aLen){arg=abs(arguments[i++]);if(larg<arg){div=larg/arg;sum=sum*div*div+1;larg=arg}else if(arg>0){div=arg/larg;sum+=div*div}else sum+=arg}return larg===Infinity?Infinity:larg*Math.sqrt(sum)}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $imul=Math.imul;$export($export.S+$export.F*__webpack_require__(5)(function(){return $imul(4294967295,5)!=-5||$imul.length!=2}),"Math",{imul:function imul(x,y){var UINT16=65535;var xn=+x;var yn=+y;var xl=UINT16&xn;var yl=UINT16&yn;return 0|xl*yl+((UINT16&xn>>>16)*yl+xl*(UINT16&yn>>>16)<<16>>>0)}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Math",{log10:function log10(x){return Math.log(x)*Math.LOG10E}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Math",{log1p:__webpack_require__(126)})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Math",{log2:function log2(x){return Math.log(x)/Math.LN2}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Math",{sign:__webpack_require__(94)})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var expm1=__webpack_require__(95);var exp=Math.exp;$export($export.S+$export.F*__webpack_require__(5)(function(){return!Math.sinh(-2e-17)!=-2e-17}),"Math",{sinh:function sinh(x){return Math.abs(x=+x)<1?(expm1(x)-expm1(-x))/2:(exp(x-1)-exp(-x-1))*(Math.E/2)}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var expm1=__webpack_require__(95);var exp=Math.exp;$export($export.S,"Math",{tanh:function tanh(x){var a=expm1(x=+x);var b=expm1(-x);return a==Infinity?1:b==Infinity?-1:(a-b)/(exp(x)+exp(-x))}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Math",{trunc:function trunc(it){return(it>0?Math.floor:Math.ceil)(it)}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var toAbsoluteIndex=__webpack_require__(43);var fromCharCode=String.fromCharCode;var $fromCodePoint=String.fromCodePoint;$export($export.S+$export.F*(!!$fromCodePoint&&$fromCodePoint.length!=1),"String",{fromCodePoint:function fromCodePoint(x){var res=[];var aLen=arguments.length;var i=0;var code;while(aLen>i){code=+arguments[i++];if(toAbsoluteIndex(code,1114111)!==code)throw RangeError(code+" is not a valid code point");res.push(code<65536?fromCharCode(code):fromCharCode(((code-=65536)>>10)+55296,code%1024+56320))}return res.join("")}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var toIObject=__webpack_require__(20);var toLength=__webpack_require__(10);$export($export.S,"String",{raw:function raw(callSite){var tpl=toIObject(callSite.raw);var len=toLength(tpl.length);var aLen=arguments.length;var res=[];var i=0;while(len>i){res.push(String(tpl[i++]));if(i<aLen)res.push(String(arguments[i]))}return res.join("")}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(52)("trim",function($trim){return function trim(){return $trim(this,3)}})},function(module,exports,__webpack_require__){"use strict";var $at=__webpack_require__(96)(true);__webpack_require__(97)(String,"String",function(iterated){this._t=String(iterated);this._i=0},function(){var O=this._t;var index=this._i;var point;if(index>=O.length)return{value:undefined,done:true};point=$at(O,index);this._i+=point.length;return{value:point,done:false}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $at=__webpack_require__(96)(false);$export($export.P,"String",{codePointAt:function codePointAt(pos){return $at(this,pos)}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var toLength=__webpack_require__(10);var context=__webpack_require__(99);var ENDS_WITH="endsWith";var $endsWith=""[ENDS_WITH];$export($export.P+$export.F*__webpack_require__(100)(ENDS_WITH),"String",{endsWith:function endsWith(searchString){var that=context(this,searchString,ENDS_WITH);var endPosition=arguments.length>1?arguments[1]:undefined;var len=toLength(that.length);var end=endPosition===undefined?len:Math.min(toLength(endPosition),len);var search=String(searchString);return $endsWith?$endsWith.call(that,search,end):that.slice(end-search.length,end)===search}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var context=__webpack_require__(99);var INCLUDES="includes";$export($export.P+$export.F*__webpack_require__(100)(INCLUDES),"String",{includes:function includes(searchString){return!!~context(this,searchString,INCLUDES).indexOf(searchString,arguments.length>1?arguments[1]:undefined)}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.P,"String",{repeat:__webpack_require__(93)})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var toLength=__webpack_require__(10);var context=__webpack_require__(99);var STARTS_WITH="startsWith";var $startsWith=""[STARTS_WITH];$export($export.P+$export.F*__webpack_require__(100)(STARTS_WITH),"String",{startsWith:function startsWith(searchString){var that=context(this,searchString,STARTS_WITH);var index=toLength(Math.min(arguments.length>1?arguments[1]:undefined,that.length));var search=String(searchString);return $startsWith?$startsWith.call(that,search,index):that.slice(index,index+search.length)===search}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(18)("anchor",function(createHTML){return function anchor(name){return createHTML(this,"a","name",name)}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(18)("big",function(createHTML){return function big(){return createHTML(this,"big","","")}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(18)("blink",function(createHTML){return function blink(){return createHTML(this,"blink","","")}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(18)("bold",function(createHTML){return function bold(){return createHTML(this,"b","","")}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(18)("fixed",function(createHTML){return function fixed(){return createHTML(this,"tt","","")}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(18)("fontcolor",function(createHTML){return function fontcolor(color){return createHTML(this,"font","color",color)}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(18)("fontsize",function(createHTML){return function fontsize(size){return createHTML(this,"font","size",size)}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(18)("italics",function(createHTML){return function italics(){return createHTML(this,"i","","")}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(18)("link",function(createHTML){return function link(url){return createHTML(this,"a","href",url)}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(18)("small",function(createHTML){return function small(){return createHTML(this,"small","","")}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(18)("strike",function(createHTML){return function strike(){return createHTML(this,"strike","","")}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(18)("sub",function(createHTML){return function sub(){return createHTML(this,"sub","","")}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(18)("sup",function(createHTML){return function sup(){return createHTML(this,"sup","","")}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Date",{now:function(){return(new Date).getTime()}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var toObject=__webpack_require__(12);var toPrimitive=__webpack_require__(29);$export($export.P+$export.F*__webpack_require__(5)(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1}),"Date",{toJSON:function toJSON(key){var O=toObject(this);var pv=toPrimitive(O);return typeof pv=="number"&&!isFinite(pv)?null:O.toISOString()}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var toISOString=__webpack_require__(244);$export($export.P+$export.F*(Date.prototype.toISOString!==toISOString),"Date",{toISOString:toISOString})},function(module,exports,__webpack_require__){"use strict";var fails=__webpack_require__(5);var getTime=Date.prototype.getTime;var $toISOString=Date.prototype.toISOString;var lz=function(num){return num>9?num:"0"+num};module.exports=fails(function(){return $toISOString.call(new Date(-5e13-1))!="0385-07-25T07:06:39.999Z"})||!fails(function(){$toISOString.call(new Date(NaN))})?function toISOString(){if(!isFinite(getTime.call(this)))throw RangeError("Invalid time value");var d=this;var y=d.getUTCFullYear();var m=d.getUTCMilliseconds();var s=y<0?"-":y>9999?"+":"";return s+("00000"+Math.abs(y)).slice(s?-6:-4)+"-"+lz(d.getUTCMonth()+1)+"-"+lz(d.getUTCDate())+"T"+lz(d.getUTCHours())+":"+lz(d.getUTCMinutes())+":"+lz(d.getUTCSeconds())+"."+(m>99?m:"0"+lz(m))+"Z"}:$toISOString},function(module,exports,__webpack_require__){var DateProto=Date.prototype;var INVALID_DATE="Invalid Date";var TO_STRING="toString";var $toString=DateProto[TO_STRING];var getTime=DateProto.getTime;if(new Date(NaN)+""!=INVALID_DATE){__webpack_require__(17)(DateProto,TO_STRING,function toString(){var value=getTime.call(this);return value===value?$toString.call(this):INVALID_DATE})}},function(module,exports,__webpack_require__){var TO_PRIMITIVE=__webpack_require__(7)("toPrimitive");var proto=Date.prototype;if(!(TO_PRIMITIVE in proto))__webpack_require__(16)(proto,TO_PRIMITIVE,__webpack_require__(247))},function(module,exports,__webpack_require__){"use strict";var anObject=__webpack_require__(1);var toPrimitive=__webpack_require__(29);var NUMBER="number";module.exports=function(hint){if(hint!=="string"&&hint!==NUMBER&&hint!=="default")throw TypeError("Incorrect hint");return toPrimitive(anObject(this),hint!=NUMBER)}},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Array",{isArray:__webpack_require__(73)})},function(module,exports,__webpack_require__){"use strict";var ctx=__webpack_require__(24);var $export=__webpack_require__(0);var toObject=__webpack_require__(12);var call=__webpack_require__(128);var isArrayIter=__webpack_require__(101);var toLength=__webpack_require__(10);var createProperty=__webpack_require__(102);var getIterFn=__webpack_require__(103);$export($export.S+$export.F*!__webpack_require__(75)(function(iter){Array.from(iter)}),"Array",{from:function from(arrayLike){var O=toObject(arrayLike);var C=typeof this=="function"?this:Array;var aLen=arguments.length;var mapfn=aLen>1?arguments[1]:undefined;var mapping=mapfn!==undefined;var index=0;var iterFn=getIterFn(O);var length,result,step,iterator;if(mapping)mapfn=ctx(mapfn,aLen>2?arguments[2]:undefined,2);if(iterFn!=undefined&&!(C==Array&&isArrayIter(iterFn))){for(iterator=iterFn.call(O),result=new C;!(step=iterator.next()).done;index++){createProperty(result,index,mapping?call(iterator,mapfn,[step.value,index],true):step.value)}}else{length=toLength(O.length);for(result=new C(length);length>index;index++){createProperty(result,index,mapping?mapfn(O[index],index):O[index])}}result.length=index;return result}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var createProperty=__webpack_require__(102);$export($export.S+$export.F*__webpack_require__(5)(function(){function F(){}return!(Array.of.call(F)instanceof F)}),"Array",{of:function of(){var index=0;var aLen=arguments.length;var result=new(typeof this=="function"?this:Array)(aLen);while(aLen>index)createProperty(result,index,arguments[index++]);result.length=aLen;return result}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var toIObject=__webpack_require__(20);var arrayJoin=[].join;$export($export.P+$export.F*(__webpack_require__(57)!=Object||!__webpack_require__(26)(arrayJoin)),"Array",{join:function join(separator){return arrayJoin.call(toIObject(this),separator===undefined?",":separator)}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var html=__webpack_require__(89);var cof=__webpack_require__(25);var toAbsoluteIndex=__webpack_require__(43);var toLength=__webpack_require__(10);var arraySlice=[].slice;$export($export.P+$export.F*__webpack_require__(5)(function(){if(html)arraySlice.call(html)}),"Array",{slice:function slice(begin,end){var len=toLength(this.length);var klass=cof(this);end=end===undefined?len:end;if(klass=="Array")return arraySlice.call(this,begin,end);var start=toAbsoluteIndex(begin,len);var upTo=toAbsoluteIndex(end,len);var size=toLength(upTo-start);var cloned=new Array(size);var i=0;for(;i<size;i++)cloned[i]=klass=="String"?this.charAt(start+i):this[start+i];return cloned}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var aFunction=__webpack_require__(14);var toObject=__webpack_require__(12);var fails=__webpack_require__(5);var $sort=[].sort;var test=[1,2,3];$export($export.P+$export.F*(fails(function(){test.sort(undefined)})||!fails(function(){test.sort(null)})||!__webpack_require__(26)($sort)),"Array",{sort:function sort(comparefn){return comparefn===undefined?$sort.call(toObject(this)):$sort.call(toObject(this),aFunction(comparefn))}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $forEach=__webpack_require__(33)(0);var STRICT=__webpack_require__(26)([].forEach,true);$export($export.P+$export.F*!STRICT,"Array",{forEach:function forEach(callbackfn){return $forEach(this,callbackfn,arguments[1])}})},function(module,exports,__webpack_require__){var isObject=__webpack_require__(6);var isArray=__webpack_require__(73);var SPECIES=__webpack_require__(7)("species");module.exports=function(original){var C;if(isArray(original)){C=original.constructor;if(typeof C=="function"&&(C===Array||isArray(C.prototype)))C=undefined;if(isObject(C)){C=C[SPECIES];if(C===null)C=undefined}}return C===undefined?Array:C}},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $map=__webpack_require__(33)(1);$export($export.P+$export.F*!__webpack_require__(26)([].map,true),"Array",{map:function map(callbackfn){return $map(this,callbackfn,arguments[1])}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $filter=__webpack_require__(33)(2);$export($export.P+$export.F*!__webpack_require__(26)([].filter,true),"Array",{filter:function filter(callbackfn){return $filter(this,callbackfn,arguments[1])}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $some=__webpack_require__(33)(3);$export($export.P+$export.F*!__webpack_require__(26)([].some,true),"Array",{some:function some(callbackfn){return $some(this,callbackfn,arguments[1])}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $every=__webpack_require__(33)(4);$export($export.P+$export.F*!__webpack_require__(26)([].every,true),"Array",{every:function every(callbackfn){return $every(this,callbackfn,arguments[1])}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $reduce=__webpack_require__(129);$export($export.P+$export.F*!__webpack_require__(26)([].reduce,true),"Array",{reduce:function reduce(callbackfn){return $reduce(this,callbackfn,arguments.length,arguments[1],false)}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $reduce=__webpack_require__(129);$export($export.P+$export.F*!__webpack_require__(26)([].reduceRight,true),"Array",{reduceRight:function reduceRight(callbackfn){return $reduce(this,callbackfn,arguments.length,arguments[1],true)}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $indexOf=__webpack_require__(71)(false);var $native=[].indexOf;var NEGATIVE_ZERO=!!$native&&1/[1].indexOf(1,-0)<0;$export($export.P+$export.F*(NEGATIVE_ZERO||!__webpack_require__(26)($native)),"Array",{indexOf:function indexOf(searchElement){return NEGATIVE_ZERO?$native.apply(this,arguments)||0:$indexOf(this,searchElement,arguments[1])}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var toIObject=__webpack_require__(20);var toInteger=__webpack_require__(31);var toLength=__webpack_require__(10);var $native=[].lastIndexOf;var NEGATIVE_ZERO=!!$native&&1/[1].lastIndexOf(1,-0)<0;$export($export.P+$export.F*(NEGATIVE_ZERO||!__webpack_require__(26)($native)),"Array",{lastIndexOf:function lastIndexOf(searchElement){if(NEGATIVE_ZERO)return $native.apply(this,arguments)||0;var O=toIObject(this);var length=toLength(O.length);var index=length-1;if(arguments.length>1)index=Math.min(index,toInteger(arguments[1]));if(index<0)index=length+index;for(;index>=0;index--)if(index in O)if(O[index]===searchElement)return index||0;return-1}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.P,"Array",{copyWithin:__webpack_require__(130)});__webpack_require__(38)("copyWithin")},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.P,"Array",{fill:__webpack_require__(105)});__webpack_require__(38)("fill")},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $find=__webpack_require__(33)(5);var KEY="find";var forced=true;if(KEY in[])Array(1)[KEY](function(){forced=false});$export($export.P+$export.F*forced,"Array",{find:function find(callbackfn){return $find(this,callbackfn,arguments.length>1?arguments[1]:undefined)}});__webpack_require__(38)(KEY)},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $find=__webpack_require__(33)(6);var KEY="findIndex";var forced=true;if(KEY in[])Array(1)[KEY](function(){forced=false});$export($export.P+$export.F*forced,"Array",{findIndex:function findIndex(callbackfn){return $find(this,callbackfn,arguments.length>1?arguments[1]:undefined)}});__webpack_require__(38)(KEY)},function(module,exports,__webpack_require__){__webpack_require__(46)("Array")},function(module,exports,__webpack_require__){var global=__webpack_require__(2);var inheritIfRequired=__webpack_require__(92);var dP=__webpack_require__(9).f;var gOPN=__webpack_require__(45).f;var isRegExp=__webpack_require__(74);var $flags=__webpack_require__(76);var $RegExp=global.RegExp;var Base=$RegExp;var proto=$RegExp.prototype;var re1=/a/g;var re2=/a/g;var CORRECT_NEW=new $RegExp(re1)!==re1;if(__webpack_require__(8)&&(!CORRECT_NEW||__webpack_require__(5)(function(){re2[__webpack_require__(7)("match")]=false;return $RegExp(re1)!=re1||$RegExp(re2)==re2||$RegExp(re1,"i")!="/a/i"}))){$RegExp=function RegExp(p,f){var tiRE=this instanceof $RegExp;var piRE=isRegExp(p);var fiU=f===undefined;return!tiRE&&piRE&&p.constructor===$RegExp&&fiU?p:inheritIfRequired(CORRECT_NEW?new Base(piRE&&!fiU?p.source:p,f):Base((piRE=p instanceof $RegExp)?p.source:p,piRE&&fiU?$flags.call(p):f),tiRE?this:proto,$RegExp)};var proxy=function(key){key in $RegExp||dP($RegExp,key,{configurable:true,get:function(){return Base[key]},set:function(it){Base[key]=it}})};for(var keys=gOPN(Base),i=0;keys.length>i;)proxy(keys[i++]);proto.constructor=$RegExp;$RegExp.prototype=proto;__webpack_require__(17)(global,"RegExp",$RegExp)}__webpack_require__(46)("RegExp")},function(module,exports,__webpack_require__){"use strict";__webpack_require__(132);var anObject=__webpack_require__(1);var $flags=__webpack_require__(76);var DESCRIPTORS=__webpack_require__(8);var TO_STRING="toString";var $toString=/./[TO_STRING];var define=function(fn){__webpack_require__(17)(RegExp.prototype,TO_STRING,fn,true)};if(__webpack_require__(5)(function(){return $toString.call({source:"a",flags:"b"})!="/a/b"})){define(function toString(){var R=anObject(this);return"/".concat(R.source,"/","flags"in R?R.flags:!DESCRIPTORS&&R instanceof RegExp?$flags.call(R):undefined)})}else if($toString.name!=TO_STRING){define(function toString(){return $toString.call(this)})}},function(module,exports,__webpack_require__){__webpack_require__(77)("match",1,function(defined,MATCH,$match){return[function match(regexp){"use strict";var O=defined(this);var fn=regexp==undefined?undefined:regexp[MATCH];return fn!==undefined?fn.call(regexp,O):new RegExp(regexp)[MATCH](String(O))},$match]})},function(module,exports,__webpack_require__){__webpack_require__(77)("replace",2,function(defined,REPLACE,$replace){return[function replace(searchValue,replaceValue){"use strict";var O=defined(this);var fn=searchValue==undefined?undefined:searchValue[REPLACE];return fn!==undefined?fn.call(searchValue,O,replaceValue):$replace.call(String(O),searchValue,replaceValue)},$replace]})},function(module,exports,__webpack_require__){__webpack_require__(77)("search",1,function(defined,SEARCH,$search){return[function search(regexp){"use strict";var O=defined(this);var fn=regexp==undefined?undefined:regexp[SEARCH];return fn!==undefined?fn.call(regexp,O):new RegExp(regexp)[SEARCH](String(O))},$search]})},function(module,exports,__webpack_require__){__webpack_require__(77)("split",2,function(defined,SPLIT,$split){"use strict";var isRegExp=__webpack_require__(74);var _split=$split;var $push=[].push;var $SPLIT="split";var LENGTH="length";var LAST_INDEX="lastIndex";if("abbc"[$SPLIT](/(b)*/)[1]=="c"||"test"[$SPLIT](/(?:)/,-1)[LENGTH]!=4||"ab"[$SPLIT](/(?:ab)*/)[LENGTH]!=2||"."[$SPLIT](/(.?)(.?)/)[LENGTH]!=4||"."[$SPLIT](/()()/)[LENGTH]>1||""[$SPLIT](/.?/)[LENGTH]){var NPCG=/()??/.exec("")[1]===undefined;$split=function(separator,limit){var string=String(this);if(separator===undefined&&limit===0)return[];if(!isRegExp(separator))return _split.call(string,separator,limit);var output=[];var flags=(separator.ignoreCase?"i":"")+(separator.multiline?"m":"")+(separator.unicode?"u":"")+(separator.sticky?"y":"");var lastLastIndex=0;var splitLimit=limit===undefined?4294967295:limit>>>0;var separatorCopy=new RegExp(separator.source,flags+"g");var separator2,match,lastIndex,lastLength,i;if(!NPCG)separator2=new RegExp("^"+separatorCopy.source+"$(?!\\s)",flags);while(match=separatorCopy.exec(string)){lastIndex=match.index+match[0][LENGTH];if(lastIndex>lastLastIndex){output.push(string.slice(lastLastIndex,match.index));if(!NPCG&&match[LENGTH]>1)match[0].replace(separator2,function(){for(i=1;i<arguments[LENGTH]-2;i++)if(arguments[i]===undefined)match[i]=undefined});if(match[LENGTH]>1&&match.index<string[LENGTH])$push.apply(output,match.slice(1));lastLength=match[0][LENGTH];lastLastIndex=lastIndex;if(output[LENGTH]>=splitLimit)break}if(separatorCopy[LAST_INDEX]===match.index)separatorCopy[LAST_INDEX]++}if(lastLastIndex===string[LENGTH]){if(lastLength||!separatorCopy.test(""))output.push("")}else output.push(string.slice(lastLastIndex));return output[LENGTH]>splitLimit?output.slice(0,splitLimit):output}}else if("0"[$SPLIT](undefined,0)[LENGTH]){$split=function(separator,limit){return separator===undefined&&limit===0?[]:_split.call(this,separator,limit)}}return[function split(separator,limit){var O=defined(this);var fn=separator==undefined?undefined:separator[SPLIT];return fn!==undefined?fn.call(separator,O,limit):$split.call(String(O),separator,limit)},$split]})},function(module,exports,__webpack_require__){"use strict";var LIBRARY=__webpack_require__(41);var global=__webpack_require__(2);var ctx=__webpack_require__(24);var classof=__webpack_require__(59);var $export=__webpack_require__(0);var isObject=__webpack_require__(6);var aFunction=__webpack_require__(14);var anInstance=__webpack_require__(47);var forOf=__webpack_require__(48);var speciesConstructor=__webpack_require__(78);var task=__webpack_require__(107).set;var microtask=__webpack_require__(108)();var newPromiseCapabilityModule=__webpack_require__(109);var perform=__webpack_require__(133);var promiseResolve=__webpack_require__(134);var PROMISE="Promise";var TypeError=global.TypeError;var process=global.process;var $Promise=global[PROMISE];var isNode=classof(process)=="process";var empty=function(){};var Internal,newGenericPromiseCapability,OwnPromiseCapability,Wrapper;var newPromiseCapability=newGenericPromiseCapability=newPromiseCapabilityModule.f;var USE_NATIVE=!!function(){try{var promise=$Promise.resolve(1);var FakePromise=(promise.constructor={})[__webpack_require__(7)("species")]=function(exec){exec(empty,empty)};return(isNode||typeof PromiseRejectionEvent=="function")&&promise.then(empty)instanceof FakePromise}catch(e){}}();var isThenable=function(it){var then;return isObject(it)&&typeof(then=it.then)=="function"?then:false};var notify=function(promise,isReject){if(promise._n)return;promise._n=true;var chain=promise._c;microtask(function(){var value=promise._v;var ok=promise._s==1;var i=0;var run=function(reaction){var handler=ok?reaction.ok:reaction.fail;var resolve=reaction.resolve;var reject=reaction.reject;var domain=reaction.domain;var result,then;try{if(handler){if(!ok){if(promise._h==2)onHandleUnhandled(promise);promise._h=1}if(handler===true)result=value;else{if(domain)domain.enter();result=handler(value);if(domain)domain.exit()}if(result===reaction.promise){reject(TypeError("Promise-chain cycle"))}else if(then=isThenable(result)){then.call(result,resolve,reject)}else resolve(result)}else reject(value)}catch(e){reject(e)}};while(chain.length>i)run(chain[i++]);promise._c=[];promise._n=false;if(isReject&&!promise._h)onUnhandled(promise)})};var onUnhandled=function(promise){task.call(global,function(){var value=promise._v;var unhandled=isUnhandled(promise);var result,handler,console;if(unhandled){result=perform(function(){if(isNode){process.emit("unhandledRejection",value,promise)}else if(handler=global.onunhandledrejection){handler({promise:promise,reason:value})}else if((console=global.console)&&console.error){console.error("Unhandled promise rejection",value)}});promise._h=isNode||isUnhandled(promise)?2:1}promise._a=undefined;if(unhandled&&result.e)throw result.v})};var isUnhandled=function(promise){return promise._h!==1&&(promise._a||promise._c).length===0};var onHandleUnhandled=function(promise){task.call(global,function(){var handler;if(isNode){process.emit("rejectionHandled",promise)}else if(handler=global.onrejectionhandled){handler({promise:promise,reason:promise._v})}})};var $reject=function(value){var promise=this;if(promise._d)return;promise._d=true;promise=promise._w||promise;promise._v=value;promise._s=2;if(!promise._a)promise._a=promise._c.slice();notify(promise,true)};var $resolve=function(value){var promise=this;var then;if(promise._d)return;promise._d=true;promise=promise._w||promise;try{if(promise===value)throw TypeError("Promise can't be resolved itself");if(then=isThenable(value)){microtask(function(){var wrapper={_w:promise,_d:false};try{then.call(value,ctx($resolve,wrapper,1),ctx($reject,wrapper,1))}catch(e){$reject.call(wrapper,e)}})}else{promise._v=value;promise._s=1;notify(promise,false)}}catch(e){$reject.call({_w:promise,_d:false},e)}};if(!USE_NATIVE){$Promise=function Promise(executor){anInstance(this,$Promise,PROMISE,"_h");aFunction(executor);Internal.call(this);try{executor(ctx($resolve,this,1),ctx($reject,this,1))}catch(err){$reject.call(this,err)}};Internal=function Promise(executor){this._c=[];this._a=undefined;this._s=0;this._d=false;this._v=undefined;this._h=0;this._n=false};Internal.prototype=__webpack_require__(49)($Promise.prototype,{then:function then(onFulfilled,onRejected){var reaction=newPromiseCapability(speciesConstructor(this,$Promise));reaction.ok=typeof onFulfilled=="function"?onFulfilled:true;reaction.fail=typeof onRejected=="function"&&onRejected;reaction.domain=isNode?process.domain:undefined;this._c.push(reaction);if(this._a)this._a.push(reaction);if(this._s)notify(this,false);return reaction.promise},catch:function(onRejected){return this.then(undefined,onRejected)}});OwnPromiseCapability=function(){var promise=new Internal;this.promise=promise;this.resolve=ctx($resolve,promise,1);this.reject=ctx($reject,promise,1)};newPromiseCapabilityModule.f=newPromiseCapability=function(C){return C===$Promise||C===Wrapper?new OwnPromiseCapability(C):newGenericPromiseCapability(C)}}$export($export.G+$export.W+$export.F*!USE_NATIVE,{Promise:$Promise});__webpack_require__(51)($Promise,PROMISE);__webpack_require__(46)(PROMISE);Wrapper=__webpack_require__(28)[PROMISE];$export($export.S+$export.F*!USE_NATIVE,PROMISE,{reject:function reject(r){var capability=newPromiseCapability(this);var $$reject=capability.reject;$$reject(r);return capability.promise}});$export($export.S+$export.F*(LIBRARY||!USE_NATIVE),PROMISE,{resolve:function resolve(x){return promiseResolve(LIBRARY&&this===Wrapper?$Promise:this,x)}});$export($export.S+$export.F*!(USE_NATIVE&&__webpack_require__(75)(function(iter){$Promise.all(iter)["catch"](empty)})),PROMISE,{all:function all(iterable){var C=this;var capability=newPromiseCapability(C);var resolve=capability.resolve;var reject=capability.reject;var result=perform(function(){var values=[];var index=0;var remaining=1;forOf(iterable,false,function(promise){var $index=index++;var alreadyCalled=false;values.push(undefined);remaining++;C.resolve(promise).then(function(value){if(alreadyCalled)return;alreadyCalled=true;values[$index]=value;--remaining||resolve(values)},reject)});--remaining||resolve(values)});if(result.e)reject(result.v);return capability.promise},race:function race(iterable){var C=this;var capability=newPromiseCapability(C);var reject=capability.reject;var result=perform(function(){forOf(iterable,false,function(promise){C.resolve(promise).then(capability.resolve,reject)})});if(result.e)reject(result.v);return capability.promise}})},function(module,exports,__webpack_require__){"use strict";var weak=__webpack_require__(139);var validate=__webpack_require__(54);var WEAK_SET="WeakSet";__webpack_require__(79)(WEAK_SET,function(get){return function WeakSet(){return get(this,arguments.length>0?arguments[0]:undefined)}},{add:function add(value){return weak.def(validate(this,WEAK_SET),value,true)}},weak,false,true)},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $typed=__webpack_require__(80);var buffer=__webpack_require__(110);var anObject=__webpack_require__(1);var toAbsoluteIndex=__webpack_require__(43);var toLength=__webpack_require__(10);var isObject=__webpack_require__(6);var ArrayBuffer=__webpack_require__(2).ArrayBuffer;var speciesConstructor=__webpack_require__(78);var $ArrayBuffer=buffer.ArrayBuffer;var $DataView=buffer.DataView;var $isView=$typed.ABV&&ArrayBuffer.isView;var $slice=$ArrayBuffer.prototype.slice;var VIEW=$typed.VIEW;var ARRAY_BUFFER="ArrayBuffer";$export($export.G+$export.W+$export.F*(ArrayBuffer!==$ArrayBuffer),{ArrayBuffer:$ArrayBuffer});$export($export.S+$export.F*!$typed.CONSTR,ARRAY_BUFFER,{isView:function isView(it){return $isView&&$isView(it)||isObject(it)&&VIEW in it}});$export($export.P+$export.U+$export.F*__webpack_require__(5)(function(){return!new $ArrayBuffer(2).slice(1,undefined).byteLength}),ARRAY_BUFFER,{slice:function slice(start,end){if($slice!==undefined&&end===undefined)return $slice.call(anObject(this),start);var len=anObject(this).byteLength;var first=toAbsoluteIndex(start,len);var final=toAbsoluteIndex(end===undefined?len:end,len);var result=new(speciesConstructor(this,$ArrayBuffer))(toLength(final-first));var viewS=new $DataView(this);var viewT=new $DataView(result);var index=0;while(first<final){viewT.setUint8(index++,viewS.getUint8(first++))}return result}});__webpack_require__(46)(ARRAY_BUFFER)},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.G+$export.W+$export.F*!__webpack_require__(80).ABV,{DataView:__webpack_require__(110).DataView})},function(module,exports,__webpack_require__){__webpack_require__(34)("Int8",1,function(init){return function Int8Array(data,byteOffset,length){return init(this,data,byteOffset,length)}})},function(module,exports,__webpack_require__){__webpack_require__(34)("Uint8",1,function(init){return function Uint8Array(data,byteOffset,length){return init(this,data,byteOffset,length)}})},function(module,exports,__webpack_require__){__webpack_require__(34)("Uint8",1,function(init){return function Uint8ClampedArray(data,byteOffset,length){return init(this,data,byteOffset,length)}},true)},function(module,exports,__webpack_require__){__webpack_require__(34)("Int16",2,function(init){return function Int16Array(data,byteOffset,length){return init(this,data,byteOffset,length)}})},function(module,exports,__webpack_require__){__webpack_require__(34)("Uint16",2,function(init){return function Uint16Array(data,byteOffset,length){return init(this,data,byteOffset,length)}})},function(module,exports,__webpack_require__){__webpack_require__(34)("Int32",4,function(init){return function Int32Array(data,byteOffset,length){return init(this,data,byteOffset,length)}})},function(module,exports,__webpack_require__){__webpack_require__(34)("Uint32",4,function(init){return function Uint32Array(data,byteOffset,length){return init(this,data,byteOffset,length)}})},function(module,exports,__webpack_require__){__webpack_require__(34)("Float32",4,function(init){return function Float32Array(data,byteOffset,length){return init(this,data,byteOffset,length)}})},function(module,exports,__webpack_require__){__webpack_require__(34)("Float64",8,function(init){return function Float64Array(data,byteOffset,length){return init(this,data,byteOffset,length)}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var aFunction=__webpack_require__(14);var anObject=__webpack_require__(1);var rApply=(__webpack_require__(2).Reflect||{}).apply;var fApply=Function.apply;$export($export.S+$export.F*!__webpack_require__(5)(function(){rApply(function(){})}),"Reflect",{apply:function apply(target,thisArgument,argumentsList){var T=aFunction(target);var L=anObject(argumentsList);return rApply?rApply(T,thisArgument,L):fApply.call(T,thisArgument,L)}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var create=__webpack_require__(44);var aFunction=__webpack_require__(14);var anObject=__webpack_require__(1);var isObject=__webpack_require__(6);var fails=__webpack_require__(5);var bind=__webpack_require__(120);var rConstruct=(__webpack_require__(2).Reflect||{}).construct;var NEW_TARGET_BUG=fails(function(){function F(){}return!(rConstruct(function(){},[],F)instanceof F)});var ARGS_BUG=!fails(function(){rConstruct(function(){})});$export($export.S+$export.F*(NEW_TARGET_BUG||ARGS_BUG),"Reflect",{construct:function construct(Target,args){aFunction(Target);anObject(args);var newTarget=arguments.length<3?Target:aFunction(arguments[2]);if(ARGS_BUG&&!NEW_TARGET_BUG)return rConstruct(Target,args,newTarget);if(Target==newTarget){switch(args.length){case 0:return new Target;case 1:return new Target(args[0]);case 2:return new Target(args[0],args[1]);case 3:return new Target(args[0],args[1],args[2]);case 4:return new Target(args[0],args[1],args[2],args[3])}var $args=[null];$args.push.apply($args,args);return new(bind.apply(Target,$args))}var proto=newTarget.prototype;var instance=create(isObject(proto)?proto:Object.prototype);var result=Function.apply.call(Target,instance,args);return isObject(result)?result:instance}})},function(module,exports,__webpack_require__){var dP=__webpack_require__(9);var $export=__webpack_require__(0);var anObject=__webpack_require__(1);var toPrimitive=__webpack_require__(29);$export($export.S+$export.F*__webpack_require__(5)(function(){Reflect.defineProperty(dP.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function defineProperty(target,propertyKey,attributes){anObject(target);propertyKey=toPrimitive(propertyKey,true);anObject(attributes);try{dP.f(target,propertyKey,attributes);return true}catch(e){return false}}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var gOPD=__webpack_require__(21).f;var anObject=__webpack_require__(1);$export($export.S,"Reflect",{deleteProperty:function deleteProperty(target,propertyKey){var desc=gOPD(anObject(target),propertyKey);return desc&&!desc.configurable?false:delete target[propertyKey]}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var anObject=__webpack_require__(1);var Enumerate=function(iterated){this._t=anObject(iterated);this._i=0;var keys=this._k=[];var key;for(key in iterated)keys.push(key)};__webpack_require__(98)(Enumerate,"Object",function(){var that=this;var keys=that._k;var key;do{if(that._i>=keys.length)return{value:undefined,done:true}}while(!((key=keys[that._i++])in that._t));return{value:key,done:false}});$export($export.S,"Reflect",{enumerate:function enumerate(target){return new Enumerate(target)}})},function(module,exports,__webpack_require__){var gOPD=__webpack_require__(21);var getPrototypeOf=__webpack_require__(22);var has=__webpack_require__(15);var $export=__webpack_require__(0);var isObject=__webpack_require__(6);var anObject=__webpack_require__(1);function get(target,propertyKey){var receiver=arguments.length<3?target:arguments[2];var desc,proto;if(anObject(target)===receiver)return target[propertyKey];if(desc=gOPD.f(target,propertyKey))return has(desc,"value")?desc.value:desc.get!==undefined?desc.get.call(receiver):undefined;if(isObject(proto=getPrototypeOf(target)))return get(proto,propertyKey,receiver)}$export($export.S,"Reflect",{get:get})},function(module,exports,__webpack_require__){var gOPD=__webpack_require__(21);var $export=__webpack_require__(0);var anObject=__webpack_require__(1);$export($export.S,"Reflect",{getOwnPropertyDescriptor:function getOwnPropertyDescriptor(target,propertyKey){return gOPD.f(anObject(target),propertyKey)}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var getProto=__webpack_require__(22);var anObject=__webpack_require__(1);$export($export.S,"Reflect",{getPrototypeOf:function getPrototypeOf(target){return getProto(anObject(target))}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Reflect",{has:function has(target,propertyKey){return propertyKey in target}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var anObject=__webpack_require__(1);var $isExtensible=Object.isExtensible;$export($export.S,"Reflect",{isExtensible:function isExtensible(target){anObject(target);return $isExtensible?$isExtensible(target):true}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Reflect",{ownKeys:__webpack_require__(141)})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var anObject=__webpack_require__(1);var $preventExtensions=Object.preventExtensions;$export($export.S,"Reflect",{preventExtensions:function preventExtensions(target){anObject(target);try{if($preventExtensions)$preventExtensions(target);return true}catch(e){return false}}})},function(module,exports,__webpack_require__){var dP=__webpack_require__(9);var gOPD=__webpack_require__(21);var getPrototypeOf=__webpack_require__(22);var has=__webpack_require__(15);var $export=__webpack_require__(0);var createDesc=__webpack_require__(39);var anObject=__webpack_require__(1);var isObject=__webpack_require__(6);function set(target,propertyKey,V){var receiver=arguments.length<4?target:arguments[3];var ownDesc=gOPD.f(anObject(target),propertyKey);var existingDescriptor,proto;if(!ownDesc){if(isObject(proto=getPrototypeOf(target))){return set(proto,propertyKey,V,receiver)}ownDesc=createDesc(0)}if(has(ownDesc,"value")){if(ownDesc.writable===false||!isObject(receiver))return false;existingDescriptor=gOPD.f(receiver,propertyKey)||createDesc(0);existingDescriptor.value=V;dP.f(receiver,propertyKey,existingDescriptor);return true}return ownDesc.set===undefined?false:(ownDesc.set.call(receiver,V),true)}$export($export.S,"Reflect",{set:set})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var setProto=__webpack_require__(90);if(setProto)$export($export.S,"Reflect",{setPrototypeOf:function setPrototypeOf(target,proto){setProto.check(target,proto);try{setProto.set(target,proto);return true}catch(e){return false}}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $includes=__webpack_require__(71)(true);$export($export.P,"Array",{includes:function includes(el){return $includes(this,el,arguments.length>1?arguments[1]:undefined)}});__webpack_require__(38)("includes")},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var flattenIntoArray=__webpack_require__(142);var toObject=__webpack_require__(12);var toLength=__webpack_require__(10);var aFunction=__webpack_require__(14);var arraySpeciesCreate=__webpack_require__(104);$export($export.P,"Array",{flatMap:function flatMap(callbackfn){var O=toObject(this);var sourceLen,A;aFunction(callbackfn);sourceLen=toLength(O.length);A=arraySpeciesCreate(O,0);flattenIntoArray(A,O,O,sourceLen,0,1,callbackfn,arguments[1]);return A}});__webpack_require__(38)("flatMap")},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var flattenIntoArray=__webpack_require__(142);var toObject=__webpack_require__(12);var toLength=__webpack_require__(10);var toInteger=__webpack_require__(31);var arraySpeciesCreate=__webpack_require__(104);$export($export.P,"Array",{flatten:function flatten(){var depthArg=arguments[0];var O=toObject(this);var sourceLen=toLength(O.length);var A=arraySpeciesCreate(O,0);flattenIntoArray(A,O,O,sourceLen,0,depthArg===undefined?1:toInteger(depthArg));return A}});__webpack_require__(38)("flatten")},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $at=__webpack_require__(96)(true);$export($export.P,"String",{at:function at(pos){return $at(this,pos)}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $pad=__webpack_require__(143);var userAgent=__webpack_require__(111);$export($export.P+$export.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(userAgent),"String",{padStart:function padStart(maxLength){return $pad(this,maxLength,arguments.length>1?arguments[1]:undefined,true)}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $pad=__webpack_require__(143);var userAgent=__webpack_require__(111);$export($export.P+$export.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(userAgent),"String",{padEnd:function padEnd(maxLength){return $pad(this,maxLength,arguments.length>1?arguments[1]:undefined,false)}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(52)("trimLeft",function($trim){return function trimLeft(){return $trim(this,1)}},"trimStart")},function(module,exports,__webpack_require__){"use strict";__webpack_require__(52)("trimRight",function($trim){return function trimRight(){return $trim(this,2)}},"trimEnd")},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var defined=__webpack_require__(30);var toLength=__webpack_require__(10);var isRegExp=__webpack_require__(74);var getFlags=__webpack_require__(76);var RegExpProto=RegExp.prototype;var $RegExpStringIterator=function(regexp,string){this._r=regexp;this._s=string};__webpack_require__(98)($RegExpStringIterator,"RegExp String",function next(){var match=this._r.exec(this._s);return{value:match,done:match===null}});$export($export.P,"String",{matchAll:function matchAll(regexp){defined(this);if(!isRegExp(regexp))throw TypeError(regexp+" is not a regexp!");var S=String(this);var flags="flags"in RegExpProto?String(regexp.flags):getFlags.call(regexp);var rx=new RegExp(regexp.source,~flags.indexOf("g")?flags:"g"+flags);rx.lastIndex=toLength(regexp.lastIndex);return new $RegExpStringIterator(rx,S)}})},function(module,exports,__webpack_require__){__webpack_require__(86)("asyncIterator")},function(module,exports,__webpack_require__){__webpack_require__(86)("observable")},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var ownKeys=__webpack_require__(141);var toIObject=__webpack_require__(20);var gOPD=__webpack_require__(21);var createProperty=__webpack_require__(102);$export($export.S,"Object",{getOwnPropertyDescriptors:function getOwnPropertyDescriptors(object){var O=toIObject(object);var getDesc=gOPD.f;var keys=ownKeys(O);var result={};var i=0;var key,desc;while(keys.length>i){desc=getDesc(O,key=keys[i++]);if(desc!==undefined)createProperty(result,key,desc)}return result}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $values=__webpack_require__(144)(false);$export($export.S,"Object",{values:function values(it){return $values(it)}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $entries=__webpack_require__(144)(true);$export($export.S,"Object",{entries:function entries(it){return $entries(it)}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var toObject=__webpack_require__(12);var aFunction=__webpack_require__(14);var $defineProperty=__webpack_require__(9);__webpack_require__(8)&&$export($export.P+__webpack_require__(81),"Object",{__defineGetter__:function __defineGetter__(P,getter){$defineProperty.f(toObject(this),P,{get:aFunction(getter),enumerable:true,configurable:true})}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var toObject=__webpack_require__(12);var aFunction=__webpack_require__(14);var $defineProperty=__webpack_require__(9);__webpack_require__(8)&&$export($export.P+__webpack_require__(81),"Object",{__defineSetter__:function __defineSetter__(P,setter){$defineProperty.f(toObject(this),P,{set:aFunction(setter),enumerable:true,configurable:true})}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var toObject=__webpack_require__(12);var toPrimitive=__webpack_require__(29);var getPrototypeOf=__webpack_require__(22);var getOwnPropertyDescriptor=__webpack_require__(21).f;__webpack_require__(8)&&$export($export.P+__webpack_require__(81),"Object",{__lookupGetter__:function __lookupGetter__(P){var O=toObject(this);var K=toPrimitive(P,true);var D;do{if(D=getOwnPropertyDescriptor(O,K))return D.get}while(O=getPrototypeOf(O))}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var toObject=__webpack_require__(12);var toPrimitive=__webpack_require__(29);var getPrototypeOf=__webpack_require__(22);var getOwnPropertyDescriptor=__webpack_require__(21).f;__webpack_require__(8)&&$export($export.P+__webpack_require__(81),"Object",{__lookupSetter__:function __lookupSetter__(P){var O=toObject(this);var K=toPrimitive(P,true);var D;do{if(D=getOwnPropertyDescriptor(O,K))return D.set}while(O=getPrototypeOf(O))}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.P+$export.R,"Map",{toJSON:__webpack_require__(145)("Map")})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.P+$export.R,"Set",{toJSON:__webpack_require__(145)("Set")})},function(module,exports,__webpack_require__){__webpack_require__(82)("Map")},function(module,exports,__webpack_require__){__webpack_require__(82)("Set")},function(module,exports,__webpack_require__){__webpack_require__(82)("WeakMap")},function(module,exports,__webpack_require__){__webpack_require__(82)("WeakSet")},function(module,exports,__webpack_require__){__webpack_require__(83)("Map")},function(module,exports,__webpack_require__){__webpack_require__(83)("Set")},function(module,exports,__webpack_require__){__webpack_require__(83)("WeakMap")},function(module,exports,__webpack_require__){__webpack_require__(83)("WeakSet")},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.G,{global:__webpack_require__(2)})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"System",{global:__webpack_require__(2)})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var cof=__webpack_require__(25);$export($export.S,"Error",{isError:function isError(it){return cof(it)==="Error"}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Math",{clamp:function clamp(x,lower,upper){return Math.min(upper,Math.max(lower,x))}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var RAD_PER_DEG=180/Math.PI;$export($export.S,"Math",{degrees:function degrees(radians){return radians*RAD_PER_DEG}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var scale=__webpack_require__(147);var fround=__webpack_require__(127);$export($export.S,"Math",{fscale:function fscale(x,inLow,inHigh,outLow,outHigh){return fround(scale(x,inLow,inHigh,outLow,outHigh))}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Math",{iaddh:function iaddh(x0,x1,y0,y1){var $x0=x0>>>0;var $x1=x1>>>0;var $y0=y0>>>0;return $x1+(y1>>>0)+(($x0&$y0|($x0|$y0)&~($x0+$y0>>>0))>>>31)|0}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Math",{isubh:function isubh(x0,x1,y0,y1){var $x0=x0>>>0;var $x1=x1>>>0;var $y0=y0>>>0;return $x1-(y1>>>0)-((~$x0&$y0|~($x0^$y0)&$x0-$y0>>>0)>>>31)|0}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Math",{imulh:function imulh(u,v){var UINT16=65535;var $u=+u;var $v=+v;var u0=$u&UINT16;var v0=$v&UINT16;var u1=$u>>16;var v1=$v>>16;var t=(u1*v0>>>0)+(u0*v0>>>16);return u1*v1+(t>>16)+((u0*v1>>>0)+(t&UINT16)>>16)}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var DEG_PER_RAD=Math.PI/180;$export($export.S,"Math",{radians:function radians(degrees){return degrees*DEG_PER_RAD}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Math",{scale:__webpack_require__(147)})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Math",{umulh:function umulh(u,v){var UINT16=65535;var $u=+u;var $v=+v;var u0=$u&UINT16;var v0=$v&UINT16;var u1=$u>>>16;var v1=$v>>>16;var t=(u1*v0>>>0)+(u0*v0>>>16);return u1*v1+(t>>>16)+((u0*v1>>>0)+(t&UINT16)>>>16)}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,"Math",{signbit:function signbit(x){return(x=+x)!=x?x:x==0?1/x==Infinity:x>0}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var core=__webpack_require__(28);var global=__webpack_require__(2);var speciesConstructor=__webpack_require__(78);var promiseResolve=__webpack_require__(134);$export($export.P+$export.R,"Promise",{finally:function(onFinally){var C=speciesConstructor(this,core.Promise||global.Promise);var isFunction=typeof onFinally=="function";return this.then(isFunction?function(x){return promiseResolve(C,onFinally()).then(function(){return x})}:onFinally,isFunction?function(e){return promiseResolve(C,onFinally()).then(function(){throw e})}:onFinally)}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var newPromiseCapability=__webpack_require__(109);var perform=__webpack_require__(133);$export($export.S,"Promise",{try:function(callbackfn){var promiseCapability=newPromiseCapability.f(this);var result=perform(callbackfn);(result.e?promiseCapability.reject:promiseCapability.resolve)(result.v);return promiseCapability.promise}})},function(module,exports,__webpack_require__){var metadata=__webpack_require__(35);var anObject=__webpack_require__(1);var toMetaKey=metadata.key;var ordinaryDefineOwnMetadata=metadata.set;metadata.exp({defineMetadata:function defineMetadata(metadataKey,metadataValue,target,targetKey){ordinaryDefineOwnMetadata(metadataKey,metadataValue,anObject(target),toMetaKey(targetKey))}})},function(module,exports,__webpack_require__){var metadata=__webpack_require__(35);var anObject=__webpack_require__(1);var toMetaKey=metadata.key;var getOrCreateMetadataMap=metadata.map;var store=metadata.store;metadata.exp({deleteMetadata:function deleteMetadata(metadataKey,target){var targetKey=arguments.length<3?undefined:toMetaKey(arguments[2]);var metadataMap=getOrCreateMetadataMap(anObject(target),targetKey,false);if(metadataMap===undefined||!metadataMap["delete"](metadataKey))return false;if(metadataMap.size)return true;var targetMetadata=store.get(target);targetMetadata["delete"](targetKey);return!!targetMetadata.size||store["delete"](target)}})},function(module,exports,__webpack_require__){var metadata=__webpack_require__(35);var anObject=__webpack_require__(1);var getPrototypeOf=__webpack_require__(22);var ordinaryHasOwnMetadata=metadata.has;var ordinaryGetOwnMetadata=metadata.get;var toMetaKey=metadata.key;var ordinaryGetMetadata=function(MetadataKey,O,P){var hasOwn=ordinaryHasOwnMetadata(MetadataKey,O,P);if(hasOwn)return ordinaryGetOwnMetadata(MetadataKey,O,P);var parent=getPrototypeOf(O);return parent!==null?ordinaryGetMetadata(MetadataKey,parent,P):undefined};metadata.exp({getMetadata:function getMetadata(metadataKey,target){return ordinaryGetMetadata(metadataKey,anObject(target),arguments.length<3?undefined:toMetaKey(arguments[2]))}})},function(module,exports,__webpack_require__){var Set=__webpack_require__(137);var from=__webpack_require__(146);var metadata=__webpack_require__(35);var anObject=__webpack_require__(1);var getPrototypeOf=__webpack_require__(22);var ordinaryOwnMetadataKeys=metadata.keys;var toMetaKey=metadata.key;var ordinaryMetadataKeys=function(O,P){var oKeys=ordinaryOwnMetadataKeys(O,P);var parent=getPrototypeOf(O);if(parent===null)return oKeys;var pKeys=ordinaryMetadataKeys(parent,P);return pKeys.length?oKeys.length?from(new Set(oKeys.concat(pKeys))):pKeys:oKeys};metadata.exp({getMetadataKeys:function getMetadataKeys(target){return ordinaryMetadataKeys(anObject(target),arguments.length<2?undefined:toMetaKey(arguments[1]))}})},function(module,exports,__webpack_require__){var metadata=__webpack_require__(35);var anObject=__webpack_require__(1);var ordinaryGetOwnMetadata=metadata.get;var toMetaKey=metadata.key;metadata.exp({getOwnMetadata:function getOwnMetadata(metadataKey,target){return ordinaryGetOwnMetadata(metadataKey,anObject(target),arguments.length<3?undefined:toMetaKey(arguments[2]))}})},function(module,exports,__webpack_require__){var metadata=__webpack_require__(35);var anObject=__webpack_require__(1);var ordinaryOwnMetadataKeys=metadata.keys;var toMetaKey=metadata.key;metadata.exp({getOwnMetadataKeys:function getOwnMetadataKeys(target){return ordinaryOwnMetadataKeys(anObject(target),arguments.length<2?undefined:toMetaKey(arguments[1]))}})},function(module,exports,__webpack_require__){var metadata=__webpack_require__(35);var anObject=__webpack_require__(1);var getPrototypeOf=__webpack_require__(22);var ordinaryHasOwnMetadata=metadata.has;var toMetaKey=metadata.key;var ordinaryHasMetadata=function(MetadataKey,O,P){var hasOwn=ordinaryHasOwnMetadata(MetadataKey,O,P);if(hasOwn)return true;var parent=getPrototypeOf(O);return parent!==null?ordinaryHasMetadata(MetadataKey,parent,P):false};metadata.exp({hasMetadata:function hasMetadata(metadataKey,target){return ordinaryHasMetadata(metadataKey,anObject(target),arguments.length<3?undefined:toMetaKey(arguments[2]))}})},function(module,exports,__webpack_require__){var metadata=__webpack_require__(35);var anObject=__webpack_require__(1);var ordinaryHasOwnMetadata=metadata.has;var toMetaKey=metadata.key;metadata.exp({hasOwnMetadata:function hasOwnMetadata(metadataKey,target){return ordinaryHasOwnMetadata(metadataKey,anObject(target),arguments.length<3?undefined:toMetaKey(arguments[2]))}})},function(module,exports,__webpack_require__){var $metadata=__webpack_require__(35);var anObject=__webpack_require__(1);var aFunction=__webpack_require__(14);var toMetaKey=$metadata.key;var ordinaryDefineOwnMetadata=$metadata.set;$metadata.exp({metadata:function metadata(metadataKey,metadataValue){return function decorator(target,targetKey){ordinaryDefineOwnMetadata(metadataKey,metadataValue,(targetKey!==undefined?anObject:aFunction)(target),toMetaKey(targetKey))}}})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var microtask=__webpack_require__(108)();var process=__webpack_require__(2).process;var isNode=__webpack_require__(25)(process)=="process";$export($export.G,{asap:function asap(fn){var domain=isNode&&process.domain;microtask(domain?domain.bind(fn):fn)}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var global=__webpack_require__(2);var core=__webpack_require__(28);var microtask=__webpack_require__(108)();var OBSERVABLE=__webpack_require__(7)("observable");var aFunction=__webpack_require__(14);var anObject=__webpack_require__(1);var anInstance=__webpack_require__(47);var redefineAll=__webpack_require__(49);var hide=__webpack_require__(16);var forOf=__webpack_require__(48);var RETURN=forOf.RETURN;var getMethod=function(fn){return fn==null?undefined:aFunction(fn)};var cleanupSubscription=function(subscription){var cleanup=subscription._c;if(cleanup){subscription._c=undefined;cleanup()}};var subscriptionClosed=function(subscription){return subscription._o===undefined};var closeSubscription=function(subscription){if(!subscriptionClosed(subscription)){subscription._o=undefined;cleanupSubscription(subscription)}};var Subscription=function(observer,subscriber){anObject(observer);this._c=undefined;this._o=observer;observer=new SubscriptionObserver(this);try{var cleanup=subscriber(observer);var subscription=cleanup;if(cleanup!=null){if(typeof cleanup.unsubscribe==="function")cleanup=function(){subscription.unsubscribe()};else aFunction(cleanup);this._c=cleanup}}catch(e){observer.error(e);return}if(subscriptionClosed(this))cleanupSubscription(this)};Subscription.prototype=redefineAll({},{unsubscribe:function unsubscribe(){closeSubscription(this)}});var SubscriptionObserver=function(subscription){this._s=subscription};SubscriptionObserver.prototype=redefineAll({},{next:function next(value){var subscription=this._s;if(!subscriptionClosed(subscription)){var observer=subscription._o;try{var m=getMethod(observer.next);if(m)return m.call(observer,value)}catch(e){try{closeSubscription(subscription)}finally{throw e}}}},error:function error(value){var subscription=this._s;if(subscriptionClosed(subscription))throw value;var observer=subscription._o;subscription._o=undefined;try{var m=getMethod(observer.error);if(!m)throw value;value=m.call(observer,value)}catch(e){try{cleanupSubscription(subscription)}finally{throw e}}cleanupSubscription(subscription);return value},complete:function complete(value){var subscription=this._s;if(!subscriptionClosed(subscription)){var observer=subscription._o;subscription._o=undefined;try{var m=getMethod(observer.complete);value=m?m.call(observer,value):undefined}catch(e){try{cleanupSubscription(subscription)}finally{throw e}}cleanupSubscription(subscription);return value}}});var $Observable=function Observable(subscriber){anInstance(this,$Observable,"Observable","_f")._f=aFunction(subscriber)};redefineAll($Observable.prototype,{subscribe:function subscribe(observer){return new Subscription(observer,this._f)},forEach:function forEach(fn){var that=this;return new(core.Promise||global.Promise)(function(resolve,reject){aFunction(fn);var subscription=that.subscribe({next:function(value){try{return fn(value)}catch(e){reject(e);subscription.unsubscribe()}},error:reject,complete:resolve})})}});redefineAll($Observable,{from:function from(x){var C=typeof this==="function"?this:$Observable;var method=getMethod(anObject(x)[OBSERVABLE]);if(method){var observable=anObject(method.call(x));return observable.constructor===C?observable:new C(function(observer){return observable.subscribe(observer)})}return new C(function(observer){var done=false;microtask(function(){if(!done){try{if(forOf(x,false,function(it){observer.next(it);if(done)return RETURN})===RETURN)return}catch(e){if(done)throw e;observer.error(e);return}observer.complete()}});return function(){done=true}})},of:function of(){for(var i=0,l=arguments.length,items=new Array(l);i<l;)items[i]=arguments[i++];return new(typeof this==="function"?this:$Observable)(function(observer){var done=false;microtask(function(){if(!done){for(var j=0;j<items.length;++j){observer.next(items[j]);if(done)return}observer.complete()}});return function(){done=true}})}});hide($Observable.prototype,OBSERVABLE,function(){return this});$export($export.G,{Observable:$Observable});__webpack_require__(46)("Observable")},function(module,exports,__webpack_require__){var global=__webpack_require__(2);var $export=__webpack_require__(0);var userAgent=__webpack_require__(111);var slice=[].slice;var MSIE=/MSIE .\./.test(userAgent);var wrap=function(set){return function(fn,time){var boundArgs=arguments.length>2;var args=boundArgs?slice.call(arguments,2):false;return set(boundArgs?function(){(typeof fn=="function"?fn:Function(fn)).apply(this,args)}:fn,time)}};$export($export.G+$export.B+$export.F*MSIE,{setTimeout:wrap(global.setTimeout),setInterval:wrap(global.setInterval)})},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $task=__webpack_require__(107);$export($export.G+$export.B,{setImmediate:$task.set,clearImmediate:$task.clear})},function(module,exports,__webpack_require__){var $iterators=__webpack_require__(106);var getKeys=__webpack_require__(42);var redefine=__webpack_require__(17);var global=__webpack_require__(2);var hide=__webpack_require__(16);var Iterators=__webpack_require__(53);var wks=__webpack_require__(7);var ITERATOR=wks("iterator");var TO_STRING_TAG=wks("toStringTag");var ArrayValues=Iterators.Array;var DOMIterables={CSSRuleList:true,CSSStyleDeclaration:false,CSSValueList:false,ClientRectList:false,DOMRectList:false,DOMStringList:false,DOMTokenList:true,DataTransferItemList:false,FileList:false,HTMLAllCollection:false,HTMLCollection:false,HTMLFormElement:false,HTMLSelectElement:false,MediaList:true,MimeTypeArray:false,NamedNodeMap:false,NodeList:true,PaintRequestList:false,Plugin:false,PluginArray:false,SVGLengthList:false,SVGNumberList:false,SVGPathSegList:false,SVGPointList:false,SVGStringList:false,SVGTransformList:false,SourceBufferList:false,StyleSheetList:true,TextTrackCueList:false,TextTrackList:false,TouchList:false};for(var collections=getKeys(DOMIterables),i=0;i<collections.length;i++){var NAME=collections[i];var explicit=DOMIterables[NAME];var Collection=global[NAME];var proto=Collection&&Collection.prototype;var key;if(proto){if(!proto[ITERATOR])hide(proto,ITERATOR,ArrayValues);if(!proto[TO_STRING_TAG])hide(proto,TO_STRING_TAG,NAME);Iterators[NAME]=ArrayValues;if(explicit)for(key in $iterators)if(!proto[key])redefine(proto,key,$iterators[key],true)}}},function(module,exports,__webpack_require__){(function(global){!function(global){"use strict";var Op=Object.prototype;var hasOwn=Op.hasOwnProperty;var undefined;var $Symbol=typeof Symbol==="function"?Symbol:{};var iteratorSymbol=$Symbol.iterator||"@@iterator";var asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator";var toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";var inModule=typeof module==="object";var runtime=global.regeneratorRuntime;if(runtime){if(inModule){module.exports=runtime}return}runtime=global.regeneratorRuntime=inModule?module.exports:{};function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator;var generator=Object.create(protoGenerator.prototype);var context=new Context(tryLocsList||[]);generator._invoke=makeInvokeMethod(innerFn,self,context);return generator}runtime.wrap=wrap;function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}var GenStateSuspendedStart="suspendedStart";var GenStateSuspendedYield="suspendedYield";var GenStateExecuting="executing";var GenStateCompleted="completed";var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};IteratorPrototype[iteratorSymbol]=function(){return this};var getProto=Object.getPrototypeOf;var NativeIteratorPrototype=getProto&&getProto(getProto(values([])));if(NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)){IteratorPrototype=NativeIteratorPrototype}var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);GeneratorFunction.prototype=Gp.constructor=GeneratorFunctionPrototype;GeneratorFunctionPrototype.constructor=GeneratorFunction;GeneratorFunctionPrototype[toStringTagSymbol]=GeneratorFunction.displayName="GeneratorFunction";function defineIteratorMethods(prototype){["next","throw","return"].forEach(function(method){prototype[method]=function(arg){return this._invoke(method,arg)}})}runtime.isGeneratorFunction=function(genFun){var ctor=typeof genFun==="function"&&genFun.constructor;return ctor?ctor===GeneratorFunction||(ctor.displayName||ctor.name)==="GeneratorFunction":false};runtime.mark=function(genFun){if(Object.setPrototypeOf){Object.setPrototypeOf(genFun,GeneratorFunctionPrototype)}else{genFun.__proto__=GeneratorFunctionPrototype;if(!(toStringTagSymbol in genFun)){genFun[toStringTagSymbol]="GeneratorFunction"}}genFun.prototype=Object.create(Gp);return genFun};runtime.awrap=function(arg){return{__await:arg}};function AsyncIterator(generator){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if(record.type==="throw"){reject(record.arg)}else{var result=record.arg;var value=result.value;if(value&&typeof value==="object"&&hasOwn.call(value,"__await")){return Promise.resolve(value.__await).then(function(value){invoke("next",value,resolve,reject)},function(err){invoke("throw",err,resolve,reject)})}return Promise.resolve(value).then(function(unwrapped){result.value=unwrapped;resolve(result)},reject)}}if(typeof global.process==="object"&&global.process.domain){invoke=global.process.domain.bind(invoke)}var previousPromise;function enqueue(method,arg){function callInvokeWithMethodAndArg(){return new Promise(function(resolve,reject){invoke(method,arg,resolve,reject)})}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}this._invoke=enqueue}defineIteratorMethods(AsyncIterator.prototype);AsyncIterator.prototype[asyncIteratorSymbol]=function(){return this};runtime.AsyncIterator=AsyncIterator;runtime.async=function(innerFn,outerFn,self,tryLocsList){var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList));return runtime.isGeneratorFunction(outerFn)?iter:iter.next().then(function(result){return result.done?result.value:iter.next()})};function makeInvokeMethod(innerFn,self,context){var state=GenStateSuspendedStart;return function invoke(method,arg){if(state===GenStateExecuting){throw new Error("Generator is already running")}if(state===GenStateCompleted){if(method==="throw"){throw arg}return doneResult()}context.method=method;context.arg=arg;while(true){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if(context.method==="next"){context.sent=context._sent=context.arg}else if(context.method==="throw"){if(state===GenStateSuspendedStart){state=GenStateCompleted;throw context.arg}context.dispatchException(context.arg)}else if(context.method==="return"){context.abrupt("return",context.arg)}state=GenStateExecuting;var record=tryCatch(innerFn,self,context);if(record.type==="normal"){state=context.done?GenStateCompleted:GenStateSuspendedYield;if(record.arg===ContinueSentinel){continue}return{value:record.arg,done:context.done}}else if(record.type==="throw"){state=GenStateCompleted;context.method="throw";context.arg=record.arg}}}}function maybeInvokeDelegate(delegate,context){var method=delegate.iterator[context.method];if(method===undefined){context.delegate=null;if(context.method==="throw"){if(delegate.iterator.return){context.method="return";context.arg=undefined;maybeInvokeDelegate(delegate,context);if(context.method==="throw"){return ContinueSentinel}}context.method="throw";context.arg=new TypeError("The iterator does not provide a 'throw' method")}return ContinueSentinel}var record=tryCatch(method,delegate.iterator,context.arg);if(record.type==="throw"){context.method="throw";context.arg=record.arg;context.delegate=null;return ContinueSentinel}var info=record.arg;if(!info){context.method="throw";context.arg=new TypeError("iterator result is not an object");context.delegate=null;return ContinueSentinel}if(info.done){context[delegate.resultName]=info.value;context.next=delegate.nextLoc;if(context.method!=="return"){context.method="next";context.arg=undefined}}else{return info}context.delegate=null;return ContinueSentinel}defineIteratorMethods(Gp);Gp[toStringTagSymbol]="Generator";Gp[iteratorSymbol]=function(){return this};Gp.toString=function(){return"[object Generator]"};function pushTryEntry(locs){var entry={tryLoc:locs[0]};if(1 in locs){entry.catchLoc=locs[1]}if(2 in locs){entry.finallyLoc=locs[2];entry.afterLoc=locs[3]}this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal";delete record.arg;entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}];tryLocsList.forEach(pushTryEntry,this);this.reset(true)}runtime.keys=function(object){var keys=[];for(var key in object){keys.push(key)}keys.reverse();return function next(){while(keys.length){var key=keys.pop();if(key in object){next.value=key;next.done=false;return next}}next.done=true;return next}};function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod){return iteratorMethod.call(iterable)}if(typeof iterable.next==="function"){return iterable}if(!isNaN(iterable.length)){var i=-1,next=function next(){while(++i<iterable.length){if(hasOwn.call(iterable,i)){next.value=iterable[i];next.done=false;return next}}next.value=undefined;next.done=true;return next};return next.next=next}}return{next:doneResult}}runtime.values=values;function doneResult(){return{value:undefined,done:true}}Context.prototype={constructor:Context,reset:function(skipTempReset){this.prev=0;this.next=0;this.sent=this._sent=undefined;this.done=false;this.delegate=null;this.method="next";this.arg=undefined;this.tryEntries.forEach(resetTryEntry);if(!skipTempReset){for(var name in this){if(name.charAt(0)==="t"&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))){this[name]=undefined}}}},stop:function(){this.done=true;var rootEntry=this.tryEntries[0];var rootRecord=rootEntry.completion;if(rootRecord.type==="throw"){throw rootRecord.arg}return this.rval},dispatchException:function(exception){if(this.done){throw exception}var context=this;function handle(loc,caught){record.type="throw";record.arg=exception;context.next=loc;if(caught){context.method="next";context.arg=undefined}return!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];var record=entry.completion;if(entry.tryLoc==="root"){return handle("end")}if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc");var hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc){return handle(entry.catchLoc,true)}else if(this.prev<entry.finallyLoc){return handle(entry.finallyLoc)}}else if(hasCatch){if(this.prev<entry.catchLoc){return handle(entry.catchLoc,true)}}else if(hasFinally){if(this.prev<entry.finallyLoc){return handle(entry.finallyLoc)}}else{throw new Error("try statement without catch or finally")}}}},abrupt:function(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}if(finallyEntry&&(type==="break"||type==="continue")&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc){finallyEntry=null}var record=finallyEntry?finallyEntry.completion:{};record.type=type;record.arg=arg;if(finallyEntry){this.method="next";this.next=finallyEntry.finallyLoc;return ContinueSentinel}return this.complete(record)},complete:function(record,afterLoc){if(record.type==="throw"){throw record.arg}if(record.type==="break"||record.type==="continue"){this.next=record.arg}else if(record.type==="return"){this.rval=this.arg=record.arg;this.method="return";this.next="end"}else if(record.type==="normal"&&afterLoc){this.next=afterLoc}return ContinueSentinel},finish:function(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc){this.complete(entry.completion,entry.afterLoc);resetTryEntry(entry);return ContinueSentinel}}},catch:function(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if(record.type==="throw"){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function(iterable,resultName,nextLoc){this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc};if(this.method==="next"){this.arg=undefined}return ContinueSentinel}}}(typeof global==="object"?global:typeof window==="object"?window:typeof self==="object"?self:this)}).call(exports,__webpack_require__(69))},function(module,exports,__webpack_require__){__webpack_require__(363);module.exports=__webpack_require__(28).RegExp.escape},function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $re=__webpack_require__(364)(/[\\^$*+?.()|[\]{}]/g,"\\$&");$export($export.S,"RegExp",{escape:function escape(it){return $re(it)}})},function(module,exports){module.exports=function(regExp,replace){var replacer=replace===Object(replace)?function(part){return replace[part]}:replace;return function(it){return String(it).replace(regExp,replacer)}}},function(module,exports,__webpack_require__){"use strict";var _deeplearn=__webpack_require__(27);var dl=_interopRequireWildcard(_deeplearn);var _index=__webpack_require__(434);var _index2=_interopRequireDefault(_index);var _index3=__webpack_require__(439);var _index4=_interopRequireDefault(_index3);var _index5=__webpack_require__(443);var _index6=_interopRequireDefault(_index5);var _index7=__webpack_require__(445);var _index8=_interopRequireDefault(_index7);var _index9=__webpack_require__(446);var _index10=_interopRequireDefault(_index9);var _index11=__webpack_require__(447);var _index12=_interopRequireDefault(_index11);var _index13=__webpack_require__(448);var _index14=_interopRequireDefault(_index13);var _imageUtilities=__webpack_require__(452);var _imageUtilities2=_interopRequireDefault(_imageUtilities);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}module.exports={ImageNet:_index2.default,KNNImageClassifier:_index4.default,LSTMGenerator:_index6.default,NeuralNetwork:_index8.default,TransformNet:_index12.default,Yolo:_index14.default,Word2Vec:_index10.default,dl:dl,array3DToImage:_imageUtilities2.default}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function isMobile(){var a=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))}exports.isMobile=isMobile},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util=__webpack_require__(4);var ndarray_1=__webpack_require__(3);var kernel_registry=__webpack_require__(368);var tape_util=__webpack_require__(369);var BackendEngine=function(){function BackendEngine(backend,safeMode){this.backend=backend;this.safeMode=safeMode;this.nextTapeNodeId=0;this.gradientScopeCount=0;this.customGradientDepth=0;this.debugMode=false;this.activeScope={keep:[],track:[]};this.scopeStack=[this.activeScope]}BackendEngine.prototype.enableDebugMode=function(){this.debugMode=true};BackendEngine.prototype.executeKernel=function(kernelName,config,grad){var _this=this;var kernelFn=function(){return kernel_registry.executeKernel(_this.backend,kernelName,config)};var start;if(this.debugMode){start=performance.now()}var result=kernelFn();if(this.debugMode){var vals=result.dataSync();var time=util.rightPad(performance.now()-start+"ms",9);var paddedName=util.rightPad(kernelName,25);var rank=result.rank;var size=result.size;var shape=util.rightPad(result.shape.toString(),14);console.log("%c"+paddedName+"\t%c"+time+"\t%c"+rank+"D "+shape+"\t%c"+size,"font-weight:bold","color:red","color:blue","color: orange");util.checkForNaN(vals,result.dtype,name)}if(this.activeTape!=null&&this.customGradientDepth===0){config=tape_util.stripUndefinedInputsFromInputConfig(config);var evaluatedNode={id:this.nextTapeNodeId++,type:"kernel",name:"kernel: "+kernelName,kernel:kernelName,inputAndArgs:config,output:result,gradient:grad};this.activeTape.push(evaluatedNode)}return result};BackendEngine.prototype.customGradient=function(f,inputs,name){this.customGradientDepth++;var gradientsFunc;var gradientsMode=true;var result=this.scope("customGradient",function(){var _a=f(),value=_a.value,gradients=_a.gradients;gradientsFunc=gradients;return value},gradientsMode);this.customGradientDepth--;if(this.activeTape!=null&&this.customGradientDepth===0){var evaluatedNode={id:this.nextTapeNodeId++,type:"customGradient",name:name,inputAndArgs:{inputs:inputs},output:result,gradient:gradientsFunc};this.activeTape.push(evaluatedNode)}return result};BackendEngine.prototype.gradients=function(f,xs,returnValue){var _this=this;var gradientsMode=true;var result=this.scope("gradients",function(){var y=f();if(y.rank!==0){throw new Error("Cannot compute gradient of non-scalar y output. "+("Got y with rank "+y.rank))}var gradients=_this.gradientWrt(y,xs);if(returnValue){return[y].concat(gradients)}else{return gradients}},gradientsMode);if(returnValue){return{value:result[0],gradients:result.slice(1)}}else{return result}};BackendEngine.prototype.vjp=function(f,xs,dy){var _this=this;var gradientsMode=true;return this.scope("vjp",function(){var y=f();if(!util.arraysEqual(y.shape,dy.shape)){throw new Error("Cannot compute vector jacobian product, "+("y shape ("+y.shape+") does not match dy shape ("+dy.shape+")."))}if(y.dtype!==dy.dtype){throw new Error("Cannot compute vector jacobian product, "+("y dtype ("+y.dtype+") does not match dy dtype ("+dy.dtype+")."))}return _this.gradientWrt(y,xs,dy)},gradientsMode)};BackendEngine.prototype.gradientWrt=function(y,xs,dy){var filteredTape=tape_util.getFilteredNodesXToY(this.activeTape,xs,y);if(filteredTape.length===0){throw new Error("Cannot compute gradient: y is not a function of xs.")}var arrayAccumulatedGradientMap={};arrayAccumulatedGradientMap[y.id]=dy==null?ndarray_1.Scalar.new(1):dy;tape_util.backpropagateGradients(arrayAccumulatedGradientMap,filteredTape);var gradients=xs.map(function(x){return arrayAccumulatedGradientMap[x.id]});gradients.forEach(function(grad,i){if(grad==null){throw new Error("Gradient error: y was not a function of xs["+i+"]")}});return gradients};BackendEngine.prototype.scope=function(name,scopeFn,gradientsMode){var _this=this;this.startScope(gradientsMode);var keepFn=function(ndarray){return _this.keep(ndarray)};var trackFn=function(ndarray){return ndarray};var result=scopeFn(keepFn,trackFn);if(result instanceof Promise){result.then(function(r){return _this.endScope(r,gradientsMode)});return result}else{this.endScope(result,gradientsMode);return result}};BackendEngine.prototype.startScope=function(gradientsMode){if(gradientsMode&&this.gradientScopeCount===0){this.activeTape=[]}if(gradientsMode){this.gradientScopeCount++}var newScopeArrays={keep:[],track:[]};this.scopeStack.push(newScopeArrays);this.activeScope=newScopeArrays};BackendEngine.prototype.endScope=function(result,gradientsMode){var _this=this;if(gradientsMode){this.gradientScopeCount--;if(this.gradientScopeCount===0){this.activeTape=null}}var arraysToKeep=this.activeScope.keep;var arraysToTrackInParent=tape_util.extractNDArraysFromScopeResult(result);arraysToKeep=arraysToKeep.concat(arraysToTrackInParent);for(var i=0;i<this.activeScope.track.length;i++){var ndarray=this.activeScope.track[i];if(util.isNDArrayInList(ndarray,arraysToKeep)){continue}if(this.activeTape!=null){arraysToTrackInParent.push(ndarray)}else{ndarray.dispose()}}this.scopeStack.pop();this.activeScope=this.scopeStack.length===0?null:this.scopeStack[this.scopeStack.length-1];arraysToTrackInParent.forEach(function(ndarray){if(!util.isNDArrayInList(ndarray,_this.activeScope.keep)){_this.track(ndarray)}})};BackendEngine.prototype.keep=function(result){if(this.scopeStack.length===1){if(this.safeMode){throw new Error("You are using math in safe mode. Enclose all "+"math.method() calls inside a scope: "+"math.scope(() => {math.method();...}) to avoid memory "+"leaks.")}}this.activeScope.keep.push(result);return result};BackendEngine.prototype.track=function(result){if(this.scopeStack.length===1){if(this.safeMode){throw new Error("You are using math in safe mode. Enclose all "+"math.method() calls inside a scope: "+"math.scope(() => {math.method();...}) to avoid memory "+"leaks.")}}this.activeScope.track.push(result);return result};BackendEngine.prototype.getBackend=function(){return this.backend};return BackendEngine}();exports.BackendEngine=BackendEngine},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util=__webpack_require__(4);var ndarray_1=__webpack_require__(3);var KERNEL_METHODS={MatMul:function(backend,config){return backend.matMul(config.inputs.a,config.inputs.b,config.args.aOrientation,config.args.bOrientation)},Clone:function(backend,config){return backend.clone(config.inputs.x)},Slice1D:function(backend,config){return backend.slice1D(config.inputs.x,config.args.begin,config.args.size)},Slice2D:function(backend,config){return backend.slice2D(config.inputs.x,config.args.begin,config.args.size)},Slice3D:function(backend,config){return backend.slice3D(config.inputs.x,config.args.begin,config.args.size)},Slice4D:function(backend,config){return backend.slice4D(config.inputs.x,config.args.begin,config.args.size)},Concat1D:function(backend,config){return backend.concat1D(config.inputs.a,config.inputs.b)},Concat2D:function(backend,config){return backend.concat2D(config.inputs.a,config.inputs.b,config.args.axis)},Concat3D:function(backend,config){return backend.concat3D(config.inputs.a,config.inputs.b,config.args.axis)},Concat4D:function(backend,config){return backend.concat4D(config.inputs.a,config.inputs.b,config.args.axis)},Neg:function(backend,config){return backend.neg(config.inputs.x)},Add:function(backend,config){return backend.add(config.inputs.a,config.inputs.b)},Sub:function(backend,config){return backend.subtract(config.inputs.a,config.inputs.b)},Mul:function(backend,config){return backend.multiply(config.inputs.a,config.inputs.b)},Div:function(backend,config){return backend.divide(config.inputs.a,config.inputs.b)},Sum:function(backend,config){return backend.sum(config.inputs.x,config.args.axes)},ArgMax:function(backend,config){return backend.argMax(config.inputs.x,config.args.axes)},ArgMin:function(backend,config){return backend.argMin(config.inputs.x,config.args.axes)},Equal:function(backend,config){return backend.equal(config.inputs.a,config.inputs.b)},NotEqual:function(backend,config){return backend.notEqual(config.inputs.a,config.inputs.b)},TopKValues:function(backend,config){return backend.topKValues(config.inputs.x,config.args.k)},TopKIndices:function(backend,config){return backend.topKIndices(config.inputs.x,config.args.k)},Min:function(backend,config){return backend.min(config.inputs.x,config.args.axes)},Minimum:function(backend,config){return backend.minimum(config.inputs.a,config.inputs.b)},Max:function(backend,config){return backend.max(config.inputs.x,config.args.axes)},Maximum:function(backend,config){return backend.maximum(config.inputs.a,config.inputs.b)},Ceil:function(backend,config){return backend.ceil(config.inputs.x)},Floor:function(backend,config){return backend.floor(config.inputs.x)},Pow:function(backend,config){return backend.pow(config.inputs.a,config.inputs.b)},Exp:function(backend,config){return backend.exp(config.inputs.x)},Log:function(backend,config){return backend.log(config.inputs.x)},Sqrt:function(backend,config){return backend.sqrt(config.inputs.x)},Square:function(backend,config){return backend.square(config.inputs.x)},Relu:function(backend,config){return backend.relu(config.inputs.x)},Reshape:function(backend,config){var x=config.inputs.x;var newShape=config.args.newShape;return ndarray_1.NDArray.make(newShape,{dataId:x.dataId},x.dtype)},Cast:function(backend,config){var x=config.inputs.x;var newDType=config.args.newDType;if(!util.hasEncodingLoss(x.dtype,newDType)){return ndarray_1.NDArray.make(x.shape,{dataId:x.dataId},newDType)}if(newDType==="int32"){return backend.int(x)}else if(newDType==="bool"){return backend.notEqual(x,ndarray_1.Scalar.new(0,x.dtype))}else{throw new Error("Error in Cast: unknown dtype argument ("+newDType+")")}},LeakyRelu:function(backend,config){return backend.leakyRelu(config.inputs.x,config.args.alpha)},PReLU:function(backend,config){return backend.prelu(config.inputs.x,config.inputs.alpha)},PReLUDer:function(backend,config){return backend.preluDer(config.inputs.x,config.inputs.alpha)},Elu:function(backend,config){return backend.elu(config.inputs.x)},EluDer:function(backend,config){return backend.eluDer(config.inputs.x)},Selu:function(backend,config){return backend.selu(config.inputs.x)},Abs:function(backend,config){return backend.abs(config.inputs.x)},Sigmoid:function(backend,config){return backend.sigmoid(config.inputs.x)},Step:function(backend,config){return backend.step(config.inputs.x,config.args.alpha)},Sin:function(backend,config){return backend.sin(config.inputs.x)},Cos:function(backend,config){return backend.cos(config.inputs.x)},Tan:function(backend,config){return backend.tan(config.inputs.x)},Asin:function(backend,config){return backend.asin(config.inputs.x)},Acos:function(backend,config){return backend.acos(config.inputs.x)},Atan:function(backend,config){return backend.atan(config.inputs.x)},Sinh:function(backend,config){return backend.sinh(config.inputs.x)},Cosh:function(backend,config){return backend.cosh(config.inputs.x)},Tanh:function(backend,config){return backend.tanh(config.inputs.x)},Clip:function(backend,config){return backend.clip(config.inputs.x,config.args.min,config.args.max)},Transpose:function(backend,config){return backend.transpose(config.inputs.x,config.args.perm)},Tile:function(backend,config){return backend.tile(config.inputs.x,config.args.reps)},Conv2D:function(backend,config){return backend.conv2d(config.inputs.x,config.inputs.filter,config.inputs.bias,config.args.convInfo)},Conv2DDerInput:function(backend,config){return backend.conv2dDerInput(config.inputs.dy,config.inputs.filter,config.args.convInfo)},Conv2DDerFilter:function(backend,config){return backend.conv2dDerFilter(config.inputs.x,config.inputs.dy,config.args.convInfo)},Conv2DDerBias:function(backend,config){return backend.conv2dDerBias(config.inputs.dy)},DepthwiseConv2D:function(backend,config){return backend.depthwiseConv2D(config.inputs.x,config.inputs.filter,config.args.convInfo)},MaxPool:function(backend,config){return backend.maxPool(config.inputs.x,config.args.convInfo)},MaxPoolBackprop:function(backend,config){return backend.maxPoolBackprop(config.inputs.dy,config.inputs.x,config.args.convInfo)},AvgPool:function(backend,config){return backend.avgPool(config.inputs.x,config.args.convInfo)},MinPool:function(backend,config){return backend.minPool(config.inputs.x,config.args.convInfo)},ResizeBilinear3D:function(backend,config){return backend.resizeBilinear3D(config.inputs.x,config.args.newShape2D,config.args.alignCorners)},BatchNorm4D:function(backend,config){return backend.batchNormalization4D(config.inputs.x,config.inputs.mean,config.inputs.variance,config.args.varianceEpsilon,config.inputs.scale,config.inputs.offset)},BatchNorm3D:function(backend,config){return backend.batchNormalization3D(config.inputs.x,config.inputs.mean,config.inputs.variance,config.args.varianceEpsilon,config.inputs.scale,config.inputs.offset)},BatchNorm2D:function(backend,config){return backend.batchNormalization2D(config.inputs.x,config.inputs.mean,config.inputs.variance,config.args.varianceEpsilon,config.inputs.scale,config.inputs.offset)},Multinomial:function(backend,config){return backend.multinomial(config.inputs.probs,config.args.numSamples,config.args.seed)},OneHot:function(backend,config){return backend.oneHot(config.inputs.indices,config.args.depth,config.args.onValue,config.args.offValue)}};function executeKernel(backend,kernelName,config){return KERNEL_METHODS[kernelName](backend,config)}exports.executeKernel=executeKernel},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var environment_1=__webpack_require__(11);var ndarray_1=__webpack_require__(3);function getFilteredNodesXToY(tape,xs,y){var arraysFromX={};var nodesFromX={};for(var i=0;i<xs.length;i++){arraysFromX[xs[i].id]=true}for(var i=0;i<tape.length;i++){var node=tape[i];var nodeInputs=node.inputAndArgs.inputs;for(var inputName in nodeInputs){var input=nodeInputs[inputName];var anyInputFromX=false;for(var j=0;j<xs.length;j++){if(arraysFromX[input.id]){if(node.output instanceof ndarray_1.NDArray){arraysFromX[node.output.id]=true}else{var keys=Object.keys(node.output);for(var _i=0,keys_1=keys;_i<keys_1.length;_i++){var key=keys_1[_i];arraysFromX[node.output[key].id]=true}}anyInputFromX=true;nodesFromX[node.id]=true;break}}if(anyInputFromX){break}}}var arraysLeadToY={};arraysLeadToY[y.id]=true;var nodesToY={};for(var i=tape.length-1;i>=0;i--){var node=tape[i];var nodeInputs=node.inputAndArgs.inputs;var outputs=[];if(node.output instanceof ndarray_1.NDArray){outputs.push(node.output)}else{var keys=Object.keys(node.output);for(var _a=0,keys_2=keys;_a<keys_2.length;_a++){var key=keys_2[_a];outputs.push(node.output[key])}}for(var j=0;j<outputs.length;j++){if(arraysLeadToY[outputs[j].id]){for(var inputName in nodeInputs){arraysLeadToY[nodeInputs[inputName].id]=true;nodesToY[node.id]=true}break}}}var filteredTape=[];for(var i=0;i<tape.length;i++){var node=tape[i];if(nodesFromX[node.id]&&nodesToY[node.id]){var prunedInputs={};for(var inputName in node.inputAndArgs.inputs){var nodeInput=node.inputAndArgs.inputs[inputName];if(arraysFromX[nodeInput.id]){prunedInputs[inputName]=nodeInput}}var prunedOutputs=void 0;if(node.output instanceof ndarray_1.NDArray){prunedOutputs=node.output}else{prunedOutputs={};for(var outputName in node.output){var output=node.output[outputName];if(arraysLeadToY[output.id]){prunedOutputs[outputName]=node.output[outputName]}}}var prunedNode=Object.assign({},node);prunedNode.inputAndArgs={inputs:prunedInputs};prunedNode.output=prunedOutputs;filteredTape.push(prunedNode)}}return filteredTape}exports.getFilteredNodesXToY=getFilteredNodesXToY;function backpropagateGradients(arrayAccumulatedGradientMap,filteredTape){for(var i=filteredTape.length-1;i>=0;i--){var node=filteredTape[i];var dy=void 0;if(node.output instanceof ndarray_1.NDArray){dy=arrayAccumulatedGradientMap[node.output.id]}else{dy={};var keys=Object.keys(node.output);for(var _i=0,keys_3=keys;_i<keys_3.length;_i++){var key=keys_3[_i];dy[key]=arrayAccumulatedGradientMap[node.output[key].id]}}if(node.gradient==null){throw new Error("Cannot compute gradient: gradient function not found "+("for "+node.name+"."))}var inputGradients=node.gradient(dy,node.output);for(var inputName in node.inputAndArgs.inputs){if(!(inputName in inputGradients)){throw new Error("Cannot backprop through input "+inputName+". "+("Available gradients found: "+Object.keys(inputGradients)+"."))}var grad=inputGradients[inputName]();var activation=node.inputAndArgs.inputs[inputName];if(arrayAccumulatedGradientMap[activation.id]==null){arrayAccumulatedGradientMap[activation.id]=grad}else{var curGradient=arrayAccumulatedGradientMap[activation.id];arrayAccumulatedGradientMap[activation.id]=environment_1.ENV.math.add(curGradient,grad);curGradient.dispose()}}}}exports.backpropagateGradients=backpropagateGradients;function computeInputs(tape){var outputArrays={};for(var i=0;i<tape.length;i++){var node=tape[i];if(node.output instanceof ndarray_1.NDArray){outputArrays[node.output.id]=true}else{var keys=Object.keys(node.output);for(var _i=0,keys_4=keys;_i<keys_4.length;_i++){var key=keys_4[_i];outputArrays[node.output[key].id]=true}}}var inputArrays={};var inputArraysSeen={};var idx=0;for(var i=0;i<tape.length;i++){var node=tape[i];var inputs=node.inputAndArgs.inputs;var keys=Object.keys(inputs);for(var _a=0,keys_5=keys;_a<keys_5.length;_a++){var key=keys_5[_a];if(!outputArrays[inputs[key].id]&&!inputArraysSeen[inputs[key].id]){inputArrays[(idx++).toString()]=inputs[key];inputArraysSeen[inputs[key].id]=true}}}return inputArrays}exports.computeInputs=computeInputs;function extractNDArraysFromScopeResult(result){if(result==null){return[]}if(result instanceof ndarray_1.NDArray){return[result]}var list=[];var resultObj=result;for(var k in resultObj){var val=resultObj[k];if(val instanceof ndarray_1.NDArray){list.push(val)}}return list}exports.extractNDArraysFromScopeResult=extractNDArraysFromScopeResult;function stripUndefinedInputsFromInputConfig(config){var keys=Object.keys(config.inputs);keys.forEach(function(key){if(config.inputs[key]==null){delete config.inputs[key]}});return config}exports.stripUndefinedInputsFromInputConfig=stripUndefinedInputsFromInputConfig},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util=__webpack_require__(4);function assertParamsValid(input,begin,size){util.assert(input.rank===begin.length,"Error in slice"+input.rank+"D: Length of begin "+begin+" must "+("match the rank of the array ("+input.rank+")."));util.assert(input.rank===size.length,"Error in slice"+input.rank+"D: Length of size "+size+" must "+("match the rank of the array ("+input.rank+")."));for(var i=0;i<input.rank;++i){util.assert(begin[i]+size[i]<=input.shape[i],"Error in slice"+input.rank+"D: begin["+i+"] + size["+i+"] "+("("+(begin[i]+size[i])+") would overflow input.shape["+i+"] ("+input.shape[i]+")"))}}exports.assertParamsValid=assertParamsValid},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var seedrandom=__webpack_require__(149);var MPRandGauss=function(){function MPRandGauss(mean,stdDeviation,dtype,truncated,seed){this.mean=mean;this.stdDev=stdDeviation;this.dtype=dtype;this.nextVal=NaN;this.truncated=truncated;if(this.truncated){this.upper=this.mean+this.stdDev*2;this.lower=this.mean-this.stdDev*2}var seedValue=seed?seed:Math.random();this.random=seedrandom.alea(seedValue.toString())}MPRandGauss.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var value=this.nextVal;this.nextVal=NaN;return value}var resultX,resultY;var isValid=false;while(!isValid){var v1=void 0,v2=void 0,s=void 0;do{v1=2*this.random()-1;v2=2*this.random()-1;s=v1*v1+v2*v2}while(s>=1||s===0);var mul=Math.sqrt(-2*Math.log(s)/s);resultX=this.mean+this.stdDev*v1*mul;resultY=this.mean+this.stdDev*v2*mul;if(!this.truncated||this.isValidTruncated(resultX)){isValid=true}}if(!this.truncated||this.isValidTruncated(resultY)){this.nextVal=this.convertValue(resultY)}return this.convertValue(resultX)};MPRandGauss.prototype.convertValue=function(value){if(this.dtype==null||this.dtype==="float32"){return value}return Math.round(value)};MPRandGauss.prototype.isValidTruncated=function(value){return value<=this.upper&&value>=this.lower};return MPRandGauss}();exports.MPRandGauss=MPRandGauss},function(module,exports,__webpack_require__){(function(module){var __WEBPACK_AMD_DEFINE_RESULT__;(function(global,module,define){function Alea(seed){var me=this,mash=Mash();me.next=function(){var t=2091639*me.s0+me.c*2.3283064365386963e-10;me.s0=me.s1;me.s1=me.s2;return me.s2=t-(me.c=t|0)};me.c=1;me.s0=mash(" ");me.s1=mash(" ");me.s2=mash(" ");me.s0-=mash(seed);if(me.s0<0){me.s0+=1}me.s1-=mash(seed);if(me.s1<0){me.s1+=1}me.s2-=mash(seed);if(me.s2<0){me.s2+=1}mash=null}function copy(f,t){t.c=f.c;t.s0=f.s0;t.s1=f.s1;t.s2=f.s2;return t}function impl(seed,opts){var xg=new Alea(seed),state=opts&&opts.state,prng=xg.next;prng.int32=function(){return xg.next()*4294967296|0};prng.double=function(){return prng()+(prng()*2097152|0)*1.1102230246251565e-16};prng.quick=prng;if(state){if(typeof state=="object")copy(state,xg);prng.state=function(){return copy(xg,{})}}return prng}function Mash(){var n=4022871197;var mash=function(data){data=data.toString();for(var i=0;i<data.length;i++){n+=data.charCodeAt(i);var h=.02519603282416938*n;n=h>>>0;h-=n;h*=n;n=h>>>0;h-=n;n+=h*4294967296}return(n>>>0)*2.3283064365386963e-10};return mash}if(module&&module.exports){module.exports=impl}else if(__webpack_require__(23)&&__webpack_require__(56)){!(__WEBPACK_AMD_DEFINE_RESULT__=function(){return impl}.call(exports,__webpack_require__,exports,module),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else{this.alea=impl}})(this,typeof module=="object"&&module,__webpack_require__(23))}).call(exports,__webpack_require__(55)(module))},function(module,exports,__webpack_require__){(function(module){var __WEBPACK_AMD_DEFINE_RESULT__;(function(global,module,define){function XorGen(seed){var me=this,strseed="";me.x=0;me.y=0;me.z=0;me.w=0;me.next=function(){var t=me.x^me.x<<11;me.x=me.y;me.y=me.z;me.z=me.w;return me.w^=me.w>>>19^t^t>>>8};if(seed===(seed|0)){me.x=seed}else{strseed+=seed}for(var k=0;k<strseed.length+64;k++){me.x^=strseed.charCodeAt(k)|0;me.next()}}function copy(f,t){t.x=f.x;t.y=f.y;t.z=f.z;t.w=f.w;return t}function impl(seed,opts){var xg=new XorGen(seed),state=opts&&opts.state,prng=function(){return(xg.next()>>>0)/4294967296};prng.double=function(){do{var top=xg.next()>>>11,bot=(xg.next()>>>0)/4294967296,result=(top+bot)/(1<<21)}while(result===0);return result};prng.int32=xg.next;prng.quick=prng;if(state){if(typeof state=="object")copy(state,xg);prng.state=function(){return copy(xg,{})}}return prng}if(module&&module.exports){module.exports=impl}else if(__webpack_require__(23)&&__webpack_require__(56)){!(__WEBPACK_AMD_DEFINE_RESULT__=function(){return impl}.call(exports,__webpack_require__,exports,module),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else{this.xor128=impl}})(this,typeof module=="object"&&module,__webpack_require__(23))}).call(exports,__webpack_require__(55)(module))},function(module,exports,__webpack_require__){(function(module){var __WEBPACK_AMD_DEFINE_RESULT__;(function(global,module,define){function XorGen(seed){var me=this,strseed="";me.next=function(){var t=me.x^me.x>>>2;me.x=me.y;me.y=me.z;me.z=me.w;me.w=me.v;return(me.d=me.d+362437|0)+(me.v=me.v^me.v<<4^(t^t<<1))|0};me.x=0;me.y=0;me.z=0;me.w=0;me.v=0;if(seed===(seed|0)){me.x=seed}else{strseed+=seed}for(var k=0;k<strseed.length+64;k++){me.x^=strseed.charCodeAt(k)|0;if(k==strseed.length){me.d=me.x<<10^me.x>>>4}me.next()}}function copy(f,t){t.x=f.x;t.y=f.y;t.z=f.z;t.w=f.w;t.v=f.v;t.d=f.d;return t}function impl(seed,opts){var xg=new XorGen(seed),state=opts&&opts.state,prng=function(){return(xg.next()>>>0)/4294967296};prng.double=function(){do{var top=xg.next()>>>11,bot=(xg.next()>>>0)/4294967296,result=(top+bot)/(1<<21)}while(result===0);return result};prng.int32=xg.next;prng.quick=prng;if(state){if(typeof state=="object")copy(state,xg);prng.state=function(){return copy(xg,{})}}return prng}if(module&&module.exports){module.exports=impl}else if(__webpack_require__(23)&&__webpack_require__(56)){!(__WEBPACK_AMD_DEFINE_RESULT__=function(){return impl}.call(exports,__webpack_require__,exports,module),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else{this.xorwow=impl}})(this,typeof module=="object"&&module,__webpack_require__(23))}).call(exports,__webpack_require__(55)(module))},function(module,exports,__webpack_require__){(function(module){var __WEBPACK_AMD_DEFINE_RESULT__;(function(global,module,define){function XorGen(seed){var me=this;me.next=function(){var X=me.x,i=me.i,t,v,w;t=X[i];t^=t>>>7;v=t^t<<24;t=X[i+1&7];v^=t^t>>>10;t=X[i+3&7];v^=t^t>>>3;t=X[i+4&7];v^=t^t<<7;t=X[i+7&7];t=t^t<<13;v^=t^t<<9;X[i]=v;me.i=i+1&7;return v};function init(me,seed){var j,w,X=[];if(seed===(seed|0)){w=X[0]=seed}else{seed=""+seed;for(j=0;j<seed.length;++j){X[j&7]=X[j&7]<<15^seed.charCodeAt(j)+X[j+1&7]<<13}}while(X.length<8)X.push(0);for(j=0;j<8&&X[j]===0;++j);if(j==8)w=X[7]=-1;else w=X[j];me.x=X;me.i=0;for(j=256;j>0;--j){me.next()}}init(me,seed)}function copy(f,t){t.x=f.x.slice();t.i=f.i;return t}function impl(seed,opts){if(seed==null)seed=+new Date;var xg=new XorGen(seed),state=opts&&opts.state,prng=function(){return(xg.next()>>>0)/4294967296};prng.double=function(){do{var top=xg.next()>>>11,bot=(xg.next()>>>0)/4294967296,result=(top+bot)/(1<<21)}while(result===0);return result};prng.int32=xg.next;prng.quick=prng;if(state){if(state.x)copy(state,xg);prng.state=function(){return copy(xg,{})}}return prng}if(module&&module.exports){module.exports=impl}else if(__webpack_require__(23)&&__webpack_require__(56)){!(__WEBPACK_AMD_DEFINE_RESULT__=function(){return impl}.call(exports,__webpack_require__,exports,module),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else{this.xorshift7=impl}})(this,typeof module=="object"&&module,__webpack_require__(23))}).call(exports,__webpack_require__(55)(module))},function(module,exports,__webpack_require__){(function(module){var __WEBPACK_AMD_DEFINE_RESULT__;(function(global,module,define){function XorGen(seed){var me=this;me.next=function(){var w=me.w,X=me.X,i=me.i,t,v;me.w=w=w+1640531527|0;v=X[i+34&127];t=X[i=i+1&127];v^=v<<13;t^=t<<17;v^=v>>>15;t^=t>>>12;v=X[i]=v^t;me.i=i;return v+(w^w>>>16)|0};function init(me,seed){var t,v,i,j,w,X=[],limit=128;if(seed===(seed|0)){v=seed;seed=null}else{seed=seed+"\0";v=0;limit=Math.max(limit,seed.length)}for(i=0,j=-32;j<limit;++j){if(seed)v^=seed.charCodeAt((j+32)%seed.length);if(j===0)w=v;v^=v<<10;v^=v>>>15;v^=v<<4;v^=v>>>13;if(j>=0){w=w+1640531527|0;t=X[j&127]^=v+w;i=0==t?i+1:0}}if(i>=128){X[(seed&&seed.length||0)&127]=-1}i=127;for(j=4*128;j>0;--j){v=X[i+34&127];t=X[i=i+1&127];v^=v<<13;t^=t<<17;v^=v>>>15;t^=t>>>12;X[i]=v^t}me.w=w;me.X=X;me.i=i}init(me,seed)}function copy(f,t){t.i=f.i;t.w=f.w;t.X=f.X.slice();return t}function impl(seed,opts){if(seed==null)seed=+new Date;var xg=new XorGen(seed),state=opts&&opts.state,prng=function(){return(xg.next()>>>0)/4294967296};prng.double=function(){do{var top=xg.next()>>>11,bot=(xg.next()>>>0)/4294967296,result=(top+bot)/(1<<21)}while(result===0);return result};prng.int32=xg.next;prng.quick=prng;if(state){if(state.X)copy(state,xg);prng.state=function(){return copy(xg,{})}}return prng}if(module&&module.exports){module.exports=impl}else if(__webpack_require__(23)&&__webpack_require__(56)){!(__WEBPACK_AMD_DEFINE_RESULT__=function(){return impl}.call(exports,__webpack_require__,exports,module),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else{this.xor4096=impl}})(this,typeof module=="object"&&module,__webpack_require__(23))}).call(exports,__webpack_require__(55)(module))},function(module,exports,__webpack_require__){(function(module){var __WEBPACK_AMD_DEFINE_RESULT__;(function(global,module,define){function XorGen(seed){var me=this,strseed="";me.next=function(){var b=me.b,c=me.c,d=me.d,a=me.a;b=b<<25^b>>>7^c;c=c-d|0;d=d<<24^d>>>8^a;a=a-b|0;me.b=b=b<<20^b>>>12^c;me.c=c=c-d|0;me.d=d<<16^c>>>16^a;return me.a=a-b|0};me.a=0;me.b=0;me.c=2654435769|0;me.d=1367130551;if(seed===Math.floor(seed)){me.a=seed/4294967296|0;me.b=seed|0}else{strseed+=seed}for(var k=0;k<strseed.length+20;k++){me.b^=strseed.charCodeAt(k)|0;me.next()}}function copy(f,t){t.a=f.a;t.b=f.b;t.c=f.c;t.d=f.d;return t}function impl(seed,opts){var xg=new XorGen(seed),state=opts&&opts.state,prng=function(){return(xg.next()>>>0)/4294967296};prng.double=function(){do{var top=xg.next()>>>11,bot=(xg.next()>>>0)/4294967296,result=(top+bot)/(1<<21)}while(result===0);return result};prng.int32=xg.next;prng.quick=prng;if(state){if(typeof state=="object")copy(state,xg);prng.state=function(){return copy(xg,{})}}return prng}if(module&&module.exports){module.exports=impl}else if(__webpack_require__(23)&&__webpack_require__(56)){!(__WEBPACK_AMD_DEFINE_RESULT__=function(){return impl}.call(exports,__webpack_require__,exports,module),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else{this.tychei=impl}})(this,typeof module=="object"&&module,__webpack_require__(23))}).call(exports,__webpack_require__(55)(module))},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;(function(pool,math){var global=this,width=256,chunks=6,digits=52,rngname="random",startdenom=math.pow(width,chunks),significance=math.pow(2,digits),overflow=significance*2,mask=width-1,nodecrypto;function seedrandom(seed,options,callback){var key=[];options=options==true?{entropy:true}:options||{};var shortseed=mixkey(flatten(options.entropy?[seed,tostring(pool)]:seed==null?autoseed():seed,3),key);var arc4=new ARC4(key);var prng=function(){var n=arc4.g(chunks),d=startdenom,x=0;while(n<significance){n=(n+x)*width;d*=width;x=arc4.g(1)}while(n>=overflow){n/=2;d/=2;x>>>=1}return(n+x)/d};prng.int32=function(){return arc4.g(4)|0};prng.quick=function(){return arc4.g(4)/4294967296};prng.double=prng;mixkey(tostring(arc4.S),pool);return(options.pass||callback||function(prng,seed,is_math_call,state){if(state){if(state.S){copy(state,arc4)}prng.state=function(){return copy(arc4,{})}}if(is_math_call){math[rngname]=prng;return seed}else return prng})(prng,shortseed,"global"in options?options.global:this==math,options.state)}math["seed"+rngname]=seedrandom;function ARC4(key){var t,keylen=key.length,me=this,i=0,j=me.i=me.j=0,s=me.S=[];if(!keylen){key=[keylen++]}while(i<width){s[i]=i++}for(i=0;i<width;i++){s[i]=s[j=mask&j+key[i%keylen]+(t=s[i])];s[j]=t}(me.g=function(count){var t,r=0,i=me.i,j=me.j,s=me.S;while(count--){t=s[i=mask&i+1];r=r*width+s[mask&(s[i]=s[j=mask&j+t])+(s[j]=t)]}me.i=i;me.j=j;return r})(width)}function copy(f,t){t.i=f.i;t.j=f.j;t.S=f.S.slice();return t}function flatten(obj,depth){var result=[],typ=typeof obj,prop;if(depth&&typ=="object"){for(prop in obj){try{result.push(flatten(obj[prop],depth-1))}catch(e){}}}return result.length?result:typ=="string"?obj:obj+"\0"}function mixkey(seed,key){var stringseed=seed+"",smear,j=0;while(j<stringseed.length){key[mask&j]=mask&(smear^=key[mask&j]*19)+stringseed.charCodeAt(j++)}return tostring(key)}function autoseed(){try{var out;if(nodecrypto&&(out=nodecrypto.randomBytes)){out=out(width)}else{out=new Uint8Array(width);(global.crypto||global.msCrypto).getRandomValues(out)}return tostring(out)}catch(e){var browser=global.navigator,plugins=browser&&browser.plugins;return[+new Date,global,plugins,global.screen,tostring(pool)]}}function tostring(a){return String.fromCharCode.apply(0,a)}mixkey(math.random(),pool);if(typeof module=="object"&&module.exports){module.exports=seedrandom;try{nodecrypto=__webpack_require__(379)}catch(ex){}}else if(true){!(__WEBPACK_AMD_DEFINE_RESULT__=function(){return seedrandom}.call(exports,__webpack_require__,exports,module),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}})([],Math)},function(module,exports){},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var webgl_util=__webpack_require__(66);function getRenderRGBShader(gpgpu,destinationWidth){var fragmentShaderSource="\n    precision highp float;\n    uniform sampler2D source;\n    varying vec2 resultUV;\n\n    const float destinationWidth = "+destinationWidth+".0;\n    const float a = 1.0;\n\n    void main() {\n      float xr = floor(resultUV.s * destinationWidth) * 3.0;\n      vec3 x = xr + vec3(0, 1, 2);\n\n      float sourceWidth = destinationWidth * 3.0;\n      vec3 u = (x + 0.5) / sourceWidth;\n      float v = 1.0 - resultUV.t;\n\n      float r = texture2D(source, vec2(u[0], v)).r;\n      float g = texture2D(source, vec2(u[1], v)).r;\n      float b = texture2D(source, vec2(u[2], v)).r;\n\n      gl_FragColor = vec4(r, g, b, a);\n    }";return gpgpu.createProgram(fragmentShaderSource)}exports.getRenderRGBShader=getRenderRGBShader;function renderToCanvas(gpgpu,renderShader,sourceTex){webgl_util.bindCanvasToFramebuffer(gpgpu.gl);renderToFramebuffer(gpgpu,renderShader,sourceTex)}exports.renderToCanvas=renderToCanvas;function renderToFramebuffer(gpgpu,renderShader,sourceTex){gpgpu.setProgram(renderShader);var sourceSamplerLocation=webgl_util.getProgramUniformLocationOrThrow(gpgpu.gl,renderShader,"source");gpgpu.setInputMatrixTexture(sourceTex,sourceSamplerLocation,0);gpgpu.executeProgram()}exports.renderToFramebuffer=renderToFramebuffer},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var environment_1=__webpack_require__(11);var backend_cpu_1=__webpack_require__(151);var backend_webgl_1=__webpack_require__(152);var math_1=__webpack_require__(60);var ndarray_1=__webpack_require__(3);var util=__webpack_require__(4);exports.TEST_EPSILON=.01;function mean(values){var sum=0;for(var i=0;i<values.length;i++){sum+=values[i]}return sum/values.length}exports.mean=mean;function standardDeviation(values,mean){var squareDiffSum=0;for(var i=0;i<values.length;i++){var diff=values[i]-mean;squareDiffSum+=diff*diff}return Math.sqrt(squareDiffSum/values.length)}exports.standardDeviation=standardDeviation;function kurtosis(values){var valuesMean=mean(values);var n=values.length;var sum2=0;var sum4=0;for(var i=0;i<n;i++){var v=values[i]-valuesMean;sum2+=Math.pow(v,2);sum4+=Math.pow(v,4)}return 1/n*sum4/Math.pow(1/n*sum2,2)}exports.kurtosis=kurtosis;function skewness(values){var valuesMean=mean(values);var n=values.length;var sum2=0;var sum3=0;for(var i=0;i<n;i++){var v=values[i]-valuesMean;sum2+=Math.pow(v,2);sum3+=Math.pow(v,3)}return 1/n*sum3/Math.pow(1/(n-1)*sum2,3/2)}exports.skewness=skewness;function jarqueBeraNormalityTest(a){var values;if(a instanceof ndarray_1.NDArray){values=a.dataSync()}else{values=a}var n=values.length;var s=skewness(values);var k=kurtosis(values);var jb=n/6*(Math.pow(s,2)+.25*Math.pow(k-3,2));var CHI_SQUARE_2DEG=5.991;if(jb>CHI_SQUARE_2DEG){throw new Error("Invalid p-value for JB: "+jb)}}exports.jarqueBeraNormalityTest=jarqueBeraNormalityTest;function expectArrayInMeanStdRange(actual,expectedMean,expectedStdDev,epsilon){if(epsilon===void 0){epsilon=exports.TEST_EPSILON}var actualValues;if(actual instanceof ndarray_1.NDArray){actualValues=actual.dataSync()}else{actualValues=actual}var actualMean=mean(actualValues);expectNumbersClose(actualMean,expectedMean,epsilon);expectNumbersClose(standardDeviation(actualValues,actualMean),expectedStdDev,epsilon)}exports.expectArrayInMeanStdRange=expectArrayInMeanStdRange;function expectArraysClose(actual,expected,epsilon){if(epsilon===void 0){epsilon=exports.TEST_EPSILON}if(!(actual instanceof ndarray_1.NDArray)&&!(expected instanceof ndarray_1.NDArray)){var aType=actual.constructor.name;var bType=expected.constructor.name;if(aType!==bType){throw new Error("Arrays are of different type actual: "+aType+" "+("vs expected: "+bType))}}else if(actual instanceof ndarray_1.NDArray&&expected instanceof ndarray_1.NDArray){if(actual.dtype!==expected.dtype){throw new Error("Arrays are of different type actual: "+actual.dtype+" "+("vs expected: "+expected.dtype+"."))}if(!util.arraysEqual(actual.shape,expected.shape)){throw new Error("Arrays are of different shape actual: "+actual.shape+" "+("vs expected: "+expected.shape+"."))}}var actualValues;var expectedValues;if(actual instanceof ndarray_1.NDArray){actualValues=actual.dataSync()}else{actualValues=actual}if(expected instanceof ndarray_1.NDArray){expectedValues=expected.dataSync()}else{expectedValues=expected}if(actualValues.length!==expectedValues.length){throw new Error("Arrays have different lengths actual: "+actualValues.length+" vs "+("expected: "+expectedValues.length+"."))}for(var i=0;i<expectedValues.length;++i){var a=actualValues[i];var e=expectedValues[i];if(!areClose(a,Number(e),epsilon)){var actualStr="actual["+i+"] === "+a;var expectedStr="expected["+i+"] === "+e;throw new Error("Arrays differ: "+actualStr+", "+expectedStr)}}}exports.expectArraysClose=expectArraysClose;function expectArraysEqual(actual,expected){return expectArraysClose(actual,expected,0)}exports.expectArraysEqual=expectArraysEqual;function expectNumbersClose(a,e,epsilon){if(epsilon===void 0){epsilon=exports.TEST_EPSILON}if(!areClose(a,e,epsilon)){throw new Error("Numbers differ: actual === "+a+", expected === "+e)}}exports.expectNumbersClose=expectNumbersClose;function areClose(a,e,epsilon){if(isNaN(a)&&isNaN(e)){return true}if(isNaN(a)||isNaN(e)||Math.abs(a-e)>epsilon){return false}return true}function expectValuesInRange(actual,low,high){var actualVals;if(actual instanceof ndarray_1.NDArray){actualVals=actual.dataSync()}else{actualVals=actual}for(var i=0;i<actualVals.length;i++){if(actualVals[i]<low||actualVals[i]>high){throw new Error("Value out of range:"+actualVals[i]+" low: "+low+", high: "+high)}}}exports.expectValuesInRange=expectValuesInRange;function randomArrayInRange(n,minValue,maxValue){var v=new Float32Array(n);var range=maxValue-minValue;for(var i=0;i<n;++i){v[i]=Math.random()*range+minValue}return v}exports.randomArrayInRange=randomArrayInRange;function makeIdentity(n){var i=new Float32Array(n*n);for(var j=0;j<n;++j){i[j*n+j]=1}return i}exports.makeIdentity=makeIdentity;function cpuMultiplyMatrix(a,aRow,aCol,b,bRow,bCol){var result=new Float32Array(aRow*bCol);for(var r=0;r<aRow;++r){var aOffset=r*aCol;var cOffset=r*bCol;for(var c=0;c<bCol;++c){var d=0;for(var k=0;k<aCol;++k){d+=a[aOffset+k]*b[k*bCol+c]}result[cOffset+c]=d}}return result}exports.cpuMultiplyMatrix=cpuMultiplyMatrix;function cpuDotProduct(a,b){if(a.length!==b.length){throw new Error("cpuDotProduct: incompatible vectors.")}var d=0;for(var i=0;i<a.length;++i){d+=a[i]*b[i]}return d}exports.cpuDotProduct=cpuDotProduct;function describeMathCPU(name,tests,featuresList){var testNameBase="CPU: math."+name;describeWithFeaturesAndExecutor(testNameBase,tests,function(testName,tests,features){return executeMathTests(testName,tests,function(){var safeMode=true;return new math_1.NDArrayMath(new backend_cpu_1.MathBackendCPU,safeMode)},features)},featuresList)}exports.describeMathCPU=describeMathCPU;function describeMathGPU(name,tests,featuresList){var testNameBase="WebGL: math."+name;describeWithFeaturesAndExecutor(testNameBase,tests,function(testName,tests,features){return executeMathTests(testName,tests,function(){var safeMode=true;return new math_1.NDArrayMath(new backend_webgl_1.MathBackendWebGL,safeMode)},features)},featuresList)}exports.describeMathGPU=describeMathGPU;function describeCustom(name,tests,featuresList,customBeforeEach,customAfterEach){describeWithFeaturesAndExecutor(name,[tests],function(testName,tests,features){return executeTests(testName,tests,features,customBeforeEach,customAfterEach)},featuresList)}exports.describeCustom=describeCustom;function describeWithFeaturesAndExecutor(testNameBase,tests,executor,featuresList){if(featuresList!=null){featuresList.forEach(function(features){var testName=testNameBase+" "+JSON.stringify(features);executor(testName,tests,features)})}else{executor(testNameBase,tests)}}var PROMISE_IT=function(name,testFunc){it(name,function(done){var result=testFunc();if(result instanceof Promise){result.then(done,function(e){fail(e);done()})}else{done()}})};function executeMathTests(testName,tests,mathFactory,features){var math;var customBeforeEach=function(){math=mathFactory();environment_1.ENV.setMath(math);math.startScope()};var customAfterEach=function(){math.endScope(null);math.dispose()};var customIt=function(name,testFunc){PROMISE_IT(name,function(){return testFunc(math)})};executeTests(testName,tests,features,customBeforeEach,customAfterEach,customIt)}exports.executeMathTests=executeMathTests;function executeTests(testName,tests,features,customBeforeEach,customAfterEach,customIt){if(customIt===void 0){customIt=PROMISE_IT}describe(testName,function(){beforeEach(function(){if(features!=null){environment_1.ENV.setFeatures(features);environment_1.ENV.registerBackend("webgl",function(){return new backend_webgl_1.MathBackendWebGL});environment_1.ENV.registerBackend("cpu",function(){return new backend_cpu_1.MathBackendCPU})}if(customBeforeEach!=null){customBeforeEach()}});afterEach(function(){if(customAfterEach!=null){customAfterEach()}if(features!=null){environment_1.ENV.reset()}});tests.forEach(function(test){return test(customIt)})})}exports.executeTests=executeTests;function assertIsNan(val,dtype){if(!util.isValNaN(val,dtype)){throw new Error("Value "+val+" does not represent NaN for dtype "+dtype)}}exports.assertIsNan=assertIsNan},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PARALLELIZE_THRESHOLD=30;function computeOptimalWindowSize(inSize){if(inSize<=exports.PARALLELIZE_THRESHOLD){return inSize}return nearestDivisor(inSize,Math.floor(Math.sqrt(inSize)))}exports.computeOptimalWindowSize=computeOptimalWindowSize;function nearestDivisor(size,start){for(var i=start;i<size;++i){if(size%i===0){return i}}return size}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ArgMinMaxProgram=function(){function ArgMinMaxProgram(reduceInfo,op,firstPass){this.variableNames=["A"];var windowSize=reduceInfo.windowSize;var batchSize=reduceInfo.batchSize;var inSize=reduceInfo.inSize;var outSize=Math.ceil(inSize/windowSize);if(!firstPass){this.variableNames.push("bestIndicesA")}this.outputShape=[batchSize,outSize];var compOp=op==="max"?">":"<";var indexSnippet=firstPass?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+windowSize+";\n\n        int bestIndex = 0;\n        float bestValue = getA(batch, inOffset);\n\n        for (int i = 0; i < "+windowSize+"; i++) {\n          int inIdx = "+indexSnippet+";\n          float candidate = getA(batch, inIdx);\n          if (isNaN(candidate)) {\n            setOutput(candidate);\n            return;\n          }\n          if (candidate "+compOp+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "}return ArgMinMaxProgram}();exports.ArgMinMaxProgram=ArgMinMaxProgram},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var broadcast_util=__webpack_require__(62);var BatchNormProgram=function(){function BatchNormProgram(xShape,meanShape,varianceShape,offsetShape,scaleShape,varianceEpsilon){this.outputShape=[];this.supportsBroadcasting=true;this.variableNames=["x","mean","variance"];broadcast_util.assertAndGetBroadcastShape(xShape,meanShape);broadcast_util.assertAndGetBroadcastShape(xShape,varianceShape);var offsetSnippet="0.0";if(offsetShape!=null){broadcast_util.assertAndGetBroadcastShape(xShape,offsetShape);this.variableNames.push("offset");offsetSnippet="getOffsetAtOutCoords()"}var scaleSnippet="1.0";if(scaleShape!=null){broadcast_util.assertAndGetBroadcastShape(xShape,scaleShape);this.variableNames.push("scale");scaleSnippet="getScaleAtOutCoords()"}this.outputShape=xShape;this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+offsetSnippet+";\n        float scale = "+scaleSnippet+";\n        float inv = scale / sqrt(variance + float("+varianceEpsilon+"));\n        setOutput((x - mean) * inv + offset);\n      }\n    "}return BatchNormProgram}();exports.BatchNormProgram=BatchNormProgram},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ClipProgram=function(){function ClipProgram(aShape,min,max){this.variableNames=["A"];this.outputShape=aShape;var minFixed=min.toFixed(20);var maxFixed=max.toFixed(20);this.userCode="\n      void main() {\n        float value = getAAtOutCoords();\n        if (isNaN(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, "+minFixed+", "+maxFixed+"));\n      }\n    "}return ClipProgram}();exports.ClipProgram=ClipProgram},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var concat_util=__webpack_require__(63);var shader_compiler_1=__webpack_require__(67);var ConcatProgram=function(){function ConcatProgram(aShape,bShape,axis){this.variableNames=["A","B"];this.outputShape=[];var yAxes=["yR","yC","yD","yW"];var concatAxis=yAxes[axis];this.outputShape=concat_util.computeOutShape(aShape,bShape,axis);var dType=shader_compiler_1.getCoordsDataType(aShape.length);var unpackSnippet=getUnpack(aShape.length);var sampleCoords=getSampleCoords(aShape.length);this.userCode="\n      void main() {\n        "+dType+" coords = getOutputCoords();\n        "+unpackSnippet+"\n\n        float value = 0.0;\n        if ("+concatAxis+" < "+aShape[axis]+") {\n          value = getA("+sampleCoords+");\n        } else {\n          "+concatAxis+" -= "+aShape[axis]+";\n          value = getB("+sampleCoords+");\n        }\n\n        setOutput(value);\n      }\n    "}return ConcatProgram}();exports.ConcatProgram=ConcatProgram;function getSampleCoords(rank){if(rank===1){return"yR"}else if(rank===2){return"yR, yC"}else if(rank===3){return"yR, yC, yD"}else if(rank===4){return"yR, yC, yD, yW"}else{throw Error("Concat for rank "+rank+" is not yet supported")}}function getUnpack(rank){var res=rank===1?"int yR = coords;":"int yR = coords.x;";if(rank>1){res+="\nint yC = coords.y;"}if(rank>2){res+="\nint yD = coords.z;"}if(rank>3){res+="\nint yW = coords.w;"}if(rank>4){throw Error("Concat for rank "+rank+" is not yet supported")}return res}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Conv2DDerFilterProgram=function(){function Conv2DDerFilterProgram(convInfo){this.variableNames=["x","dy"];this.outputShape=convInfo.filterShape;var strideHeight=convInfo.strideHeight;var strideWidth=convInfo.strideWidth;var padTop=convInfo.padInfo.top;var padLeft=convInfo.padInfo.left;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+convInfo.batchSize+"; b++) {\n          for (int yR = 0; yR < "+convInfo.outHeight+"; yR++) {\n            int xR = wR + yR * "+strideHeight+" - "+padTop+";\n\n            if (xR < 0 || xR >= "+convInfo.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+convInfo.outWidth+"; yC++) {\n              int xC = wC + yC * "+strideWidth+" - "+padLeft+";\n\n              if (xC < 0 || xC >= "+convInfo.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}return Conv2DDerFilterProgram}();exports.Conv2DDerFilterProgram=Conv2DDerFilterProgram;var Conv2DDerInputProgram=function(){function Conv2DDerInputProgram(convInfo){this.variableNames=["dy","W"];this.outputShape=convInfo.inShape;var filterHeight=convInfo.filterHeight;var filterWidth=convInfo.filterWidth;var strideHeight=convInfo.strideHeight;var strideWidth=convInfo.strideWidth;var padTop=filterHeight-1-convInfo.padInfo.top;var padLeft=filterWidth-1-convInfo.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2("+padTop+", "+padLeft+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+filterHeight+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+convInfo.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+filterHeight+" - 1 - wR;\n\n          for (int wC = 0; wC < "+filterWidth+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+convInfo.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+filterWidth+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+convInfo.outChannels+"; d2++) {\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, d2);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}return Conv2DDerInputProgram}();exports.Conv2DDerInputProgram=Conv2DDerInputProgram;var Conv2DDerBiasProgram=function(){function Conv2DDerBiasProgram(yShape){this.variableNames=["dy"];var batchSize=yShape[0],yNumRows=yShape[1],yNumCols=yShape[2],outputDepth=yShape[3];this.outputShape=[outputDepth];this.userCode="\n      void main() {\n        int d2 = getOutputCoords();\n\n        float derBias = 0.0;\n        for (int b = 0; b < "+batchSize+"; b++) {\n          for (int yR = 0; yR < "+yNumRows+"; yR++) {\n            for (int yC = 0; yC < "+yNumCols+"; yC++) {\n              derBias += getDy(b, yR, yC, d2);\n            }\n          }\n        }\n        setOutput(derBias);\n      }\n    "}return Conv2DDerBiasProgram}();exports.Conv2DDerBiasProgram=Conv2DDerBiasProgram},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Conv2DProgram=function(){function Conv2DProgram(convInfo,hasBias){this.variableNames=["x","W"];if(hasBias){this.variableNames.push("bias")}this.outputShape=convInfo.outShape;var biasSnippet=hasBias?"dotProd += getBias(d2);":"";var padTop=convInfo.padInfo.top;var padLeft=convInfo.padInfo.left;var strideHeight=convInfo.strideHeight;var strideWidth=convInfo.strideWidth;var filterHeight=convInfo.filterHeight;var filterWidth=convInfo.filterWidth;var inputDepthNearestVec4=Math.floor(convInfo.inChannels/4)*4;var inputDepthVec4Remainder=convInfo.inChannels%4;this.userCode="\n      const ivec2 strides = ivec2("+strideHeight+", "+strideWidth+");\n      const ivec2 pads = ivec2("+padTop+", "+padLeft+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+filterHeight+"; wR++) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+convInfo.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+filterWidth+"; wC++) {\n            int xC = xCCorner + wC;\n\n            if (xC < 0 || xC >= "+convInfo.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+inputDepthNearestVec4+"; d1 += 4) {\n              vec4 xValues = vec4(\n                getX(batch, xR, xC, d1),\n                getX(batch, xR, xC, d1 + 1),\n                getX(batch, xR, xC, d1 + 2),\n                getX(batch, xR, xC, d1 + 3)\n              );\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              dotProd += dot(xValues, wValues);\n            }\n\n            if ("+(inputDepthVec4Remainder===1)+") {\n              dotProd +=\n                getX(batch, xR, xC, "+inputDepthNearestVec4+") *\n                getW(wR, wC, "+inputDepthNearestVec4+", d2);\n            } else if ("+(inputDepthVec4Remainder===2)+") {\n              vec2 xValues = vec2(\n                getX(batch, xR, xC, "+inputDepthNearestVec4+"),\n                getX(batch, xR, xC, "+inputDepthNearestVec4+" + 1)\n              );\n              vec2 wValues = vec2(\n                getW(wR, wC, "+inputDepthNearestVec4+", d2),\n                getW(wR, wC, "+inputDepthNearestVec4+" + 1, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            } else if ("+(inputDepthVec4Remainder===3)+") {\n              vec3 xValues = vec3(\n                getX(batch, xR, xC, "+inputDepthNearestVec4+"),\n                getX(batch, xR, xC, "+inputDepthNearestVec4+" + 1),\n                getX(batch, xR, xC, "+inputDepthNearestVec4+" + 2)\n              );\n              vec3 wValues = vec3(\n                getW(wR, wC, "+inputDepthNearestVec4+", d2),\n                getW(wR, wC, "+inputDepthNearestVec4+" + 1, d2),\n                getW(wR, wC, "+inputDepthNearestVec4+" + 2, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            }\n          }\n        }\n        "+biasSnippet+"\n        setOutput(dotProd);\n      }\n    "}return Conv2DProgram}();exports.Conv2DProgram=Conv2DProgram},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var DepthwiseConv2DProgram=function(){function DepthwiseConv2DProgram(convInfo){this.variableNames=["x","W"];this.outputShape=convInfo.outShape;var xNumRows=convInfo.inHeight;var xNumCols=convInfo.inWidth;var padTop=convInfo.padInfo.top;var padLeft=convInfo.padInfo.left;var strideHeight=convInfo.strideHeight;var strideWidth=convInfo.strideWidth;var filterHeight=convInfo.filterHeight;var filterWidth=convInfo.filterWidth;var channelMul=convInfo.outChannels/convInfo.inChannels;this.userCode="\n      const ivec2 strides = ivec2("+strideHeight+", "+strideWidth+");\n      const ivec2 pads = ivec2("+padTop+", "+padLeft+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+channelMul+";\n        int q = d2 - d1 * "+channelMul+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TODO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+filterHeight+"; wR++) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+xNumRows+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+filterWidth+"; wC++) {\n            int xC = xCCorner + wC;\n\n            if (xC < 0 || xC >= "+xNumCols+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}return DepthwiseConv2DProgram}();exports.DepthwiseConv2DProgram=DepthwiseConv2DProgram},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Copy2DProgram=function(){function Copy2DProgram(srcNumCols,destNumCols){this.variableNames=["source"];this.outputShape=null;this.userCode="\n      uniform ivec2 sourceStart;\n      uniform ivec2 destStart;\n\n      void main() {\n        ivec2 destCoords = getOutputCoords() - destStart;\n        int index = destCoords.x * "+destNumCols+" + destCoords.y;\n        int r = index / "+srcNumCols+";\n        ivec2 sourceCoords = sourceStart + ivec2(r, index - r * "+srcNumCols+");\n        setOutput(getSource(sourceCoords.x, sourceCoords.y));\n      }\n    "}Copy2DProgram.prototype.getCustomSetupFunc=function(sourceStart,destStart,destSize){return function(gpgpu,webGLProgram){gpgpu.setOutputMatrixWriteRegion(destStart[0],destSize[0],destStart[1],destSize[1]);var sourceStartCRLoc=gpgpu.getUniformLocation(webGLProgram,"sourceStart");gpgpu.gl.uniform2i(sourceStartCRLoc,sourceStart[0],sourceStart[1]);var destStartCRLoc=gpgpu.getUniformLocation(webGLProgram,"destStart");gpgpu.gl.uniform2i(destStartCRLoc,destStart[0],destStart[1])}};return Copy2DProgram}();exports.Copy2DProgram=Copy2DProgram},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var environment_1=__webpack_require__(11);var util=__webpack_require__(4);var shader_compiler=__webpack_require__(67);var ATTRIBUTE_NAMES=["uv","clipSpacePos"];var NAN_UNIFORM_NAME="NaN";function shouldUploadNaNUniform(){return!environment_1.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")}function compileProgram(gpgpu,program,inputs,output){var userCode=program.userCode;var inputInfos=inputs.map(function(input,i){var shapeInfo={logicalShape:input.array.shape,texShape:input.texData.texShape,textureType:input.texData.textureType};return{name:program.variableNames[i],shapeInfo:shapeInfo}});var inShapeInfos=inputInfos.map(function(x){return x.shapeInfo});var outShapeInfo={logicalShape:output.array.shape,texShape:output.texData.texShape,textureType:output.texData.textureType};var source=shader_compiler.makeShader(inputInfos,outShapeInfo,userCode,program.supportsBroadcasting===true);var webGLProgram=gpgpu.createProgram(source);var uniformLocations={};for(var i=0;i<program.variableNames.length;i++){var uniformName=program.variableNames[i];uniformLocations[uniformName]=gpgpu.getUniformLocation(webGLProgram,uniformName)}var attributeLocations={};ATTRIBUTE_NAMES.forEach(function(attribute){attributeLocations[attribute]=gpgpu.getAttributeLocation(webGLProgram,attribute)});if(shouldUploadNaNUniform()){uniformLocations[NAN_UNIFORM_NAME]=gpgpu.getUniformLocation(webGLProgram,NAN_UNIFORM_NAME)}return{program:program,source:source,webGLProgram:webGLProgram,uniformLocations:uniformLocations,attributeLocations:attributeLocations,gpgpu:gpgpu,inShapeInfos:inShapeInfos,outShapeInfo:outShapeInfo}}exports.compileProgram=compileProgram;function validateBinaryAndProgram(shapeInfos,inputs){if(shapeInfos.length!==inputs.length){throw Error("Binary was compiled with "+shapeInfos.length+" inputs, but "+("was executed with "+inputs.length+" inputs"))}shapeInfos.forEach(function(s,i){var shapeA=s.logicalShape;var texShapeA=s.texShape;var shapeB=inputs[i].array.shape;var texShapeB=inputs[i].texData.texShape;if(!util.arraysEqual(shapeA,shapeB)){throw Error("Binary was compiled with different shapes than "+("the current args. Shapes "+shapeA+" and "+shapeB+" must match"))}if(!util.arraysEqual(texShapeA,texShapeB)){throw Error("Binary was compiled with different texture shapes than the"+(" current args. Shape "+texShapeA+" and "+texShapeB+" must match"))}})}function runProgram(binary,inputs,output,customSetup){validateBinaryAndProgram(binary.inShapeInfos,inputs);validateBinaryAndProgram([binary.outShapeInfo],[output]);var outTex=output.texData.texture;var outTexShape=output.texData.texShape;var gpgpu=binary.gpgpu;gpgpu.setOutputMatrixTexture(outTex,outTexShape[0],outTexShape[1]);gpgpu.setProgram(binary.webGLProgram);inputs.forEach(function(input,i){var tex=input.texData.texture;var variableName=binary.program.variableNames[i];var variableUniformLocation=binary.uniformLocations[variableName];gpgpu.setInputMatrixTexture(tex,variableUniformLocation,i)});if(shouldUploadNaNUniform()){gpgpu.gl.uniform1f(binary.uniformLocations[NAN_UNIFORM_NAME],NaN)}if(customSetup!=null){customSetup(gpgpu,binary.webGLProgram)}gpgpu.executeProgram(binary.attributeLocations)}exports.runProgram=runProgram;function makeShaderKey(program,inputs,output){var keyInputs="";inputs.concat(output).forEach(function(x){keyInputs+=x.array.shape+"_"+x.texData.texShape+"_"+x.texData.textureType});var keyUserCode=program.userCode;var keyBroadcast=(program.supportsBroadcasting===true).toString();var key=program.constructor.name;key+="_"+keyBroadcast+"_"+keyInputs+"_"+keyUserCode;return key}exports.makeShaderKey=makeShaderKey},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var MaxPool2DBackpropProgram=function(){function MaxPool2DBackpropProgram(convInfo){this.variableNames=["dy","maxPos"];this.outputShape=convInfo.inShape;var filterHeight=convInfo.filterHeight;var filterWidth=convInfo.filterWidth;var strideHeight=convInfo.strideHeight;var strideWidth=convInfo.strideWidth;var padTop=filterHeight-1-convInfo.padInfo.top;var padLeft=filterWidth-1-convInfo.padInfo.left;var lastIndex=filterHeight*filterWidth-1;this.userCode="\n      const ivec2 pads = ivec2("+padTop+", "+padLeft+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+filterHeight+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+convInfo.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+filterWidth+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+convInfo.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+lastIndex+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+filterWidth+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}return MaxPool2DBackpropProgram}();exports.MaxPool2DBackpropProgram=MaxPool2DBackpropProgram},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var matmul_1=__webpack_require__(61);var MatMulProgram=function(){function MatMulProgram(aShape,bShape,aOrient,bOrient){if(aOrient===void 0){aOrient=matmul_1.MatrixOrientation.REGULAR}if(bOrient===void 0){bOrient=matmul_1.MatrixOrientation.REGULAR}this.variableNames=["matrixA","matrixB"];var outerShapeA=aOrient===matmul_1.MatrixOrientation.REGULAR?aShape[0]:aShape[1];var outerShapeB=bOrient===matmul_1.MatrixOrientation.REGULAR?bShape[1]:bShape[0];this.outputShape=[outerShapeA,outerShapeB];var sharedDim=aOrient===matmul_1.MatrixOrientation.REGULAR?aShape[1]:aShape[0];var aSnippetFromOffset=function(vec4Offset,indexVar){return aOrient===matmul_1.MatrixOrientation.REGULAR?"aRow, "+indexVar+" + "+vec4Offset:indexVar+" + "+vec4Offset+", aRow"};var bSnippetFromOffset=function(vec4Offset,indexVar){return bOrient===matmul_1.MatrixOrientation.REGULAR?indexVar+" + "+vec4Offset+", bCol":"bCol, "+indexVar+" + "+vec4Offset};var sharedDimNearestVec4=Math.floor(sharedDim/4)*4;var sharedDimVec4Remainder=sharedDim%4;this.userCode=" float dotARowBCol(int aRow, int bCol) {\n      float result = 0.0;\n      for (int i = 0; i < "+sharedDimNearestVec4+"; i += 4) {\n        vec4 a = vec4(\n          getMatrixA("+aSnippetFromOffset(0,"i")+"),\n          getMatrixA("+aSnippetFromOffset(1,"i")+"),\n          getMatrixA("+aSnippetFromOffset(2,"i")+"),\n          getMatrixA("+aSnippetFromOffset(3,"i")+")\n        );\n        vec4 b = vec4(\n          getMatrixB("+bSnippetFromOffset(0,"i")+"),\n          getMatrixB("+bSnippetFromOffset(1,"i")+"),\n          getMatrixB("+bSnippetFromOffset(2,"i")+"),\n          getMatrixB("+bSnippetFromOffset(3,"i")+")\n        );\n\n        result += dot(a, b);\n      }\n\n      if ("+(sharedDimVec4Remainder===1)+") {\n        result += getMatrixA("+aSnippetFromOffset(0,sharedDimNearestVec4)+") *\n          getMatrixB("+bSnippetFromOffset(0,sharedDimNearestVec4)+");\n      } else if ("+(sharedDimVec4Remainder===2)+") {\n        vec2 a = vec2(\n          getMatrixA("+aSnippetFromOffset(0,sharedDimNearestVec4)+"),\n          getMatrixA("+aSnippetFromOffset(1,sharedDimNearestVec4)+")\n        );\n        vec2 b = vec2(\n          getMatrixB("+bSnippetFromOffset(0,sharedDimNearestVec4)+"),\n          getMatrixB("+bSnippetFromOffset(1,sharedDimNearestVec4)+")\n        );\n        result += dot(a, b);\n      } else if ("+(sharedDimVec4Remainder===3)+") {\n        vec3 a = vec3(\n          getMatrixA("+aSnippetFromOffset(0,sharedDimNearestVec4)+"),\n          getMatrixA("+aSnippetFromOffset(1,sharedDimNearestVec4)+"),\n          getMatrixA("+aSnippetFromOffset(2,sharedDimNearestVec4)+")\n        );\n        vec3 b = vec3(\n          getMatrixB("+bSnippetFromOffset(0,sharedDimNearestVec4)+"),\n          getMatrixB("+bSnippetFromOffset(1,sharedDimNearestVec4)+"),\n          getMatrixB("+bSnippetFromOffset(2,sharedDimNearestVec4)+")\n        );\n        result += dot(a, b);\n      }\n\n      return result;\n    }\n\n    void main() {\n      ivec2 resRC = getOutputCoords();\n      setOutput(dotARowBCol(resRC.x, resRC.y));\n    }\n    "}return MatMulProgram}();exports.MatMulProgram=MatMulProgram},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var MultinomialProgram=function(){function MultinomialProgram(batchSize,numOutcomes,numSamples){this.variableNames=["probs"];this.outputShape=[batchSize,numSamples];this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(numOutcomes-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(numOutcomes-1)+"));\n      }\n    "}MultinomialProgram.prototype.getCustomSetupFunc=function(seed){var _this=this;return function(gpgpu,webGLProgram){if(_this.seedLoc==null){_this.seedLoc=gpgpu.getUniformLocation(webGLProgram,"seed")}gpgpu.gl.uniform1f(_this.seedLoc,seed)}};return MultinomialProgram}();exports.MultinomialProgram=MultinomialProgram},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var OneHotProgram=function(){function OneHotProgram(numIndices,depth,onValue,offValue){this.variableNames=["indices"];this.outputShape=[numIndices,depth];this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+offValue+"), float("+onValue+"),\n                      float(index == coords.y)));\n      }\n    "}OneHotProgram.prototype.getCustomSetupFunc=function(seed){var _this=this;return function(gpgpu,webGLProgram){if(_this.seedLoc==null){_this.seedLoc=gpgpu.getUniformLocation(webGLProgram,"seed")}gpgpu.gl.uniform1f(_this.seedLoc,seed)}};return OneHotProgram}();exports.OneHotProgram=OneHotProgram},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Pool2DProgram=function(){function Pool2DProgram(convInfo,poolType,computePositions){this.variableNames=["x"];if(poolType==="avg"&&computePositions){throw new Error("Cannot compute positions for average pool.")}var filterHeight=convInfo.filterHeight;var filterWidth=convInfo.filterWidth;var strideHeight=convInfo.strideHeight;var strideWidth=convInfo.strideWidth;var padTop=convInfo.padInfo.top;var padLeft=convInfo.padInfo.left;this.outputShape=convInfo.outShape;var isAvgPool=poolType==="avg";var initializationValue="0.0";if(!isAvgPool){if(poolType==="min"){initializationValue="1.0 / 0.0"}else{initializationValue="-1.0 / 0.0"}}if(computePositions){var compareOp_1=poolType==="min"?"<=":">=";this.userCode="\n        const ivec2 strides = ivec2("+strideHeight+", "+strideWidth+");\n        const ivec2 pads = ivec2("+padTop+", "+padLeft+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+filterHeight+"; wR++) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+convInfo.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+filterWidth+"; wC++) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+convInfo.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              if (isNaN(value)) {\n                setOutput(value);\n                return;\n              }\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value "+compareOp_1+" currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+filterWidth+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";return}var compareOp=poolType==="min"?"min":"max";var returnValue=poolType+"("+poolType+"("+poolType+"("+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";if(poolType==="avg"){returnValue="avgValue / "+filterHeight*filterWidth+".0"}var filterWidthNearestVec4=Math.floor(filterWidth/4)*4;var filterWidthVec4Remainder=filterWidth%4;var updateSnippet="\n      if (hasNaN(values)) {\n        setOutput(getNaN(values));\n        return;\n      }\n      if ("+isAvgPool+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = "+compareOp+"(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+strideHeight+", "+strideWidth+");\n      const ivec2 pads = ivec2("+padTop+", "+padLeft+");\n      const float initializationValue = "+initializationValue+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+convInfo.inWidth+") {\n          return initializationValue;\n        }\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+initializationValue+");\n        float avgValue = 0.0;\n\n        for (int wR = 0; wR < "+filterHeight+"; wR++) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+convInfo.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+filterWidthNearestVec4+"; wC += 4) {\n            int xC = xCCorner + wC;\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + 1, d),\n              getValue(batch, xR, xC + 2, d),\n              getValue(batch, xR, xC + 3, d)\n            );\n\n            "+updateSnippet+"\n          }\n\n          int xC = xCCorner + "+filterWidthNearestVec4+";\n          if ("+(filterWidthVec4Remainder===1)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n            "+updateSnippet+"\n          } else if ("+(filterWidthVec4Remainder===2)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + 1, d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+updateSnippet+"\n          } else if ("+(filterWidthVec4Remainder===3)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + 1, d),\n              getValue(batch, xR, xC + 2, d),\n              initializationValue\n            );\n\n            "+updateSnippet+"\n          }\n        }\n        setOutput("+returnValue+");\n      }\n    "}return Pool2DProgram}();exports.Pool2DProgram=Pool2DProgram},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ReduceProgram=function(){function ReduceProgram(reduceInfo,reduceType){this.variableNames=["x"];var windowSize=reduceInfo.windowSize;var batchSize=reduceInfo.batchSize;var inSize=reduceInfo.inSize;var outSize=Math.ceil(inSize/windowSize);this.outputShape=[batchSize,outSize];var isReduceSum=reduceType==="sum";var initializationValue="0.0";if(!isReduceSum){if(reduceType==="min"){initializationValue="1.0 / 0.0"}else{initializationValue="-1.0 / 0.0"}}var compareOp=reduceType==="min"?"min":"max";var returnValue=reduceType+"("+reduceType+"("+reduceType+"("+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";if(reduceType==="sum"){returnValue="sumValue"}var windowSizeNearestVec4=Math.floor(windowSize/4)*4;var windowSizeVec4Remainder=windowSize%4;var updateSnippet="\n      if ("+isReduceSum+") {\n        sumValue += dot(values, ones);\n      } else {\n        if (hasNaN(values)) {\n          setOutput(getNaN(values));\n          return;\n        }\n        minMaxValue = "+compareOp+"(values, minMaxValue);\n      }\n    ";var checkOutOfBounds="";if(inSize%windowSize>0){checkOutOfBounds="\n        if (inIdx < 0 || inIdx >= "+inSize+") {\n          return initializationValue;\n        }\n      "}this.userCode="\n      const float initializationValue = "+initializationValue+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+checkOutOfBounds+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+windowSize+";\n\n        vec4 minMaxValue = vec4("+initializationValue+");\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+windowSizeNearestVec4+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+updateSnippet+"\n        }\n\n        int inIdx = inOffset + "+windowSizeNearestVec4+";\n        if ("+(windowSizeVec4Remainder===1)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n          "+updateSnippet+"\n        } else if ("+(windowSizeVec4Remainder===2)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n          "+updateSnippet+"\n        } else if ("+(windowSizeVec4Remainder===3)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n          "+updateSnippet+"\n        }\n        setOutput("+returnValue+");\n      }\n    "}return ReduceProgram}();exports.ReduceProgram=ReduceProgram},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ResizeBilinear3DProgram=function(){function ResizeBilinear3DProgram(inputShape,outputDimensionsRowCol,alignCorners){this.variableNames=["A"];this.outputShape=[];var depth=inputShape[2];this.outputShape=[outputDimensionsRowCol[0],outputDimensionsRowCol[1],depth];var effectiveInputShape=alignCorners?[inputShape[0]-1,inputShape[1]-1,depth]:inputShape;var effectiveOutputShape=alignCorners?[this.outputShape[0]-1,this.outputShape[1]-1,depth]:this.outputShape;this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+effectiveInputShape[0]/effectiveOutputShape[0]+",\n          "+effectiveInputShape[1]/effectiveOutputShape[1]+");\n      const vec2 inputShapeRC = vec2("+inputShape[0]+".0, "+inputShape[1]+".0);\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        ivec2 yRC = coords.xy;\n        int d = coords.z;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "}return ResizeBilinear3DProgram}();exports.ResizeBilinear3DProgram=ResizeBilinear3DProgram},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var shader_compiler_1=__webpack_require__(67);var SliceProgram=function(){function SliceProgram(destSize){this.variableNames=["source"];this.outputShape=destSize;this.rank=destSize.length;var dtype=shader_compiler_1.getCoordsDataType(this.rank);var sourceCoords=getCoords(this.rank);this.userCode="\n      uniform "+dtype+" start;\n\n      void main() {\n        "+dtype+" sourceLoc = start + getOutputCoords();\n        setOutput(getSource("+sourceCoords+"));\n      }\n    "}SliceProgram.prototype.getCustomSetupFunc=function(start){var _this=this;if(start.length!==this.rank){throw Error("The rank ("+this.rank+") of the program must match the "+("length of start ("+start.length+")"))}return function(gpgpu,webGLProgram){if(_this.startLoc==null){_this.startLoc=gpgpu.getUniformLocationNoThrow(webGLProgram,"start");if(_this.startLoc==null){return}}if(_this.rank===1){gpgpu.gl.uniform1i(_this.startLoc,start[0])}else if(_this.rank===2){gpgpu.gl.uniform2i(_this.startLoc,start[0],start[1])}else if(_this.rank===3){gpgpu.gl.uniform3i(_this.startLoc,start[0],start[1],start[2])}else if(_this.rank===4){gpgpu.gl.uniform4i(_this.startLoc,start[0],start[1],start[2],start[3])}else{throw Error("Slicing for rank "+_this.rank+" is not yet supported")}}};return SliceProgram}();exports.SliceProgram=SliceProgram;function getCoords(rank){if(rank===1){return"sourceLoc"}else if(rank===2){return"sourceLoc.x, sourceLoc.y"}else if(rank===3){return"sourceLoc.x, sourceLoc.y, sourceLoc.z"}else if(rank===4){return"sourceLoc.x, sourceLoc.y, sourceLoc.z, sourceLoc.w"}else{throw Error("Slicing for rank "+rank+" is not yet supported")}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var TextureManager=function(){function TextureManager(gpgpu){this.gpgpu=gpgpu;this.numUsedTextures=0;this.numFreeTextures=0;this.freeTextures={};this.logEnabled=false;this.allocatedTextures=[];this.usedTextureCount={}}TextureManager.prototype.acquireTexture=function(shapeRC){var shapeKey=getKeyFromTextureShape(shapeRC);if(!(shapeKey in this.freeTextures)){this.freeTextures[shapeKey]=[]}if(!(shapeKey in this.usedTextureCount)){this.usedTextureCount[shapeKey]=0}this.usedTextureCount[shapeKey]++;if(this.freeTextures[shapeKey].length>0){this.numFreeTextures--;this.numUsedTextures++;this.log();return this.freeTextures[shapeKey].shift()}this.numUsedTextures++;this.log();var newTexture=this.gpgpu.createMatrixTexture(shapeRC[0],shapeRC[1]);this.allocatedTextures.push(newTexture);return newTexture};TextureManager.prototype.releaseTexture=function(texture,shape){var shapeKey=getKeyFromTextureShape(shape);if(!(shapeKey in this.freeTextures)){this.freeTextures[shapeKey]=[]}this.freeTextures[shapeKey].push(texture);this.numFreeTextures++;this.numUsedTextures--;this.usedTextureCount[shapeKey]--;this.log()};TextureManager.prototype.log=function(){if(!this.logEnabled){return}var total=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+total+")")};TextureManager.prototype.getNumUsedTextures=function(){return this.numUsedTextures};TextureManager.prototype.getNumFreeTextures=function(){return this.numFreeTextures};TextureManager.prototype.dispose=function(){var _this=this;this.allocatedTextures.forEach(function(texture){_this.gpgpu.deleteMatrixTexture(texture)});this.freeTextures=null;this.allocatedTextures=null;this.usedTextureCount=null;this.numUsedTextures=0;this.numFreeTextures=0};return TextureManager}();exports.TextureManager=TextureManager;function getKeyFromTextureShape(shapeRowsCol){return shapeRowsCol[0]+"_"+shapeRowsCol[1]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var shader_compiler_1=__webpack_require__(67);var TileProgram=function(){function TileProgram(aShape,reps){this.variableNames=["A"];var outputShape=new Array(aShape.length);for(var i=0;i<outputShape.length;i++){outputShape[i]=aShape[i]*reps[i]}this.outputShape=outputShape;this.rank=outputShape.length;var dtype=shader_compiler_1.getCoordsDataType(this.rank);var sourceCoords=getSourceCoords(aShape);this.userCode="\n      void main() {\n        "+dtype+" resRC = getOutputCoords();\n        setOutput(getA("+sourceCoords+"));\n      }\n    "}return TileProgram}();exports.TileProgram=TileProgram;function getSourceCoords(aShape){var rank=aShape.length;if(rank>4){throw Error("Tile for rank "+rank+" is not yet supported")}if(rank===1){return"imod(resRC, "+aShape[0]+")"}var currentCoords=["resRC.x","resRC.y","resRC.z","resRC.w"];var sourceCoords=[];for(var i=0;i<aShape.length;i++){sourceCoords.push("imod("+currentCoords[i]+", "+aShape[i]+")")}return sourceCoords.join()}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var shader_compiler_1=__webpack_require__(67);var TransposeProgram=function(){function TransposeProgram(aShape,newDim){this.variableNames=["A"];var outputShape=new Array(aShape.length);for(var i=0;i<outputShape.length;i++){outputShape[i]=aShape[newDim[i]]}this.outputShape=outputShape;this.rank=outputShape.length;var dtype=shader_compiler_1.getCoordsDataType(this.rank);var switched=getSwitchedCoords(newDim);this.userCode="\n    void main() {\n      "+dtype+" resRC = getOutputCoords();\n      setOutput(getA("+switched+"));\n    }\n    "}return TransposeProgram}();exports.TransposeProgram=TransposeProgram;function getSwitchedCoords(newDim){var rank=newDim.length;if(rank>4){throw Error("Transpose for rank "+rank+" is not yet supported")}var originalOrder=["resRC.x","resRC.y","resRC.z","resRC.w"];var switchedCoords=new Array(rank);for(var i=0;i<newDim.length;i++){switchedCoords[newDim[i]]=originalOrder[i]}return switchedCoords.join()}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var version="0.4.1";exports.version=version},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ndarray_1=__webpack_require__(3);var MANIFEST_FILE="manifest.json";var CheckpointLoader=function(){function CheckpointLoader(urlPath){this.urlPath=urlPath;if(this.urlPath.charAt(this.urlPath.length-1)!=="/"){this.urlPath+="/"}}CheckpointLoader.prototype.loadManifest=function(){var _this=this;return new Promise(function(resolve,reject){var xhr=new XMLHttpRequest;xhr.open("GET",_this.urlPath+MANIFEST_FILE);xhr.onload=function(){_this.checkpointManifest=JSON.parse(xhr.responseText);resolve()};xhr.onerror=function(error){throw new Error(MANIFEST_FILE+" not found at "+_this.urlPath+". "+error)};xhr.send()})};CheckpointLoader.prototype.getCheckpointManifest=function(){var _this=this;if(this.checkpointManifest==null){return new Promise(function(resolve,reject){_this.loadManifest().then(function(){resolve(_this.checkpointManifest)})})}return new Promise(function(resolve,reject){resolve(_this.checkpointManifest)})};CheckpointLoader.prototype.getAllVariables=function(){var _this=this;if(this.variables!=null){return new Promise(function(resolve,reject){resolve(_this.variables)})}return new Promise(function(resolve,reject){_this.getCheckpointManifest().then(function(checkpointDefinition){var variableNames=Object.keys(_this.checkpointManifest);var variablePromises=[];for(var i=0;i<variableNames.length;i++){variablePromises.push(_this.getVariable(variableNames[i]))}Promise.all(variablePromises).then(function(variables){_this.variables={};for(var i=0;i<variables.length;i++){_this.variables[variableNames[i]]=variables[i]}resolve(_this.variables)})})})};CheckpointLoader.prototype.getVariable=function(varName){var _this=this;if(!(varName in this.checkpointManifest)){throw new Error("Cannot load non-existant variable "+varName)}var variableRequestPromiseMethod=function(resolve,reject){var xhr=new XMLHttpRequest;xhr.responseType="arraybuffer";var fname=_this.checkpointManifest[varName].filename;xhr.open("GET",_this.urlPath+fname);xhr.onload=function(){if(xhr.status===404){throw new Error("Not found variable "+varName)}var values=new Float32Array(xhr.response);var ndarray=ndarray_1.NDArray.make(_this.checkpointManifest[varName].shape,{values:values});resolve(ndarray)};xhr.onerror=function(error){throw new Error("Could not fetch variable "+varName+": "+error)};xhr.send()};if(this.checkpointManifest==null){return new Promise(function(resolve,reject){_this.loadManifest().then(function(){new Promise(variableRequestPromiseMethod).then(resolve)})})}return new Promise(variableRequestPromiseMethod)};return CheckpointLoader}();exports.CheckpointLoader=CheckpointLoader},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var ndarray_1=__webpack_require__(3);var util=__webpack_require__(4);var InMemoryShuffledInputProviderBuilder=function(){function InMemoryShuffledInputProviderBuilder(inputs){this.inputs=inputs;this.idx=0;this.inputCounter=0;this.epoch=0;this.shuffledIndices=util.createShuffledIndices(inputs[0].length);this.numInputs=inputs.length;var numExamples=this.inputs[0].length;for(var i=0;i<this.numInputs;i++){util.assert(this.inputs[i].length===numExamples,"Number of examples must match across different inputs.")}for(var i=0;i<this.numInputs;i++){var inputShape=this.inputs[i][0].shape;for(var j=0;j<this.inputs[i].length;j++){util.assertShapesMatch(inputShape,this.inputs[i][j].shape)}}}InMemoryShuffledInputProviderBuilder.prototype.getCurrentExampleIndex=function(){var returnIdx=this.idx;this.inputCounter++;if(this.inputCounter>=this.numInputs){this.idx++;this.inputCounter=0;if(this.idx>=this.inputs[0].length){this.idx=0;this.epoch++}}return returnIdx};InMemoryShuffledInputProviderBuilder.prototype.getNextInput=function(inputId){var currentExampleIndex=this.getCurrentExampleIndex();return this.inputs[inputId][this.shuffledIndices[currentExampleIndex]]};InMemoryShuffledInputProviderBuilder.prototype.getEpoch=function(){return this.epoch};InMemoryShuffledInputProviderBuilder.prototype.getInputProviders=function(){var inputProviders=[];for(var i=0;i<this.numInputs;i++){inputProviders.push(this.getInputProvider(i))}return inputProviders};return InMemoryShuffledInputProviderBuilder}();exports.InMemoryShuffledInputProviderBuilder=InMemoryShuffledInputProviderBuilder;var InCPUMemoryShuffledInputProviderBuilder=function(_super){__extends(InCPUMemoryShuffledInputProviderBuilder,_super);function InCPUMemoryShuffledInputProviderBuilder(){return _super!==null&&_super.apply(this,arguments)||this}InCPUMemoryShuffledInputProviderBuilder.prototype.getInputProvider=function(inputId){var shuffledInputProvider=this;return{getNextCopy:function(math){return ndarray_1.NDArray.like(shuffledInputProvider.getNextInput(inputId))},disposeCopy:function(math,copy){copy.dispose()}}};return InCPUMemoryShuffledInputProviderBuilder}(InMemoryShuffledInputProviderBuilder);exports.InCPUMemoryShuffledInputProviderBuilder=InCPUMemoryShuffledInputProviderBuilder;var InGPUMemoryShuffledInputProviderBuilder=function(_super){__extends(InGPUMemoryShuffledInputProviderBuilder,_super);function InGPUMemoryShuffledInputProviderBuilder(){return _super!==null&&_super.apply(this,arguments)||this}InGPUMemoryShuffledInputProviderBuilder.prototype.getInputProvider=function(inputId){var shuffledInputProvider=this;return{getNextCopy:function(math){return math.clone(shuffledInputProvider.getNextInput(inputId))},disposeCopy:function(math,copy){copy.dispose()}}};return InGPUMemoryShuffledInputProviderBuilder}(InMemoryShuffledInputProviderBuilder);exports.InGPUMemoryShuffledInputProviderBuilder=InGPUMemoryShuffledInputProviderBuilder},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ndarray_1=__webpack_require__(3);var session_1=__webpack_require__(157);var DEFAULT_EVAL_INTERVAL_MS=1500;var DEFAULT_COST_INTERVAL_MS=500;var DEFAULT_INFERENCE_EXAMPLE_INTERVAL_MS=3e3;var MetricReduction;(function(MetricReduction){MetricReduction[MetricReduction["SUM"]=0]="SUM";MetricReduction[MetricReduction["MEAN"]=1]="MEAN"})(MetricReduction=exports.MetricReduction||(exports.MetricReduction={}));var GraphRunner=function(){function GraphRunner(math,session,eventObserver){this.math=math;this.session=session;this.eventObserver=eventObserver;this.lastCostTimestamp=0;this.lastEvalTimestamp=0;this.resetStatistics();this.zeroScalar=ndarray_1.Scalar.new(0)}GraphRunner.prototype.resetStatistics=function(){this.totalBatchesTrained=0};GraphRunner.prototype.train=function(costTensor,trainFeedEntries,batchSize,optimizer,numBatches,metricTensor,metricFeedEntries,metricBatchSize,metricReduction,evalIntervalMs,costIntervalMs){if(metricReduction===void 0){metricReduction=MetricReduction.MEAN}if(evalIntervalMs===void 0){evalIntervalMs=DEFAULT_EVAL_INTERVAL_MS}if(costIntervalMs===void 0){costIntervalMs=DEFAULT_COST_INTERVAL_MS}this.costTensor=costTensor;this.trainFeedEntries=trainFeedEntries;this.metricTensor=metricTensor;this.metricFeedEntries=metricFeedEntries;if(metricBatchSize!=null&&this.metricBatchSize!==metricBatchSize){if(this.metricBatchSizeScalar!=null){this.metricBatchSizeScalar.dispose()}this.metricBatchSizeScalar=ndarray_1.Scalar.new(metricBatchSize)}this.metricBatchSize=metricBatchSize;this.metricReduction=metricReduction;this.batchSize=batchSize;this.optimizer=optimizer;this.metricIntervalMs=evalIntervalMs;this.costIntervalMs=costIntervalMs;this.currentTrainLoopNumBatches=numBatches;this.batchesTrainedThisRun=0;this.isTraining=true;this.trainStartTimestamp=performance.now();this.trainNetwork()};GraphRunner.prototype.stopTraining=function(){this.isTraining=false};GraphRunner.prototype.resumeTraining=function(){this.isTraining=true;this.trainNetwork()};GraphRunner.prototype.trainNetwork=function(){var _this=this;if(this.batchesTrainedThisRun===this.currentTrainLoopNumBatches){this.stopTraining()}if(!this.isTraining){if(this.eventObserver.doneTrainingCallback!=null){this.eventObserver.doneTrainingCallback()}return}var start=performance.now();var shouldComputeCost=this.eventObserver.avgCostCallback!=null&&start-this.lastCostTimestamp>this.costIntervalMs;if(shouldComputeCost){this.lastCostTimestamp=start}var costReduction=shouldComputeCost?session_1.CostReduction.MEAN:session_1.CostReduction.NONE;this.math.scope(function(keep){var avgCost=_this.session.train(_this.costTensor,_this.trainFeedEntries,_this.batchSize,_this.optimizer,costReduction);if(shouldComputeCost){var trainTime=performance.now()-start;_this.eventObserver.avgCostCallback(avgCost);if(_this.eventObserver.trainExamplesPerSecCallback!=null){var examplesPerSec=_this.batchSize*1e3/trainTime;_this.eventObserver.trainExamplesPerSecCallback(examplesPerSec)}}if(_this.eventObserver.metricCallback!=null&&_this.metricFeedEntries!=null&&start-_this.lastEvalTimestamp>_this.metricIntervalMs){_this.lastEvalTimestamp=start;if(_this.lastComputedMetric!=null){_this.lastComputedMetric.dispose()}_this.lastComputedMetric=_this.computeMetric();_this.eventObserver.metricCallback(_this.lastComputedMetric)}if(_this.eventObserver.totalTimeCallback!=null){_this.eventObserver.totalTimeCallback((start-_this.trainStartTimestamp)/1e3)}_this.batchesTrainedThisRun++;_this.totalBatchesTrained++;if(_this.eventObserver.batchesTrainedCallback!=null){_this.eventObserver.batchesTrainedCallback(_this.totalBatchesTrained)}});requestAnimationFrame(function(){return _this.trainNetwork()})};GraphRunner.prototype.infer=function(inferenceTensor,inferenceFeedEntries,inferenceExampleIntervalMs,inferenceExampleCount,numPasses){var _this=this;if(inferenceExampleIntervalMs===void 0){inferenceExampleIntervalMs=DEFAULT_INFERENCE_EXAMPLE_INTERVAL_MS}if(inferenceExampleCount===void 0){inferenceExampleCount=5}if(this.eventObserver.inferenceExamplesCallback==null&&this.eventObserver.inferenceExamplesPerSecCallback==null){throw new Error("Cannot start inference loop, no inference example or "+"examples/sec observer provided.")}for(var i=0;i<inferenceFeedEntries.length;i++){var feedEntry=inferenceFeedEntries[i];if(feedEntry.data instanceof ndarray_1.NDArray){throw new Error("Cannot start inference on the model runner with feed entries of "+"type NDArray. Please use InputProviders.")}}this.inferenceExampleIntervalMs=inferenceExampleIntervalMs;this.inferenceTensor=inferenceTensor;this.inferenceFeedEntries=inferenceFeedEntries;this.inferenceExampleCount=inferenceExampleCount;this.currentInferenceLoopNumPasses=numPasses;if(!this.isInferring){this.inferencePassesThisRun=0;requestAnimationFrame(function(){return _this.inferNetwork()})}this.isInferring=true};GraphRunner.prototype.inferNetwork=function(){var _this=this;if(!this.isInferring||this.inferencePassesThisRun===this.currentInferenceLoopNumPasses){return}this.math.scope(function(keep){var feeds=[];var inferenceValues=[];var start=performance.now();for(var i=0;i<_this.inferenceExampleCount;i++){var ndarrayFeedEntries=[];for(var j=0;j<_this.inferenceFeedEntries.length;j++){var feedEntry=_this.inferenceFeedEntries[j];var nextCopy=feedEntry.data.getNextCopy(_this.math);ndarrayFeedEntries.push({tensor:feedEntry.tensor,data:nextCopy})}feeds.push(ndarrayFeedEntries);inferenceValues.push(_this.session.eval(_this.inferenceTensor,ndarrayFeedEntries))}if(_this.eventObserver.inferenceExamplesPerSecCallback!=null){inferenceValues[inferenceValues.length-1].dataSync();var inferenceExamplesPerSecTime=performance.now()-start;var examplesPerSec=_this.inferenceExampleCount*1e3/inferenceExamplesPerSecTime;_this.eventObserver.inferenceExamplesPerSecCallback(examplesPerSec)}if(_this.eventObserver.inferenceExamplesCallback!=null){_this.eventObserver.inferenceExamplesCallback(feeds,inferenceValues)}_this.inferencePassesThisRun++});this.lastInferTimeoutID=window.setTimeout(function(){return _this.inferNetwork()},this.inferenceExampleIntervalMs)};GraphRunner.prototype.stopInferring=function(){this.isInferring=false;window.clearTimeout(this.lastInferTimeoutID)};GraphRunner.prototype.isInferenceRunning=function(){return this.isInferring};GraphRunner.prototype.computeMetric=function(){var _this=this;if(this.metricFeedEntries==null){throw new Error("Cannot compute metric, no metric FeedEntries provided.")}var metric=this.zeroScalar;return this.math.scope(function(keep){for(var i=0;i<_this.metricBatchSize;i++){var metricValue=_this.session.eval(_this.metricTensor,_this.metricFeedEntries);metric=_this.math.add(metric,metricValue.asType("float32"))}if(_this.metricReduction===MetricReduction.MEAN){metric=_this.math.divide(metric,_this.metricBatchSizeScalar)}return metric})};GraphRunner.prototype.getTotalBatchesTrained=function(){return this.totalBatchesTrained};GraphRunner.prototype.getLastComputedMetric=function(){return this.lastComputedMetric};GraphRunner.prototype.setMath=function(math){this.math=math};GraphRunner.prototype.setSession=function(session){this.session=session};GraphRunner.prototype.setInferenceTensor=function(inferenceTensor){this.inferenceTensor=inferenceTensor};GraphRunner.prototype.setInferenceExampleCount=function(inferenceExampleCount){this.inferenceExampleCount=inferenceExampleCount};return GraphRunner}();exports.GraphRunner=GraphRunner},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var graph_1=__webpack_require__(68);var graph_util=__webpack_require__(19);var add_1=__webpack_require__(408);var argmax_1=__webpack_require__(409);var argmaxequals_1=__webpack_require__(410);var concat3d_1=__webpack_require__(411);var convolution_1=__webpack_require__(412);var divide_1=__webpack_require__(413);var element_wise_activation_1=__webpack_require__(414);var element_wise_cost_1=__webpack_require__(416);var exp_1=__webpack_require__(418);var linear_combination_1=__webpack_require__(419);var log_1=__webpack_require__(420);var matmul_1=__webpack_require__(421);var max_pool_1=__webpack_require__(422);var multiply_1=__webpack_require__(423);var reduce_sum_1=__webpack_require__(424);var reshape_1=__webpack_require__(425);var softmax_1=__webpack_require__(426);var subtract_1=__webpack_require__(427);function emitFromGraphNodes(nodes){var ops=[];nodes.forEach(function(node){return Array.prototype.push.apply(ops,emitOpFromNode(node))});return ops}exports.emitFromGraphNodes=emitFromGraphNodes;function emitOpFromNode(node){if(node instanceof graph_1.ReshapeNode){return[new reshape_1.Reshape(node.inputs[graph_1.ReshapeNode.X],node.output)]}else if(node instanceof graph_1.MatMulNode){var x1=node.inputs[graph_1.MatMulNode.X1];var x2=node.inputs[graph_1.MatMulNode.X2];return[new matmul_1.MatMul(x1,x2,node.output)]}else if(node instanceof graph_1.Convolution2DNode){var w=node.inputs[graph_1.Convolution2DNode.W];var x=node.inputs[graph_1.Convolution2DNode.X];var b=node.inputs[graph_1.Convolution2DNode.B];return[new convolution_1.Convolution2D(w,x,b,node.output,node.fieldSize,node.outputDepth,node.stride,node.zeroPad)]}else if(node instanceof graph_1.MaxPoolNode){var x=node.inputs[graph_1.MaxPoolNode.X];return[new max_pool_1.MaxPool(x,node.output,node.fieldSize,node.stride,node.zeroPad)]}else if(node instanceof graph_1.ExpNode){return[new exp_1.Exp(node.inputs[graph_1.ExpNode.X],node.output)]}else if(node instanceof graph_1.LogNode){return[new log_1.Log(node.inputs[graph_1.LogNode.X],node.output)]}else if(node instanceof graph_1.ReLUNode){return[new element_wise_activation_1.ReLU(node.inputs[graph_1.ReLUNode.X],node.output)]}else if(node instanceof graph_1.LeakyReLUNode){return[new element_wise_activation_1.LeakyReLU(node.inputs[graph_1.LeakyReLUNode.X],node.output,node.alpha)]}else if(node instanceof graph_1.PReLUNode){return[new element_wise_activation_1.PReLU(node.inputs[graph_1.PReLUNode.X],node.inputs[graph_1.PReLUNode.ALPHA],node.output)]}else if(node instanceof graph_1.EluNode){return[new element_wise_activation_1.Elu(node.inputs[graph_1.EluNode.X],node.output)]}else if(node instanceof graph_1.TanHNode){return[new element_wise_activation_1.TanH(node.inputs[graph_1.TanHNode.X],node.output)]}else if(node instanceof graph_1.SigmoidNode){return[new element_wise_activation_1.Sigmoid(node.inputs[graph_1.SigmoidNode.X],node.output)]}else if(node instanceof graph_1.SoftmaxCrossEntropyCostNode){var x=node.inputs[graph_1.SoftmaxCrossEntropyCostNode.X];var target=node.inputs[graph_1.SoftmaxCrossEntropyCostNode.TARGET];return[new softmax_1.SoftmaxCrossEntropyCost(x,target,node.output)]}else if(node instanceof graph_1.SoftmaxNode){return[new softmax_1.Softmax(node.inputs[graph_1.SoftmaxNode.X],node.output)]}else if(node instanceof graph_1.MeanSquaredCostNode){var label=node.inputs[graph_1.MeanSquaredCostNode.LABEL];var prediction=node.inputs[graph_1.MeanSquaredCostNode.PREDICTION];return[new element_wise_cost_1.MeanSquaredCost(label,prediction,node.output)]}else if(node instanceof graph_1.ArgMaxEqualsNode){return[new argmaxequals_1.ArgMaxEquals(node.inputs[graph_1.ArgMaxEqualsNode.X1],node.inputs[graph_1.ArgMaxEqualsNode.X2],node.output)]}else if(node instanceof graph_1.ArgMaxNode){return[new argmax_1.ArgMax(node.x,node.output)]}else if(node instanceof graph_1.FusedLinearCombinationNode){return[new linear_combination_1.LinearCombination(node.inputs[graph_1.FusedLinearCombinationNode.T1],node.inputs[graph_1.FusedLinearCombinationNode.T2],node.inputs[graph_1.FusedLinearCombinationNode.C1],node.inputs[graph_1.FusedLinearCombinationNode.C2],node.output)]}else if(node instanceof graph_1.Concat3DNode){return[new concat3d_1.Concat3D(node.inputs[graph_1.Concat3DNode.X1],node.inputs[graph_1.Concat3DNode.X2],node.axis,node.output)]}else if(node instanceof graph_1.SquareNode){return[new element_wise_activation_1.Square(node.inputs[graph_1.SquareNode.X],node.output)]}else if(node instanceof graph_1.AddNode){return[new add_1.Add(node.inputs[graph_1.AddNode.T1],node.inputs[graph_1.AddNode.T2],node.output)]}else if(node instanceof graph_1.SubtractNode){return[new subtract_1.Subtract(node.inputs[graph_1.SubtractNode.T1],node.inputs[graph_1.SubtractNode.T2],node.output)]}else if(node instanceof graph_1.MultiplyNode){return[new multiply_1.Multiply(node.inputs[graph_1.MultiplyNode.T1],node.inputs[graph_1.MultiplyNode.T2],node.output)]}else if(node instanceof graph_1.DivideNode){return[new divide_1.Divide(node.inputs[graph_1.DivideNode.T1],node.inputs[graph_1.DivideNode.T2],node.output)]}else if(node instanceof graph_1.ReduceSumNode){return[new reduce_sum_1.ReduceSum(node.inputs[graph_1.ReduceSumNode.X],node.output)]}else if(graph_util.isInputNode(node)){return[]}else{throw Error("Unsupported node type: "+node.constructor.name)}}},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var util=__webpack_require__(4);var graph_util=__webpack_require__(19);var op_1=__webpack_require__(13);var Add=function(_super){__extends(Add,_super);function Add(x1Tensor,x2Tensor,yTensor){var _this=_super.call(this)||this;_this.x1Tensor=x1Tensor;_this.x2Tensor=x2Tensor;_this.yTensor=yTensor;util.assert(util.sizeFromShape(x1Tensor.shape)===1||util.sizeFromShape(x2Tensor.shape)===1||util.arraysEqual(x1Tensor.shape,x2Tensor.shape)||x1Tensor.shape.length===2&&x2Tensor.shape.length===1&&x1Tensor.shape[1]===x2Tensor.shape[0]||x1Tensor.shape.length===1&&x2Tensor.shape.length===2&&x1Tensor.shape[0]===x2Tensor.shape[1],"One of t1 or t2 must be a scalar, or t1 and t2 must have "+"the same shape, "+"or one of them can be broadcasted (2D and 1D).");return _this}Add.prototype.feedForward=function(math,inferenceArrays){var _this=this;var x1=inferenceArrays.get(this.x1Tensor);var x2=inferenceArrays.get(this.x2Tensor);math.scope(function(keep){var result;if(util.isScalarShape(x1.shape)){result=math.scalarPlusArray(x1,x2)}else if(util.isScalarShape(x2.shape)){result=math.scalarPlusArray(x2,x1)}else{result=math.add(x1,x2)}inferenceArrays.set(_this.yTensor,keep(result))})};Add.prototype.backProp=function(math,inferenceArrays,gradientArrays){var _this=this;var dy=gradientArrays.get(this.yTensor);math.scope(function(){if(graph_util.shouldBackProp(_this.x1Tensor)){if(_this.x1Tensor.shape.length===1&&_this.x2Tensor.shape.length===2&&_this.x1Tensor.shape[0]===_this.x2Tensor.shape[1]){var sum=math.sum(dy,0);gradientArrays.add(_this.x1Tensor,sum)}else if(util.isScalarShape(_this.x1Tensor.shape)){var sum=math.sum(dy);gradientArrays.add(_this.x1Tensor,sum)}else{gradientArrays.add(_this.x1Tensor,math.clone(dy))}}if(graph_util.shouldBackProp(_this.x2Tensor)){if(_this.x1Tensor.shape.length===2&&_this.x2Tensor.shape.length===1&&_this.x1Tensor.shape[1]===_this.x2Tensor.shape[0]){var sum=math.sum(dy,0);gradientArrays.add(_this.x2Tensor,sum)}else if(util.isScalarShape(_this.x2Tensor.shape)){var sum=math.sum(dy);gradientArrays.add(_this.x2Tensor,sum)}else{gradientArrays.add(_this.x2Tensor,math.clone(dy))}}})};Add.prototype.dispose=function(){if(this.dySizeScalar!=null){this.dySizeScalar.dispose()}};return Add}(op_1.Operation);exports.Add=Add},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var op_1=__webpack_require__(13);var ArgMax=function(_super){__extends(ArgMax,_super);function ArgMax(xTensor,yTensor){var _this=_super.call(this)||this;_this.xTensor=xTensor;_this.yTensor=yTensor;return _this}ArgMax.prototype.feedForward=function(math,inferenceArrays){var _this=this;var x=inferenceArrays.get(this.xTensor);math.scope(function(keep){inferenceArrays.set(_this.yTensor,keep(math.argMax(x)))})};ArgMax.prototype.backProp=function(math,inferenceArrays,gradientArrays){throw new Error("ArgMax backprop unimplemented")};return ArgMax}(op_1.Operation);exports.ArgMax=ArgMax},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var op_1=__webpack_require__(13);var ArgMaxEquals=function(_super){__extends(ArgMaxEquals,_super);function ArgMaxEquals(x1Tensor,x2Tensor,yTensor){var _this=_super.call(this)||this;_this.x1Tensor=x1Tensor;_this.x2Tensor=x2Tensor;_this.yTensor=yTensor;return _this}ArgMaxEquals.prototype.feedForward=function(math,inferenceArrays){var _this=this;var x1=inferenceArrays.get(this.x1Tensor);var x2=inferenceArrays.get(this.x2Tensor);math.scope(function(keep){inferenceArrays.set(_this.yTensor,keep(math.argMaxEquals(x1,x2)))})};ArgMaxEquals.prototype.backProp=function(math,inferenceArrays,gradientArrays){throw new Error("ArgMaxEquals backprop unimplemented")};return ArgMaxEquals}(op_1.Operation);exports.ArgMaxEquals=ArgMaxEquals},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var concat_util=__webpack_require__(63);var op_1=__webpack_require__(13);var Concat3D=function(_super){__extends(Concat3D,_super);function Concat3D(x1Tensor,x2Tensor,axis,yTensor){var _this=_super.call(this)||this;_this.x1Tensor=x1Tensor;_this.x2Tensor=x2Tensor;_this.axis=axis;_this.yTensor=yTensor;concat_util.assertParams(x1Tensor.shape,x2Tensor.shape,axis);return _this}Concat3D.prototype.feedForward=function(math,inferenceArrays){var _this=this;var x1=inferenceArrays.get(this.x1Tensor);var x2=inferenceArrays.get(this.x2Tensor);math.scope(function(keep){var concatResult=math.concat3D(x1,x2,_this.axis);inferenceArrays.set(_this.yTensor,keep(concatResult))})};Concat3D.prototype.backProp=function(math,inferenceArrays,gradientArrays){throw new Error("Concat3D backprop not implemented.")};return Concat3D}(op_1.Operation);exports.Concat3D=Concat3D},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var conv_util=__webpack_require__(64);var util=__webpack_require__(4);var op_1=__webpack_require__(13);var Convolution2D=function(_super){__extends(Convolution2D,_super);function Convolution2D(wTensor,xTensor,bTensor,yTensor,fieldSize,outputDepth,stride,zeroPad){if(stride===void 0){stride=1}var _this=_super.call(this)||this;_this.wTensor=wTensor;_this.xTensor=xTensor;_this.bTensor=bTensor;_this.yTensor=yTensor;_this.fieldSize=fieldSize;_this.outputDepth=outputDepth;_this.stride=stride;_this.assertWeightsShape(wTensor.shape);_this.zeroPad=zeroPad!=null?zeroPad:conv_util.computeDefaultPad(_this.xTensor.shape,_this.fieldSize,_this.stride);util.assert(util.isInt(_this.zeroPad),"The zero padding ("+_this.zeroPad+") must be an integer. Change the "+"stride and/or zero pad parameters");return _this}Convolution2D.prototype.feedForward=function(math,inferenceArrays){var _this=this;var weights=inferenceArrays.get(this.wTensor);var biases=inferenceArrays.get(this.bTensor);var x=inferenceArrays.get(this.xTensor);math.scope(function(keep){inferenceArrays.set(_this.yTensor,keep(math.conv2d(x,weights,biases,_this.stride,_this.zeroPad)))})};Convolution2D.prototype.backProp=function(math,inferenceArrays,gradientArrays){var _this=this;var filter=inferenceArrays.get(this.wTensor);var x=inferenceArrays.get(this.xTensor);var dy=gradientArrays.get(this.yTensor);math.scope(function(){var dw=math.conv2dDerFilter(x,dy,filter.shape,_this.stride,_this.zeroPad);var db=math.conv2dDerBias(dy);var dx=math.conv2dDerInput(x.shape,dy,filter,_this.stride,_this.zeroPad);gradientArrays.add(_this.wTensor,dw);gradientArrays.add(_this.bTensor,db);gradientArrays.add(_this.xTensor,dx)})};Convolution2D.prototype.assertWeightsShape=function(weightsShape){util.assert(weightsShape[0]===this.fieldSize&&weightsShape[1]===this.fieldSize&&weightsShape[2]===this.xTensor.shape[2]&&weightsShape[3]===this.outputDepth,"weights must be of shape ["+this.fieldSize+","+this.fieldSize+","+(this.xTensor.shape[2]+","+this.outputDepth+"] but they are of")+("shape ["+weightsShape+"]"))};return Convolution2D}(op_1.Operation);exports.Convolution2D=Convolution2D},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var util=__webpack_require__(4);var graph_util=__webpack_require__(19);var op_1=__webpack_require__(13);var Divide=function(_super){__extends(Divide,_super);function Divide(x1Tensor,x2Tensor,yTensor){var _this=_super.call(this)||this;_this.x1Tensor=x1Tensor;_this.x2Tensor=x2Tensor;_this.yTensor=yTensor;util.assert(util.sizeFromShape(x1Tensor.shape)===1||util.sizeFromShape(x2Tensor.shape)===1||util.arraysEqual(x1Tensor.shape,x2Tensor.shape),"One of t1 or t2 must be a scalar, or t1 and t2 must have "+"the same shape");return _this}Divide.prototype.feedForward=function(math,inferenceArrays){var _this=this;var t1=inferenceArrays.get(this.x1Tensor);var t2=inferenceArrays.get(this.x2Tensor);math.scope(function(keep){var result;if(util.isScalarShape(t1.shape)){result=math.scalarDividedByArray(t1,t2)}else if(util.isScalarShape(t2.shape)){result=math.arrayDividedByScalar(t1,t2)}else{result=math.divide(t1,t2)}inferenceArrays.set(_this.yTensor,keep(result))})};Divide.prototype.backProp=function(math,inferenceArrays,gradientArrays){var _this=this;var x1=inferenceArrays.get(this.x1Tensor);var x2=inferenceArrays.get(this.x2Tensor);var dy=gradientArrays.get(this.yTensor);var x1IsScalar=util.isScalarShape(x1.shape);var x2IsScalar=util.isScalarShape(x2.shape);math.scope(function(){if(graph_util.shouldBackProp(_this.x1Tensor)){if(x1IsScalar){var div=math.divide(dy,x2);gradientArrays.add(_this.x1Tensor,math.sum(div));div.dispose()}else if(x2IsScalar){gradientArrays.add(_this.x1Tensor,math.arrayDividedByScalar(dy,x2))}else{gradientArrays.add(_this.x1Tensor,math.divide(dy,x2))}}if(graph_util.shouldBackProp(_this.x2Tensor)){var x2Squared=math.elementWiseMul(x2,x2);var x1OverX2Squared=void 0;if(x2IsScalar){x1OverX2Squared=math.arrayDividedByScalar(x1,x2Squared)}else if(x1IsScalar){x1OverX2Squared=math.scalarDividedByArray(x1,x2Squared)}else{x1OverX2Squared=math.divide(x1,x2Squared)}var dx2=math.neg(x1OverX2Squared);var dyTimesDerivative=math.elementWiseMul(dy,dx2);if(x2IsScalar){gradientArrays.add(_this.x2Tensor,math.sum(dyTimesDerivative))}else{gradientArrays.add(_this.x2Tensor,dyTimesDerivative)}}})};return Divide}(op_1.Operation);exports.Divide=Divide},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var activation_functions_1=__webpack_require__(415);var op_1=__webpack_require__(13);var ElementWiseActivation=function(_super){__extends(ElementWiseActivation,_super);function ElementWiseActivation(xTensor,yTensor,func){var _this=_super.call(this)||this;_this.xTensor=xTensor;_this.yTensor=yTensor;_this.func=func;return _this}ElementWiseActivation.prototype.feedForward=function(math,inferenceArrays){var _this=this;var x=inferenceArrays.get(this.xTensor);math.scope(function(keep){inferenceArrays.set(_this.yTensor,keep(_this.func.output(math,x)))})};ElementWiseActivation.prototype.backProp=function(math,inferenceArrays,gradientArrays){var _this=this;var x=inferenceArrays.get(this.xTensor);var y=inferenceArrays.get(this.yTensor);var dy=gradientArrays.get(this.yTensor);math.scope(function(){var dydx=_this.func.der(math,x,y);gradientArrays.add(_this.xTensor,math.elementWiseMul(dy,dydx));dydx.dispose()})};ElementWiseActivation.prototype.dispose=function(){this.func.dispose()};return ElementWiseActivation}(op_1.Operation);exports.ElementWiseActivation=ElementWiseActivation;var ReLU=function(_super){__extends(ReLU,_super);function ReLU(xTensor,yTensor){return _super.call(this,xTensor,yTensor,new activation_functions_1.ReLUFunc)||this}return ReLU}(ElementWiseActivation);exports.ReLU=ReLU;var LeakyReLU=function(_super){__extends(LeakyReLU,_super);function LeakyReLU(xTensor,yTensor,alpha){return _super.call(this,xTensor,yTensor,new activation_functions_1.LeakyReluFunc(alpha))||this}return LeakyReLU}(ElementWiseActivation);exports.LeakyReLU=LeakyReLU;var TanH=function(_super){__extends(TanH,_super);function TanH(xTensor,yTensor){return _super.call(this,xTensor,yTensor,new activation_functions_1.TanHFunc)||this}return TanH}(ElementWiseActivation);exports.TanH=TanH;var Sigmoid=function(_super){__extends(Sigmoid,_super);function Sigmoid(xTensor,yTensor){return _super.call(this,xTensor,yTensor,new activation_functions_1.SigmoidFunc)||this}return Sigmoid}(ElementWiseActivation);exports.Sigmoid=Sigmoid;var Square=function(_super){__extends(Square,_super);function Square(xTensor,yTensor){return _super.call(this,xTensor,yTensor,new activation_functions_1.SquareFunc)||this}return Square}(ElementWiseActivation);exports.Square=Square;var Elu=function(_super){__extends(Elu,_super);function Elu(xTensor,yTensor){return _super.call(this,xTensor,yTensor,new activation_functions_1.EluFunc)||this}return Elu}(ElementWiseActivation);exports.Elu=Elu;var PReLU=function(_super){__extends(PReLU,_super);function PReLU(xTensor,alphaTensor,yTensor){var _this=_super.call(this)||this;_this.xTensor=xTensor;_this.alphaTensor=alphaTensor;_this.yTensor=yTensor;return _this}PReLU.prototype.feedForward=function(math,inferenceArrays){var _this=this;var x=inferenceArrays.get(this.xTensor);var alpha=inferenceArrays.get(this.alphaTensor);math.scope(function(keep){inferenceArrays.set(_this.yTensor,keep(math.prelu(x,alpha)))})};PReLU.prototype.backProp=function(math,inferenceArrays,gradientArrays){var _this=this;var x=inferenceArrays.get(this.xTensor);var alpha=inferenceArrays.get(this.alphaTensor);var dy=gradientArrays.get(this.yTensor);math.scope(function(){var dydx=math.preluDer(x,alpha);gradientArrays.add(_this.xTensor,math.elementWiseMul(dy,dydx))})};return PReLU}(op_1.Operation);exports.PReLU=PReLU},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ndarray_1=__webpack_require__(3);var TanHFunc=function(){function TanHFunc(){this.one=ndarray_1.Scalar.new(1)}TanHFunc.prototype.output=function(math,x){return math.tanh(x)};TanHFunc.prototype.der=function(math,x,y){var _this=this;return math.scope(function(){var ySquared=math.elementWiseMul(y,y);return math.scalarMinusArray(_this.one,ySquared)})};TanHFunc.prototype.dispose=function(){this.one.dispose()};return TanHFunc}();exports.TanHFunc=TanHFunc;var ReLUFunc=function(){function ReLUFunc(){}ReLUFunc.prototype.output=function(math,x){return math.relu(x)};ReLUFunc.prototype.der=function(math,x,y){return math.step(x)};ReLUFunc.prototype.dispose=function(){};return ReLUFunc}();exports.ReLUFunc=ReLUFunc;var LeakyReluFunc=function(){function LeakyReluFunc(alpha){this.alpha=alpha}LeakyReluFunc.prototype.output=function(math,x){return math.leakyRelu(x,this.alpha)};LeakyReluFunc.prototype.der=function(math,x,y){return math.step(x,this.alpha)};LeakyReluFunc.prototype.dispose=function(){};return LeakyReluFunc}();exports.LeakyReluFunc=LeakyReluFunc;var SigmoidFunc=function(){function SigmoidFunc(){}SigmoidFunc.prototype.output=function(math,x){return math.sigmoid(x)};SigmoidFunc.prototype.der=function(math,x,y){return math.scope(function(){var ySquared=math.elementWiseMul(y,y);return math.subStrict(y,ySquared)})};SigmoidFunc.prototype.dispose=function(){};return SigmoidFunc}();exports.SigmoidFunc=SigmoidFunc;var SquareFunc=function(){function SquareFunc(){this.two=ndarray_1.Scalar.new(2)}SquareFunc.prototype.output=function(math,x){return math.elementWiseMul(x,x)};SquareFunc.prototype.der=function(math,x,y){return math.scalarTimesArray(this.two,x)};SquareFunc.prototype.dispose=function(){this.two.dispose()};return SquareFunc}();exports.SquareFunc=SquareFunc;var EluFunc=function(){function EluFunc(){}EluFunc.prototype.output=function(math,x){return math.elu(x)};EluFunc.prototype.der=function(math,x,y){return math.eluDer(x)};EluFunc.prototype.dispose=function(){};return EluFunc}();exports.EluFunc=EluFunc},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var environment_1=__webpack_require__(11);var cost_functions_1=__webpack_require__(417);var ndarray_1=__webpack_require__(3);var util=__webpack_require__(4);var graph_util=__webpack_require__(19);var op_1=__webpack_require__(13);var ElementWiseCost=function(_super){__extends(ElementWiseCost,_super);function ElementWiseCost(x1Tensor,x2Tensor,yTensor,func){var _this=_super.call(this)||this;_this.x1Tensor=x1Tensor;_this.x2Tensor=x2Tensor;_this.yTensor=yTensor;_this.func=func;_this.oneOverNScalar=environment_1.ENV.math.keep(ndarray_1.Scalar.new(1/util.sizeFromShape(x1Tensor.shape)));return _this}ElementWiseCost.prototype.feedForward=function(math,inferenceArrays){var _this=this;var x1=inferenceArrays.get(this.x1Tensor);var x2=inferenceArrays.get(this.x2Tensor);math.scope(function(keep){var elementWiseCost=_this.func.cost(math,x1,x2);var sum=math.sum(elementWiseCost);var result=math.scalarTimesArray(_this.oneOverNScalar,sum);inferenceArrays.set(_this.yTensor,keep(result))})};ElementWiseCost.prototype.backProp=function(math,inferenceArrays,gradientArrays){var _this=this;var x1=inferenceArrays.get(this.x1Tensor);var x2=inferenceArrays.get(this.x2Tensor);math.scope(function(){if(graph_util.shouldBackProp(_this.x1Tensor)){gradientArrays.add(_this.x1Tensor,_this.func.der(math,x1,x2))}if(graph_util.shouldBackProp(_this.x2Tensor)){gradientArrays.add(_this.x2Tensor,_this.func.der(math,x2,x1))}})};ElementWiseCost.prototype.dispose=function(){this.func.dispose();this.oneOverNScalar.dispose()};return ElementWiseCost}(op_1.Operation);exports.ElementWiseCost=ElementWiseCost;var MeanSquaredCost=function(_super){__extends(MeanSquaredCost,_super);function MeanSquaredCost(x1Tensor,x2Tensor,yTensor){return _super.call(this,x1Tensor,x2Tensor,yTensor,new cost_functions_1.SquareCostFunc)||this}return MeanSquaredCost}(ElementWiseCost);exports.MeanSquaredCost=MeanSquaredCost},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var environment_1=__webpack_require__(11);var ndarray_1=__webpack_require__(3);var SquareCostFunc=function(){function SquareCostFunc(){this.halfOne=environment_1.ENV.math.keep(ndarray_1.Scalar.new(.5))}SquareCostFunc.prototype.cost=function(math,x1,x2){var diff=math.subStrict(x1,x2);var diffSquared=math.elementWiseMul(diff,diff);var result=math.scalarTimesArray(this.halfOne,diffSquared);diff.dispose();diffSquared.dispose();return result};SquareCostFunc.prototype.der=function(math,x1,x2){return math.subStrict(x1,x2)};SquareCostFunc.prototype.dispose=function(){this.halfOne.dispose()};return SquareCostFunc}();exports.SquareCostFunc=SquareCostFunc},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var graph_util=__webpack_require__(19);var op_1=__webpack_require__(13);var Exp=function(_super){__extends(Exp,_super);function Exp(xTensor,yTensor){var _this=_super.call(this)||this;_this.xTensor=xTensor;_this.yTensor=yTensor;return _this}Exp.prototype.feedForward=function(math,inferenceArrays){var _this=this;var x=inferenceArrays.get(this.xTensor);math.scope(function(keep){inferenceArrays.set(_this.yTensor,keep(math.exp(x)))})};Exp.prototype.backProp=function(math,inferenceArrays,gradientArrays){var _this=this;var y=inferenceArrays.get(this.yTensor);var dy=gradientArrays.get(this.yTensor);math.scope(function(){if(graph_util.shouldBackProp(_this.xTensor)){gradientArrays.add(_this.xTensor,math.elementWiseMul(y,dy))}})};return Exp}(op_1.Operation);exports.Exp=Exp},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var graph_util=__webpack_require__(19);var op_1=__webpack_require__(13);var LinearCombination=function(_super){__extends(LinearCombination,_super);function LinearCombination(x1Tensor,x2Tensor,c1Tensor,c2Tensor,outTensor){var _this=_super.call(this)||this;_this.x1Tensor=x1Tensor;_this.x2Tensor=x2Tensor;_this.c1Tensor=c1Tensor;_this.c2Tensor=c2Tensor;_this.outTensor=outTensor;return _this}LinearCombination.prototype.feedForward=function(math,inferenceArrays){var _this=this;var x1=inferenceArrays.get(this.x1Tensor);var x2=inferenceArrays.get(this.x2Tensor);var c1=inferenceArrays.get(this.c1Tensor).asScalar();var c2=inferenceArrays.get(this.c2Tensor).asScalar();math.scope(function(keep){inferenceArrays.set(_this.outTensor,keep(math.scaledArrayAdd(c1,x1,c2,x2)))})};LinearCombination.prototype.backProp=function(math,inferenceArrays,gradientArrays){var _this=this;var x1=inferenceArrays.get(this.x1Tensor);var x2=inferenceArrays.get(this.x2Tensor);var c1=inferenceArrays.get(this.c1Tensor);var c2=inferenceArrays.get(this.c2Tensor);var dy=gradientArrays.get(this.outTensor);math.scope(function(){if(graph_util.shouldBackProp(_this.x1Tensor)){gradientArrays.add(_this.x1Tensor,math.scalarTimesArray(c1,dy))}if(graph_util.shouldBackProp(_this.x2Tensor)){gradientArrays.add(_this.x2Tensor,math.scalarTimesArray(c2,dy))}if(graph_util.shouldBackProp(_this.c1Tensor)){var dotProduct1=math.elementWiseMul(x1,dy);gradientArrays.add(_this.c1Tensor,math.sum(dotProduct1))}if(graph_util.shouldBackProp(_this.c2Tensor)){var dotProduct2=math.elementWiseMul(x2,dy);gradientArrays.add(_this.c2Tensor,math.sum(dotProduct2))}})};return LinearCombination}(op_1.Operation);exports.LinearCombination=LinearCombination},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var graph_util=__webpack_require__(19);var op_1=__webpack_require__(13);var Log=function(_super){__extends(Log,_super);function Log(xTensor,yTensor){var _this=_super.call(this)||this;_this.xTensor=xTensor;_this.yTensor=yTensor;return _this}Log.prototype.feedForward=function(math,inferenceArrays){var _this=this;var x=inferenceArrays.get(this.xTensor);math.scope(function(keep){inferenceArrays.set(_this.yTensor,keep(math.log(x)))})};Log.prototype.backProp=function(math,inferenceArrays,gradientArrays){var _this=this;var x=inferenceArrays.get(this.xTensor);var dy=gradientArrays.get(this.yTensor);math.scope(function(){if(graph_util.shouldBackProp(_this.xTensor)){gradientArrays.add(_this.xTensor,math.divide(dy,x))}})};return Log}(op_1.Operation);exports.Log=Log},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var matmul_1=__webpack_require__(61);var graph_util=__webpack_require__(19);var op_1=__webpack_require__(13);var MatMul=function(_super){__extends(MatMul,_super);function MatMul(x1Tensor,x2Tensor,yTensor){var _this=_super.call(this)||this;_this.x1Tensor=x1Tensor;_this.x2Tensor=x2Tensor;_this.yTensor=yTensor;return _this}MatMul.prototype.feedForward=function(math,inferenceArrays){var _this=this;var x1=inferenceArrays.get(this.x1Tensor);var x2=inferenceArrays.get(this.x2Tensor);math.scope(function(keep){if(x1.shape.length===2&&x2.shape.length===2){inferenceArrays.set(_this.yTensor,keep(math.matMul(x1,x2)))}else if(x1.shape.length===2&&x2.shape.length===1){inferenceArrays.set(_this.yTensor,keep(math.matrixTimesVector(x1,x2)))}else if(x1.shape.length===1&&x2.shape.length===2){inferenceArrays.set(_this.yTensor,keep(math.vectorTimesMatrix(x1,x2)))}})};MatMul.prototype.backProp=function(math,inferenceArrays,gradientArrays){var _this=this;var x1=inferenceArrays.get(this.x1Tensor);var x2=inferenceArrays.get(this.x2Tensor);var dy=gradientArrays.get(this.yTensor);if(x1.shape.length===1){x1=x1.reshape([1,x1.size]);dy=dy.reshape([1,dy.size])}if(x2.shape.length===1){x2=x2.reshape([x2.size,1]);dy=dy.reshape([dy.size,1])}math.scope(function(){if(graph_util.shouldBackProp(_this.x1Tensor)){var dx1=math.matMul(dy,x2,matmul_1.MatrixOrientation.REGULAR,matmul_1.MatrixOrientation.TRANSPOSED);gradientArrays.add(_this.x1Tensor,_this.x1Tensor.shape.length===1?dx1.as1D():dx1)}if(graph_util.shouldBackProp(_this.x2Tensor)){var dx2=math.matMul(x1,dy,matmul_1.MatrixOrientation.TRANSPOSED,matmul_1.MatrixOrientation.REGULAR);gradientArrays.add(_this.x2Tensor,_this.x2Tensor.shape.length===1?dx2.as1D():dx2)}})};return MatMul}(op_1.Operation);exports.MatMul=MatMul},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var conv_util=__webpack_require__(64);var util=__webpack_require__(4);var op_1=__webpack_require__(13);var MaxPool=function(_super){__extends(MaxPool,_super);function MaxPool(xTensor,yTensor,fieldSize,stride,pad){if(stride===void 0){stride=1}var _this=_super.call(this)||this;_this.xTensor=xTensor;_this.yTensor=yTensor;_this.fieldSize=fieldSize;_this.stride=stride;if(pad!=null){_this.pad=pad}else{_this.pad=conv_util.computeDefaultPad(xTensor.shape,_this.fieldSize,_this.stride)}util.assert(util.isInt(_this.pad),"The zero padding ("+_this.pad+") must be an integer. Change the "+"stride and/or zero pad parameters");return _this}MaxPool.prototype.feedForward=function(math,inferenceArrays){var _this=this;var x=inferenceArrays.get(this.xTensor);math.scope(function(keep){inferenceArrays.set(_this.yTensor,keep(math.maxPool(x,_this.fieldSize,_this.stride,_this.pad)))})};MaxPool.prototype.backProp=function(math,inferenceArrays,gradientArrays){var _this=this;var x=inferenceArrays.get(this.xTensor);var dy=gradientArrays.get(this.yTensor);math.scope(function(){gradientArrays.add(_this.xTensor,math.maxPoolBackprop(dy,x,_this.fieldSize,_this.stride,_this.pad))})};return MaxPool}(op_1.Operation);exports.MaxPool=MaxPool},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var util=__webpack_require__(4);var graph_util=__webpack_require__(19);var op_1=__webpack_require__(13);var Multiply=function(_super){__extends(Multiply,_super);function Multiply(x1Tensor,x2Tensor,yTensor){var _this=_super.call(this)||this;_this.x1Tensor=x1Tensor;_this.x2Tensor=x2Tensor;_this.yTensor=yTensor;util.assert(util.sizeFromShape(x1Tensor.shape)===1||util.sizeFromShape(x2Tensor.shape)===1||util.arraysEqual(x1Tensor.shape,x2Tensor.shape),"One of t1 or t2 must be a scalar, or t1 and t2 must have "+"the same shape");return _this}Multiply.prototype.feedForward=function(math,inferenceArrays){var _this=this;var t1=inferenceArrays.get(this.x1Tensor);var t2=inferenceArrays.get(this.x2Tensor);math.scope(function(keep){var result;if(util.isScalarShape(t1.shape)){result=math.scalarTimesArray(t1,t2)}else if(util.isScalarShape(t2.shape)){result=math.scalarTimesArray(t2,t1)}else{result=math.elementWiseMul(t1,t2)}inferenceArrays.set(_this.yTensor,keep(result))})};Multiply.prototype.backProp=function(math,inferenceArrays,gradientArrays){var _this=this;var x1=inferenceArrays.get(this.x1Tensor);var x2=inferenceArrays.get(this.x2Tensor);var dy=gradientArrays.get(this.yTensor);math.scope(function(){if(graph_util.shouldBackProp(_this.x1Tensor)){if(util.isScalarShape(_this.x1Tensor.shape)){var mul=math.elementWiseMul(dy,x2);gradientArrays.add(_this.x1Tensor,math.sum(mul))}else if(util.isScalarShape(x2.shape)){gradientArrays.add(_this.x1Tensor,math.scalarTimesArray(x2,dy))}else{gradientArrays.add(_this.x1Tensor,math.elementWiseMul(x2,dy))}}if(graph_util.shouldBackProp(_this.x2Tensor)){if(util.isScalarShape(_this.x2Tensor.shape)){var mul=math.elementWiseMul(dy,x1);gradientArrays.add(_this.x2Tensor,math.sum(mul))}else if(util.isScalarShape(x1.shape)){gradientArrays.add(_this.x2Tensor,math.scalarTimesArray(x1,dy))}else{gradientArrays.add(_this.x2Tensor,math.elementWiseMul(x1,dy))}}})};return Multiply}(op_1.Operation);exports.Multiply=Multiply},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var environment_1=__webpack_require__(11);var ndarray_1=__webpack_require__(3);var util=__webpack_require__(4);var graph_util=__webpack_require__(19);var op_1=__webpack_require__(13);var ReduceSum=function(_super){__extends(ReduceSum,_super);function ReduceSum(x,outTensor){var _this=_super.call(this)||this;_this.x=x;_this.outTensor=outTensor;util.assertShapesMatch(outTensor.shape,[]);_this.ones=environment_1.ENV.math.keep(ndarray_1.NDArray.ones(x.shape));return _this}ReduceSum.prototype.feedForward=function(math,inferenceArrays){var _this=this;var x=inferenceArrays.get(this.x);math.scope(function(keep){inferenceArrays.set(_this.outTensor,keep(math.sum(x)))})};ReduceSum.prototype.backProp=function(math,inferenceArrays,gradientArrays){var _this=this;if(!graph_util.shouldBackProp(this.x)){return}math.scope(function(){var dy=gradientArrays.get(_this.outTensor);gradientArrays.add(_this.x,math.scalarTimesArray(dy,_this.ones))})};ReduceSum.prototype.dispose=function(){this.ones.dispose()};return ReduceSum}(op_1.Operation);exports.ReduceSum=ReduceSum},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var util=__webpack_require__(4);var op_1=__webpack_require__(13);var Reshape=function(_super){__extends(Reshape,_super);function Reshape(xTensor,yTensor){var _this=_super.call(this)||this;_this.xTensor=xTensor;_this.yTensor=yTensor;var xSize=util.sizeFromShape(xTensor.shape);var ySize=util.sizeFromShape(yTensor.shape);util.assert(xSize===ySize,"The input size ("+xSize+") and output size ("+ySize+") must match");return _this}Reshape.prototype.feedForward=function(math,inferenceArrays){var _this=this;var x=inferenceArrays.get(this.xTensor);var clone=math.clone(x);math.scope(function(keep){inferenceArrays.set(_this.yTensor,keep(clone.reshape(_this.yTensor.shape)))})};Reshape.prototype.backProp=function(math,inferenceArrays,gradientArrays){var _this=this;var dy=gradientArrays.get(this.yTensor);var clone=math.clone(dy);math.scope(function(){gradientArrays.add(_this.xTensor,clone.reshape(_this.xTensor.shape))})};return Reshape}(op_1.Operation);exports.Reshape=Reshape},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var environment_1=__webpack_require__(11);var ndarray_1=__webpack_require__(3);var util=__webpack_require__(4);var graph_1=__webpack_require__(68);var graph_util=__webpack_require__(19);var op_1=__webpack_require__(13);var Softmax=function(_super){__extends(Softmax,_super);function Softmax(logitsTensor,output){var _this=_super.call(this)||this;_this.logitsTensor=logitsTensor;_this.output=output;return _this}Softmax.prototype.feedForward=function(math,inferenceArrays){var _this=this;var logits=inferenceArrays.get(this.logitsTensor);return math.scope(function(keep){inferenceArrays.set(_this.output,keep(math.softmax(logits)))})};Softmax.prototype.backProp=function(math,inferenceArrays,gradientArrays){var _this=this;var y=inferenceArrays.get(this.output);var dy=gradientArrays.get(this.output);math.scope(function(){if(graph_util.shouldBackProp(_this.logitsTensor)){var dlogits=math.elementWiseMul(math.subtract(dy,math.sum(math.elementWiseMul(dy,y))),y);gradientArrays.add(_this.logitsTensor,dlogits)}})};return Softmax}(op_1.Operation);exports.Softmax=Softmax;var SoftmaxCrossEntropyCost=function(_super){__extends(SoftmaxCrossEntropyCost,_super);function SoftmaxCrossEntropyCost(logitsTensor,labelTensor,yTensor){var _this=_super.call(this)||this;_this.logitsTensor=logitsTensor;_this.labelTensor=labelTensor;_this.yTensor=yTensor;_this.softmaxTensor=new graph_1.Tensor(logitsTensor.shape);_this.epsilon=environment_1.ENV.math.keep(ndarray_1.Scalar.new(1e-5));return _this}SoftmaxCrossEntropyCost.prototype.feedForward=function(math,inferenceArrays){var _this=this;var logits=inferenceArrays.get(this.logitsTensor);var label=inferenceArrays.get(this.labelTensor);math.scope(function(keep){var softmaxResult=math.softmax(logits);inferenceArrays.set(_this.softmaxTensor,keep(softmaxResult));inferenceArrays.set(_this.yTensor,keep(crossEntropyCost(math,softmaxResult,label,_this.epsilon)))})};SoftmaxCrossEntropyCost.prototype.backProp=function(math,inferenceArrays,gradientArrays){var _this=this;var softmax=inferenceArrays.get(this.softmaxTensor);var label=inferenceArrays.get(this.labelTensor);math.scope(function(){gradientArrays.add(_this.logitsTensor,math.subtract(softmax,label))})};SoftmaxCrossEntropyCost.prototype.disposeTransientArrays=function(inferenceArrays,gradientArrays){inferenceArrays.disposeArray(this.softmaxTensor)};SoftmaxCrossEntropyCost.prototype.dispose=function(){this.epsilon.dispose()};return SoftmaxCrossEntropyCost}(op_1.Operation);exports.SoftmaxCrossEntropyCost=SoftmaxCrossEntropyCost;function crossEntropyCost(math,y,target,epsilon){util.assert(y.size===target.size,"The output and target must be the same size");return math.scope(function(){var yPlusEps=math.scalarPlusArray(epsilon,y);var logOutput=math.log(yPlusEps);var tarLogOutput=math.elementWiseMul(target,logOutput);var costVector=math.neg(tarLogOutput);return math.sum(costVector)})}exports.crossEntropyCost=crossEntropyCost},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var util=__webpack_require__(4);var graph_util=__webpack_require__(19);var op_1=__webpack_require__(13);var Subtract=function(_super){__extends(Subtract,_super);function Subtract(t1,t2,outTensor){var _this=_super.call(this)||this;_this.t1=t1;_this.t2=t2;_this.outTensor=outTensor;util.assert(util.sizeFromShape(t1.shape)===1||util.sizeFromShape(t2.shape)===1||util.arraysEqual(t1.shape,t2.shape),"One of t1 or t2 must be a scalar, or t1 and t2 must have "+"the same shape");return _this}Subtract.prototype.feedForward=function(math,inferenceArrays){var _this=this;var t1=inferenceArrays.get(this.t1);var t2=inferenceArrays.get(this.t2);math.scope(function(keep){var result;if(util.isScalarShape(t1.shape)){result=math.scalarMinusArray(t1,t2)}else if(util.isScalarShape(t2.shape)){result=math.arrayMinusScalar(t1,t2)}else{result=math.subtract(t1,t2)}inferenceArrays.set(_this.outTensor,keep(result))})};Subtract.prototype.backProp=function(math,inferenceArrays,gradientArrays){var _this=this;var dy=gradientArrays.get(this.outTensor);math.scope(function(){if(graph_util.shouldBackProp(_this.t1)){if(util.isScalarShape(_this.t1.shape)){var sum=math.sum(dy);gradientArrays.add(_this.t1,sum)}else{gradientArrays.add(_this.t1,math.clone(dy))}}if(graph_util.shouldBackProp(_this.t2)){if(util.isScalarShape(_this.t2.shape)){var sum=math.sum(dy);var negSum=math.neg(sum);gradientArrays.add(_this.t2,negSum)}else{gradientArrays.add(_this.t2,math.neg(dy))}}})};Subtract.prototype.dispose=function(){if(this.dySizeScalar!=null){this.dySizeScalar.dispose()}};return Subtract}(op_1.Operation);exports.Subtract=Subtract},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var ndarray_1=__webpack_require__(3);var optimizer_1=__webpack_require__(50);var tensor_array_map_1=__webpack_require__(36);var AdadeltaOptimizer=function(_super){__extends(AdadeltaOptimizer,_super);function AdadeltaOptimizer(learningRate,gamma,specifiedVariableList){var _this=_super.call(this,learningRate,specifiedVariableList)||this;_this.learningRate=learningRate;_this.gamma=gamma;_this.accumulatedSquaredGradients=new tensor_array_map_1.TensorArrayMap;_this.accumulatedUpdates=new tensor_array_map_1.TensorArrayMap;_this.eps=ndarray_1.Scalar.new(1e-6);_this.g=ndarray_1.Scalar.new(_this.gamma);return _this}AdadeltaOptimizer.prototype.applyGradients=function(variableGradients){throw new Error("Adadelta optimizer not yet implemented for eager mode.")};AdadeltaOptimizer.prototype.beforeBatch=function(math,batchSize,runtime,activationArrayMap,gradientArrayMap){var _this=this;_super.prototype.beforeBatch.call(this,math,batchSize,runtime,activationArrayMap,gradientArrayMap);if(this.accumulatedSquaredGradients.size()===0){this.variableNodes.forEach(function(node){_this.accumulatedSquaredGradients.set(node.output,ndarray_1.NDArray.zeros(node.output.shape));_this.accumulatedUpdates.set(node.output,ndarray_1.NDArray.zeros(node.output.shape))})}};AdadeltaOptimizer.prototype.afterBatch=function(math,batchSize,runtime,activationArrayMap,gradientArrayMap){var _this=this;math.scope(function(keep){_this.variableNodes.forEach(function(node){var oldVariable=activationArrayMap.get(node.output);var gradient=_this.variableGradients.get(node.output);var oldCache=_this.accumulatedSquaredGradients.get(node.output);var oldUpdates=_this.accumulatedUpdates.get(node.output);var gradientSquare=math.multiply(gradient,gradient);var cache=math.scaledArrayAdd(_this.g,oldCache,math.subtract(_this.one,_this.g),gradientSquare);var updates=math.multiply(math.divide(math.sqrt(math.add(oldUpdates,_this.eps)),math.sqrt(math.add(oldCache,_this.eps))),gradient);var variable=math.scaledArrayAdd(_this.cGraph,updates,_this.one,oldVariable);var updateSquare=math.multiply(updates,updates);var newUpdates=math.scaledArrayAdd(_this.g,oldUpdates,math.subtract(_this.one,_this.g),updateSquare);_this.accumulatedSquaredGradients.set(node.output,keep(cache));_this.accumulatedUpdates.set(node.output,keep(newUpdates));activationArrayMap.set(node.output,keep(variable));node.data=variable;oldVariable.dispose();oldCache.dispose();oldUpdates.dispose()})});this.variableGradients.dispose();this.variableGradients=new tensor_array_map_1.TensorArrayMap};AdadeltaOptimizer.prototype.dispose=function(){_super.prototype.dispose.call(this);this.eps.dispose();this.g.dispose();this.accumulatedSquaredGradients.dispose();this.accumulatedUpdates.dispose()};return AdadeltaOptimizer}(optimizer_1.Optimizer);exports.AdadeltaOptimizer=AdadeltaOptimizer},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var ndarray_1=__webpack_require__(3);var optimizer_1=__webpack_require__(50);var tensor_array_map_1=__webpack_require__(36);var AdagradOptimizer=function(_super){__extends(AdagradOptimizer,_super);function AdagradOptimizer(learningRate,specifiedVariableList){var _this=_super.call(this,learningRate,specifiedVariableList)||this;_this.learningRate=learningRate;_this.accumulatedSquaredGradients=new tensor_array_map_1.TensorArrayMap;_this.eps=ndarray_1.Scalar.new(1e-6);return _this}AdagradOptimizer.prototype.applyGradients=function(variableGradients){throw new Error("Adagrad optimizer not yet implemented for eager mode.")};AdagradOptimizer.prototype.beforeBatch=function(math,batchSize,runtime,activationArrayMap,gradientArrayMap){var _this=this;_super.prototype.beforeBatch.call(this,math,batchSize,runtime,activationArrayMap,gradientArrayMap);if(this.accumulatedSquaredGradients.size()===0){this.variableNodes.forEach(function(node){_this.accumulatedSquaredGradients.set(node.output,ndarray_1.NDArray.zeros(node.output.shape))})}};AdagradOptimizer.prototype.afterBatch=function(math,batchSize,runtime,activationArrayMap,gradientArrayMap){var _this=this;math.scope(function(keep){_this.variableNodes.forEach(function(node){var oldVariable=activationArrayMap.get(node.output);var gradient=_this.variableGradients.get(node.output);var oldCache=_this.accumulatedSquaredGradients.get(node.output);var gradientSquare=math.multiply(gradient,gradient);var cache=math.add(oldCache,gradientSquare);var variable=math.scaledArrayAdd(_this.cGraph,math.divide(gradient,math.add(math.sqrt(cache),_this.eps)),_this.one,oldVariable);_this.accumulatedSquaredGradients.set(node.output,keep(cache));activationArrayMap.set(node.output,keep(variable));node.data=variable;oldVariable.dispose();oldCache.dispose()})});this.variableGradients.dispose();this.variableGradients=new tensor_array_map_1.TensorArrayMap};AdagradOptimizer.prototype.dispose=function(){_super.prototype.dispose.call(this);this.eps.dispose();this.accumulatedSquaredGradients.dispose()};return AdagradOptimizer}(optimizer_1.Optimizer);exports.AdagradOptimizer=AdagradOptimizer},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var ndarray_1=__webpack_require__(3);var optimizer_1=__webpack_require__(50);var tensor_array_map_1=__webpack_require__(36);var AdamOptimizer=function(_super){__extends(AdamOptimizer,_super);function AdamOptimizer(learningRate,beta1,beta2,specifiedVariableList){var _this=_super.call(this,learningRate,specifiedVariableList)||this;_this.learningRate=learningRate;_this.beta1=beta1;_this.beta2=beta2;_this.firstMoment=new tensor_array_map_1.TensorArrayMap;_this.secondMoment=new tensor_array_map_1.TensorArrayMap;_this.eps=ndarray_1.Scalar.new(1e-8);_this.b1=ndarray_1.Scalar.new(_this.beta1);_this.b2=ndarray_1.Scalar.new(_this.beta2);_this.accB1=ndarray_1.Scalar.new(_this.beta1);_this.accB2=ndarray_1.Scalar.new(_this.beta2);return _this}AdamOptimizer.prototype.applyGradients=function(variableGradients){throw new Error("Adam optimizer not yet implemented for eager mode.")};AdamOptimizer.prototype.beforeBatch=function(math,batchSize,runtime,activationArrayMap,gradientArrayMap){var _this=this;_super.prototype.beforeBatch.call(this,math,batchSize,runtime,activationArrayMap,gradientArrayMap);if(this.firstMoment.size()===0){this.variableNodes.forEach(function(node){_this.firstMoment.set(node.output,ndarray_1.NDArray.zeros(node.output.shape))})}if(this.secondMoment.size()===0){this.variableNodes.forEach(function(node){_this.secondMoment.set(node.output,ndarray_1.NDArray.zeros(node.output.shape))})}};AdamOptimizer.prototype.afterBatch=function(math,batchSize,runtime,activationArrayMap,gradientArrayMap){var _this=this;math.scope(function(keep){_this.variableNodes.forEach(function(node){var oldVariable=activationArrayMap.get(node.output);var gradient=_this.variableGradients.get(node.output);var oldFirstMoment=_this.firstMoment.get(node.output);var oldSecondMoment=_this.secondMoment.get(node.output);var newFirstMoment=math.scaledArrayAdd(_this.b1,oldFirstMoment,math.subtract(_this.one,_this.b1),gradient);var gradientSquare=math.multiply(gradient,gradient);var newSecondMoment=math.scaledArrayAdd(_this.b2,oldSecondMoment,math.subtract(_this.one,_this.b2),gradientSquare);var biasCorrectedFirstMoment=math.divide(newFirstMoment,math.subtract(_this.one,_this.accB1));var biasCorrectedSecondMoment=math.divide(newSecondMoment,math.subtract(_this.one,_this.accB2));var variable=math.scaledArrayAdd(_this.cGraph,math.divide(biasCorrectedFirstMoment,math.add(math.sqrt(biasCorrectedSecondMoment),_this.eps)),_this.one,oldVariable);activationArrayMap.set(node.output,keep(variable));node.data=variable;_this.firstMoment.set(node.output,keep(newFirstMoment));_this.secondMoment.set(node.output,keep(newSecondMoment));oldVariable.dispose();gradient.dispose();oldFirstMoment.dispose();oldSecondMoment.dispose()});var oldAccB1=_this.accB1;var oldAccB2=_this.accB2;_this.accB1=keep(math.multiply(_this.accB1,_this.b1));_this.accB2=keep(math.multiply(_this.accB2,_this.b2));oldAccB1.dispose();oldAccB2.dispose()});this.variableGradients.dispose();this.variableGradients=new tensor_array_map_1.TensorArrayMap};AdamOptimizer.prototype.dispose=function(){_super.prototype.dispose.call(this);this.firstMoment.dispose();this.secondMoment.dispose();this.eps.dispose();this.b1.dispose();this.b2.dispose();this.accB1.dispose();this.accB2.dispose()};return AdamOptimizer}(optimizer_1.Optimizer);exports.AdamOptimizer=AdamOptimizer},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var ndarray_1=__webpack_require__(3);var optimizer_1=__webpack_require__(50);var tensor_array_map_1=__webpack_require__(36);var AdamaxOptimizer=function(_super){__extends(AdamaxOptimizer,_super);function AdamaxOptimizer(learningRate,beta1,beta2,specifiedVariableList){var _this=_super.call(this,learningRate,specifiedVariableList)||this;_this.learningRate=learningRate;_this.beta1=beta1;_this.beta2=beta2;_this.firstMoment=new tensor_array_map_1.TensorArrayMap;_this.weightedInfNorm=new tensor_array_map_1.TensorArrayMap;_this.eps=ndarray_1.Scalar.new(1e-8);_this.b1=ndarray_1.Scalar.new(_this.beta1);_this.b2=ndarray_1.Scalar.new(_this.beta2);_this.accB1=ndarray_1.Scalar.new(_this.beta1);return _this}AdamaxOptimizer.prototype.applyGradients=function(variableGradients){throw new Error("Adamax optimizer not yet implemented for eager mode.")};AdamaxOptimizer.prototype.beforeBatch=function(math,batchSize,runtime,activationArrayMap,gradientArrayMap){var _this=this;_super.prototype.beforeBatch.call(this,math,batchSize,runtime,activationArrayMap,gradientArrayMap);if(this.firstMoment.size()===0){this.variableNodes.forEach(function(node){_this.firstMoment.set(node.output,ndarray_1.NDArray.zeros(node.output.shape))})}if(this.weightedInfNorm.size()===0){this.variableNodes.forEach(function(node){_this.weightedInfNorm.set(node.output,ndarray_1.NDArray.zeros(node.output.shape))})}};AdamaxOptimizer.prototype.afterBatch=function(math,batchSize,runtime,activationArrayMap,gradientArrayMap){var _this=this;math.scope(function(keep){_this.variableNodes.forEach(function(node){var oldVariable=activationArrayMap.get(node.output);var gradient=_this.variableGradients.get(node.output);var oldFirstMoment=_this.firstMoment.get(node.output);var oldWeightedInfNorm=_this.weightedInfNorm.get(node.output);var newFirstMoment=math.scaledArrayAdd(_this.b1,oldFirstMoment,math.subtract(_this.one,_this.b1),gradient);var ut0=math.multiply(_this.b2,oldWeightedInfNorm);var ut1=math.abs(gradient);var newWeightedInfNorm=math.add(math.relu(math.subtract(ut0,ut1)),ut1);var variable=math.scaledArrayAdd(_this.one,oldVariable,math.divideStrict(_this.cGraph,math.subtract(_this.one,_this.accB1)),math.divide(newFirstMoment,math.add(_this.eps,newWeightedInfNorm)));activationArrayMap.set(node.output,keep(variable));node.data=variable;_this.firstMoment.set(node.output,keep(newFirstMoment));_this.weightedInfNorm.set(node.output,keep(newWeightedInfNorm));oldVariable.dispose();gradient.dispose();oldFirstMoment.dispose();oldWeightedInfNorm.dispose()});var oldAccB1=_this.accB1;_this.accB1=keep(math.multiply(_this.accB1,_this.b1));oldAccB1.dispose()});this.variableGradients.dispose();this.variableGradients=new tensor_array_map_1.TensorArrayMap};AdamaxOptimizer.prototype.dispose=function(){_super.prototype.dispose.call(this);this.firstMoment.dispose();this.weightedInfNorm.dispose();this.eps.dispose();this.accB1.dispose();this.b1.dispose();this.b2.dispose()};return AdamaxOptimizer}(optimizer_1.Optimizer);exports.AdamaxOptimizer=AdamaxOptimizer},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var ndarray_1=__webpack_require__(3);var sgd_optimizer_1=__webpack_require__(160);var tensor_array_map_1=__webpack_require__(36);var MomentumOptimizer=function(_super){__extends(MomentumOptimizer,_super);function MomentumOptimizer(learningRate,momentum,specifiedVariableList){var _this=_super.call(this,learningRate,specifiedVariableList)||this;_this.learningRate=learningRate;_this.momentum=momentum;_this.variableVelocities=new tensor_array_map_1.TensorArrayMap;_this.m=ndarray_1.Scalar.new(_this.momentum);return _this}MomentumOptimizer.prototype.applyGradients=function(variableGradients){throw new Error("Momentum optimizer not yet implemented for eager mode.")};MomentumOptimizer.prototype.beforeBatch=function(math,batchSize,runtime,activationArrayMap,gradientArrayMap){var _this=this;_super.prototype.beforeBatch.call(this,math,batchSize,runtime,activationArrayMap,gradientArrayMap);if(this.variableVelocities.size()===0){this.variableNodes.forEach(function(node){_this.variableVelocities.set(node.output,ndarray_1.NDArray.zeros(node.output.shape))})}};MomentumOptimizer.prototype.afterBatch=function(math,batchSize,runtime,activationArrayMap,gradientArrayMap){var _this=this;math.scope(function(keep){_this.variableNodes.forEach(function(node){var oldVariable=activationArrayMap.get(node.output);var gradient=_this.variableGradients.get(node.output);var oldVelocity=_this.variableVelocities.get(node.output);var velocity=math.scaledArrayAdd(_this.m,oldVelocity,_this.one,gradient);var variable=math.scaledArrayAdd(_this.cGraph,velocity,_this.one,oldVariable);_this.variableVelocities.set(node.output,keep(velocity));activationArrayMap.set(node.output,keep(variable));node.data=variable;oldVariable.dispose();oldVelocity.dispose()})});this.variableGradients.dispose();this.variableGradients=new tensor_array_map_1.TensorArrayMap};MomentumOptimizer.prototype.dispose=function(){_super.prototype.dispose.call(this);this.m.dispose();this.variableVelocities.dispose()};MomentumOptimizer.prototype.setMomentum=function(momentum){this.momentum=momentum};return MomentumOptimizer}(sgd_optimizer_1.SGDOptimizer);exports.MomentumOptimizer=MomentumOptimizer},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var ndarray_1=__webpack_require__(3);var optimizer_1=__webpack_require__(50);var tensor_array_map_1=__webpack_require__(36);var RMSPropOptimizer=function(_super){__extends(RMSPropOptimizer,_super);function RMSPropOptimizer(learningRate,gamma,specifiedVariableList){var _this=_super.call(this,learningRate,specifiedVariableList)||this;_this.learningRate=learningRate;_this.gamma=gamma;_this.accumulatedSquaredGradients=new tensor_array_map_1.TensorArrayMap;_this.eps=ndarray_1.Scalar.new(1e-6);_this.g=ndarray_1.Scalar.new(_this.gamma);return _this}RMSPropOptimizer.prototype.applyGradients=function(variableGradients){throw new Error("RMSProp optimizer not yet implemented for eager mode.")};RMSPropOptimizer.prototype.beforeBatch=function(math,batchSize,runtime,activationArrayMap,gradientArrayMap){var _this=this;_super.prototype.beforeBatch.call(this,math,batchSize,runtime,activationArrayMap,gradientArrayMap);if(this.accumulatedSquaredGradients.size()===0){this.variableNodes.forEach(function(node){_this.accumulatedSquaredGradients.set(node.output,ndarray_1.NDArray.zeros(node.output.shape))})}};RMSPropOptimizer.prototype.afterBatch=function(math,batchSize,runtime,activationArrayMap,gradientArrayMap){var _this=this;math.scope(function(keep){_this.variableNodes.forEach(function(node){var oldVariable=activationArrayMap.get(node.output);var gradient=_this.variableGradients.get(node.output);var oldCache=_this.accumulatedSquaredGradients.get(node.output);var gradientSquare=math.multiply(gradient,gradient);var cache=math.scaledArrayAdd(_this.g,oldCache,math.subtract(_this.one,_this.g),gradientSquare);var variable=math.scaledArrayAdd(_this.cGraph,math.divide(gradient,math.add(math.sqrt(cache),_this.eps)),_this.one,oldVariable);_this.accumulatedSquaredGradients.set(node.output,keep(cache));activationArrayMap.set(node.output,keep(variable));node.data=variable;oldVariable.dispose();oldCache.dispose()})});this.variableGradients.dispose();this.variableGradients=new tensor_array_map_1.TensorArrayMap};RMSPropOptimizer.prototype.dispose=function(){_super.prototype.dispose.call(this);this.eps.dispose();this.g.dispose();this.accumulatedSquaredGradients.dispose()};return RMSPropOptimizer}(optimizer_1.Optimizer);exports.RMSPropOptimizer=RMSPropOptimizer},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _deeplearn=__webpack_require__(27);var _deeplearnSqueezenet=__webpack_require__(161);var _mobileNet=__webpack_require__(438);function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}}return step("next")})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ImageNet=function(){function ImageNet(model){_classCallCheck(this,ImageNet);this.model=model;this.ready=false;this.math=_deeplearn.ENV.math;if(this.model==="SqueezeNet"){this.net=new _deeplearnSqueezenet.SqueezeNet(this.math)}else if(this.model==="MobileNet"){this.net=new _mobileNet.MobileNet(this.math)}}_createClass(ImageNet,[{key:"predict",value:function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(img,num,callback){var _this=this;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(this.ready){this.getClasses(img,num,callback)}else{ImageNet.loadModel(this.net).then(function(){_this.ready=true;_this.getClasses(img,num,callback)})}case 1:case"end":return _context.stop()}}},_callee,this)}));function predict(_x,_x2,_x3){return _ref.apply(this,arguments)}return predict}()},{key:"getClasses",value:function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(img,num,callback){var image,results,result,topKClasses;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:image=_deeplearn.Array3D.fromPixels(img);results=[];result=this.net.predict(image);_context2.next=5;return this.net.getTopKClasses(result,num||10);case 5:topKClasses=_context2.sent;Object.keys(topKClasses).forEach(function(value){results.push({label:value,probability:topKClasses[value]})});results.sort(function(a,b){return b.probability-a.probability});callback(results);case 9:case"end":return _context2.stop()}}},_callee2,this)}));function getClasses(_x4,_x5,_x6){return _ref2.apply(this,arguments)}return getClasses}()}],[{key:"loadModel",value:function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(model){return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return model.load();case 2:return _context3.abrupt("return",true);case 3:case"end":return _context3.stop()}}},_callee3,this)}));function loadModel(_x7){return _ref3.apply(this,arguments)}return loadModel}()}]);return ImageNet}();exports.default=ImageNet},function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=y[op[0]&2?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[0,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var deeplearn_1=__webpack_require__(27);var model_util=__webpack_require__(436);var imagenet_classes_1=__webpack_require__(437);var GOOGLE_CLOUD_STORAGE_DIR="https://storage.googleapis.com/learnjs-data/checkpoint_zoo/";var SqueezeNet=function(){function SqueezeNet(math){this.math=math;this.preprocessOffset=deeplearn_1.Array1D.new([103.939,116.779,123.68])}SqueezeNet.prototype.load=function(){return __awaiter(this,void 0,void 0,function(){var checkpointLoader,_a;return __generator(this,function(_b){switch(_b.label){case 0:checkpointLoader=new deeplearn_1.CheckpointLoader(GOOGLE_CLOUD_STORAGE_DIR+"squeezenet1_1/");_a=this;return[4,checkpointLoader.getAllVariables()];case 1:_a.variables=_b.sent();return[2]}})})};SqueezeNet.prototype.predict=function(input){return this.predictWithActivation(input).logits};SqueezeNet.prototype.predictWithActivation=function(input,activationName){var _this=this;var _a=this.math.scope(function(){var activation;var preprocessedInput=_this.math.subtract(input.asType("float32"),_this.preprocessOffset);var conv1=_this.math.conv2d(preprocessedInput,_this.variables["conv1_W:0"],_this.variables["conv1_b:0"],2,0);var conv1relu=_this.math.relu(conv1);if(activationName==="conv_1"){activation=conv1relu}var pool1=_this.math.maxPool(conv1relu,3,2,0);if(activationName==="maxpool_1"){activation=pool1}var fire2=_this.fireModule(pool1,2);if(activationName==="fire2"){activation=fire2}var fire3=_this.fireModule(fire2,3);if(activationName==="fire3"){activation=fire3}var pool2=_this.math.maxPool(fire3,3,2,"valid");if(activationName==="maxpool_2"){activation=pool2}var fire4=_this.fireModule(pool2,4);if(activationName==="fire4"){activation=fire4}var fire5=_this.fireModule(fire4,5);if(activationName==="fire5"){activation=fire5}var pool3=_this.math.maxPool(fire5,3,2,0);if(activationName==="maxpool_3"){activation=pool3}var fire6=_this.fireModule(pool3,6);if(activationName==="fire6"){activation=fire6}var fire7=_this.fireModule(fire6,7);if(activationName==="fire7"){activation=fire7}var fire8=_this.fireModule(fire7,8);if(activationName==="fire8"){activation=fire8}var fire9=_this.fireModule(fire8,9);if(activationName==="fire9"){activation=fire9}var conv10=_this.math.conv2d(fire9,_this.variables["conv10_W:0"],_this.variables["conv10_b:0"],1,0);if(activationName==="conv10"){activation=conv10}return[_this.math.avgPool(conv10,conv10.shape[0],1,0).as1D(),activation]}),logits=_a[0],activation=_a[1];return{activation:activation,logits:logits}};SqueezeNet.prototype.fireModule=function(input,fireId){var y1=this.math.conv2d(input,this.variables["fire"+fireId+"/squeeze1x1_W:0"],this.variables["fire"+fireId+"/squeeze1x1_b:0"],1,0);var y2=this.math.relu(y1);var left1=this.math.conv2d(y2,this.variables["fire"+fireId+"/expand1x1_W:0"],this.variables["fire"+fireId+"/expand1x1_b:0"],1,0);var left2=this.math.relu(left1);var right1=this.math.conv2d(y2,this.variables["fire"+fireId+"/expand3x3_W:0"],this.variables["fire"+fireId+"/expand3x3_b:0"],1,1);var right2=this.math.relu(right1);return this.math.concat3D(left2,right2,2)};SqueezeNet.prototype.getTopKClasses=function(logits,topK){return __awaiter(this,void 0,void 0,function(){var _this=this;var predictions,topk,_a,_b,topkIndices,topkValues,topClassesToProbability,i;return __generator(this,function(_c){switch(_c.label){case 0:predictions=this.math.scope(function(){return _this.math.softmax(logits).asType("float32")});_b=(_a=model_util).topK;return[4,predictions.data()];case 1:topk=_b.apply(_a,[_c.sent(),topK]);predictions.dispose();topkIndices=topk.indices;topkValues=topk.values;topClassesToProbability={};for(i=0;i<topkIndices.length;i++){topClassesToProbability[imagenet_classes_1.IMAGENET_CLASSES[topkIndices[i]]]=topkValues[i]}return[2,topClassesToProbability]}})})};SqueezeNet.prototype.dispose=function(){this.preprocessOffset.dispose();for(var varName in this.variables){this.variables[varName].dispose()}};return SqueezeNet}();exports.SqueezeNet=SqueezeNet},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function topK(values,k){var valuesAndIndices=[];for(var i=0;i<values.length;i++){valuesAndIndices.push({value:values[i],index:i})}valuesAndIndices.sort(function(a,b){return b.value-a.value});var topkValues=new Float32Array(k);var topkIndices=new Int32Array(k);for(var i=0;i<k;i++){topkValues[i]=valuesAndIndices[i].value;topkIndices[i]=valuesAndIndices[i].index}return{values:topkValues,indices:topkIndices}}exports.topK=topK},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.IMAGENET_CLASSES={0:"tench, Tinca tinca",1:"goldfish, Carassius auratus",2:"great white shark, white shark, man-eater, man-eating shark, "+"Carcharodon carcharias",3:"tiger shark, Galeocerdo cuvieri",4:"hammerhead, hammerhead shark",5:"electric ray, crampfish, numbfish, torpedo",6:"stingray",7:"cock",8:"hen",9:"ostrich, Struthio camelus",10:"brambling, Fringilla montifringilla",11:"goldfinch, Carduelis carduelis",12:"house finch, linnet, Carpodacus mexicanus",13:"junco, snowbird",14:"indigo bunting, indigo finch, indigo bird, Passerina cyanea",15:"robin, American robin, Turdus migratorius",16:"bulbul",17:"jay",18:"magpie",19:"chickadee",20:"water ouzel, dipper",21:"kite",22:"bald eagle, American eagle, Haliaeetus leucocephalus",23:"vulture",24:"great grey owl, great gray owl, Strix nebulosa",25:"European fire salamander, Salamandra salamandra",26:"common newt, Triturus vulgaris",27:"eft",28:"spotted salamander, Ambystoma maculatum",29:"axolotl, mud puppy, Ambystoma mexicanum",30:"bullfrog, Rana catesbeiana",31:"tree frog, tree-frog",32:"tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui",33:"loggerhead, loggerhead turtle, Caretta caretta",34:"leatherback turtle, leatherback, leathery turtle, Dermochelys coriacea",35:"mud turtle",36:"terrapin",37:"box turtle, box tortoise",38:"banded gecko",39:"common iguana, iguana, Iguana iguana",40:"American chameleon, anole, Anolis carolinensis",41:"whiptail, whiptail lizard",42:"agama",43:"frilled lizard, Chlamydosaurus kingi",44:"alligator lizard",45:"Gila monster, Heloderma suspectum",46:"green lizard, Lacerta viridis",47:"African chameleon, Chamaeleo chamaeleon",48:"Komodo dragon, Komodo lizard, dragon lizard, giant lizard, "+"Varanus komodoensis",49:"African crocodile, Nile crocodile, Crocodylus niloticus",50:"American alligator, Alligator mississipiensis",51:"triceratops",52:"thunder snake, worm snake, Carphophis amoenus",53:"ringneck snake, ring-necked snake, ring snake",54:"hognose snake, puff adder, sand viper",55:"green snake, grass snake",56:"king snake, kingsnake",57:"garter snake, grass snake",58:"water snake",59:"vine snake",60:"night snake, Hypsiglena torquata",61:"boa constrictor, Constrictor constrictor",62:"rock python, rock snake, Python sebae",63:"Indian cobra, Naja naja",64:"green mamba",65:"sea snake",66:"horned viper, cerastes, sand viper, horned asp, Cerastes cornutus",67:"diamondback, diamondback rattlesnake, Crotalus adamanteus",68:"sidewinder, horned rattlesnake, Crotalus cerastes",69:"trilobite",70:"harvestman, daddy longlegs, Phalangium opilio",71:"scorpion",72:"black and gold garden spider, Argiope aurantia",73:"barn spider, Araneus cavaticus",74:"garden spider, Aranea diademata",75:"black widow, Latrodectus mactans",76:"tarantula",77:"wolf spider, hunting spider",78:"tick",79:"centipede",80:"black grouse",81:"ptarmigan",82:"ruffed grouse, partridge, Bonasa umbellus",83:"prairie chicken, prairie grouse, prairie fowl",84:"peacock",85:"quail",86:"partridge",87:"African grey, African gray, Psittacus erithacus",88:"macaw",89:"sulphur-crested cockatoo, Kakatoe galerita, Cacatua galerita",90:"lorikeet",91:"coucal",92:"bee eater",93:"hornbill",94:"hummingbird",95:"jacamar",96:"toucan",97:"drake",98:"red-breasted merganser, Mergus serrator",99:"goose",100:"black swan, Cygnus atratus",101:"tusker",102:"echidna, spiny anteater, anteater",103:"platypus, duckbill, duckbilled platypus, duck-billed platypus, "+"Ornithorhynchus anatinus",104:"wallaby, brush kangaroo",105:"koala, koala bear, kangaroo bear, native bear, Phascolarctos cinereus",106:"wombat",107:"jelly fish",108:"sea anemone, anemone",109:"brain coral",110:"flatworm, platyhelminth",111:"nematode, nematode worm, roundworm",112:"conch",113:"snail",114:"slug",115:"sea slug, nudibranch",116:"chiton, coat-of-mail shell, sea cradle, polyplacophore",117:"chambered nautilus, pearly nautilus, nautilus",118:"Dungeness crab, Cancer magister",119:"rock crab, Cancer irroratus",120:"fiddler crab",121:"king crab, Alaska crab, Alaskan king crab, Alaska king crab, "+"Paralithodes camtschatica",122:"American lobster, Northern lobster, Maine lobster, Homarus americanus",123:"spiny lobster, langouste, rock lobster, crawfish, crayfish, sea "+"crawfish",124:"crayfish, crawfish, crawdad, crawdaddy",125:"hermit crab",126:"isopod",127:"white stork, Ciconia ciconia",128:"black stork, Ciconia nigra",129:"spoonbill",130:"flamingo",131:"little blue heron, Egretta caerulea",132:"American egret, great white heron, Egretta albus",133:"bittern",134:"crane",135:"limpkin, Aramus pictus",136:"European gallinule, Porphyrio porphyrio",137:"American coot, marsh hen, mud hen, water hen, Fulica americana",138:"bustard",139:"ruddy turnstone, Arenaria interpres",140:"red-backed sandpiper, dunlin, Erolia alpina",141:"redshank, Tringa totanus",142:"dowitcher",143:"oystercatcher, oyster catcher",144:"pelican",145:"king penguin, Aptenodytes patagonica",146:"albatross, mollymawk",147:"grey whale, gray whale, devilfish, Eschrichtius gibbosus, "+"Eschrichtius robustus",148:"killer whale, killer, orca, grampus, sea wolf, Orcinus orca",149:"dugong, Dugong dugon",150:"sea lion",151:"Chihuahua",152:"Japanese spaniel",153:"Maltese dog, Maltese terrier, Maltese",154:"Pekinese, Pekingese, Peke",155:"Shih-Tzu",156:"Blenheim spaniel",157:"papillon",158:"toy terrier",159:"Rhodesian ridgeback",160:"Afghan hound, Afghan",161:"basset, basset hound",162:"beagle",163:"bloodhound, sleuthhound",164:"bluetick",165:"black-and-tan coonhound",166:"Walker hound, Walker foxhound",167:"English foxhound",168:"redbone",169:"borzoi, Russian wolfhound",170:"Irish wolfhound",171:"Italian greyhound",172:"whippet",173:"Ibizan hound, Ibizan Podenco",174:"Norwegian elkhound, elkhound",175:"otterhound, otter hound",176:"Saluki, gazelle hound",177:"Scottish deerhound, deerhound",178:"Weimaraner",179:"Staffordshire bullterrier, Staffordshire bull terrier",180:"American Staffordshire terrier, Staffordshire terrier, American pit "+"bull terrier, pit bull terrier",181:"Bedlington terrier",182:"Border terrier",183:"Kerry blue terrier",184:"Irish terrier",185:"Norfolk terrier",186:"Norwich terrier",187:"Yorkshire terrier",188:"wire-haired fox terrier",189:"Lakeland terrier",190:"Sealyham terrier, Sealyham",191:"Airedale, Airedale terrier",192:"cairn, cairn terrier",193:"Australian terrier",194:"Dandie Dinmont, Dandie Dinmont terrier",195:"Boston bull, Boston terrier",196:"miniature schnauzer",197:"giant schnauzer",198:"standard schnauzer",199:"Scotch terrier, Scottish terrier, Scottie",200:"Tibetan terrier, chrysanthemum dog",201:"silky terrier, Sydney silky",202:"soft-coated wheaten terrier",203:"West Highland white terrier",204:"Lhasa, Lhasa apso",205:"flat-coated retriever",206:"curly-coated retriever",207:"golden retriever",208:"Labrador retriever",209:"Chesapeake Bay retriever",210:"German short-haired pointer",211:"vizsla, Hungarian pointer",212:"English setter",213:"Irish setter, red setter",214:"Gordon setter",215:"Brittany spaniel",216:"clumber, clumber spaniel",217:"English springer, English springer spaniel",218:"Welsh springer spaniel",219:"cocker spaniel, English cocker spaniel, cocker",220:"Sussex spaniel",221:"Irish water spaniel",222:"kuvasz",223:"schipperke",224:"groenendael",225:"malinois",226:"briard",227:"kelpie",228:"komondor",229:"Old English sheepdog, bobtail",230:"Shetland sheepdog, Shetland sheep dog, Shetland",231:"collie",232:"Border collie",233:"Bouvier des Flandres, Bouviers des Flandres",234:"Rottweiler",235:"German shepherd, German shepherd dog, German police dog, alsatian",236:"Doberman, Doberman pinscher",237:"miniature pinscher",238:"Greater Swiss Mountain dog",239:"Bernese mountain dog",240:"Appenzeller",241:"EntleBucher",242:"boxer",243:"bull mastiff",244:"Tibetan mastiff",245:"French bulldog",246:"Great Dane",247:"Saint Bernard, St Bernard",248:"Eskimo dog, husky",249:"malamute, malemute, Alaskan malamute",250:"Siberian husky",251:"dalmatian, coach dog, carriage dog",252:"affenpinscher, monkey pinscher, monkey dog",253:"basenji",254:"pug, pug-dog",255:"Leonberg",256:"Newfoundland, Newfoundland dog",257:"Great Pyrenees",258:"Samoyed, Samoyede",259:"Pomeranian",260:"chow, chow chow",261:"keeshond",262:"Brabancon griffon",263:"Pembroke, Pembroke Welsh corgi",264:"Cardigan, Cardigan Welsh corgi",265:"toy poodle",266:"miniature poodle",267:"standard poodle",268:"Mexican hairless",269:"timber wolf, grey wolf, gray wolf, Canis lupus",270:"white wolf, Arctic wolf, Canis lupus tundrarum",271:"red wolf, maned wolf, Canis rufus, Canis niger",272:"coyote, prairie wolf, brush wolf, Canis latrans",273:"dingo, warrigal, warragal, Canis dingo",274:"dhole, Cuon alpinus",275:"African hunting dog, hyena dog, Cape hunting dog, Lycaon pictus",276:"hyena, hyaena",277:"red fox, Vulpes vulpes",278:"kit fox, Vulpes macrotis",279:"Arctic fox, white fox, Alopex lagopus",280:"grey fox, gray fox, Urocyon cinereoargenteus",281:"tabby, tabby cat",282:"tiger cat",283:"Persian cat",284:"Siamese cat, Siamese",285:"Egyptian cat",286:"cougar, puma, catamount, mountain lion, painter, panther, "+"Felis concolor",287:"lynx, catamount",288:"leopard, Panthera pardus",289:"snow leopard, ounce, Panthera uncia",290:"jaguar, panther, Panthera onca, Felis onca",291:"lion, king of beasts, Panthera leo",292:"tiger, Panthera tigris",293:"cheetah, chetah, Acinonyx jubatus",294:"brown bear, bruin, Ursus arctos",295:"American black bear, black bear, Ursus americanus, Euarctos "+"americanus",296:"ice bear, polar bear, Ursus Maritimus, Thalarctos maritimus",297:"sloth bear, Melursus ursinus, Ursus ursinus",298:"mongoose",299:"meerkat, mierkat",300:"tiger beetle",301:"ladybug, ladybeetle, lady beetle, ladybird, ladybird beetle",302:"ground beetle, carabid beetle",303:"long-horned beetle, longicorn, longicorn beetle",304:"leaf beetle, chrysomelid",305:"dung beetle",306:"rhinoceros beetle",307:"weevil",308:"fly",309:"bee",310:"ant, emmet, pismire",311:"grasshopper, hopper",312:"cricket",313:"walking stick, walkingstick, stick insect",314:"cockroach, roach",315:"mantis, mantid",316:"cicada, cicala",317:"leafhopper",318:"lacewing, lacewing fly",319:"dragonfly, darning needle, devil's darning needle, sewing needle, "+"snake feeder, snake doctor, mosquito hawk, skeeter hawk",320:"damselfly",321:"admiral",322:"ringlet, ringlet butterfly",323:"monarch, monarch butterfly, milkweed butterfly, Danaus plexippus",324:"cabbage butterfly",325:"sulphur butterfly, sulfur butterfly",326:"lycaenid, lycaenid butterfly",327:"starfish, sea star",328:"sea urchin",329:"sea cucumber, holothurian",330:"wood rabbit, cottontail, cottontail rabbit",331:"hare",332:"Angora, Angora rabbit",333:"hamster",334:"porcupine, hedgehog",335:"fox squirrel, eastern fox squirrel, Sciurus niger",336:"marmot",337:"beaver",338:"guinea pig, Cavia cobaya",339:"sorrel",340:"zebra",341:"hog, pig, grunter, squealer, Sus scrofa",342:"wild boar, boar, Sus scrofa",343:"warthog",344:"hippopotamus, hippo, river horse, Hippopotamus amphibius",345:"ox",346:"water buffalo, water ox, Asiatic buffalo, Bubalus bubalis",347:"bison",348:"ram, tup",349:"bighorn, bighorn sheep, cimarron, Rocky Mountain bighorn, Rocky "+"Mountain sheep, Ovis canadensis",350:"ibex, Capra ibex",351:"hartebeest",352:"impala, Aepyceros melampus",353:"gazelle",354:"Arabian camel, dromedary, Camelus dromedarius",355:"llama",356:"weasel",357:"mink",358:"polecat, fitch, foulmart, foumart, Mustela putorius",359:"black-footed ferret, ferret, Mustela nigripes",360:"otter",361:"skunk, polecat, wood pussy",362:"badger",363:"armadillo",364:"three-toed sloth, ai, Bradypus tridactylus",365:"orangutan, orang, orangutang, Pongo pygmaeus",366:"gorilla, Gorilla gorilla",367:"chimpanzee, chimp, Pan troglodytes",368:"gibbon, Hylobates lar",369:"siamang, Hylobates syndactylus, Symphalangus syndactylus",370:"guenon, guenon monkey",371:"patas, hussar monkey, Erythrocebus patas",372:"baboon",373:"macaque",374:"langur",375:"colobus, colobus monkey",376:"proboscis monkey, Nasalis larvatus",377:"marmoset",378:"capuchin, ringtail, Cebus capucinus",379:"howler monkey, howler",380:"titi, titi monkey",381:"spider monkey, Ateles geoffroyi",382:"squirrel monkey, Saimiri sciureus",383:"Madagascar cat, ring-tailed lemur, Lemur catta",384:"indri, indris, Indri indri, Indri brevicaudatus",385:"Indian elephant, Elephas maximus",386:"African elephant, Loxodonta africana",387:"lesser panda, red panda, panda, bear cat, cat bear, Ailurus fulgens",388:"giant panda, panda, panda bear, coon bear, Ailuropoda melanoleuca",389:"barracouta, snoek",390:"eel",391:"coho, cohoe, coho salmon, blue jack, silver salmon, Oncorhynchus "+"kisutch",392:"rock beauty, Holocanthus tricolor",393:"anemone fish",394:"sturgeon",395:"gar, garfish, garpike, billfish, Lepisosteus osseus",396:"lionfish",397:"puffer, pufferfish, blowfish, globefish",398:"abacus",399:"abaya",400:"academic gown, academic robe, judge's robe",401:"accordion, piano accordion, squeeze box",402:"acoustic guitar",403:"aircraft carrier, carrier, flattop, attack aircraft carrier",404:"airliner",405:"airship, dirigible",406:"altar",407:"ambulance",408:"amphibian, amphibious vehicle",409:"analog clock",410:"apiary, bee house",411:"apron",412:"ashcan, trash can, garbage can, wastebin, ash bin, ash-bin, ashbin, "+"dustbin, trash barrel, trash bin",413:"assault rifle, assault gun",414:"backpack, back pack, knapsack, packsack, rucksack, haversack",415:"bakery, bakeshop, bakehouse",416:"balance beam, beam",417:"balloon",418:"ballpoint, ballpoint pen, ballpen, Biro",419:"Band Aid",420:"banjo",421:"bannister, banister, balustrade, balusters, handrail",422:"barbell",423:"barber chair",424:"barbershop",425:"barn",426:"barometer",427:"barrel, cask",428:"barrow, garden cart, lawn cart, wheelbarrow",429:"baseball",430:"basketball",431:"bassinet",432:"bassoon",433:"bathing cap, swimming cap",434:"bath towel",435:"bathtub, bathing tub, bath, tub",436:"beach wagon, station wagon, wagon, estate car, beach waggon, station "+"waggon, waggon",437:"beacon, lighthouse, beacon light, pharos",438:"beaker",439:"bearskin, busby, shako",440:"beer bottle",441:"beer glass",442:"bell cote, bell cot",443:"bib",444:"bicycle-built-for-two, tandem bicycle, tandem",445:"bikini, two-piece",446:"binder, ring-binder",447:"binoculars, field glasses, opera glasses",448:"birdhouse",449:"boathouse",450:"bobsled, bobsleigh, bob",451:"bolo tie, bolo, bola tie, bola",452:"bonnet, poke bonnet",453:"bookcase",454:"bookshop, bookstore, bookstall",455:"bottlecap",456:"bow",457:"bow tie, bow-tie, bowtie",458:"brass, memorial tablet, plaque",459:"brassiere, bra, bandeau",460:"breakwater, groin, groyne, mole, bulwark, seawall, jetty",461:"breastplate, aegis, egis",462:"broom",463:"bucket, pail",464:"buckle",465:"bulletproof vest",466:"bullet train, bullet",467:"butcher shop, meat market",468:"cab, hack, taxi, taxicab",469:"caldron, cauldron",470:"candle, taper, wax light",471:"cannon",472:"canoe",473:"can opener, tin opener",474:"cardigan",475:"car mirror",476:"carousel, carrousel, merry-go-round, roundabout, whirligig",477:"carpenter's kit, tool kit",478:"carton",479:"car wheel",480:"cash machine, cash dispenser, automated teller machine, automatic "+"teller machine, automated teller, automatic teller, ATM",481:"cassette",482:"cassette player",483:"castle",484:"catamaran",485:"CD player",486:"cello, violoncello",487:"cellular telephone, cellular phone, cellphone, cell, mobile phone",488:"chain",489:"chainlink fence",490:"chain mail, ring mail, mail, chain armor, chain armour, ring armor, "+"ring armour",491:"chain saw, chainsaw",492:"chest",493:"chiffonier, commode",494:"chime, bell, gong",495:"china cabinet, china closet",496:"Christmas stocking",497:"church, church building",498:"cinema, movie theater, movie theatre, movie house, picture palace",499:"cleaver, meat cleaver, chopper",500:"cliff dwelling",501:"cloak",502:"clog, geta, patten, sabot",503:"cocktail shaker",504:"coffee mug",505:"coffeepot",506:"coil, spiral, volute, whorl, helix",507:"combination lock",508:"computer keyboard, keypad",509:"confectionery, confectionary, candy store",510:"container ship, containership, container vessel",511:"convertible",512:"corkscrew, bottle screw",513:"cornet, horn, trumpet, trump",514:"cowboy boot",515:"cowboy hat, ten-gallon hat",516:"cradle",517:"crane",518:"crash helmet",519:"crate",520:"crib, cot",521:"Crock Pot",522:"croquet ball",523:"crutch",524:"cuirass",525:"dam, dike, dyke",526:"desk",527:"desktop computer",528:"dial telephone, dial phone",529:"diaper, nappy, napkin",530:"digital clock",531:"digital watch",532:"dining table, board",533:"dishrag, dishcloth",534:"dishwasher, dish washer, dishwashing machine",535:"disk brake, disc brake",536:"dock, dockage, docking facility",537:"dogsled, dog sled, dog sleigh",538:"dome",539:"doormat, welcome mat",540:"drilling platform, offshore rig",541:"drum, membranophone, tympan",542:"drumstick",543:"dumbbell",544:"Dutch oven",545:"electric fan, blower",546:"electric guitar",547:"electric locomotive",548:"entertainment center",549:"envelope",550:"espresso maker",551:"face powder",552:"feather boa, boa",553:"file, file cabinet, filing cabinet",554:"fireboat",555:"fire engine, fire truck",556:"fire screen, fireguard",557:"flagpole, flagstaff",558:"flute, transverse flute",559:"folding chair",560:"football helmet",561:"forklift",562:"fountain",563:"fountain pen",564:"four-poster",565:"freight car",566:"French horn, horn",567:"frying pan, frypan, skillet",568:"fur coat",569:"garbage truck, dustcart",570:"gasmask, respirator, gas helmet",571:"gas pump, gasoline pump, petrol pump, island dispenser",572:"goblet",573:"go-kart",574:"golf ball",575:"golfcart, golf cart",576:"gondola",577:"gong, tam-tam",578:"gown",579:"grand piano, grand",580:"greenhouse, nursery, glasshouse",581:"grille, radiator grille",582:"grocery store, grocery, food market, market",583:"guillotine",584:"hair slide",585:"hair spray",586:"half track",587:"hammer",588:"hamper",589:"hand blower, blow dryer, blow drier, hair dryer, hair drier",590:"hand-held computer, hand-held microcomputer",591:"handkerchief, hankie, hanky, hankey",592:"hard disc, hard disk, fixed disk",593:"harmonica, mouth organ, harp, mouth harp",594:"harp",595:"harvester, reaper",596:"hatchet",597:"holster",598:"home theater, home theatre",599:"honeycomb",600:"hook, claw",601:"hoopskirt, crinoline",602:"horizontal bar, high bar",603:"horse cart, horse-cart",604:"hourglass",605:"iPod",606:"iron, smoothing iron",607:"jack-o'-lantern",608:"jean, blue jean, denim",609:"jeep, landrover",610:"jersey, T-shirt, tee shirt",611:"jigsaw puzzle",612:"jinrikisha, ricksha, rickshaw",613:"joystick",614:"kimono",615:"knee pad",616:"knot",617:"lab coat, laboratory coat",618:"ladle",619:"lampshade, lamp shade",620:"laptop, laptop computer",621:"lawn mower, mower",622:"lens cap, lens cover",623:"letter opener, paper knife, paperknife",624:"library",625:"lifeboat",626:"lighter, light, igniter, ignitor",627:"limousine, limo",628:"liner, ocean liner",629:"lipstick, lip rouge",630:"Loafer",631:"lotion",632:"loudspeaker, speaker, speaker unit, loudspeaker system, speaker "+"system",633:"loupe, jeweler's loupe",634:"lumbermill, sawmill",635:"magnetic compass",636:"mailbag, postbag",637:"mailbox, letter box",638:"maillot",639:"maillot, tank suit",640:"manhole cover",641:"maraca",642:"marimba, xylophone",643:"mask",644:"matchstick",645:"maypole",646:"maze, labyrinth",647:"measuring cup",648:"medicine chest, medicine cabinet",649:"megalith, megalithic structure",650:"microphone, mike",651:"microwave, microwave oven",652:"military uniform",653:"milk can",654:"minibus",655:"miniskirt, mini",656:"minivan",657:"missile",658:"mitten",659:"mixing bowl",660:"mobile home, manufactured home",661:"Model T",662:"modem",663:"monastery",664:"monitor",665:"moped",666:"mortar",667:"mortarboard",668:"mosque",669:"mosquito net",670:"motor scooter, scooter",671:"mountain bike, all-terrain bike, off-roader",672:"mountain tent",673:"mouse, computer mouse",674:"mousetrap",675:"moving van",676:"muzzle",677:"nail",678:"neck brace",679:"necklace",680:"nipple",681:"notebook, notebook computer",682:"obelisk",683:"oboe, hautboy, hautbois",684:"ocarina, sweet potato",685:"odometer, hodometer, mileometer, milometer",686:"oil filter",687:"organ, pipe organ",688:"oscilloscope, scope, cathode-ray oscilloscope, CRO",689:"overskirt",690:"oxcart",691:"oxygen mask",692:"packet",693:"paddle, boat paddle",694:"paddlewheel, paddle wheel",695:"padlock",696:"paintbrush",697:"pajama, pyjama, pj's, jammies",698:"palace",699:"panpipe, pandean pipe, syrinx",700:"paper towel",701:"parachute, chute",702:"parallel bars, bars",703:"park bench",704:"parking meter",705:"passenger car, coach, carriage",706:"patio, terrace",707:"pay-phone, pay-station",708:"pedestal, plinth, footstall",709:"pencil box, pencil case",710:"pencil sharpener",711:"perfume, essence",712:"Petri dish",713:"photocopier",714:"pick, plectrum, plectron",715:"pickelhaube",716:"picket fence, paling",717:"pickup, pickup truck",718:"pier",719:"piggy bank, penny bank",720:"pill bottle",721:"pillow",722:"ping-pong ball",723:"pinwheel",724:"pirate, pirate ship",725:"pitcher, ewer",726:"plane, carpenter's plane, woodworking plane",727:"planetarium",728:"plastic bag",729:"plate rack",730:"plow, plough",731:"plunger, plumber's helper",732:"Polaroid camera, Polaroid Land camera",733:"pole",734:"police van, police wagon, paddy wagon, patrol wagon, wagon, black "+"Maria",735:"poncho",736:"pool table, billiard table, snooker table",737:"pop bottle, soda bottle",738:"pot, flowerpot",739:"potter's wheel",740:"power drill",741:"prayer rug, prayer mat",742:"printer",743:"prison, prison house",744:"projectile, missile",745:"projector",746:"puck, hockey puck",747:"punching bag, punch bag, punching ball, punchball",748:"purse",749:"quill, quill pen",750:"quilt, comforter, comfort, puff",751:"racer, race car, racing car",752:"racket, racquet",753:"radiator",754:"radio, wireless",755:"radio telescope, radio reflector",756:"rain barrel",757:"recreational vehicle, RV, R.V.",758:"reel",759:"reflex camera",760:"refrigerator, icebox",761:"remote control, remote",762:"restaurant, eating house, eating place, eatery",763:"revolver, six-gun, six-shooter",764:"rifle",765:"rocking chair, rocker",766:"rotisserie",767:"rubber eraser, rubber, pencil eraser",768:"rugby ball",769:"rule, ruler",770:"running shoe",771:"safe",772:"safety pin",773:"saltshaker, salt shaker",774:"sandal",775:"sarong",776:"sax, saxophone",777:"scabbard",778:"scale, weighing machine",779:"school bus",780:"schooner",781:"scoreboard",782:"screen, CRT screen",783:"screw",784:"screwdriver",785:"seat belt, seatbelt",786:"sewing machine",787:"shield, buckler",788:"shoe shop, shoe-shop, shoe store",789:"shoji",790:"shopping basket",791:"shopping cart",792:"shovel",793:"shower cap",794:"shower curtain",795:"ski",796:"ski mask",797:"sleeping bag",798:"slide rule, slipstick",799:"sliding door",800:"slot, one-armed bandit",801:"snorkel",802:"snowmobile",803:"snowplow, snowplough",804:"soap dispenser",805:"soccer ball",806:"sock",807:"solar dish, solar collector, solar furnace",808:"sombrero",809:"soup bowl",810:"space bar",811:"space heater",812:"space shuttle",813:"spatula",814:"speedboat",815:"spider web, spider's web",816:"spindle",817:"sports car, sport car",818:"spotlight, spot",819:"stage",820:"steam locomotive",821:"steel arch bridge",822:"steel drum",823:"stethoscope",824:"stole",825:"stone wall",826:"stopwatch, stop watch",827:"stove",828:"strainer",829:"streetcar, tram, tramcar, trolley, trolley car",830:"stretcher",831:"studio couch, day bed",832:"stupa, tope",833:"submarine, pigboat, sub, U-boat",834:"suit, suit of clothes",835:"sundial",836:"sunglass",837:"sunglasses, dark glasses, shades",838:"sunscreen, sunblock, sun blocker",839:"suspension bridge",840:"swab, swob, mop",841:"sweatshirt",842:"swimming trunks, bathing trunks",843:"swing",844:"switch, electric switch, electrical switch",845:"syringe",846:"table lamp",847:"tank, army tank, armored combat vehicle, armoured combat vehicle",848:"tape player",849:"teapot",850:"teddy, teddy bear",851:"television, television system",852:"tennis ball",853:"thatch, thatched roof",854:"theater curtain, theatre curtain",855:"thimble",856:"thresher, thrasher, threshing machine",857:"throne",858:"tile roof",859:"toaster",860:"tobacco shop, tobacconist shop, tobacconist",861:"toilet seat",862:"torch",863:"totem pole",864:"tow truck, tow car, wrecker",865:"toyshop",866:"tractor",867:"trailer truck, tractor trailer, trucking rig, rig, articulated "+"lorry, semi",868:"tray",869:"trench coat",870:"tricycle, trike, velocipede",871:"trimaran",872:"tripod",873:"triumphal arch",874:"trolleybus, trolley coach, trackless trolley",875:"trombone",876:"tub, vat",877:"turnstile",878:"typewriter keyboard",879:"umbrella",880:"unicycle, monocycle",881:"upright, upright piano",882:"vacuum, vacuum cleaner",883:"vase",884:"vault",885:"velvet",886:"vending machine",887:"vestment",888:"viaduct",889:"violin, fiddle",890:"volleyball",891:"waffle iron",892:"wall clock",893:"wallet, billfold, notecase, pocketbook",894:"wardrobe, closet, press",895:"warplane, military plane",896:"washbasin, handbasin, washbowl, lavabo, wash-hand basin",897:"washer, automatic washer, washing machine",898:"water bottle",899:"water jug",900:"water tower",901:"whiskey jug",902:"whistle",903:"wig",904:"window screen",905:"window shade",906:"Windsor tie",907:"wine bottle",908:"wing",909:"wok",910:"wooden spoon",911:"wool, woolen, woollen",912:"worm fence, snake fence, snake-rail fence, Virginia fence",913:"wreck",914:"yawl",915:"yurt",916:"web site, website, internet site, site",917:"comic book",918:"crossword puzzle, crossword",919:"street sign",920:"traffic light, traffic signal, stoplight",921:"book jacket, dust cover, dust jacket, dust wrapper",922:"menu",923:"plate",924:"guacamole",925:"consomme",926:"hot pot, hotpot",927:"trifle",928:"ice cream, icecream",929:"ice lolly, lolly, lollipop, popsicle",930:"French loaf",931:"bagel, beigel",932:"pretzel",933:"cheeseburger",934:"hotdog, hot dog, red hot",935:"mashed potato",936:"head cabbage",937:"broccoli",938:"cauliflower",939:"zucchini, courgette",940:"spaghetti squash",941:"acorn squash",942:"butternut squash",943:"cucumber, cuke",944:"artichoke, globe artichoke",945:"bell pepper",946:"cardoon",947:"mushroom",948:"Granny Smith",949:"strawberry",950:"orange",951:"lemon",952:"fig",953:"pineapple, ananas",954:"banana",955:"jackfruit, jak, jack",956:"custard apple",957:"pomegranate",958:"hay",959:"carbonara",960:"chocolate sauce, chocolate syrup",961:"dough",962:"meat loaf, meatloaf",963:"pizza, pizza pie",964:"potpie",965:"burrito",966:"red wine",967:"espresso",968:"cup",969:"eggnog",970:"alp",971:"bubble",972:"cliff, drop, drop-off",973:"coral reef",974:"geyser",975:"lakeside, lakeshore",976:"promontory, headland, head, foreland",977:"sandbar, sand bar",978:"seashore, coast, seacoast, sea-coast",979:"valley, vale",980:"volcano",981:"ballplayer, baseball player",982:"groom, bridegroom",983:"scuba diver",984:"rapeseed",985:"daisy",986:"yellow lady's slipper, yellow lady-slipper, Cypripedium calceolus, "+"Cypripedium parviflorum",987:"corn",988:"acorn",989:"hip, rose hip, rosehip",990:"buckeye, horse chestnut, conker",991:"coral fungus",992:"agaric",993:"gyromitra",994:"stinkhorn, carrion fungus",995:"earthstar",996:"hen-of-the-woods, hen of the woods, Polyporus frondosus, Grifola "+"frondosa",997:"bolete",998:"ear, spike, capitulum",999:"toilet tissue, toilet paper, bathroom tissue"}},function(module,exports,__webpack_require__){"use strict";(function(global){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var require;var require;var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};(function(f){if((false?"undefined":_typeof(exports))==="object"&&typeof module!=="undefined"){module.exports=f()}else if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_FACTORY__=f,__WEBPACK_AMD_DEFINE_RESULT__=typeof __WEBPACK_AMD_DEFINE_FACTORY__==="function"?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.mobilenet=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return require(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++){s(r[o])}return s}({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.IMAGENET_CLASSES={0:"background",1:"tench, Tinca tinca",2:"goldfish, Carassius auratus",3:"great white shark, white shark, man-eater,"+" man-eating shark, Carcharodon carcharias",4:"tiger shark, Galeocerdo cuvieri",5:"hammerhead, hammerhead shark",6:"electric ray, crampfish, numbfish, torpedo",7:"stingray",8:"cock",9:"hen",10:"ostrich, Struthio camelus",11:"brambling, Fringilla montifringilla",12:"goldfinch, Carduelis carduelis",13:"house finch, linnet, Carpodacus mexicanus",14:"junco, snowbird",15:"indigo bunting, indigo finch, indigo bird, Passerina cyanea",16:"robin, American robin, Turdus migratorius",17:"bulbul",18:"jay",19:"magpie",20:"chickadee",21:"water ouzel, dipper",22:"kite",23:"bald eagle, American eagle, Haliaeetus leucocephalus",24:"vulture",25:"great grey owl, great gray owl, Strix nebulosa",26:"European fire salamander, Salamandra salamandra",27:"common newt, Triturus vulgaris",28:"eft",29:"spotted salamander, Ambystoma maculatum",30:"axolotl, mud puppy, Ambystoma mexicanum",31:"bullfrog, Rana catesbeiana",32:"tree frog, tree-frog",33:"tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui",34:"loggerhead, loggerhead turtle, Caretta caretta",35:"leatherback turtle, leatherback, leathery turtle, Dermochelys coriacea",36:"mud turtle",37:"terrapin",38:"box turtle, box tortoise",39:"banded gecko",40:"common iguana, iguana, Iguana iguana",41:"American chameleon, anole, Anolis carolinensis",42:"whiptail, whiptail lizard",43:"agama",44:"frilled lizard, Chlamydosaurus kingi",45:"alligator lizard",46:"Gila monster, Heloderma suspectum",47:"green lizard, Lacerta viridis",48:"African chameleon, Chamaeleo chamaeleon",49:"Komodo dragon, Komodo lizard, dragon lizard,"+" giant lizard, Varanus komodoensis",50:"African crocodile, Nile crocodile, Crocodylus niloticus",51:"American alligator, Alligator mississipiensis",52:"triceratops",53:"thunder snake, worm snake, Carphophis amoenus",54:"ringneck snake, ring-necked snake, ring snake",55:"hognose snake, puff adder, sand viper",56:"green snake, grass snake",57:"king snake, kingsnake",58:"garter snake, grass snake",59:"water snake",60:"vine snake",61:"night snake, Hypsiglena torquata",62:"boa constrictor, Constrictor constrictor",63:"rock python, rock snake, Python sebae",64:"Indian cobra, Naja naja",65:"green mamba",66:"sea snake",67:"horned viper, cerastes, sand viper, horned asp, Cerastes cornutus",68:"diamondback, diamondback rattlesnake, Crotalus adamanteus",69:"sidewinder, horned rattlesnake, Crotalus cerastes",70:"trilobite",71:"harvestman, daddy longlegs, Phalangium opilio",72:"scorpion",73:"black and gold garden spider, Argiope aurantia",74:"barn spider, Araneus cavaticus",75:"garden spider, Aranea diademata",76:"black widow, Latrodectus mactans",77:"tarantula",78:"wolf spider, hunting spider",79:"tick",80:"centipede",81:"black grouse",82:"ptarmigan",83:"ruffed grouse, partridge, Bonasa umbellus",84:"prairie chicken, prairie grouse, prairie fowl",85:"peacock",86:"quail",87:"partridge",88:"African grey, African gray, Psittacus erithacus",89:"macaw",90:"sulphur-crested cockatoo, Kakatoe galerita, Cacatua galerita",91:"lorikeet",92:"coucal",93:"bee eater",94:"hornbill",95:"hummingbird",96:"jacamar",97:"toucan",98:"drake",99:"red-breasted merganser, Mergus serrator",100:"goose",101:"black swan, Cygnus atratus",102:"tusker",103:"echidna, spiny anteater, anteater",104:"platypus, duckbill, duckbilled platypus, duck-billed platypus,"+" Ornithorhynchus anatinus",105:"wallaby, brush kangaroo",106:"koala, koala bear, kangaroo bear, native bear, Phascolarctos cinereus",107:"wombat",108:"jelly fish",109:"sea anemone, anemone",110:"brain coral",111:"flatworm, platyhelminth",112:"nematode, nematode worm, roundworm",113:"conch",114:"snail",115:"slug",116:"sea slug, nudibranch",117:"chiton, coat-of-mail shell, sea cradle, polyplacophore",118:"chambered nautilus, pearly nautilus, nautilus",119:"Dungeness crab, Cancer magister",120:"rock crab, Cancer irroratus",121:"fiddler crab",122:"king crab, Alaska crab, Alaskan king crab, Alaska king crab,"+" Paralithodes camtschatica",123:"American lobster, Northern lobster, Maine lobster, Homarus americanus",124:"spiny lobster, langouste, rock lobster, crawfish, crayfish,"+" sea crawfish",125:"crayfish, crawfish, crawdad, crawdaddy",126:"hermit crab",127:"isopod",128:"white stork, Ciconia ciconia",129:"black stork, Ciconia nigra",130:"spoonbill",131:"flamingo",132:"little blue heron, Egretta caerulea",133:"American egret, great white heron, Egretta albus",134:"bittern",135:"crane",136:"limpkin, Aramus pictus",137:"European gallinule, Porphyrio porphyrio",138:"American coot, marsh hen, mud hen, water hen, Fulica americana",139:"bustard",140:"ruddy turnstone, Arenaria interpres",141:"red-backed sandpiper, dunlin, Erolia alpina",142:"redshank, Tringa totanus",143:"dowitcher",144:"oystercatcher, oyster catcher",145:"pelican",146:"king penguin, Aptenodytes patagonica",147:"albatross, mollymawk",148:"grey whale, gray whale, devilfish, Eschrichtius gibbosus,"+" Eschrichtius robustus",149:"killer whale, killer, orca, grampus, sea wolf, Orcinus orca",150:"dugong, Dugong dugon",151:"sea lion",152:"Chihuahua",153:"Japanese spaniel",154:"Maltese dog, Maltese terrier, Maltese",155:"Pekinese, Pekingese, Peke",156:"Shih-Tzu",157:"Blenheim spaniel",158:"papillon",159:"toy terrier",160:"Rhodesian ridgeback",161:"Afghan hound, Afghan",162:"basset, basset hound",163:"beagle",164:"bloodhound, sleuthhound",165:"bluetick",166:"black-and-tan coonhound",167:"Walker hound, Walker foxhound",168:"English foxhound",169:"redbone",170:"borzoi, Russian wolfhound",171:"Irish wolfhound",172:"Italian greyhound",173:"whippet",174:"Ibizan hound, Ibizan Podenco",175:"Norwegian elkhound, elkhound",176:"otterhound, otter hound",177:"Saluki, gazelle hound",178:"Scottish deerhound, deerhound",179:"Weimaraner",180:"Staffordshire bullterrier, Staffordshire bull terrier",181:"American Staffordshire terrier, Staffordshire terrier,"+" American pit bull terrier, pit bull terrier",182:"Bedlington terrier",183:"Border terrier",184:"Kerry blue terrier",185:"Irish terrier",186:"Norfolk terrier",187:"Norwich terrier",188:"Yorkshire terrier",189:"wire-haired fox terrier",190:"Lakeland terrier",191:"Sealyham terrier, Sealyham",192:"Airedale, Airedale terrier",193:"cairn, cairn terrier",194:"Australian terrier",195:"Dandie Dinmont, Dandie Dinmont terrier",196:"Boston bull, Boston terrier",197:"miniature schnauzer",198:"giant schnauzer",199:"standard schnauzer",200:"Scotch terrier, Scottish terrier, Scottie",201:"Tibetan terrier, chrysanthemum dog",202:"silky terrier, Sydney silky",203:"soft-coated wheaten terrier",204:"West Highland white terrier",205:"Lhasa, Lhasa apso",206:"flat-coated retriever",207:"curly-coated retriever",208:"golden retriever",209:"Labrador retriever",210:"Chesapeake Bay retriever",211:"German short-haired pointer",212:"vizsla, Hungarian pointer",213:"English setter",214:"Irish setter, red setter",215:"Gordon setter",216:"Brittany spaniel",217:"clumber, clumber spaniel",218:"English springer, English springer spaniel",219:"Welsh springer spaniel",220:"cocker spaniel, English cocker spaniel, cocker",221:"Sussex spaniel",222:"Irish water spaniel",223:"kuvasz",224:"schipperke",225:"groenendael",226:"malinois",227:"briard",228:"kelpie",229:"komondor",230:"Old English sheepdog, bobtail",231:"Shetland sheepdog, Shetland sheep dog, Shetland",232:"collie",233:"Border collie",234:"Bouvier des Flandres, Bouviers des Flandres",235:"Rottweiler",236:"German shepherd, German shepherd dog, German police dog, alsatian",237:"Doberman, Doberman pinscher",238:"miniature pinscher",239:"Greater Swiss Mountain dog",240:"Bernese mountain dog",241:"Appenzeller",242:"EntleBucher",243:"boxer",244:"bull mastiff",245:"Tibetan mastiff",246:"French bulldog",247:"Great Dane",248:"Saint Bernard, St Bernard",249:"Eskimo dog, husky",250:"malamute, malemute, Alaskan malamute",251:"Siberian husky",252:"dalmatian, coach dog, carriage dog",253:"affenpinscher, monkey pinscher, monkey dog",254:"basenji",255:"pug, pug-dog",256:"Leonberg",257:"Newfoundland, Newfoundland dog",258:"Great Pyrenees",259:"Samoyed, Samoyede",260:"Pomeranian",261:"chow, chow chow",262:"keeshond",263:"Brabancon griffon",264:"Pembroke, Pembroke Welsh corgi",265:"Cardigan, Cardigan Welsh corgi",266:"toy poodle",267:"miniature poodle",268:"standard poodle",269:"Mexican hairless",270:"timber wolf, grey wolf, gray wolf, Canis lupus",271:"white wolf, Arctic wolf, Canis lupus tundrarum",272:"red wolf, maned wolf, Canis rufus, Canis niger",273:"coyote, prairie wolf, brush wolf, Canis latrans",274:"dingo, warrigal, warragal, Canis dingo",275:"dhole, Cuon alpinus",276:"African hunting dog, hyena dog, Cape hunting dog, Lycaon pictus",277:"hyena, hyaena",278:"red fox, Vulpes vulpes",279:"kit fox, Vulpes macrotis",280:"Arctic fox, white fox, Alopex lagopus",281:"grey fox, gray fox, Urocyon cinereoargenteus",282:"tabby, tabby cat",283:"tiger cat",284:"Persian cat",285:"Siamese cat, Siamese",286:"Egyptian cat",287:"cougar, puma, catamount, mountain lion, painter, panther,"+" Felis concolor",288:"lynx, catamount",289:"leopard, Panthera pardus",290:"snow leopard, ounce, Panthera uncia",291:"jaguar, panther, Panthera onca, Felis onca",292:"lion, king of beasts, Panthera leo",293:"tiger, Panthera tigris",294:"cheetah, chetah, Acinonyx jubatus",295:"brown bear, bruin, Ursus arctos",296:"American black bear, black bear, Ursus americanus,"+" Euarctos americanus",297:"ice bear, polar bear, Ursus Maritimus, Thalarctos maritimus",298:"sloth bear, Melursus ursinus, Ursus ursinus",299:"mongoose",300:"meerkat, mierkat",301:"tiger beetle",302:"ladybug, ladybeetle, lady beetle, ladybird, ladybird beetle",303:"ground beetle, carabid beetle",304:"long-horned beetle, longicorn, longicorn beetle",305:"leaf beetle, chrysomelid",306:"dung beetle",307:"rhinoceros beetle",308:"weevil",309:"fly",310:"bee",311:"ant, emmet, pismire",312:"grasshopper, hopper",313:"cricket",314:"walking stick, walkingstick, stick insect",315:"cockroach, roach",316:"mantis, mantid",317:"cicada, cicala",318:"leafhopper",319:"lacewing, lacewing fly",320:"dragonfly, darning needle, devil's darning needle, sewing"+"needle, snake feeder, snake doctor, mosquito hawk, skeeter hawk",321:"damselfly",322:"admiral",323:"ringlet, ringlet butterfly",324:"monarch, monarch butterfly, milkweed butterfly, Danaus plexippus",325:"cabbage butterfly",326:"sulphur butterfly, sulfur butterfly",327:"lycaenid, lycaenid butterfly",328:"starfish, sea star",329:"sea urchin",330:"sea cucumber, holothurian",331:"wood rabbit, cottontail, cottontail rabbit",332:"hare",333:"Angora, Angora rabbit",334:"hamster",335:"porcupine, hedgehog",336:"fox squirrel, eastern fox squirrel, Sciurus niger",337:"marmot",338:"beaver",339:"guinea pig, Cavia cobaya",340:"sorrel",341:"zebra",342:"hog, pig, grunter, squealer, Sus scrofa",343:"wild boar, boar, Sus scrofa",344:"warthog",345:"hippopotamus, hippo, river horse, Hippopotamus amphibius",346:"ox",347:"water buffalo, water ox, Asiatic buffalo, Bubalus bubalis",348:"bison",349:"ram, tup",350:"bighorn, bighorn sheep, cimarron, Rocky Mountain bighorn, Rocky "+"Mountain sheep, Ovis canadensis",351:"ibex, Capra ibex",352:"hartebeest",353:"impala, Aepyceros melampus",354:"gazelle",355:"Arabian camel, dromedary, Camelus dromedarius",356:"llama",357:"weasel",358:"mink",359:"polecat, fitch, foulmart, foumart, Mustela putorius",360:"black-footed ferret, ferret, Mustela nigripes",361:"otter",362:"skunk, polecat, wood pussy",363:"badger",364:"armadillo",365:"three-toed sloth, ai, Bradypus tridactylus",366:"orangutan, orang, orangutang, Pongo pygmaeus",367:"gorilla, Gorilla gorilla",368:"chimpanzee, chimp, Pan troglodytes",369:"gibbon, Hylobates lar",370:"siamang, Hylobates syndactylus, Symphalangus syndactylus",371:"guenon, guenon monkey",372:"patas, hussar monkey, Erythrocebus patas",373:"baboon",374:"macaque",375:"langur",376:"colobus, colobus monkey",377:"proboscis monkey, Nasalis larvatus",378:"marmoset",379:"capuchin, ringtail, Cebus capucinus",380:"howler monkey, howler",381:"titi, titi monkey",382:"spider monkey, Ateles geoffroyi",383:"squirrel monkey, Saimiri sciureus",384:"Madagascar cat, ring-tailed lemur, Lemur catta",385:"indri, indris, Indri indri, Indri brevicaudatus",386:"Indian elephant, Elephas maximus",387:"African elephant, Loxodonta africana",388:"lesser panda, red panda, panda, bear cat, cat bear, Ailurus fulgens",389:"giant panda, panda, panda bear, coon bear, Ailuropoda melanoleuca",390:"barracouta, snoek",391:"eel",392:"coho, cohoe, coho salmon, blue jack, silver salmon, "+"Oncorhynchus kisutch",393:"rock beauty, Holocanthus tricolor",394:"anemone fish",395:"sturgeon",396:"gar, garfish, garpike, billfish, Lepisosteus osseus",397:"lionfish",398:"puffer, pufferfish, blowfish, globefish",399:"abacus",400:"abaya",401:"academic gown, academic robe, judge's robe",402:"accordion, piano accordion, squeeze box",403:"acoustic guitar",404:"aircraft carrier, carrier, flattop, attack aircraft carrier",405:"airliner",406:"airship, dirigible",407:"altar",408:"ambulance",409:"amphibian, amphibious vehicle",410:"analog clock",411:"apiary, bee house",412:"apron",413:"ashcan, trash can, garbage can, wastebin, ash bin, ash-bin,"+" ashbin, dustbin, trash barrel, trash bin",414:"assault rifle, assault gun",415:"backpack, back pack, knapsack, packsack, rucksack, haversack",416:"bakery, bakeshop, bakehouse",417:"balance beam, beam",418:"balloon",419:"ballpoint, ballpoint pen, ballpen, Biro",420:"Band Aid",421:"banjo",422:"bannister, banister, balustrade, balusters, handrail",423:"barbell",424:"barber chair",425:"barbershop",426:"barn",427:"barometer",428:"barrel, cask",429:"barrow, garden cart, lawn cart, wheelbarrow",430:"baseball",431:"basketball",432:"bassinet",433:"bassoon",434:"bathing cap, swimming cap",435:"bath towel",436:"bathtub, bathing tub, bath, tub",437:"beach wagon, station wagon, wagon, estate car, beach waggon,"+" station waggon, waggon",438:"beacon, lighthouse, beacon light, pharos",439:"beaker",440:"bearskin, busby, shako",441:"beer bottle",442:"beer glass",443:"bell cote, bell cot",444:"bib",445:"bicycle-built-for-two, tandem bicycle, tandem",446:"bikini, two-piece",447:"binder, ring-binder",448:"binoculars, field glasses, opera glasses",449:"birdhouse",450:"boathouse",451:"bobsled, bobsleigh, bob",452:"bolo tie, bolo, bola tie, bola",453:"bonnet, poke bonnet",454:"bookcase",455:"bookshop, bookstore, bookstall",456:"bottlecap",457:"bow",458:"bow tie, bow-tie, bowtie",459:"brass, memorial tablet, plaque",460:"brassiere, bra, bandeau",461:"breakwater, groin, groyne, mole, bulwark, seawall, jetty",462:"breastplate, aegis, egis",463:"broom",464:"bucket, pail",465:"buckle",466:"bulletproof vest",467:"bullet train, bullet",468:"butcher shop, meat market",469:"cab, hack, taxi, taxicab",470:"caldron, cauldron",471:"candle, taper, wax light",472:"cannon",473:"canoe",474:"can opener, tin opener",475:"cardigan",476:"car mirror",477:"carousel, carrousel, merry-go-round, roundabout, whirligig",478:"carpenter's kit, tool kit",479:"carton",480:"car wheel",481:"cash machine, cash dispenser, automated teller machine, automatic"+" teller machine, automated teller, automatic teller, ATM",482:"cassette",483:"cassette player",484:"castle",485:"catamaran",486:"CD player",487:"cello, violoncello",488:"cellular telephone, cellular phone, cellphone, cell, mobile phone",489:"chain",490:"chainlink fence",491:"chain mail, ring mail, mail, chain armor, chain armour,"+" ring armor, ring armour",492:"chain saw, chainsaw",493:"chest",494:"chiffonier, commode",495:"chime, bell, gong",496:"china cabinet, china closet",497:"Christmas stocking",498:"church, church building",499:"cinema, movie theater, movie theatre, movie house, picture palace",500:"cleaver, meat cleaver, chopper",501:"cliff dwelling",502:"cloak",503:"clog, geta, patten, sabot",504:"cocktail shaker",505:"coffee mug",506:"coffeepot",507:"coil, spiral, volute, whorl, helix",508:"combination lock",509:"computer keyboard, keypad",510:"confectionery, confectionary, candy store",511:"container ship, containership, container vessel",512:"convertible",513:"corkscrew, bottle screw",514:"cornet, horn, trumpet, trump",515:"cowboy boot",516:"cowboy hat, ten-gallon hat",517:"cradle",518:"crane",519:"crash helmet",520:"crate",521:"crib, cot",522:"Crock Pot",523:"croquet ball",524:"crutch",525:"cuirass",526:"dam, dike, dyke",527:"desk",528:"desktop computer",529:"dial telephone, dial phone",530:"diaper, nappy, napkin",531:"digital clock",532:"digital watch",533:"dining table, board",534:"dishrag, dishcloth",535:"dishwasher, dish washer, dishwashing machine",536:"disk brake, disc brake",537:"dock, dockage, docking facility",538:"dogsled, dog sled, dog sleigh",539:"dome",540:"doormat, welcome mat",541:"drilling platform, offshore rig",542:"drum, membranophone, tympan",543:"drumstick",544:"dumbbell",545:"Dutch oven",546:"electric fan, blower",547:"electric guitar",548:"electric locomotive",549:"entertainment center",550:"envelope",551:"espresso maker",552:"face powder",553:"feather boa, boa",554:"file, file cabinet, filing cabinet",555:"fireboat",556:"fire engine, fire truck",557:"fire screen, fireguard",558:"flagpole, flagstaff",559:"flute, transverse flute",560:"folding chair",561:"football helmet",562:"forklift",563:"fountain",564:"fountain pen",565:"four-poster",566:"freight car",567:"French horn, horn",568:"frying pan, frypan, skillet",569:"fur coat",570:"garbage truck, dustcart",571:"gasmask, respirator, gas helmet",572:"gas pump, gasoline pump, petrol pump, island dispenser",573:"goblet",574:"go-kart",575:"golf ball",576:"golfcart, golf cart",577:"gondola",578:"gong, tam-tam",579:"gown",580:"grand piano, grand",581:"greenhouse, nursery, glasshouse",582:"grille, radiator grille",583:"grocery store, grocery, food market, market",584:"guillotine",585:"hair slide",586:"hair spray",587:"half track",588:"hammer",589:"hamper",590:"hand blower, blow dryer, blow drier, hair dryer, hair drier",591:"hand-held computer, hand-held microcomputer",592:"handkerchief, hankie, hanky, hankey",593:"hard disc, hard disk, fixed disk",594:"harmonica, mouth organ, harp, mouth harp",595:"harp",596:"harvester, reaper",597:"hatchet",598:"holster",599:"home theater, home theatre",600:"honeycomb",601:"hook, claw",602:"hoopskirt, crinoline",603:"horizontal bar, high bar",604:"horse cart, horse-cart",605:"hourglass",606:"iPod",607:"iron, smoothing iron",608:"jack-o'-lantern",609:"jean, blue jean, denim",610:"jeep, landrover",611:"jersey, T-shirt, tee shirt",612:"jigsaw puzzle",613:"jinrikisha, ricksha, rickshaw",614:"joystick",615:"kimono",616:"knee pad",617:"knot",618:"lab coat, laboratory coat",619:"ladle",620:"lampshade, lamp shade",621:"laptop, laptop computer",622:"lawn mower, mower",623:"lens cap, lens cover",624:"letter opener, paper knife, paperknife",625:"library",626:"lifeboat",627:"lighter, light, igniter, ignitor",628:"limousine, limo",629:"liner, ocean liner",630:"lipstick, lip rouge",631:"Loafer",632:"lotion",633:"loudspeaker, speaker, speaker unit, loudspeaker system, "+"speaker system",634:"loupe, jeweler's loupe",635:"lumbermill, sawmill",636:"magnetic compass",637:"mailbag, postbag",638:"mailbox, letter box",639:"maillot",640:"maillot, tank suit",641:"manhole cover",642:"maraca",643:"marimba, xylophone",644:"mask",645:"matchstick",646:"maypole",647:"maze, labyrinth",648:"measuring cup",649:"medicine chest, medicine cabinet",650:"megalith, megalithic structure",651:"microphone, mike",652:"microwave, microwave oven",653:"military uniform",654:"milk can",655:"minibus",656:"miniskirt, mini",657:"minivan",658:"missile",659:"mitten",660:"mixing bowl",661:"mobile home, manufactured home",662:"Model T",663:"modem",664:"monastery",665:"monitor",666:"moped",667:"mortar",668:"mortarboard",669:"mosque",670:"mosquito net",671:"motor scooter, scooter",672:"mountain bike, all-terrain bike, off-roader",673:"mountain tent",674:"mouse, computer mouse",675:"mousetrap",676:"moving van",677:"muzzle",678:"nail",679:"neck brace",680:"necklace",681:"nipple",682:"notebook, notebook computer",683:"obelisk",684:"oboe, hautboy, hautbois",685:"ocarina, sweet potato",686:"odometer, hodometer, mileometer, milometer",687:"oil filter",688:"organ, pipe organ",689:"oscilloscope, scope, cathode-ray oscilloscope, CRO",690:"overskirt",691:"oxcart",692:"oxygen mask",693:"packet",694:"paddle, boat paddle",695:"paddlewheel, paddle wheel",696:"padlock",697:"paintbrush",698:"pajama, pyjama, pj's, jammies",699:"palace",700:"panpipe, pandean pipe, syrinx",701:"paper towel",702:"parachute, chute",703:"parallel bars, bars",704:"park bench",705:"parking meter",706:"passenger car, coach, carriage",707:"patio, terrace",708:"pay-phone, pay-station",709:"pedestal, plinth, footstall",710:"pencil box, pencil case",711:"pencil sharpener",712:"perfume, essence",713:"Petri dish",714:"photocopier",715:"pick, plectrum, plectron",716:"pickelhaube",717:"picket fence, paling",718:"pickup, pickup truck",719:"pier",720:"piggy bank, penny bank",721:"pill bottle",722:"pillow",723:"ping-pong ball",724:"pinwheel",725:"pirate, pirate ship",726:"pitcher, ewer",727:"plane, carpenter's plane, woodworking plane",728:"planetarium",729:"plastic bag",730:"plate rack",731:"plow, plough",732:"plunger, plumber's helper",733:"Polaroid camera, Polaroid Land camera",734:"pole",735:"police van, police wagon, paddy wagon, patrol wagon, wagon,"+" black Maria",736:"poncho",737:"pool table, billiard table, snooker table",738:"pop bottle, soda bottle",739:"pot, flowerpot",740:"potter's wheel",741:"power drill",742:"prayer rug, prayer mat",743:"printer",744:"prison, prison house",745:"projectile, missile",746:"projector",747:"puck, hockey puck",748:"punching bag, punch bag, punching ball, punchball",749:"purse",750:"quill, quill pen",751:"quilt, comforter, comfort, puff",752:"racer, race car, racing car",753:"racket, racquet",754:"radiator",755:"radio, wireless",756:"radio telescope, radio reflector",757:"rain barrel",758:"recreational vehicle, RV, R.V.",759:"reel",760:"reflex camera",761:"refrigerator, icebox",762:"remote control, remote",763:"restaurant, eating house, eating place, eatery",764:"revolver, six-gun, six-shooter",765:"rifle",766:"rocking chair, rocker",767:"rotisserie",768:"rubber eraser, rubber, pencil eraser",769:"rugby ball",770:"rule, ruler",771:"running shoe",772:"safe",773:"safety pin",774:"saltshaker, salt shaker",775:"sandal",776:"sarong",777:"sax, saxophone",778:"scabbard",779:"scale, weighing machine",780:"school bus",781:"schooner",782:"scoreboard",783:"screen, CRT screen",784:"screw",785:"screwdriver",786:"seat belt, seatbelt",787:"sewing machine",788:"shield, buckler",789:"shoe shop, shoe-shop, shoe store",790:"shoji",791:"shopping basket",792:"shopping cart",793:"shovel",794:"shower cap",795:"shower curtain",796:"ski",797:"ski mask",798:"sleeping bag",799:"slide rule, slipstick",800:"sliding door",801:"slot, one-armed bandit",802:"snorkel",803:"snowmobile",804:"snowplow, snowplough",805:"soap dispenser",806:"soccer ball",807:"sock",808:"solar dish, solar collector, solar furnace",809:"sombrero",810:"soup bowl",811:"space bar",812:"space heater",813:"space shuttle",814:"spatula",815:"speedboat",816:"spider web, spider's web",817:"spindle",818:"sports car, sport car",819:"spotlight, spot",820:"stage",821:"steam locomotive",822:"steel arch bridge",823:"steel drum",824:"stethoscope",825:"stole",826:"stone wall",827:"stopwatch, stop watch",828:"stove",829:"strainer",830:"streetcar, tram, tramcar, trolley, trolley car",831:"stretcher",832:"studio couch, day bed",833:"stupa, tope",834:"submarine, pigboat, sub, U-boat",835:"suit, suit of clothes",836:"sundial",837:"sunglass",838:"sunglasses, dark glasses, shades",839:"sunscreen, sunblock, sun blocker",840:"suspension bridge",841:"swab, swob, mop",842:"sweatshirt",843:"swimming trunks, bathing trunks",844:"swing",845:"switch, electric switch, electrical switch",846:"syringe",847:"table lamp",848:"tank, army tank, armored combat vehicle, armoured combat vehicle",849:"tape player",850:"teapot",851:"teddy, teddy bear",852:"television, television system",853:"tennis ball",854:"thatch, thatched roof",855:"theater curtain, theatre curtain",856:"thimble",857:"thresher, thrasher, threshing machine",858:"throne",859:"tile roof",860:"toaster",861:"tobacco shop, tobacconist shop, tobacconist",862:"toilet seat",863:"torch",864:"totem pole",865:"tow truck, tow car, wrecker",866:"toyshop",867:"tractor",868:"trailer truck, tractor trailer, trucking rig, rig,"+" articulated lorry, semi",869:"tray",870:"trench coat",871:"tricycle, trike, velocipede",872:"trimaran",873:"tripod",874:"triumphal arch",875:"trolleybus, trolley coach, trackless trolley",876:"trombone",877:"tub, vat",878:"turnstile",879:"typewriter keyboard",880:"umbrella",881:"unicycle, monocycle",882:"upright, upright piano",883:"vacuum, vacuum cleaner",884:"vase",885:"vault",886:"velvet",887:"vending machine",888:"vestment",889:"viaduct",890:"violin, fiddle",891:"volleyball",892:"waffle iron",893:"wall clock",894:"wallet, billfold, notecase, pocketbook",895:"wardrobe, closet, press",896:"warplane, military plane",897:"washbasin, handbasin, washbowl, lavabo, wash-hand basin",898:"washer, automatic washer, washing machine",899:"water bottle",900:"water jug",901:"water tower",902:"whiskey jug",903:"whistle",904:"wig",905:"window screen",906:"window shade",907:"Windsor tie",908:"wine bottle",909:"wing",910:"wok",911:"wooden spoon",912:"wool, woolen, woollen",913:"worm fence, snake fence, snake-rail fence, Virginia fence",914:"wreck",915:"yawl",916:"yurt",917:"web site, website, internet site, site",918:"comic book",919:"crossword puzzle, crossword",920:"street sign",921:"traffic light, traffic signal, stoplight",922:"book jacket, dust cover, dust jacket, dust wrapper",923:"menu",924:"plate",925:"guacamole",926:"consomme",927:"hot pot, hotpot",928:"trifle",929:"ice cream, icecream",930:"ice lolly, lolly, lollipop, popsicle",931:"French loaf",932:"bagel, beigel",933:"pretzel",934:"cheeseburger",935:"hotdog, hot dog, red hot",936:"mashed potato",937:"head cabbage",938:"broccoli",939:"cauliflower",940:"zucchini, courgette",941:"spaghetti squash",942:"acorn squash",943:"butternut squash",944:"cucumber, cuke",945:"artichoke, globe artichoke",946:"bell pepper",947:"cardoon",948:"mushroom",949:"Granny Smith",950:"strawberry",951:"orange",952:"lemon",953:"fig",954:"pineapple, ananas",955:"banana",956:"jackfruit, jak, jack",957:"custard apple",958:"pomegranate",959:"hay",960:"carbonara",961:"chocolate sauce, chocolate syrup",962:"dough",963:"meat loaf, meatloaf",964:"pizza, pizza pie",965:"potpie",966:"burrito",967:"red wine",968:"espresso",969:"cup",970:"eggnog",971:"alp",972:"bubble",973:"cliff, drop, drop-off",974:"coral reef",975:"geyser",976:"lakeside, lakeshore",977:"promontory, headland, head, foreland",978:"sandbar, sand bar",979:"seashore, coast, seacoast, sea-coast",980:"valley, vale",981:"volcano",982:"ballplayer, baseball player",983:"groom, bridegroom",984:"scuba diver",985:"rapeseed",986:"daisy",987:"yellow lady's slipper, yellow lady-slipper, Cypripedium"+" calceolus, Cypripedium parviflorum",988:"corn",989:"acorn",990:"hip, rose hip, rosehip",991:"buckeye, horse chestnut, conker",992:"coral fungus",993:"agaric",994:"gyromitra",995:"stinkhorn, carrion fungus",996:"earthstar",997:"hen-of-the-woods, hen of the woods, Polyporus"+" frondosus, Grifola frondosa",998:"bolete",999:"ear, spike, capitulum",1e3:"toilet tissue, toilet paper, bathroom tissue"}},{}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var mobilenet_1=require("./mobilenet");exports.MobileNet=mobilenet_1.MobileNet},{"./mobilenet":3}],3:[function(require,module,exports){(function(global){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function sent(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_){try{if(f=1,y&&(t=y[op[0]&2?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[0,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var deeplearn_1=typeof window!=="undefined"?window["dl"]:typeof global!=="undefined"?global["dl"]:null;var model_util=require("../util");var imagenet_classes_1=require("./imagenet_classes");var GOOGLE_CLOUD_STORAGE_DIR="https://storage.googleapis.com/learnjs-data/checkpoint_zoo/";var MobileNet=function(){function MobileNet(math){deeplearn_1=ml5.dl;this.clases=imagenet_classes_1;this.math=math;this.PREPROCESS_DIVISOR=deeplearn_1.Scalar.new(255/2);this.ONE=deeplearn_1.Scalar.new(1)}MobileNet.prototype.load=function(){return __awaiter(this,void 0,void 0,function(){var checkpointLoader,_a;return __generator(this,function(_b){switch(_b.label){case 0:checkpointLoader=new deeplearn_1.CheckpointLoader(GOOGLE_CLOUD_STORAGE_DIR+"mobilenet_v1_1.0_224/");_a=this;return[4,checkpointLoader.getAllVariables()];case 1:_a.variables=_b.sent();return[2]}})})};MobileNet.prototype.predict=function(input){var _this=this;var netout=this.math.scope(function(keep){var preprocessedInput=_this.math.subtract(_this.math.arrayDividedByScalar(input,_this.PREPROCESS_DIVISOR),_this.ONE);var x1=_this.convBlock(preprocessedInput,[2,2]);var x2=_this.depthwiseConvBlock(x1,[1,1],1);var x3=_this.depthwiseConvBlock(x2,[2,2],2);var x4=_this.depthwiseConvBlock(x3,[1,1],3);var x5=_this.depthwiseConvBlock(x4,[2,2],4);var x6=_this.depthwiseConvBlock(x5,[1,1],5);var x7=_this.depthwiseConvBlock(x6,[2,2],6);var x8=_this.depthwiseConvBlock(x7,[1,1],7);var x9=_this.depthwiseConvBlock(x8,[1,1],8);var x10=_this.depthwiseConvBlock(x9,[1,1],9);var x11=_this.depthwiseConvBlock(x10,[1,1],10);var x12=_this.depthwiseConvBlock(x11,[1,1],11);var x13=_this.depthwiseConvBlock(x12,[2,2],12);var x14=_this.depthwiseConvBlock(x13,[1,1],13);var x15=_this.math.avgPool(x14,x14.shape[0],1,0);var x16=_this.math.conv2d(x15,_this.variables["MobilenetV1/Logits/Conv2d_1c_1x1/weights"],_this.variables["MobilenetV1/Logits/Conv2d_1c_1x1/biases"],1,"same");return x16.as1D()});return netout};MobileNet.prototype.convBlock=function(inputs,strides){var convPadding="MobilenetV1/Conv2d_0";var x1=this.math.conv2d(inputs,this.variables[convPadding+"/weights"],null,strides,"same");var x2=this.math.batchNormalization3D(x1,this.variables[convPadding+"/BatchNorm/moving_mean"],this.variables[convPadding+"/BatchNorm/moving_variance"],.001,this.variables[convPadding+"/BatchNorm/gamma"],this.variables[convPadding+"/BatchNorm/beta"]);return this.math.clip(x2,0,6)};MobileNet.prototype.depthwiseConvBlock=function(inputs,strides,blockID){var dwPadding="MobilenetV1/Conv2d_"+String(blockID)+"_depthwise";var pwPadding="MobilenetV1/Conv2d_"+String(blockID)+"_pointwise";var x1=this.math.depthwiseConv2D(inputs,this.variables[dwPadding+"/depthwise_weights"],strides,"same");var x2=this.math.batchNormalization3D(x1,this.variables[dwPadding+"/BatchNorm/moving_mean"],this.variables[dwPadding+"/BatchNorm/moving_variance"],.001,this.variables[dwPadding+"/BatchNorm/gamma"],this.variables[dwPadding+"/BatchNorm/beta"]);var x3=this.math.clip(x2,0,6);var x4=this.math.conv2d(x3,this.variables[pwPadding+"/weights"],null,[1,1],"same");var x5=this.math.batchNormalization3D(x4,this.variables[pwPadding+"/BatchNorm/moving_mean"],this.variables[pwPadding+"/BatchNorm/moving_variance"],.001,this.variables[pwPadding+"/BatchNorm/gamma"],this.variables[pwPadding+"/BatchNorm/beta"]);return this.math.clip(x5,0,6)};MobileNet.prototype.getTopKClasses=function(logits,topK){return __awaiter(this,void 0,void 0,function(){var predictions,topk,_a,_b,topkIndices,topkValues,topClassesToProbability,i;return __generator(this,function(_c){switch(_c.label){case 0:predictions=this.math.softmax(logits).asType("float32");_b=(_a=model_util).topK;return[4,predictions.data()];case 1:topk=_b.apply(_a,[_c.sent(),topK]);topkIndices=topk.indices;topkValues=topk.values;topClassesToProbability={};for(i=0;i<topkIndices.length;i++){topClassesToProbability[imagenet_classes_1.IMAGENET_CLASSES[topkIndices[i]]]=topkValues[i]}return[2,topClassesToProbability]}})})};MobileNet.prototype.dispose=function(){for(var varName in this.variables){this.variables[varName].dispose()}};return MobileNet}();exports.MobileNet=MobileNet}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../util":4,"./imagenet_classes":1}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function topK(values,k){var valuesAndIndices=[];for(var i=0;i<values.length;i++){valuesAndIndices.push({value:values[i],index:i})}valuesAndIndices.sort(function(a,b){return b.value-a.value});var topkValues=new Float32Array(k);var topkIndices=new Int32Array(k);for(var i=0;i<k;i++){topkValues[i]=valuesAndIndices[i].value;topkIndices[i]=valuesAndIndices[i].index}return{values:topkValues,indices:topkIndices}}exports.topK=topK},{}]},{},[2])(2)})}).call(exports,__webpack_require__(69))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _deeplearn=__webpack_require__(27);var _deeplearnKnnImageClassifier=__webpack_require__(440);function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}}return step("next")})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var KNNImageClassifier=function(){function KNNImageClassifier(callback,numClasses,knnKValue){var _this=this;_classCallCheck(this,KNNImageClassifier);this.ready=false;this.hasAnyTrainedClass=false;this.predicting=false;this.knnKValue=0||knnKValue;this.numClasses=15||numClasses;this.math=_deeplearn.ENV.math;this.classifier=new _deeplearnKnnImageClassifier.KNNImageClassifier(this.numClasses,this.knnKValue,this.math);KNNImageClassifier.loadModel(this.classifier).then(function(){_this.ready=true;callback()})}_createClass(KNNImageClassifier,[{key:"addImage",value:function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(input,index){var _this2=this;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!this.ready){_context2.next=4;break}this.predicting=false;_context2.next=4;return this.math.scope(_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var image;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:image=_deeplearn.Array3D.fromPixels(input);_this2.classifier.addImage(image,index);_this2.hasAnyTrainedClass=true;case 3:case"end":return _context.stop()}}},_callee,_this2)})));case 4:case"end":return _context2.stop()}}},_callee2,this)}));function addImage(_x,_x2){return _ref.apply(this,arguments)}return addImage}()},{key:"predict",value:function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(input,callback){var _this3=this;return regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!(this.ready&&this.hasAnyTrainedClass)){_context4.next=3;break}_context4.next=3;return this.math.scope(_asyncToGenerator(regeneratorRuntime.mark(function _callee3(){var image,results;return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_this3.predicting=true;image=_deeplearn.Array3D.fromPixels(input);_context3.next=4;return _this3.classifier.predictClass(image);case 4:results=_context3.sent;callback(results);case 6:case"end":return _context3.stop()}}},_callee3,_this3)})));case 3:case"end":return _context4.stop()}}},_callee4,this)}));function predict(_x3,_x4){return _ref3.apply(this,arguments)}return predict}()},{key:"getClassExampleCount",value:function getClassExampleCount(){if(this.ready){return this.classifier.getClassExampleCount()}return null}},{key:"clearClass",value:function clearClass(classIndex){if(this.ready&&this.hasAnyTrainedClass){this.classifier.clearClass(classIndex)}}}],[{key:"loadModel",value:function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark(function _callee5(model){return regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return model.load();case 2:case"end":return _context5.stop()}}},_callee5,this)}));function loadModel(_x5){return _ref5.apply(this,arguments)}return loadModel}()}]);return KNNImageClassifier}();exports.default=KNNImageClassifier},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var knn_image_classifier_1=__webpack_require__(441);exports.KNNImageClassifier=knn_image_classifier_1.KNNImageClassifier},function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=y[op[0]&2?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[0,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var deeplearn_1=__webpack_require__(27);var deeplearn_squeezenet_1=__webpack_require__(161);var model_util=__webpack_require__(442);var KNNImageClassifier=function(){function KNNImageClassifier(numClasses,k,math){this.numClasses=numClasses;this.k=k;this.math=math;this.classLogitsMatrices=[];this.classExampleCount=[];this.varsLoaded=false;this.squashLogitsDenominator=deeplearn_1.Scalar.new(300);for(var i=0;i<this.numClasses;i++){this.classLogitsMatrices.push(null);this.classExampleCount.push(0)}this.squeezeNet=new deeplearn_squeezenet_1.SqueezeNet(this.math)}KNNImageClassifier.prototype.load=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.squeezeNet.load()];case 1:_a.sent();this.varsLoaded=true;return[2]}})})};KNNImageClassifier.prototype.clearClass=function(classIndex){if(classIndex>=this.numClasses){console.log("Cannot clear invalid class ${classIndex}");return}this.classLogitsMatrices[classIndex]=null;this.classExampleCount[classIndex]=0;this.clearTrainLogitsMatrix()};KNNImageClassifier.prototype.addImage=function(image,classIndex){var _this=this;if(!this.varsLoaded){console.warn("Cannot add images until vars have been loaded.");return}if(classIndex>=this.numClasses){console.warn("Cannot add to invalid class ${classIndex}")}this.clearTrainLogitsMatrix();this.math.scope(function(keep,track){var logits=_this.squeezeNet.predict(image);var imageLogits=_this.normalizeVector(logits);var logitsSize=imageLogits.shape[0];if(_this.classLogitsMatrices[classIndex]==null){_this.classLogitsMatrices[classIndex]=imageLogits.as2D(1,logitsSize)}else{var newTrainLogitsMatrix=_this.math.concat2D(_this.classLogitsMatrices[classIndex].as2D(_this.classExampleCount[classIndex],logitsSize),imageLogits.as2D(1,logitsSize),0);_this.classLogitsMatrices[classIndex].dispose();_this.classLogitsMatrices[classIndex]=newTrainLogitsMatrix}keep(_this.classLogitsMatrices[classIndex]);_this.classExampleCount[classIndex]++})};KNNImageClassifier.prototype.predict=function(image){var _this=this;if(!this.varsLoaded){throw new Error("Cannot predict until vars have been loaded.")}return this.math.scope(function(keep){var logits=_this.squeezeNet.predict(image);var imageLogits=_this.normalizeVector(logits);var logitsSize=imageLogits.shape[0];if(_this.trainLogitsMatrix==null){var newTrainLogitsMatrix=null;for(var i=0;i<_this.numClasses;i++){newTrainLogitsMatrix=_this.concatWithNulls(newTrainLogitsMatrix,_this.classLogitsMatrices[i])}_this.trainLogitsMatrix=newTrainLogitsMatrix}if(_this.trainLogitsMatrix==null){console.warn("Cannot predict without providing training images.");return null}keep(_this.trainLogitsMatrix);var numExamples=_this.getNumExamples();return _this.math.matMul(_this.trainLogitsMatrix.as2D(numExamples,logitsSize),imageLogits.as2D(logitsSize,1)).as1D()})};KNNImageClassifier.prototype.predictClass=function(image){return __awaiter(this,void 0,void 0,function(){var imageClass,confidences,knn,numExamples,kVal,topK,_a,_b,topKIndices,indicesForClasses,topKCountsForClasses,i,num,i,classForEntry,topConfidence,i,probability;return __generator(this,function(_c){switch(_c.label){case 0:imageClass=-1;confidences=new Array(this.numClasses);if(!this.varsLoaded){throw new Error("Cannot predict until vars have been loaded.")}knn=this.predict(image).asType("float32");numExamples=this.getNumExamples();kVal=Math.min(this.k,numExamples);_b=(_a=model_util).topK;return[4,knn.data()];case 1:topK=_b.apply(_a,[_c.sent(),kVal]);knn.dispose();topKIndices=topK.indices;if(topKIndices==null){return[2,{classIndex:imageClass,confidences:confidences}]}indicesForClasses=[];topKCountsForClasses=[];for(i=0;i<this.numClasses;i++){topKCountsForClasses.push(0);num=this.classExampleCount[i];if(i>0){num+=indicesForClasses[i-1]}indicesForClasses.push(num)}for(i=0;i<topKIndices.length;i++){for(classForEntry=0;classForEntry<indicesForClasses.length;classForEntry++){if(topKIndices[i]<indicesForClasses[classForEntry]){topKCountsForClasses[classForEntry]++;break}}}topConfidence=0;for(i=0;i<this.numClasses;i++){probability=topKCountsForClasses[i]/kVal;if(probability>topConfidence){topConfidence=probability;imageClass=i}confidences[i]=probability}return[2,{classIndex:imageClass,confidences:confidences}]}})})};KNNImageClassifier.prototype.getClassExampleCount=function(){return this.classExampleCount};KNNImageClassifier.prototype.clearTrainLogitsMatrix=function(){if(this.trainLogitsMatrix!=null){this.trainLogitsMatrix.dispose();this.trainLogitsMatrix=null}};KNNImageClassifier.prototype.concatWithNulls=function(ndarray1,ndarray2){if(ndarray1==null&&ndarray2==null){return null}if(ndarray1==null){return this.math.clone(ndarray2)}else if(ndarray2===null){return this.math.clone(ndarray1)}return this.math.concat2D(ndarray1,ndarray2,0)};KNNImageClassifier.prototype.normalizeVector=function(vec){var squashedVec=this.math.divide(vec,this.squashLogitsDenominator);var squared=this.math.multiplyStrict(squashedVec,squashedVec);var sum=this.math.sum(squared);var sqrtSum=this.math.sqrt(sum);return this.math.divide(squashedVec,sqrtSum)};KNNImageClassifier.prototype.getNumExamples=function(){var total=0;for(var i=0;i<this.classExampleCount.length;i++){total+=this.classExampleCount[i]}return total};KNNImageClassifier.prototype.dispose=function(){this.squeezeNet.dispose();this.clearTrainLogitsMatrix();this.classLogitsMatrices.forEach(function(classLogitsMatrix){return classLogitsMatrix.dispose()});this.squashLogitsDenominator.dispose()};return KNNImageClassifier}();exports.KNNImageClassifier=KNNImageClassifier},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function topK(values,k){var valuesAndIndices=[];for(var i=0;i<values.length;i++){valuesAndIndices.push({value:values[i],index:i})}valuesAndIndices.sort(function(a,b){return b.value-a.value});var topkValues=new Float32Array(k);var topkIndices=new Int32Array(k);for(var i=0;i<k;i++){topkValues[i]=valuesAndIndices[i].value;topkIndices[i]=valuesAndIndices[i].index}return{values:topkValues,indices:topkIndices}}exports.topK=topK},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _deeplearn=__webpack_require__(27);var _sample=__webpack_require__(444);var _sample2=_interopRequireDefault(_sample);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}}return step("next")})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var regexCell=/cell_[0-9]|lstm_[0-9]/gi;var regexWeights=/weights|weight|kernel|kernels|w/gi;var regexFullyConnected=/softmax/gi;var LSTMGenerator=function(){function LSTMGenerator(model){_classCallCheck(this,LSTMGenerator);this.ready=false;this.model={};this.math=_deeplearn.ENV.math;this.cellsAmount=0;this.vocab={};this.vocabSize=0;this.defaults={seed:"a",length:20,temperature:.5};this.loadVocab(model);this.loadCheckpoints(model)}_createClass(LSTMGenerator,[{key:"loadCheckpoints",value:function loadCheckpoints(path){var _this=this;var reader=new _deeplearn.CheckpointLoader(path);reader.getAllVariables().then(function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(vars){return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:Object.keys(vars).forEach(function(key){if(key.match(regexCell)){if(key.match(regexWeights)){_this.model["Kernel_"+key.match(/[0-9]/)[0]]=vars[key];_this.cellsAmount+=1}else{_this.model["Bias_"+key.match(/[0-9]/)[0]]=vars[key]}}else if(key.match(regexFullyConnected)){if(key.match(regexWeights)){_this.model.fullyConnectedWeights=vars[key]}else{_this.model.fullyConnectedBiases=vars[key]}}else{_this.model[key]=vars[key]}});_this.ready=true;case 2:case"end":return _context.stop()}}},_callee,_this)}));return function(_x){return _ref.apply(this,arguments)}}())}},{key:"loadVocab",value:function loadVocab(file){var _this2=this;fetch(file+"/vocab.json").then(function(response){return response.json()}).then(function(json){_this2.vocab=json;_this2.vocabSize=Object.keys(json).length}).catch(function(error){console.log("There has been a problem loading the vocab: "+error.message)})}},{key:"generate",value:function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(options,callback){var _this3=this;var seed,length,temperature,results,generated;return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:seed=options.seed||this.defaults.seed;length=options.length||this.defaults.length;temperature=options.temperature||this.defaults.temperature;results=[];if(!this.ready){_context3.next=10;break}_context3.next=7;return this.math.scope(_asyncToGenerator(regeneratorRuntime.mark(function _callee2(){var forgetBias,LSTMCells,c,h,i,userInput,encodedInput,current,input,_i,onehot,output,embedded,outputH,weightedResult,logits,divided,probabilities,normalized,sampledResult;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:forgetBias=_deeplearn.Scalar.new(1);LSTMCells=[];c=[];h=[];for(i=0;i<_this3.cellsAmount;i+=1){LSTMCells.push(_this3.math.basicLSTMCell.bind(_this3.math,forgetBias,_this3.model["Kernel_"+i],_this3.model["Bias_"+i]));c.push(_deeplearn.Array2D.zeros([1,_this3.model["Bias_"+i].shape[0]/4]));h.push(_deeplearn.Array2D.zeros([1,_this3.model["Bias_"+i].shape[0]/4]))}userInput=Array.from(seed);encodedInput=[];userInput.forEach(function(char,ind){if(ind<100){encodedInput.push(_this3.vocab[char])}});current=0;input=encodedInput[current];_i=0;case 11:if(!(_i<userInput.length+length)){_context2.next=33;break}onehot=_deeplearn.Array2D.zeros([1,_this3.vocabSize]);onehot.set(1,0,input);output=void 0;if(_this3.model.embedding){embedded=_this3.math.matMul(onehot,_this3.model.embedding);output=_this3.math.multiRNNCell(LSTMCells,embedded,c,h)}else{output=_this3.math.multiRNNCell(LSTMCells,onehot,c,h)}c=output[0];h=output[1];outputH=h[1];weightedResult=_this3.math.matMul(outputH,_this3.model.fullyConnectedWeights);logits=_this3.math.add(weightedResult,_this3.model.fullyConnectedBiases);divided=_this3.math.arrayDividedByScalar(logits,_deeplearn.Scalar.new(temperature));_context2.next=24;return _this3.math.exp(divided);case 24:probabilities=_context2.sent;_context2.next=27;return _this3.math.divide(probabilities,_this3.math.sum(probabilities)).dataSync();case 27:normalized=_context2.sent;sampledResult=(0,_sample2.default)(normalized);if(userInput.length>current){input=encodedInput[current];current+=1}else{input=sampledResult;results.push(sampledResult)}case 30:_i+=1;_context2.next=11;break;case 33:case"end":return _context2.stop()}}},_callee2,_this3)})));case 7:generated="";results.forEach(function(c){var mapped=Object.keys(_this3.vocab).find(function(key){return _this3.vocab[key]===c});if(mapped){generated+=mapped}});callback({generated:generated});case 10:case"end":return _context3.stop()}}},_callee3,this)}));function generate(_x2,_x3){return _ref2.apply(this,arguments)}return generate}()}]);return LSTMGenerator}();exports.default=LSTMGenerator},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var sampleFromDistribution=function sampleFromDistribution(input){var randomValue=Math.random();var sum=0;var result=void 0;for(var j=0;j<input.length;j+=1){sum+=input[j];if(randomValue<sum){result=j;break}}return result};exports.default=sampleFromDistribution},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _deeplearn=__webpack_require__(27);function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}}return step("next")})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var NeuralNetwork=function(){function NeuralNetwork(inputNodes,hiddenNodes,outputNodes){var learningRate=arguments.length>3&&arguments[3]!==undefined?arguments[3]:.1;_classCallCheck(this,NeuralNetwork);this.math=_deeplearn.ENV.math;this.iNodes=inputNodes;this.hNodes=hiddenNodes;this.oNodes=outputNodes;this.wih=_deeplearn.Array2D.randNormal([this.hNodes,this.iNodes]);this.who=_deeplearn.Array2D.randNormal([this.oNodes,this.hNodes]);this.learningRate=_deeplearn.Scalar.new(learningRate)}_createClass(NeuralNetwork,[{key:"train",value:function train(inputsArray,targetsArray){var _this=this;this.math.scope(function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(keep){var inputs,targets,hiddenInputs,hiddenOutputs,finalInputs,finalOutputs,outputErrors,hiddenErrors;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:inputs=_this.math.transpose(_deeplearn.Array2D.new([1,inputsArray.length],inputsArray));targets=_this.math.transpose(_deeplearn.Array2D.new([1,targetsArray.length],targetsArray));hiddenInputs=_this.math.matMul(_this.wih,inputs);hiddenOutputs=_this.math.sigmoid(hiddenInputs);finalInputs=_this.math.matMul(_this.who,hiddenOutputs);finalOutputs=_this.math.sigmoid(finalInputs);outputErrors=_this.math.subtract(targets,finalOutputs);hiddenErrors=_this.math.matMul(_this.math.transpose(_this.who),outputErrors);_context.next=10;return keep(_this.math.add(_this.who,_this.math.multiply(_this.learningRate,_this.math.matMul(_this.math.multiply(_this.math.multiply(outputErrors,finalOutputs),_this.math.subtract(_deeplearn.Scalar.new(1),finalOutputs)),_this.math.transpose(hiddenOutputs)))));case 10:_this.who=_context.sent;_context.next=13;return keep(_this.math.add(_this.wih,_this.math.multiply(_this.learningRate,_this.math.matMul(_this.math.multiply(_this.math.multiply(hiddenErrors,hiddenOutputs),_this.math.subtract(_deeplearn.Scalar.new(1),hiddenOutputs)),_this.math.transpose(inputs)))));case 13:_this.wih=_context.sent;case 14:case"end":return _context.stop()}}},_callee,_this)}));return function(_x2){return _ref.apply(this,arguments)}}())}},{key:"query",value:function query(inputsArray){var _this2=this;return this.math.scope(function(){var inputs=_this2.math.transpose(_deeplearn.Array2D.new([1,inputsArray.length],inputsArray));var hiddenInputs=_this2.math.matMul(_this2.wih,inputs);var hiddenOutputs=_this2.math.sigmoid(hiddenInputs);var finalInputs=_this2.math.matMul(_this2.who,hiddenOutputs);var finalOutputs=_this2.math.sigmoid(finalInputs);var argMax=_this2.math.argMax(finalOutputs).getValues()[0];var results=finalOutputs.getValues();return{argMax:argMax,results:Array.from(results)}})}}]);return NeuralNetwork}();exports.default=NeuralNetwork},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _deeplearn=__webpack_require__(27);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Word2Vec=function(){function Word2Vec(vectors){_classCallCheck(this,Word2Vec);this.ready=false;this.model={};this.modelSize=0;this.math=_deeplearn.ENV.math;this.loadVectors(vectors)}_createClass(Word2Vec,[{key:"loadVectors",value:function loadVectors(file){var _this=this;fetch(file).then(function(response){return response.json()}).then(function(json){Object.keys(json.vectors).forEach(function(word){_this.model[word]=_deeplearn.Array1D.new(json.vectors[word])});_this.modelSize=Object.keys(json).length}).catch(function(error){console.log("There has been a problem loading the vocab: "+error.message)})}},{key:"add",value:function add(inputs){var max=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var sum=Word2Vec.addOrSubtract(this.model,inputs,"ADD");return Word2Vec.nearest(this.model,sum,inputs.length,inputs.length+max)}},{key:"subtract",value:function subtract(inputs){var max=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var subtraction=Word2Vec.addOrSubtract(this.model,inputs,"SUBTRACT");return Word2Vec.nearest(this.model,subtraction,inputs.length,inputs.length+max)}},{key:"average",value:function average(inputs){var max=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var sum=Word2Vec.addOrSubtract(this.model,inputs,"ADD");var avg=this.math.arrayDividedByScalar(sum,_deeplearn.Scalar.new(inputs.length));return Word2Vec.nearest(this.model,avg,inputs.length,inputs.length+max)}},{key:"nearest",value:function nearest(input){var max=arguments.length>1&&arguments[1]!==undefined?arguments[1]:10;var vector=this.model[input];if(!vector){return null}return Word2Vec.nearest(this.model,vector,1,max)}}],[{key:"addOrSubtract",value:function addOrSubtract(model,values,operation){var vectors=[];var notFound=[];values.forEach(function(value){var vector=model[value];if(!vector){notFound.push(vector)}else{vectors.push(vector)}});if(notFound.length>0||values.length<2){return{error:"Invalid inputs",notFound:notFound,values:values}}return _deeplearn.ENV.math.scope(function(){var result=vectors[0];if(operation==="ADD"){for(var i=1;i<vectors.length;i+=1){result=_deeplearn.ENV.math.add(result,vectors[i])}}else{for(var _i=1;_i<vectors.length;_i+=1){result=_deeplearn.ENV.math.subtract(result,vectors[_i])}}return result})}},{key:"nearest",value:function nearest(model,input,start,max){var nearestVectors=[];Object.keys(model).forEach(function(vector){var distance=_deeplearn.util.distSquared(input.dataSync(),model[vector].dataSync());nearestVectors.push({vector:vector,distance:distance})});nearestVectors.sort(function(a,b){return a.distance-b.distance});return nearestVectors.slice(start,max)}}]);return Word2Vec}();exports.default=Word2Vec},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _deeplearn=__webpack_require__(27);function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}}return step("next")})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var TransformNet=function(){function TransformNet(model,callback){var _this=this;_classCallCheck(this,TransformNet);this.ready=false;this.math=_deeplearn.ENV.math;this.variableDictionary={};this.timesScalar=_deeplearn.Scalar.new(150);this.plusScalar=_deeplearn.Scalar.new(255/2);this.epsilonScalar=_deeplearn.Scalar.new(.001);this.loadCheckpoints(model).then(function(){_this.ready=true;callback()})}_createClass(TransformNet,[{key:"loadCheckpoints",value:function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(path){var checkpointLoader;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:checkpointLoader=new _deeplearn.CheckpointLoader(path);_context.next=3;return checkpointLoader.getAllVariables();case 3:this.variables=_context.sent;case 4:case"end":return _context.stop()}}},_callee,this)}));function loadCheckpoints(_x){return _ref.apply(this,arguments)}return loadCheckpoints}()},{key:"predict",value:function predict(imgElement){var _this2=this;var varName=function varName(varId){var variableName=void 0;if(varId===0){variableName="Variable"}else{variableName="Variable_"+varId}return variableName};var instanceNorm=function instanceNorm(input,varId){var _input$shape=_slicedToArray(input.shape,3),height=_input$shape[0],width=_input$shape[1],inDepth=_input$shape[2];var moments=_this2.math.moments(input,[0,1]);var mu=moments.mean;var sigmaSq=moments.variance;var shift=_this2.variables[varName(varId)];var scale=_this2.variables[varName(varId+1)];var epsilon=_this2.epsilonScalar;var normalized=_this2.math.divide(_this2.math.sub(input.asType("float32"),mu),_this2.math.sqrt(_this2.math.add(sigmaSq,epsilon)));var shifted=_this2.math.add(_this2.math.multiply(scale,normalized),shift);return shifted.as3D(height,width,inDepth)};var convLayer=function convLayer(input,strides,relu,varId){var y=_this2.math.conv2d(input,_this2.variables[varName(varId)],null,[strides,strides],"same");var y2=instanceNorm(y,varId+1);if(relu){return _this2.math.relu(y2)}return y2};var convTransposeLayer=function convTransposeLayer(input,numFilters,strides,varId){var _input$shape2=_slicedToArray(input.shape,2),height=_input$shape2[0],width=_input$shape2[1];var newRows=height*strides;var newCols=width*strides;var newShape=[newRows,newCols,numFilters];var y=_this2.math.conv2dTranspose(input,_this2.variables[varName(varId)],newShape,[strides,strides],"same");var y2=instanceNorm(y,varId+1);var y3=_this2.math.relu(y2);return y3};var residualBlock=function residualBlock(input,varId){var conv1=convLayer(input,1,true,varId);var conv2=convLayer(conv1,1,false,varId+3);return _this2.math.addStrict(conv2,input)};var preprocessedInput=_deeplearn.Array3D.fromPixels(imgElement);var img=this.math.scope(function(){var conv1=convLayer(preprocessedInput,1,true,0);var conv2=convLayer(conv1,2,true,3);var conv3=convLayer(conv2,2,true,6);var resid1=residualBlock(conv3,9);var resid2=residualBlock(resid1,15);var resid3=residualBlock(resid2,21);var resid4=residualBlock(resid3,27);var resid5=residualBlock(resid4,33);var convT1=convTransposeLayer(resid5,64,2,39);var convT2=convTransposeLayer(convT1,32,2,42);var convT3=convLayer(convT2,1,false,45);var outTanh=_this2.math.tanh(convT3);var scaled=_this2.math.scalarTimesArray(_this2.timesScalar,outTanh);var shifted=_this2.math.scalarPlusArray(_this2.plusScalar,scaled);var clamped=_this2.math.clip(shifted,0,255);var normalized=_this2.math.divide(clamped,_deeplearn.Scalar.new(255));return normalized});return img}}]);return TransformNet}();exports.default=TransformNet},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _deeplearn=__webpack_require__(27);var _yolo_mobilenet=__webpack_require__(449);var _IMAGENET_CLASSES=__webpack_require__(451);var _IMAGENET_CLASSES2=_interopRequireDefault(_IMAGENET_CLASSES);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}}return step("next")})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Yolo=function(){function Yolo(callback){var _this=this;var canvas=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;_classCallCheck(this,Yolo);this.ready=false;this.math=_deeplearn.ENV.math;this.canvas=canvas;this.yoloMobileNet=new _yolo_mobilenet.YoloMobileNetDetection(this.math);this.yoloMobileNet.load().then(function(){_this.ready=true;callback()})}_createClass(Yolo,[{key:"predict",value:function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(input,callback){var pixels,result,BoundingBoxes,width,height,boxes;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!this.ready){_context.next=11;break}pixels=_deeplearn.Array3D.fromPixels(input);_context.next=4;return this.yoloMobileNet.predict(pixels);case 4:result=_context.sent;_context.next=7;return this.yoloMobileNet.interpretNetout(result);case 7:BoundingBoxes=_context.sent;if(this.canvas){width=this.canvas.width;height=this.canvas.height;boxes=[];BoundingBoxes.forEach(function(box){var prob=box.getMaxProb().toFixed(2).toString();var boxColor=box.getColor();var color=boxColor.substring(4,boxColor.length-1).replace(/ /g,"").split(",");var x=(box.x-box.w/2)*width;var y=(box.y-box.h/2)*height;var w=box.w*width;var h=box.h*height;var index=box.index;var label=_IMAGENET_CLASSES2.default[box.index];boxes.push({color:color,label:label,prob:prob,x:x,y:y,w:w,h:h,index:index})});callback({BoundingBoxes:BoundingBoxes,boxes:boxes})}else{callback({BoundingBoxes:BoundingBoxes})}_context.next=12;break;case 11:callback({result:[],boxes:[]});case 12:case"end":return _context.stop()}}},_callee,this)}));function predict(_x2,_x3){return _ref.apply(this,arguments)}return predict}()}]);return Yolo}();exports.default=Yolo},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.YoloMobileNetDetection=undefined;var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _deeplearn=__webpack_require__(27);var _mobilenet_utils=__webpack_require__(450);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var __awaiter=undefined&&undefined.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var GOOGLE_CLOUD_STORAGE_DIR="https://storage.googleapis.com/learnjs-data/checkpoint_zoo/";var YoloMobileNetDetection=exports.YoloMobileNetDetection=function(){function YoloMobileNetDetection(math){_classCallCheck(this,YoloMobileNetDetection);this.math=math;this.PREPROCESS_DIVISOR=_deeplearn.Scalar.new(255/2);this.ONE=_deeplearn.Scalar.new(1);this.THRESHOLD=.3;this.THRESHOLD_SCALAR=_deeplearn.Scalar.new(this.THRESHOLD);this.ANCHORS=[.57273,.677385,1.87446,2.06253,3.33843,5.47434,7.88282,3.52778,9.77052,9.16828]}_createClass(YoloMobileNetDetection,[{key:"load",value:function load(){return __awaiter(this,void 0,void 0,regeneratorRuntime.mark(function _callee(){var checkpointLoader;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:checkpointLoader=new _deeplearn.CheckpointLoader(GOOGLE_CLOUD_STORAGE_DIR+"yolo_mobilenet_v1_1.0_416/");_context.next=3;return checkpointLoader.getAllVariables();case 3:this.variables=_context.sent;case 4:case"end":return _context.stop()}}},_callee,this)}))}},{key:"predict",value:function predict(input){var _this=this;var netout=this.math.scope(function(keep){var preprocessedInput=_this.math.subtract(_this.math.arrayDividedByScalar(input,_this.PREPROCESS_DIVISOR),_this.ONE);var x1=_this.convBlock(preprocessedInput,[2,2]);var x2=_this.depthwiseConvBlock(x1,[1,1],1);var x3=_this.depthwiseConvBlock(x2,[2,2],2);var x4=_this.depthwiseConvBlock(x3,[1,1],3);var x5=_this.depthwiseConvBlock(x4,[2,2],4);var x6=_this.depthwiseConvBlock(x5,[1,1],5);var x7=_this.depthwiseConvBlock(x6,[2,2],6);var x8=_this.depthwiseConvBlock(x7,[1,1],7);var x9=_this.depthwiseConvBlock(x8,[1,1],8);var x10=_this.depthwiseConvBlock(x9,[1,1],9);var x11=_this.depthwiseConvBlock(x10,[1,1],10);var x12=_this.depthwiseConvBlock(x11,[1,1],11);var x13=_this.depthwiseConvBlock(x12,[2,2],12);var x14=_this.depthwiseConvBlock(x13,[1,1],13);var x15=_this.math.conv2d(x14,_this.variables["conv_23/kernel"],_this.variables["conv_23/bias"],[1,1],"same");return x15.as4D(13,13,5,6)});return netout}},{key:"convBlock",value:function convBlock(inputs,strides){var x1=this.math.conv2d(inputs,this.variables["conv1/kernel"],null,strides,"same");var x2=this.math.batchNormalization3D(x1,this.variables["conv1_bn/moving_mean"],this.variables["conv1_bn/moving_variance"],.001,this.variables["conv1_bn/gamma"],this.variables["conv1_bn/beta"]);return this.math.clip(x2,0,6)}},{key:"depthwiseConvBlock",value:function depthwiseConvBlock(inputs,strides,blockID){var dwPadding="conv_dw_"+String(blockID)+"";var pwPadding="conv_pw_"+String(blockID)+"";var x1=this.math.depthwiseConv2D(inputs,this.variables[dwPadding+"/depthwise_kernel"],strides,"same");var x2=this.math.batchNormalization3D(x1,this.variables[dwPadding+"_bn/moving_mean"],this.variables[dwPadding+"_bn/moving_variance"],.001,this.variables[dwPadding+"_bn/gamma"],this.variables[dwPadding+"_bn/beta"]);var x3=this.math.clip(x2,0,6);var x4=this.math.conv2d(x3,this.variables[pwPadding+"/kernel"],null,[1,1],"same");var x5=this.math.batchNormalization3D(x4,this.variables[pwPadding+"_bn/moving_mean"],this.variables[pwPadding+"_bn/moving_variance"],.001,this.variables[pwPadding+"_bn/gamma"],this.variables[pwPadding+"_bn/beta"]);return this.math.clip(x5,0,6)}},{key:"interpretNetout",value:function interpretNetout(netout){return __awaiter(this,void 0,void 0,regeneratorRuntime.mark(function _callee2(){var GRID_H,GRID_W,BOX,CLASS,boxes,confidence,classes,mask,objectLikelihood,objectLikelihoodValues,i,_objectLikelihood$ind,_objectLikelihood$ind2,row,col,box,conf,probs,xywh,x,y,w,h,_loop,cls,likelyBoxes,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,_box;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:GRID_H=netout.shape[0];GRID_W=netout.shape[1];BOX=netout.shape[2];CLASS=netout.shape[3]-5;boxes=[];confidence=this.math.sigmoid(this.math.slice4D(netout,[0,0,0,4],[GRID_H,GRID_W,BOX,1]));classes=this.math.softmax(this.math.slice4D(netout,[0,0,0,5],[GRID_H,GRID_W,BOX,CLASS]));classes=this.math.multiply(classes,confidence);mask=this.math.step(this.math.relu(this.math.subtract(classes,this.THRESHOLD_SCALAR)));classes=this.math.multiply(classes,mask);objectLikelihood=this.math.sum(classes,3);_context2.next=13;return objectLikelihood.data();case 13:objectLikelihoodValues=_context2.sent;i=0;case 15:if(!(i<objectLikelihoodValues.length)){_context2.next=37;break}if(!(objectLikelihoodValues[i]>0)){_context2.next=34;break}_objectLikelihood$ind=objectLikelihood.indexToLoc(i),_objectLikelihood$ind2=_slicedToArray(_objectLikelihood$ind,3),row=_objectLikelihood$ind2[0],col=_objectLikelihood$ind2[1],box=_objectLikelihood$ind2[2];conf=confidence.get(row,col,box,0);_context2.next=21;return this.math.slice4D(classes,[row,col,box,0],[1,1,1,CLASS]).data();case 21:probs=_context2.sent;_context2.next=24;return this.math.slice4D(netout,[row,col,box,0],[1,1,1,4]).data();case 24:xywh=_context2.sent;x=xywh[0];y=xywh[1];w=xywh[2];h=xywh[3];x=(col+this.sigmoid(x))/GRID_W;y=(row+this.sigmoid(y))/GRID_H;w=this.ANCHORS[2*box+0]*Math.exp(w)/GRID_W;h=this.ANCHORS[2*box+1]*Math.exp(h)/GRID_H;boxes.push(new _mobilenet_utils.BoundingBox(x,y,w,h,conf,probs,i));case 34:i++;_context2.next=15;break;case 37:_loop=function _loop(cls){var allProbs=boxes.map(function(box){return box.probs[cls]});var indices=new Array(allProbs.length);for(var _i=0;_i<allProbs.length;++_i){indices[_i]=_i}indices.sort(function(a,b){return allProbs[a]>allProbs[b]?1:0});for(var _i2=0;_i2<allProbs.length;_i2++){var indexI=indices[_i2];if(boxes[indexI].probs[cls]===0){continue}else{for(var j=_i2+1;j<allProbs.length;j++){var indexJ=indices[j];if(boxes[indexI].iou(boxes[indexJ])>.4){boxes[indexJ].probs[cls]=0}}}}};for(cls=0;cls<CLASS;cls++){_loop(cls)}likelyBoxes=[];_iteratorNormalCompletion=true;_didIteratorError=false;_iteratorError=undefined;_context2.prev=43;for(_iterator=boxes[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){_box=_step.value;if(_box.getMaxProb()>this.THRESHOLD){likelyBoxes.push(_box)}}_context2.next=51;break;case 47:_context2.prev=47;_context2.t0=_context2["catch"](43);_didIteratorError=true;_iteratorError=_context2.t0;case 51:_context2.prev=51;_context2.prev=52;if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}case 54:_context2.prev=54;if(!_didIteratorError){_context2.next=57;break}throw _iteratorError;case 57:return _context2.finish(54);case 58:return _context2.finish(51);case 59:return _context2.abrupt("return",likelyBoxes);case 60:case"end":return _context2.stop()}}},_callee2,this,[[43,47,51,59],[52,,54,58]])}))}},{key:"sigmoid",value:function sigmoid(x){return 1/(1+Math.exp(-x))}},{key:"dispose",value:function dispose(){for(var varName in this.variables){this.variables[varName].dispose()}}}]);return YoloMobileNetDetection}()},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var BoundingBox=exports.BoundingBox=function(){function BoundingBox(x,y,w,h,conf,probs,index){_classCallCheck(this,BoundingBox);this.maxProb=-1;this.maxIndx=-1;this.x=x;this.y=y;this.w=w;this.h=h;this.c=conf;this.probs=probs;this.index=index}_createClass(BoundingBox,[{key:"getMaxProb",value:function getMaxProb(){if(this.maxProb===-1){this.maxProb=this.probs.reduce(function(a,b){return Math.max(a,b)})}return this.maxProb}},{key:"getLabel",value:function getLabel(){if(this.maxIndx===-1){this.maxIndx=this.probs.indexOf(this.getMaxProb())}return BoundingBox.LABELS[this.maxIndx]}},{key:"getColor",value:function getColor(){if(this.maxIndx===-1){this.maxIndx=this.probs.indexOf(this.getMaxProb())}return BoundingBox.COLORS[this.maxIndx]}},{key:"iou",value:function iou(box){var intersection=this.intersect(box);var union=this.w*this.h+box.w*box.h-intersection;return intersection/union}},{key:"intersect",value:function intersect(box){var width=this.overlap([this.x-this.w/2,this.x+this.w/2],[box.x-box.w/2,box.x+box.w/2]);var height=this.overlap([this.y-this.h/2,this.y+this.h/2],[box.y-box.h/2,box.y+box.h/2]);return width*height}},{key:"overlap",value:function overlap(intervalA,intervalB){var _intervalA=_slicedToArray(intervalA,2),x1=_intervalA[0],x2=_intervalA[1];var _intervalB=_slicedToArray(intervalB,2),x3=_intervalB[0],x4=_intervalB[1];if(x3<x1){if(x4<x1){return 0}else{return Math.min(x2,x4)-x1}}else{if(x2<x3){return 0}else{return Math.min(x2,x4)-x3}}}}]);return BoundingBox}();BoundingBox.LABELS=["raccoon"];BoundingBox.COLORS=["rgb(43,206,72)"]},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default={0:"background",1:"tench, Tinca tinca",2:"goldfish, Carassius auratus",3:"great white shark, white shark, man-eater,"+" man-eating shark, Carcharodon carcharias",4:"tiger shark, Galeocerdo cuvieri",5:"hammerhead, hammerhead shark",6:"electric ray, crampfish, numbfish, torpedo",7:"stingray",8:"cock",9:"hen",10:"ostrich, Struthio camelus",11:"brambling, Fringilla montifringilla",12:"goldfinch, Carduelis carduelis",13:"house finch, linnet, Carpodacus mexicanus",14:"junco, snowbird",15:"indigo bunting, indigo finch, indigo bird, Passerina cyanea",16:"robin, American robin, Turdus migratorius",17:"bulbul",18:"jay",19:"magpie",20:"chickadee",21:"water ouzel, dipper",22:"kite",23:"bald eagle, American eagle, Haliaeetus leucocephalus",24:"vulture",25:"great grey owl, great gray owl, Strix nebulosa",26:"European fire salamander, Salamandra salamandra",27:"common newt, Triturus vulgaris",28:"eft",29:"spotted salamander, Ambystoma maculatum",30:"axolotl, mud puppy, Ambystoma mexicanum",31:"bullfrog, Rana catesbeiana",32:"tree frog, tree-frog",33:"tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui",34:"loggerhead, loggerhead turtle, Caretta caretta",35:"leatherback turtle, leatherback, leathery turtle, Dermochelys coriacea",36:"mud turtle",37:"terrapin",38:"box turtle, box tortoise",39:"banded gecko",40:"common iguana, iguana, Iguana iguana",41:"American chameleon, anole, Anolis carolinensis",42:"whiptail, whiptail lizard",43:"agama",44:"frilled lizard, Chlamydosaurus kingi",45:"alligator lizard",46:"Gila monster, Heloderma suspectum",47:"green lizard, Lacerta viridis",48:"African chameleon, Chamaeleo chamaeleon",49:"Komodo dragon, Komodo lizard, dragon lizard,"+" giant lizard, Varanus komodoensis",50:"African crocodile, Nile crocodile, Crocodylus niloticus",51:"American alligator, Alligator mississipiensis",52:"triceratops",53:"thunder snake, worm snake, Carphophis amoenus",54:"ringneck snake, ring-necked snake, ring snake",55:"hognose snake, puff adder, sand viper",56:"green snake, grass snake",57:"king snake, kingsnake",58:"garter snake, grass snake",59:"water snake",60:"vine snake",61:"night snake, Hypsiglena torquata",62:"boa constrictor, Constrictor constrictor",63:"rock python, rock snake, Python sebae",64:"Indian cobra, Naja naja",65:"green mamba",66:"sea snake",67:"horned viper, cerastes, sand viper, horned asp, Cerastes cornutus",68:"diamondback, diamondback rattlesnake, Crotalus adamanteus",69:"sidewinder, horned rattlesnake, Crotalus cerastes",70:"trilobite",71:"harvestman, daddy longlegs, Phalangium opilio",72:"scorpion",73:"black and gold garden spider, Argiope aurantia",74:"barn spider, Araneus cavaticus",75:"garden spider, Aranea diademata",76:"black widow, Latrodectus mactans",77:"tarantula",78:"wolf spider, hunting spider",79:"tick",80:"centipede",81:"black grouse",82:"ptarmigan",83:"ruffed grouse, partridge, Bonasa umbellus",84:"prairie chicken, prairie grouse, prairie fowl",85:"peacock",86:"quail",87:"partridge",88:"African grey, African gray, Psittacus erithacus",89:"macaw",90:"sulphur-crested cockatoo, Kakatoe galerita, Cacatua galerita",91:"lorikeet",92:"coucal",93:"bee eater",94:"hornbill",95:"hummingbird",96:"jacamar",97:"toucan",98:"drake",99:"red-breasted merganser, Mergus serrator",100:"goose",101:"black swan, Cygnus atratus",102:"tusker",103:"echidna, spiny anteater, anteater",104:"platypus, duckbill, duckbilled platypus, duck-billed platypus,"+" Ornithorhynchus anatinus",105:"wallaby, brush kangaroo",106:"koala, koala bear, kangaroo bear, native bear, Phascolarctos cinereus",107:"wombat",108:"jelly fish",109:"sea anemone, anemone",110:"brain coral",111:"flatworm, platyhelminth",112:"nematode, nematode worm, roundworm",113:"conch",114:"snail",115:"slug",116:"sea slug, nudibranch",117:"chiton, coat-of-mail shell, sea cradle, polyplacophore",118:"chambered nautilus, pearly nautilus, nautilus",119:"Dungeness crab, Cancer magister",120:"rock crab, Cancer irroratus",121:"fiddler crab",122:"king crab, Alaska crab, Alaskan king crab, Alaska king crab,"+" Paralithodes camtschatica",123:"American lobster, Northern lobster, Maine lobster, Homarus americanus",124:"spiny lobster, langouste, rock lobster, crawfish, crayfish,"+" sea crawfish",125:"crayfish, crawfish, crawdad, crawdaddy",126:"hermit crab",127:"isopod",128:"white stork, Ciconia ciconia",129:"black stork, Ciconia nigra",130:"spoonbill",131:"flamingo",132:"little blue heron, Egretta caerulea",133:"American egret, great white heron, Egretta albus",134:"bittern",135:"crane",136:"limpkin, Aramus pictus",137:"European gallinule, Porphyrio porphyrio",138:"American coot, marsh hen, mud hen, water hen, Fulica americana",139:"bustard",140:"ruddy turnstone, Arenaria interpres",141:"red-backed sandpiper, dunlin, Erolia alpina",142:"redshank, Tringa totanus",143:"dowitcher",144:"oystercatcher, oyster catcher",145:"pelican",146:"king penguin, Aptenodytes patagonica",147:"albatross, mollymawk",148:"grey whale, gray whale, devilfish, Eschrichtius gibbosus,"+" Eschrichtius robustus",149:"killer whale, killer, orca, grampus, sea wolf, Orcinus orca",150:"dugong, Dugong dugon",151:"sea lion",152:"Chihuahua",153:"Japanese spaniel",154:"Maltese dog, Maltese terrier, Maltese",155:"Pekinese, Pekingese, Peke",156:"Shih-Tzu",157:"Blenheim spaniel",158:"papillon",159:"toy terrier",160:"Rhodesian ridgeback",161:"Afghan hound, Afghan",162:"basset, basset hound",163:"beagle",164:"bloodhound, sleuthhound",165:"bluetick",166:"black-and-tan coonhound",167:"Walker hound, Walker foxhound",168:"English foxhound",169:"redbone",170:"borzoi, Russian wolfhound",171:"Irish wolfhound",172:"Italian greyhound",173:"whippet",174:"Ibizan hound, Ibizan Podenco",175:"Norwegian elkhound, elkhound",176:"otterhound, otter hound",177:"Saluki, gazelle hound",178:"Scottish deerhound, deerhound",179:"Weimaraner",180:"Staffordshire bullterrier, Staffordshire bull terrier",181:"American Staffordshire terrier, Staffordshire terrier,"+" American pit bull terrier, pit bull terrier",182:"Bedlington terrier",183:"Border terrier",184:"Kerry blue terrier",185:"Irish terrier",186:"Norfolk terrier",187:"Norwich terrier",188:"Yorkshire terrier",189:"wire-haired fox terrier",190:"Lakeland terrier",191:"Sealyham terrier, Sealyham",192:"Airedale, Airedale terrier",193:"cairn, cairn terrier",194:"Australian terrier",195:"Dandie Dinmont, Dandie Dinmont terrier",196:"Boston bull, Boston terrier",197:"miniature schnauzer",198:"giant schnauzer",199:"standard schnauzer",200:"Scotch terrier, Scottish terrier, Scottie",201:"Tibetan terrier, chrysanthemum dog",202:"silky terrier, Sydney silky",203:"soft-coated wheaten terrier",204:"West Highland white terrier",205:"Lhasa, Lhasa apso",206:"flat-coated retriever",207:"curly-coated retriever",208:"golden retriever",209:"Labrador retriever",210:"Chesapeake Bay retriever",211:"German short-haired pointer",212:"vizsla, Hungarian pointer",213:"English setter",214:"Irish setter, red setter",215:"Gordon setter",216:"Brittany spaniel",217:"clumber, clumber spaniel",218:"English springer, English springer spaniel",219:"Welsh springer spaniel",220:"cocker spaniel, English cocker spaniel, cocker",221:"Sussex spaniel",222:"Irish water spaniel",223:"kuvasz",224:"schipperke",225:"groenendael",226:"malinois",227:"briard",228:"kelpie",229:"komondor",230:"Old English sheepdog, bobtail",231:"Shetland sheepdog, Shetland sheep dog, Shetland",232:"collie",233:"Border collie",234:"Bouvier des Flandres, Bouviers des Flandres",235:"Rottweiler",236:"German shepherd, German shepherd dog, German police dog, alsatian",237:"Doberman, Doberman pinscher",238:"miniature pinscher",239:"Greater Swiss Mountain dog",240:"Bernese mountain dog",241:"Appenzeller",242:"EntleBucher",243:"boxer",244:"bull mastiff",245:"Tibetan mastiff",246:"French bulldog",247:"Great Dane",248:"Saint Bernard, St Bernard",249:"Eskimo dog, husky",250:"malamute, malemute, Alaskan malamute",251:"Siberian husky",252:"dalmatian, coach dog, carriage dog",253:"affenpinscher, monkey pinscher, monkey dog",254:"basenji",255:"pug, pug-dog",256:"Leonberg",257:"Newfoundland, Newfoundland dog",258:"Great Pyrenees",259:"Samoyed, Samoyede",260:"Pomeranian",261:"chow, chow chow",262:"keeshond",263:"Brabancon griffon",264:"Pembroke, Pembroke Welsh corgi",265:"Cardigan, Cardigan Welsh corgi",266:"toy poodle",267:"miniature poodle",268:"standard poodle",269:"Mexican hairless",270:"timber wolf, grey wolf, gray wolf, Canis lupus",271:"white wolf, Arctic wolf, Canis lupus tundrarum",272:"red wolf, maned wolf, Canis rufus, Canis niger",273:"coyote, prairie wolf, brush wolf, Canis latrans",274:"dingo, warrigal, warragal, Canis dingo",275:"dhole, Cuon alpinus",276:"African hunting dog, hyena dog, Cape hunting dog, Lycaon pictus",277:"hyena, hyaena",278:"red fox, Vulpes vulpes",279:"kit fox, Vulpes macrotis",280:"Arctic fox, white fox, Alopex lagopus",281:"grey fox, gray fox, Urocyon cinereoargenteus",282:"tabby, tabby cat",283:"tiger cat",284:"Persian cat",285:"Siamese cat, Siamese",286:"Egyptian cat",287:"cougar, puma, catamount, mountain lion, painter, panther,"+" Felis concolor",288:"lynx, catamount",289:"leopard, Panthera pardus",290:"snow leopard, ounce, Panthera uncia",291:"jaguar, panther, Panthera onca, Felis onca",292:"lion, king of beasts, Panthera leo",293:"tiger, Panthera tigris",294:"cheetah, chetah, Acinonyx jubatus",295:"brown bear, bruin, Ursus arctos",296:"American black bear, black bear, Ursus americanus,"+" Euarctos americanus",297:"ice bear, polar bear, Ursus Maritimus, Thalarctos maritimus",298:"sloth bear, Melursus ursinus, Ursus ursinus",299:"mongoose",300:"meerkat, mierkat",301:"tiger beetle",302:"ladybug, ladybeetle, lady beetle, ladybird, ladybird beetle",303:"ground beetle, carabid beetle",304:"long-horned beetle, longicorn, longicorn beetle",305:"leaf beetle, chrysomelid",306:"dung beetle",307:"rhinoceros beetle",308:"weevil",309:"fly",310:"bee",311:"ant, emmet, pismire",312:"grasshopper, hopper",313:"cricket",314:"walking stick, walkingstick, stick insect",315:"cockroach, roach",316:"mantis, mantid",317:"cicada, cicala",318:"leafhopper",319:"lacewing, lacewing fly",320:"dragonfly, darning needle, devil's darning needle, sewing"+"needle, snake feeder, snake doctor, mosquito hawk, skeeter hawk",321:"damselfly",322:"admiral",323:"ringlet, ringlet butterfly",324:"monarch, monarch butterfly, milkweed butterfly, Danaus plexippus",325:"cabbage butterfly",326:"sulphur butterfly, sulfur butterfly",327:"lycaenid, lycaenid butterfly",328:"starfish, sea star",329:"sea urchin",330:"sea cucumber, holothurian",331:"wood rabbit, cottontail, cottontail rabbit",332:"hare",333:"Angora, Angora rabbit",334:"hamster",335:"porcupine, hedgehog",336:"fox squirrel, eastern fox squirrel, Sciurus niger",337:"marmot",338:"beaver",339:"guinea pig, Cavia cobaya",340:"sorrel",341:"zebra",342:"hog, pig, grunter, squealer, Sus scrofa",343:"wild boar, boar, Sus scrofa",344:"warthog",345:"hippopotamus, hippo, river horse, Hippopotamus amphibius",346:"ox",347:"water buffalo, water ox, Asiatic buffalo, Bubalus bubalis",348:"bison",349:"ram, tup",350:"bighorn, bighorn sheep, cimarron, Rocky Mountain bighorn, Rocky "+"Mountain sheep, Ovis canadensis",351:"ibex, Capra ibex",352:"hartebeest",353:"impala, Aepyceros melampus",354:"gazelle",355:"Arabian camel, dromedary, Camelus dromedarius",356:"llama",357:"weasel",358:"mink",359:"polecat, fitch, foulmart, foumart, Mustela putorius",360:"black-footed ferret, ferret, Mustela nigripes",361:"otter",362:"skunk, polecat, wood pussy",363:"badger",364:"armadillo",365:"three-toed sloth, ai, Bradypus tridactylus",366:"orangutan, orang, orangutang, Pongo pygmaeus",367:"gorilla, Gorilla gorilla",368:"chimpanzee, chimp, Pan troglodytes",369:"gibbon, Hylobates lar",370:"siamang, Hylobates syndactylus, Symphalangus syndactylus",371:"guenon, guenon monkey",372:"patas, hussar monkey, Erythrocebus patas",373:"baboon",374:"macaque",375:"langur",376:"colobus, colobus monkey",377:"proboscis monkey, Nasalis larvatus",378:"marmoset",379:"capuchin, ringtail, Cebus capucinus",380:"howler monkey, howler",381:"titi, titi monkey",382:"spider monkey, Ateles geoffroyi",383:"squirrel monkey, Saimiri sciureus",384:"Madagascar cat, ring-tailed lemur, Lemur catta",385:"indri, indris, Indri indri, Indri brevicaudatus",386:"Indian elephant, Elephas maximus",387:"African elephant, Loxodonta africana",388:"lesser panda, red panda, panda, bear cat, cat bear, Ailurus fulgens",389:"giant panda, panda, panda bear, coon bear, Ailuropoda melanoleuca",390:"barracouta, snoek",391:"eel",392:"coho, cohoe, coho salmon, blue jack, silver salmon, "+"Oncorhynchus kisutch",393:"rock beauty, Holocanthus tricolor",394:"anemone fish",395:"sturgeon",396:"gar, garfish, garpike, billfish, Lepisosteus osseus",397:"lionfish",398:"puffer, pufferfish, blowfish, globefish",399:"abacus",400:"abaya",401:"academic gown, academic robe, judge's robe",402:"accordion, piano accordion, squeeze box",403:"acoustic guitar",404:"aircraft carrier, carrier, flattop, attack aircraft carrier",405:"airliner",406:"airship, dirigible",407:"altar",408:"ambulance",409:"amphibian, amphibious vehicle",410:"analog clock",411:"apiary, bee house",412:"apron",413:"ashcan, trash can, garbage can, wastebin, ash bin, ash-bin,"+" ashbin, dustbin, trash barrel, trash bin",414:"assault rifle, assault gun",415:"backpack, back pack, knapsack, packsack, rucksack, haversack",416:"bakery, bakeshop, bakehouse",417:"balance beam, beam",418:"balloon",419:"ballpoint, ballpoint pen, ballpen, Biro",420:"Band Aid",421:"banjo",422:"bannister, banister, balustrade, balusters, handrail",423:"barbell",424:"barber chair",425:"barbershop",426:"barn",427:"barometer",428:"barrel, cask",429:"barrow, garden cart, lawn cart, wheelbarrow",430:"baseball",431:"basketball",432:"bassinet",433:"bassoon",434:"bathing cap, swimming cap",435:"bath towel",436:"bathtub, bathing tub, bath, tub",437:"beach wagon, station wagon, wagon, estate car, beach waggon,"+" station waggon, waggon",438:"beacon, lighthouse, beacon light, pharos",439:"beaker",440:"bearskin, busby, shako",441:"beer bottle",442:"beer glass",443:"bell cote, bell cot",444:"bib",445:"bicycle-built-for-two, tandem bicycle, tandem",446:"bikini, two-piece",447:"binder, ring-binder",448:"binoculars, field glasses, opera glasses",449:"birdhouse",450:"boathouse",451:"bobsled, bobsleigh, bob",452:"bolo tie, bolo, bola tie, bola",453:"bonnet, poke bonnet",454:"bookcase",455:"bookshop, bookstore, bookstall",456:"bottlecap",457:"bow",458:"bow tie, bow-tie, bowtie",459:"brass, memorial tablet, plaque",460:"brassiere, bra, bandeau",461:"breakwater, groin, groyne, mole, bulwark, seawall, jetty",462:"breastplate, aegis, egis",463:"broom",464:"bucket, pail",465:"buckle",466:"bulletproof vest",467:"bullet train, bullet",468:"butcher shop, meat market",469:"cab, hack, taxi, taxicab",470:"caldron, cauldron",471:"candle, taper, wax light",472:"cannon",473:"canoe",474:"can opener, tin opener",475:"cardigan",476:"car mirror",477:"carousel, carrousel, merry-go-round, roundabout, whirligig",478:"carpenter's kit, tool kit",479:"carton",480:"car wheel",481:"cash machine, cash dispenser, automated teller machine, automatic"+" teller machine, automated teller, automatic teller, ATM",482:"cassette",483:"cassette player",484:"castle",485:"catamaran",486:"CD player",487:"cello, violoncello",488:"cellular telephone, cellular phone, cellphone, cell, mobile phone",489:"chain",490:"chainlink fence",491:"chain mail, ring mail, mail, chain armor, chain armour,"+" ring armor, ring armour",492:"chain saw, chainsaw",493:"chest",494:"chiffonier, commode",495:"chime, bell, gong",496:"china cabinet, china closet",497:"Christmas stocking",498:"church, church building",499:"cinema, movie theater, movie theatre, movie house, picture palace",500:"cleaver, meat cleaver, chopper",501:"cliff dwelling",502:"cloak",503:"clog, geta, patten, sabot",504:"cocktail shaker",505:"coffee mug",506:"coffeepot",507:"coil, spiral, volute, whorl, helix",508:"combination lock",509:"computer keyboard, keypad",510:"confectionery, confectionary, candy store",511:"container ship, containership, container vessel",512:"convertible",513:"corkscrew, bottle screw",514:"cornet, horn, trumpet, trump",515:"cowboy boot",516:"cowboy hat, ten-gallon hat",517:"cradle",518:"crane",519:"crash helmet",520:"crate",521:"crib, cot",522:"Crock Pot",523:"croquet ball",524:"crutch",525:"cuirass",526:"dam, dike, dyke",527:"desk",528:"desktop computer",529:"dial telephone, dial phone",530:"diaper, nappy, napkin",531:"digital clock",532:"digital watch",533:"dining table, board",534:"dishrag, dishcloth",535:"dishwasher, dish washer, dishwashing machine",536:"disk brake, disc brake",537:"dock, dockage, docking facility",538:"dogsled, dog sled, dog sleigh",539:"dome",540:"doormat, welcome mat",541:"drilling platform, offshore rig",542:"drum, membranophone, tympan",543:"drumstick",544:"dumbbell",545:"Dutch oven",546:"electric fan, blower",547:"electric guitar",548:"electric locomotive",549:"entertainment center",550:"envelope",551:"espresso maker",552:"face powder",553:"feather boa, boa",554:"file, file cabinet, filing cabinet",555:"fireboat",556:"fire engine, fire truck",557:"fire screen, fireguard",558:"flagpole, flagstaff",559:"flute, transverse flute",560:"folding chair",561:"football helmet",562:"forklift",563:"fountain",564:"fountain pen",565:"four-poster",566:"freight car",567:"French horn, horn",568:"frying pan, frypan, skillet",569:"fur coat",570:"garbage truck, dustcart",571:"gasmask, respirator, gas helmet",572:"gas pump, gasoline pump, petrol pump, island dispenser",573:"goblet",574:"go-kart",575:"golf ball",576:"golfcart, golf cart",577:"gondola",578:"gong, tam-tam",579:"gown",580:"grand piano, grand",581:"greenhouse, nursery, glasshouse",582:"grille, radiator grille",583:"grocery store, grocery, food market, market",584:"guillotine",585:"hair slide",586:"hair spray",587:"half track",588:"hammer",589:"hamper",590:"hand blower, blow dryer, blow drier, hair dryer, hair drier",591:"hand-held computer, hand-held microcomputer",592:"handkerchief, hankie, hanky, hankey",593:"hard disc, hard disk, fixed disk",594:"harmonica, mouth organ, harp, mouth harp",595:"harp",596:"harvester, reaper",597:"hatchet",598:"holster",599:"home theater, home theatre",600:"honeycomb",601:"hook, claw",602:"hoopskirt, crinoline",603:"horizontal bar, high bar",604:"horse cart, horse-cart",605:"hourglass",606:"iPod",607:"iron, smoothing iron",608:"jack-o'-lantern",609:"jean, blue jean, denim",610:"jeep, landrover",611:"jersey, T-shirt, tee shirt",612:"jigsaw puzzle",613:"jinrikisha, ricksha, rickshaw",614:"joystick",615:"kimono",616:"knee pad",617:"knot",618:"lab coat, laboratory coat",619:"ladle",620:"lampshade, lamp shade",621:"laptop, laptop computer",622:"lawn mower, mower",623:"lens cap, lens cover",624:"letter opener, paper knife, paperknife",625:"library",626:"lifeboat",627:"lighter, light, igniter, ignitor",628:"limousine, limo",629:"liner, ocean liner",630:"lipstick, lip rouge",631:"Loafer",632:"lotion",633:"loudspeaker, speaker, speaker unit, loudspeaker system, "+"speaker system",634:"loupe, jeweler's loupe",635:"lumbermill, sawmill",636:"magnetic compass",637:"mailbag, postbag",638:"mailbox, letter box",639:"maillot",640:"maillot, tank suit",641:"manhole cover",642:"maraca",643:"marimba, xylophone",644:"mask",645:"matchstick",646:"maypole",647:"maze, labyrinth",648:"measuring cup",649:"medicine chest, medicine cabinet",650:"megalith, megalithic structure",651:"microphone, mike",652:"microwave, microwave oven",653:"military uniform",654:"milk can",655:"minibus",656:"miniskirt, mini",657:"minivan",658:"missile",659:"mitten",660:"mixing bowl",661:"mobile home, manufactured home",662:"Model T",663:"modem",664:"monastery",665:"monitor",666:"moped",667:"mortar",668:"mortarboard",669:"mosque",670:"mosquito net",671:"motor scooter, scooter",672:"mountain bike, all-terrain bike, off-roader",673:"mountain tent",674:"mouse, computer mouse",675:"mousetrap",676:"moving van",677:"muzzle",678:"nail",679:"neck brace",680:"necklace",681:"nipple",682:"notebook, notebook computer",683:"obelisk",684:"oboe, hautboy, hautbois",685:"ocarina, sweet potato",686:"odometer, hodometer, mileometer, milometer",687:"oil filter",688:"organ, pipe organ",689:"oscilloscope, scope, cathode-ray oscilloscope, CRO",690:"overskirt",691:"oxcart",692:"oxygen mask",693:"packet",694:"paddle, boat paddle",695:"paddlewheel, paddle wheel",696:"padlock",697:"paintbrush",698:"pajama, pyjama, pj's, jammies",699:"palace",700:"panpipe, pandean pipe, syrinx",701:"paper towel",702:"parachute, chute",703:"parallel bars, bars",704:"park bench",705:"parking meter",706:"passenger car, coach, carriage",707:"patio, terrace",708:"pay-phone, pay-station",709:"pedestal, plinth, footstall",710:"pencil box, pencil case",711:"pencil sharpener",712:"perfume, essence",713:"Petri dish",714:"photocopier",715:"pick, plectrum, plectron",716:"pickelhaube",717:"picket fence, paling",718:"pickup, pickup truck",719:"pier",720:"piggy bank, penny bank",721:"pill bottle",722:"pillow",723:"ping-pong ball",724:"pinwheel",725:"pirate, pirate ship",726:"pitcher, ewer",727:"plane, carpenter's plane, woodworking plane",728:"planetarium",729:"plastic bag",730:"plate rack",731:"plow, plough",732:"plunger, plumber's helper",733:"Polaroid camera, Polaroid Land camera",734:"pole",735:"police van, police wagon, paddy wagon, patrol wagon, wagon,"+" black Maria",736:"poncho",737:"pool table, billiard table, snooker table",738:"pop bottle, soda bottle",739:"pot, flowerpot",740:"potter's wheel",741:"power drill",742:"prayer rug, prayer mat",743:"printer",744:"prison, prison house",745:"projectile, missile",746:"projector",747:"puck, hockey puck",748:"punching bag, punch bag, punching ball, punchball",749:"purse",750:"quill, quill pen",751:"quilt, comforter, comfort, puff",752:"racer, race car, racing car",753:"racket, racquet",754:"radiator",755:"radio, wireless",756:"radio telescope, radio reflector",757:"rain barrel",758:"recreational vehicle, RV, R.V.",759:"reel",760:"reflex camera",761:"refrigerator, icebox",762:"remote control, remote",763:"restaurant, eating house, eating place, eatery",764:"revolver, six-gun, six-shooter",765:"rifle",766:"rocking chair, rocker",767:"rotisserie",768:"rubber eraser, rubber, pencil eraser",769:"rugby ball",770:"rule, ruler",771:"running shoe",772:"safe",773:"safety pin",774:"saltshaker, salt shaker",775:"sandal",776:"sarong",777:"sax, saxophone",778:"scabbard",779:"scale, weighing machine",780:"school bus",781:"schooner",782:"scoreboard",783:"screen, CRT screen",784:"screw",785:"screwdriver",786:"seat belt, seatbelt",787:"sewing machine",788:"shield, buckler",789:"shoe shop, shoe-shop, shoe store",790:"shoji",791:"shopping basket",792:"shopping cart",793:"shovel",794:"shower cap",795:"shower curtain",796:"ski",797:"ski mask",798:"sleeping bag",799:"slide rule, slipstick",800:"sliding door",801:"slot, one-armed bandit",802:"snorkel",803:"snowmobile",804:"snowplow, snowplough",805:"soap dispenser",806:"soccer ball",807:"sock",808:"solar dish, solar collector, solar furnace",809:"sombrero",810:"soup bowl",811:"space bar",812:"space heater",813:"space shuttle",814:"spatula",815:"speedboat",816:"spider web, spider's web",817:"spindle",818:"sports car, sport car",819:"spotlight, spot",820:"stage",821:"steam locomotive",822:"steel arch bridge",823:"steel drum",824:"stethoscope",825:"stole",826:"stone wall",827:"stopwatch, stop watch",828:"stove",829:"strainer",830:"streetcar, tram, tramcar, trolley, trolley car",831:"stretcher",832:"studio couch, day bed",833:"stupa, tope",834:"submarine, pigboat, sub, U-boat",835:"suit, suit of clothes",836:"sundial",837:"sunglass",838:"sunglasses, dark glasses, shades",839:"sunscreen, sunblock, sun blocker",840:"suspension bridge",841:"swab, swob, mop",842:"sweatshirt",843:"swimming trunks, bathing trunks",844:"swing",845:"switch, electric switch, electrical switch",846:"syringe",847:"table lamp",848:"tank, army tank, armored combat vehicle, armoured combat vehicle",849:"tape player",850:"teapot",851:"teddy, teddy bear",852:"television, television system",853:"tennis ball",854:"thatch, thatched roof",855:"theater curtain, theatre curtain",856:"thimble",857:"thresher, thrasher, threshing machine",858:"throne",859:"tile roof",860:"toaster",861:"tobacco shop, tobacconist shop, tobacconist",862:"toilet seat",863:"torch",864:"totem pole",865:"tow truck, tow car, wrecker",866:"toyshop",867:"tractor",868:"trailer truck, tractor trailer, trucking rig, rig,"+" articulated lorry, semi",869:"tray",870:"trench coat",871:"tricycle, trike, velocipede",872:"trimaran",873:"tripod",874:"triumphal arch",875:"trolleybus, trolley coach, trackless trolley",876:"trombone",877:"tub, vat",878:"turnstile",879:"typewriter keyboard",880:"umbrella",881:"unicycle, monocycle",882:"upright, upright piano",883:"vacuum, vacuum cleaner",884:"vase",885:"vault",886:"velvet",887:"vending machine",888:"vestment",889:"viaduct",890:"violin, fiddle",891:"volleyball",892:"waffle iron",893:"wall clock",894:"wallet, billfold, notecase, pocketbook",895:"wardrobe, closet, press",896:"warplane, military plane",897:"washbasin, handbasin, washbowl, lavabo, wash-hand basin",898:"washer, automatic washer, washing machine",899:"water bottle",900:"water jug",901:"water tower",902:"whiskey jug",903:"whistle",904:"wig",905:"window screen",906:"window shade",907:"Windsor tie",908:"wine bottle",909:"wing",910:"wok",911:"wooden spoon",912:"wool, woolen, woollen",913:"worm fence, snake fence, snake-rail fence, Virginia fence",914:"wreck",915:"yawl",916:"yurt",917:"web site, website, internet site, site",918:"comic book",919:"crossword puzzle, crossword",920:"street sign",921:"traffic light, traffic signal, stoplight",922:"book jacket, dust cover, dust jacket, dust wrapper",923:"menu",924:"plate",925:"guacamole",926:"consomme",927:"hot pot, hotpot",928:"trifle",929:"ice cream, icecream",930:"ice lolly, lolly, lollipop, popsicle",931:"French loaf",932:"bagel, beigel",933:"pretzel",934:"cheeseburger",935:"hotdog, hot dog, red hot",936:"mashed potato",937:"head cabbage",938:"broccoli",939:"cauliflower",940:"zucchini, courgette",941:"spaghetti squash",942:"acorn squash",943:"butternut squash",944:"cucumber, cuke",945:"artichoke, globe artichoke",946:"bell pepper",947:"cardoon",948:"mushroom",949:"Granny Smith",950:"strawberry",951:"orange",952:"lemon",953:"fig",954:"pineapple, ananas",955:"banana",956:"jackfruit, jak, jack",957:"custard apple",958:"pomegranate",959:"hay",960:"carbonara",961:"chocolate sauce, chocolate syrup",962:"dough",963:"meat loaf, meatloaf",964:"pizza, pizza pie",965:"potpie",966:"burrito",967:"red wine",968:"espresso",969:"cup",970:"eggnog",971:"alp",972:"bubble",973:"cliff, drop, drop-off",974:"coral reef",975:"geyser",976:"lakeside, lakeshore",977:"promontory, headland, head, foreland",978:"sandbar, sand bar",979:"seashore, coast, seacoast, sea-coast",980:"valley, vale",981:"volcano",982:"ballplayer, baseball player",983:"groom, bridegroom",984:"scuba diver",985:"rapeseed",986:"daisy",987:"yellow lady's slipper, yellow lady-slipper, Cypripedium"+" calceolus, Cypripedium parviflorum",988:"corn",989:"acorn",990:"hip, rose hip, rosehip",991:"buckeye, horse chestnut, conker",992:"coral fungus",993:"agaric",994:"gyromitra",995:"stinkhorn, carrion fungus",996:"earthstar",997:"hen-of-the-woods, hen of the woods, Polyporus"+" frondosus, Grifola frondosa",998:"bolete",999:"ear, spike, capitulum",1e3:"toilet tissue, toilet paper, bathroom tissue"}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var array3DToImage=function array3DToImage(imgData){var _imgData$shape=_slicedToArray(imgData.shape,2),imgWidth=_imgData$shape[0],imgHeight=_imgData$shape[1];var data=imgData.dataSync();var canvas=document.createElement("canvas");canvas.width=imgWidth;canvas.height=imgHeight;var ctx=canvas.getContext("2d");var imageData=ctx.getImageData(0,0,canvas.width,canvas.height);for(var i=0;i<imgWidth*imgHeight;i+=1){var j=i*4;var k=i*3;imageData.data[j+0]=Math.floor(256*data[k+0]);imageData.data[j+1]=Math.floor(256*data[k+1]);imageData.data[j+2]=Math.floor(256*data[k+2]);imageData.data[j+3]=255}ctx.putImageData(imageData,0,0);var dataUrl=canvas.toDataURL();var outputImg=document.createElement("img");outputImg.src=dataUrl;outputImg.style.width=imgWidth;outputImg.style.height=imgHeight;return outputImg};exports.default=array3DToImage}])});